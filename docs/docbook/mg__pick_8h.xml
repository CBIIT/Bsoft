<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_mg__pick_8h" xml:lang="en-US">
<title>/Users/bernard/b20/bsoft/include/mg_pick.h File Reference</title>
<indexterm><primary>/Users/bernard/b20/bsoft/include/mg_pick.h</primary></indexterm>
<para>

<para>Header file for single particle picking functions. </para>
 
</para>
<programlisting>#include &quot;mg_processing.h&quot;
#include &quot;rwimg.h&quot;
#include &quot;marker.h&quot;
</programlisting><simplesect>
    <title>Functions    </title>
        <itemizedlist>
            <listitem><para><link linkend="_class_bparticle">Bparticle</link> * <link linkend="_mg__pick_8h_1ab7ccc5b38841c16eab514e33ed0874d1">particles_from_peaks</link> (<link linkend="_class_bimage">Bimage</link> *pcc, long bin, double excl_dist, double part_ori, double &amp;fommin, double fommax=1e30, long maxnum=1000000, double pix_min=2, double pix_max=10)</para>

<para>Finds the peaks in a cross-correlation map corresponding to particles. </para>
</listitem>
            <listitem><para><link linkend="_class_bparticle">Bparticle</link> * <link linkend="_mg__pick_8h_1a46bf293fcc1eec6a2f839f4d4e1d62b0">particles_pick_cc</link> (<link linkend="_class_bimage">Bimage</link> *p, <link linkend="_class_bimage">Bimage</link> *ptemp, <link linkend="_class_bimage">Bimage</link> *pmask, double hires, double lores, double fommin, double fommax, double excl_dist, long bin=1)</para>

<para>Picks particles using cross-correlation. </para>
</listitem>
            <listitem><para><link linkend="_class_bparticle">Bparticle</link> * <link linkend="_mg__pick_8h_1a1d82f76cda5944e4bddf7dc332ba900d">particles_pick_var</link> (<link linkend="_class_bimage">Bimage</link> *p, long average_kernel, long var_kernel, double nsig, double part_ori, double excl_dist, long bin)</para>

<para>Picks particles in variance map. </para>
</listitem>
            <listitem><para><link linkend="_class_bparticle">Bparticle</link> * <link linkend="_mg__pick_8h_1a9777bc2296380ac6328d1a337ba225e3">particles_pick_var</link> (<link linkend="_class_bimage">Bimage</link> *p, long average_kernel, long var_kernel, double cutmin, double cutmax, double part_ori, double excl_dist, long bin)</para>
</listitem>
            <listitem><para><link linkend="_class_bparticle">Bparticle</link> * <link linkend="_mg__pick_8h_1a0b69bc8f158cf7c1d6ac70e72437ca67">particles_pick_cc</link> (<link linkend="_class_bstring">Bstring</link> &amp;filename, long img_num, <link linkend="_class_bimage">Bimage</link> *ptemp, <link linkend="_class_bimage">Bimage</link> *pmask, double hires, double lores, double fommin, double fommax, double excl_dist, long bin=1)</para>

<para>Picks particles using cross-correlation. </para>
</listitem>
            <listitem><para><link linkend="_class_bparticle">Bparticle</link> * <link linkend="_mg__pick_8h_1a3d57f97b05afffea77f5f66b3b31968c">particles_pick_var</link> (<link linkend="_class_bstring">Bstring</link> &amp;filename, long img_num, long average_kernel, long var_kernel, double nsig, double part_ori, double excl_dist, long bin)</para>

<para>Picks particles in variance map. </para>
</listitem>
            <listitem><para>double <link linkend="_mg__pick_8h_1a55548a3e01919c369449304470bb943a">project_pick_particles</link> (<link linkend="_class_bproject">Bproject</link> *<link linkend="_tcltk__bmodel_8cpp_1aea438e09dfc03683a0f49a05e9a69cac">project</link>, <link linkend="_class_bimage">Bimage</link> *ptemp, <link linkend="_class_bimage">Bimage</link> *pmask, double hires, double lores, double fommin, double fommax, double excl_dist, long bin)</para>

<para>Picks particles using cross-correlation. </para>
</listitem>
            <listitem><para>double <link linkend="_mg__pick_8h_1a5868b84fc7a9b82c3bb7aa6f4048343c">project_pick_particles</link> (<link linkend="_class_bproject">Bproject</link> *<link linkend="_tcltk__bmodel_8cpp_1aea438e09dfc03683a0f49a05e9a69cac">project</link>, long average_kernel, long var_kernel, double nsig, double part_ori, double excl_dist, long bin)</para>

<para>Picks particles in variance map. </para>
</listitem>
            <listitem><para>long <link linkend="_mg__pick_8h_1a3577fe340636129fd51e37f2e57aaa8b">project_pick_particles</link> (<link linkend="_class_bproject">Bproject</link> *<link linkend="_tcltk__bmodel_8cpp_1aea438e09dfc03683a0f49a05e9a69cac">project</link>, double din, double dout, int avg_kernel, double ainc, int flags, int contrast)</para>

<para>Locates particles using a fore/background difference measure. </para>
</listitem>
            <listitem><para>long <link linkend="_mg__pick_8h_1a6922e824abff4e64b8d5d2a2489f4806">project_pick_background</link> (<link linkend="_class_bproject">Bproject</link> *<link linkend="_tcltk__bmodel_8cpp_1aea438e09dfc03683a0f49a05e9a69cac">project</link>, long number, long average_kernel, long var_kernel, double excl_dist)</para>

<para>Picks background areas not overlapping existing particles. </para>
</listitem>
            <listitem><para>long <link linkend="_mg__pick_8h_1a26bb7fcc279d123048308edcc26e93f9">project_pick_sym_axis</link> (<link linkend="_class_bproject">Bproject</link> *<link linkend="_tcltk__bmodel_8cpp_1aea438e09dfc03683a0f49a05e9a69cac">project</link>, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp;sym, int sym_axis, double axis_dist)</para>

<para>Picks subregions in 3D particles on the given symmetry axis. </para>
</listitem>
            <listitem><para>double <link linkend="_mg__pick_8h_1a8dae4e50317671edde11c61bb12a6ede">project_extract_orient_particles</link> (<link linkend="_class_bproject">Bproject</link> *<link linkend="_tcltk__bmodel_8cpp_1aea438e09dfc03683a0f49a05e9a69cac">project</link>, <link linkend="_class_bstring">Bstring</link> &amp;tempfile, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp;sym, double hires, double lores, long bin)</para>

<para>Picks particles using cross-correlation. </para>
</listitem>
        </itemizedlist>
</simplesect>
<section>
<title>Detailed Description</title>

<para>Header file for single particle picking functions. </para>

<para><formalpara><title>Author</title>

<para>Bernard Heymann </para>
</formalpara>
<formalpara><title>Date</title>

<para>Created: 20000505 </para>

<para>Modified: 20190912 </para>
</formalpara>
</para>
</section>
<section>
<title>Function Documentation</title>
<anchor xml:id="_mg__pick_8h_1ab7ccc5b38841c16eab514e33ed0874d1"/>    <section>
    <title>particles_from_peaks()</title>
<indexterm><primary>particles_from_peaks</primary><secondary>mg_pick.h</secondary></indexterm>
<indexterm><primary>mg_pick.h</primary><secondary>particles_from_peaks</secondary></indexterm>
<para><computeroutput><link linkend="_class_bparticle">Bparticle</link>* particles_from_peaks (<link linkend="_class_bimage">Bimage</link> * pcc, long bin, double excl_dist, double part_ori, double &amp; fommin, double fommax, long maxnum, double pix_min, double pix_max)</computeroutput></para><para>

<para>Finds the peaks in a cross-correlation map corresponding to particles. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pcc</entry>
                                <entry>
<para>peak map (after binning). </para>
</entry>
                            </row>
                            <row>
                                <entry>bin</entry>
                                <entry>
<para>binning to speed up calculations. </para>
</entry>
                            </row>
                            <row>
                                <entry>excl_dist</entry>
                                <entry>
<para>distance between peaks. </para>
</entry>
                            </row>
                            <row>
                                <entry>part_ori</entry>
                                <entry>
<para>particle origin. </para>
</entry>
                            </row>
                            <row>
                                <entry>fommin</entry>
                                <entry>
<para>minimum threshold to accept peaks. </para>
</entry>
                            </row>
                            <row>
                                <entry>fommax</entry>
                                <entry>
<para>maximum threshold to accept peaks. </para>
</entry>
                            </row>
                            <row>
                                <entry>maxnum</entry>
                                <entry>
<para>maximum number of peaks to pick. </para>
</entry>
                            </row>
                            <row>
                                <entry>pix_min</entry>
                                <entry>
<para>minimum peak width. </para>
</entry>
                            </row>
                            <row>
                                <entry>pix_max</entry>
                                <entry>
<para>maximum peak width. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bparticle* list of particles. <literallayout><computeroutput>The map is searched in increments of the particle radius to identify
peaks above the threshold and within a box the size of the
particle radius. The identified peaks are further examined to eliminate 
ones that are too close to a higher scoring peak. The acceptable distance
between peaks is set to 1.8 times the particle radius.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 75 of file mg_pick.cpp.</para>
    </section><anchor xml:id="_mg__pick_8h_1a46bf293fcc1eec6a2f839f4d4e1d62b0"/>    <section>
    <title>particles_pick_cc()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>particles_pick_cc</primary><secondary>mg_pick.h</secondary></indexterm>
<indexterm><primary>mg_pick.h</primary><secondary>particles_pick_cc</secondary></indexterm>
<para><computeroutput><link linkend="_class_bparticle">Bparticle</link>* particles_pick_cc (<link linkend="_class_bimage">Bimage</link> * p, <link linkend="_class_bimage">Bimage</link> * ptemp, <link linkend="_class_bimage">Bimage</link> * pmask, double hires, double lores, double fommin, double fommax, double excl_dist, long bin)</computeroutput></para><para>

<para>Picks particles using cross-correlation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image to pick from. </para>
</entry>
                            </row>
                            <row>
                                <entry>*ptemp</entry>
                                <entry>
<para>template image. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>frequency space mask. </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>fommin</entry>
                                <entry>
<para>minimum FOM cutoff. </para>
</entry>
                            </row>
                            <row>
                                <entry>fommax</entry>
                                <entry>
<para>maximum FOM cutoff. </para>
</entry>
                            </row>
                            <row>
                                <entry>excl_dist</entry>
                                <entry>
<para>minimum distance between particles. </para>
</entry>
                            </row>
                            <row>
                                <entry>bin</entry>
                                <entry>
<para>level of image binning. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bparticle* list of particles. <literallayout><computeroutput>A template is cross-correlated with the input image including
bandpass filtering to target the size of the particle.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 141 of file mg_pick.cpp.</para>
    </section><anchor xml:id="_mg__pick_8h_1a0b69bc8f158cf7c1d6ac70e72437ca67"/>    <section>
    <title>particles_pick_cc()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>particles_pick_cc</primary><secondary>mg_pick.h</secondary></indexterm>
<indexterm><primary>mg_pick.h</primary><secondary>particles_pick_cc</secondary></indexterm>
<para><computeroutput><link linkend="_class_bparticle">Bparticle</link>* particles_pick_cc (<link linkend="_class_bstring">Bstring</link> &amp; filename, long img_num, <link linkend="_class_bimage">Bimage</link> * ptemp, <link linkend="_class_bimage">Bimage</link> * pmask, double hires, double lores, double fommin, double fommax, double excl_dist, long bin)</computeroutput></para><para>

<para>Picks particles using cross-correlation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>&amp;filename</entry>
                                <entry>
<para>image to pick from. </para>
</entry>
                            </row>
                            <row>
                                <entry>img_num</entry>
                                <entry>
<para>sub-image number. </para>
</entry>
                            </row>
                            <row>
                                <entry>*ptemp</entry>
                                <entry>
<para>template image. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>frequency space mask. </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>fommin</entry>
                                <entry>
<para>minimum FOM cutoff. </para>
</entry>
                            </row>
                            <row>
                                <entry>fommax</entry>
                                <entry>
<para>maximum FOM cutoff. </para>
</entry>
                            </row>
                            <row>
                                <entry>excl_dist</entry>
                                <entry>
<para>minimum distance between particles. </para>
</entry>
                            </row>
                            <row>
                                <entry>bin</entry>
                                <entry>
<para>level of image binning. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bparticle* list of particles. <literallayout><computeroutput>A template is cross-correlated with the input image including
bandpass filtering to target the size of the particle.
The template must have the correct pixel size.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 338 of file mg_pick.cpp.</para>
    </section><anchor xml:id="_mg__pick_8h_1a9777bc2296380ac6328d1a337ba225e3"/>    <section>
    <title>particles_pick_var()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>particles_pick_var</primary><secondary>mg_pick.h</secondary></indexterm>
<indexterm><primary>mg_pick.h</primary><secondary>particles_pick_var</secondary></indexterm>
<para><computeroutput><link linkend="_class_bparticle">Bparticle</link>* particles_pick_var (<link linkend="_class_bimage">Bimage</link> * p, long average_kernel, long var_kernel, double cutmin, double cutmax, double part_ori, double excl_dist, long bin)</computeroutput></para><para>
Definition at line 288 of file mg_pick.cpp.</para>
    </section><anchor xml:id="_mg__pick_8h_1a1d82f76cda5944e4bddf7dc332ba900d"/>    <section>
    <title>particles_pick_var()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>particles_pick_var</primary><secondary>mg_pick.h</secondary></indexterm>
<indexterm><primary>mg_pick.h</primary><secondary>particles_pick_var</secondary></indexterm>
<para><computeroutput><link linkend="_class_bparticle">Bparticle</link>* particles_pick_var (<link linkend="_class_bimage">Bimage</link> * p, long avg_kernel, long var_kernel, double nsig, double part_ori, double excl_dist, long bin)</computeroutput></para><para>

<para>Picks particles in variance map. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image to pick from. </para>
</entry>
                            </row>
                            <row>
                                <entry>avg_kernel</entry>
                                <entry>
<para>averaging kernel size. </para>
</entry>
                            </row>
                            <row>
                                <entry>var_kernel</entry>
                                <entry>
<para>variance kernel size. </para>
</entry>
                            </row>
                            <row>
                                <entry>nsig</entry>
                                <entry>
<para>multiple of sigma above variance average to accept peaks. </para>
</entry>
                            </row>
                            <row>
                                <entry>part_ori</entry>
                                <entry>
<para>particle origin. </para>
</entry>
                            </row>
                            <row>
                                <entry>excl_dist</entry>
                                <entry>
<para>minimum distance between particles. </para>
</entry>
                            </row>
                            <row>
                                <entry>bin</entry>
                                <entry>
<para>level of image binning. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bparticle* list of particles. <literallayout><computeroutput>A copy of the micrograph is filtered with an averaging kernel
and a variance map calculated. The variance map is then used to
find high variance peaks as candidate locations for particles.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 222 of file mg_pick.cpp.</para>
    </section><anchor xml:id="_mg__pick_8h_1a3d57f97b05afffea77f5f66b3b31968c"/>    <section>
    <title>particles_pick_var()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>particles_pick_var</primary><secondary>mg_pick.h</secondary></indexterm>
<indexterm><primary>mg_pick.h</primary><secondary>particles_pick_var</secondary></indexterm>
<para><computeroutput><link linkend="_class_bparticle">Bparticle</link>* particles_pick_var (<link linkend="_class_bstring">Bstring</link> &amp; filename, long img_num, long avg_kernel, long var_kernel, double nsig, double part_ori, double excl_dist, long bin)</computeroutput></para><para>

<para>Picks particles in variance map. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>&amp;filename</entry>
                                <entry>
<para>image to pick from. </para>
</entry>
                            </row>
                            <row>
                                <entry>img_num</entry>
                                <entry>
<para>sub-image number. </para>
</entry>
                            </row>
                            <row>
                                <entry>avg_kernel</entry>
                                <entry>
<para>averaging kernel size. </para>
</entry>
                            </row>
                            <row>
                                <entry>var_kernel</entry>
                                <entry>
<para>variance kernel size. </para>
</entry>
                            </row>
                            <row>
                                <entry>nsig</entry>
                                <entry>
<para>multiple of sigma above variance average to accept peaks. </para>
</entry>
                            </row>
                            <row>
                                <entry>part_ori</entry>
                                <entry>
<para>particle origin. </para>
</entry>
                            </row>
                            <row>
                                <entry>excl_dist</entry>
                                <entry>
<para>minimum distance between particles. </para>
</entry>
                            </row>
                            <row>
                                <entry>bin</entry>
                                <entry>
<para>level of image binning. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bparticle* list of particles. <literallayout><computeroutput>A copy of the micrograph is filtered with an averaging kernel
and a variance map calculated. The variance map is then used to
find high variance peaks as candidate locations for particles.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 372 of file mg_pick.cpp.</para>
    </section><anchor xml:id="_mg__pick_8h_1a8dae4e50317671edde11c61bb12a6ede"/>    <section>
    <title>project_extract_orient_particles()</title>
<indexterm><primary>project_extract_orient_particles</primary><secondary>mg_pick.h</secondary></indexterm>
<indexterm><primary>mg_pick.h</primary><secondary>project_extract_orient_particles</secondary></indexterm>
<para><computeroutput>double project_extract_orient_particles (<link linkend="_class_bproject">Bproject</link> * project, <link linkend="_class_bstring">Bstring</link> &amp; tempfile, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp; sym, double hires, double lores, long bin)</computeroutput></para><para>

<para>Picks particles using cross-correlation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*project</entry>
                                <entry>
<para>project parameter structure. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;tempfile</entry>
                                <entry>
<para>template image. </para>
</entry>
                            </row>
                            <row>
                                <entry>sym</entry>
                                <entry>
<para>point group symmetry. </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>bin</entry>
                                <entry>
<para>level of image binning. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double minimum threshold used to accept peaks. <literallayout><computeroutput>Each micrograph is cross-correlated with the template image including
bandpass filtering and frequency space masking.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1303 of file mg_pick.cpp.</para>
    </section><anchor xml:id="_mg__pick_8h_1a6922e824abff4e64b8d5d2a2489f4806"/>    <section>
    <title>project_pick_background()</title>
<indexterm><primary>project_pick_background</primary><secondary>mg_pick.h</secondary></indexterm>
<indexterm><primary>mg_pick.h</primary><secondary>project_pick_background</secondary></indexterm>
<para><computeroutput>long project_pick_background (<link linkend="_class_bproject">Bproject</link> * project, long number, long avg_kernel, long var_kernel, double excl_dist)</computeroutput></para><para>

<para>Picks background areas not overlapping existing particles. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*project</entry>
                                <entry>
<para>project parameter structure. </para>
</entry>
                            </row>
                            <row>
                                <entry>number</entry>
                                <entry>
<para>maximum number of background images to pick. </para>
</entry>
                            </row>
                            <row>
                                <entry>avg_kernel</entry>
                                <entry>
<para>averaging kernel to smooth the image. </para>
</entry>
                            </row>
                            <row>
                                <entry>var_kernel</entry>
                                <entry>
<para>kernel to calculate a local variance image. </para>
</entry>
                            </row>
                            <row>
                                <entry>excl_dist</entry>
                                <entry>
<para>exclusion distance between areas. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of background areas. </para>
</formalpara>
</para>
<para>
Definition at line 850 of file mg_pick.cpp.</para>
    </section><anchor xml:id="_mg__pick_8h_1a55548a3e01919c369449304470bb943a"/>    <section>
    <title>project_pick_particles()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>project_pick_particles</primary><secondary>mg_pick.h</secondary></indexterm>
<indexterm><primary>mg_pick.h</primary><secondary>project_pick_particles</secondary></indexterm>
<para><computeroutput>double project_pick_particles (<link linkend="_class_bproject">Bproject</link> * project, <link linkend="_class_bimage">Bimage</link> * ptemp, <link linkend="_class_bimage">Bimage</link> * pmask, double hires, double lores, double fommin, double fommax, double excl_dist, long bin)</computeroutput></para><para>

<para>Picks particles using cross-correlation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*project</entry>
                                <entry>
<para>project parameter structure. </para>
</entry>
                            </row>
                            <row>
                                <entry>*ptemp</entry>
                                <entry>
<para>template image. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>frequency space mask. </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>fommin</entry>
                                <entry>
<para>minimum FOM cutoff. </para>
</entry>
                            </row>
                            <row>
                                <entry>fommax</entry>
                                <entry>
<para>maximum FOM cutoff. </para>
</entry>
                            </row>
                            <row>
                                <entry>excl_dist</entry>
                                <entry>
<para>minimum distance between particles. </para>
</entry>
                            </row>
                            <row>
                                <entry>bin</entry>
                                <entry>
<para>level of image binning. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double minimum threshold used to accept peaks. <literallayout><computeroutput>Each micrograph is cross-correlated with the template image including
bandpass filtering and frequency space masking.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 535 of file mg_pick.cpp.</para>
    </section><anchor xml:id="_mg__pick_8h_1a3577fe340636129fd51e37f2e57aaa8b"/>    <section>
    <title>project_pick_particles()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>project_pick_particles</primary><secondary>mg_pick.h</secondary></indexterm>
<indexterm><primary>mg_pick.h</primary><secondary>project_pick_particles</secondary></indexterm>
<para><computeroutput>long project_pick_particles (<link linkend="_class_bproject">Bproject</link> * project, double din, double dout, int avg_kernel, double ainc, int flags, int contrast)</computeroutput></para><para>

<para>Locates particles using a fore/background difference measure. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*project</entry>
                                <entry>
<para>project parameter structure. </para>
</entry>
                            </row>
                            <row>
                                <entry>din</entry>
                                <entry>
<para>inner diameter corresponding to particle edge. </para>
</entry>
                            </row>
                            <row>
                                <entry>dout</entry>
                                <entry>
<para>outer diameter corresponding to background. </para>
</entry>
                            </row>
                            <row>
                                <entry>avg_kernel</entry>
                                <entry>
<para>averaging kernle to smooth difference map. </para>
</entry>
                            </row>
                            <row>
                                <entry>ainc</entry>
                                <entry>
<para>angular increment. </para>
</entry>
                            </row>
                            <row>
                                <entry>flags</entry>
                                <entry>
<para>flags: bit 1 = filter extremes. </para>
</entry>
                            </row>
                            <row>
                                <entry>contrast</entry>
                                <entry>
<para>contrast direction (foreground: white=1, black=0). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of particles. <literallayout><computeroutput>Two marker sets are generated at the indicated diameters.
At each pixel, the marker sets are used to calculate a difference
between the foreground and background as an estimate of the
presence of a particle.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 678 of file mg_pick.cpp.</para>
    </section><anchor xml:id="_mg__pick_8h_1a5868b84fc7a9b82c3bb7aa6f4048343c"/>    <section>
    <title>project_pick_particles()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>project_pick_particles</primary><secondary>mg_pick.h</secondary></indexterm>
<indexterm><primary>mg_pick.h</primary><secondary>project_pick_particles</secondary></indexterm>
<para><computeroutput>double project_pick_particles (<link linkend="_class_bproject">Bproject</link> * project, long avg_kernel, long var_kernel, double nsig, double part_ori, double excl_dist, long bin)</computeroutput></para><para>

<para>Picks particles in variance map. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*project</entry>
                                <entry>
<para>project parameter structure. </para>
</entry>
                            </row>
                            <row>
                                <entry>avg_kernel</entry>
                                <entry>
<para>averaging kernel size. </para>
</entry>
                            </row>
                            <row>
                                <entry>var_kernel</entry>
                                <entry>
<para>variance kernel size. </para>
</entry>
                            </row>
                            <row>
                                <entry>nsig</entry>
                                <entry>
<para>multiple of sigma above variance average to accept peaks. </para>
</entry>
                            </row>
                            <row>
                                <entry>part_ori</entry>
                                <entry>
<para>particle origin. </para>
</entry>
                            </row>
                            <row>
                                <entry>excl_dist</entry>
                                <entry>
<para>minimum distance between particles. </para>
</entry>
                            </row>
                            <row>
                                <entry>bin</entry>
                                <entry>
<para>level of image binning. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double minimum threshold used to accept peaks. <literallayout><computeroutput>A copy of the micrograph is filtered with an averaging kernel
and a variance map calculated. The variance map is then used to
find high variance peaks as candidate locations for particles.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 607 of file mg_pick.cpp.</para>
    </section><anchor xml:id="_mg__pick_8h_1a26bb7fcc279d123048308edcc26e93f9"/>    <section>
    <title>project_pick_sym_axis()</title>
<indexterm><primary>project_pick_sym_axis</primary><secondary>mg_pick.h</secondary></indexterm>
<indexterm><primary>mg_pick.h</primary><secondary>project_pick_sym_axis</secondary></indexterm>
<para><computeroutput>long project_pick_sym_axis (<link linkend="_class_bproject">Bproject</link> * project, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp; sym, int sym_axis, double axis_dist)</computeroutput></para><para>

<para>Picks subregions in 3D particles on the given symmetry axis. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*project</entry>
                                <entry>
<para>parameter structure with all parameters. </para>
</entry>
                            </row>
                            <row>
                                <entry>sym</entry>
                                <entry>
<para>point group symmetry. </para>
</entry>
                            </row>
                            <row>
                                <entry>sym_axis</entry>
                                <entry>
<para>symmetry axis to pick subregions. </para>
</entry>
                            </row>
                            <row>
                                <entry>axis_dist</entry>
                                <entry>
<para>distance along symmetry axis. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of new particles. <literallayout><computeroutput>The existing particles are replaced by the new particles.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 946 of file mg_pick.cpp.</para>
</section>
</section>
</section>
