<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Bsoft: /usr/local/bsoft/src/img/img_segment.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Bsoft
   &#160;<span id="projectnumber">1.9</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('img__segment_8cpp.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">img_segment.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions used to segment/interpret images.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="rwimg_8h_source.html">rwimg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="img__segment_8h_source.html">img_segment.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="img__feature_8h_source.html">img_feature.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="img__combine_8h_source.html">img_combine.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="linked__list_8h_source.html">linked_list.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h_source.html">utilities.h</a>&quot;</code><br />
</div>
<p><a href="img__segment_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acc946f28ddabdac9ddf571ed347c1f66"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__segment_8cpp.html#acc946f28ddabdac9ddf571ed347c1f66">img_blobs</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, float threshold, float min_size, float max_size, float setvalue, int sign)</td></tr>
<tr class="memdesc:acc946f28ddabdac9ddf571ed347c1f66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Identifies contiguous regions above a given threshold (blobs) and eliminate those less than a minimum size.  <a href="#acc946f28ddabdac9ddf571ed347c1f66">More...</a><br /></td></tr>
<tr class="separator:acc946f28ddabdac9ddf571ed347c1f66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15cb308b4a52cabcee5ab7b49757b79d"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__segment_8cpp.html#a15cb308b4a52cabcee5ab7b49757b79d">img_find_threshold</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, int img_num, double mol_weight, float rho)</td></tr>
<tr class="memdesc:a15cb308b4a52cabcee5ab7b49757b79d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the density threshold associated with a particular molecular weight.  <a href="#a15cb308b4a52cabcee5ab7b49757b79d">More...</a><br /></td></tr>
<tr class="separator:a15cb308b4a52cabcee5ab7b49757b79d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f3668bdd9fc03b671f910b9b19aacbb"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__segment_8cpp.html#a2f3668bdd9fc03b671f910b9b19aacbb">img_mass_at_threshold</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, int img_num, float threshold, float rho)</td></tr>
<tr class="memdesc:a2f3668bdd9fc03b671f910b9b19aacbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the mass from the density threshold.  <a href="#a2f3668bdd9fc03b671f910b9b19aacbb">More...</a><br /></td></tr>
<tr class="separator:a2f3668bdd9fc03b671f910b9b19aacbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f8f0b4452c79a95a7b23a31f9dd58f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__segment_8cpp.html#a7f8f0b4452c79a95a7b23a31f9dd58f5">img_internal_volume</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, float threshold, int mask_out_freq)</td></tr>
<tr class="memdesc:a7f8f0b4452c79a95a7b23a31f9dd58f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the density threshold associated with a particular molecular weight.  <a href="#a7f8f0b4452c79a95a7b23a31f9dd58f5">More...</a><br /></td></tr>
<tr class="separator:a7f8f0b4452c79a95a7b23a31f9dd58f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac69c6225f24b398e460d68acaca84275"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__segment_8cpp.html#ac69c6225f24b398e460d68acaca84275">img_segment_threshold_series</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, float threshold_first, float threshold_last, float threshold_step)</td></tr>
<tr class="memdesc:ac69c6225f24b398e460d68acaca84275"><td class="mdescLeft">&#160;</td><td class="mdescRight">Segments a map through a series of thresholds and reports results.  <a href="#ac69c6225f24b398e460d68acaca84275">More...</a><br /></td></tr>
<tr class="separator:ac69c6225f24b398e460d68acaca84275"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6515d59fb55f514e218f6183811bb98d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__segment_8cpp.html#a6515d59fb55f514e218f6183811bb98d">img_flood_fill</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pfeature, float threshold_hi, float threshold_lo, float threshold_step, int fill_borders)</td></tr>
<tr class="memdesc:a6515d59fb55f514e218f6183811bb98d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and expands a feature map from a starting to ending threshold value.  <a href="#a6515d59fb55f514e218f6183811bb98d">More...</a><br /></td></tr>
<tr class="separator:a6515d59fb55f514e218f6183811bb98d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdc16995e6d5f9bb80f10996647f31c7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__segment_8cpp.html#acdc16995e6d5f9bb80f10996647f31c7">img_flood_peaks</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, int kernel_size, float threshold)</td></tr>
<tr class="memdesc:acdc16995e6d5f9bb80f10996647f31c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a segmented image from peaks above a threshold value.  <a href="#acdc16995e6d5f9bb80f10996647f31c7">More...</a><br /></td></tr>
<tr class="separator:acdc16995e6d5f9bb80f10996647f31c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2790788b671c64551a4392817ee9bcd6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__segment_8cpp.html#a2790788b671c64551a4392817ee9bcd6">img_set_second_mask</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pmask, float threshold)</td></tr>
<tr class="memdesc:a2790788b671c64551a4392817ee9bcd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">A second level mask is added to a primary mask based on a threshold.  <a href="#a2790788b671c64551a4392817ee9bcd6">More...</a><br /></td></tr>
<tr class="separator:a2790788b671c64551a4392817ee9bcd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf86a1e65978bd1e7afe8f02e788af3f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__segment_8cpp.html#adf86a1e65978bd1e7afe8f02e788af3f">img_check_neighbors</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, unsigned long index)</td></tr>
<tr class="memdesc:adf86a1e65978bd1e7afe8f02e788af3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check neighbors in feature map and assign a value if a neighbor is assigned.  <a href="#adf86a1e65978bd1e7afe8f02e788af3f">More...</a><br /></td></tr>
<tr class="separator:adf86a1e65978bd1e7afe8f02e788af3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab706b6dfc3a58000904a69034b1bed65"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__segment_8cpp.html#ab706b6dfc3a58000904a69034b1bed65">img_find_highest_in_kernel</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, unsigned long index, int size)</td></tr>
<tr class="memdesc:ab706b6dfc3a58000904a69034b1bed65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the highest value in a kernel excluding the central voxel.  <a href="#ab706b6dfc3a58000904a69034b1bed65">More...</a><br /></td></tr>
<tr class="separator:ab706b6dfc3a58000904a69034b1bed65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ff2a7070cda8be40cb3bda9db5605cd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__segment_8cpp.html#a4ff2a7070cda8be40cb3bda9db5605cd">img_excise_feature</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pfeature, <a class="el" href="struct_bmarker.html">Bmarker</a> *markers)</td></tr>
<tr class="memdesc:a4ff2a7070cda8be40cb3bda9db5605cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the density around a voxel associated with a particular feature.  <a href="#a4ff2a7070cda8be40cb3bda9db5605cd">More...</a><br /></td></tr>
<tr class="separator:a4ff2a7070cda8be40cb3bda9db5605cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cf2d7a6697b3a1bd8ffee04a39156d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__segment_8cpp.html#a9cf2d7a6697b3a1bd8ffee04a39156d0">img_excise_all_features</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pfeature)</td></tr>
<tr class="memdesc:a9cf2d7a6697b3a1bd8ffee04a39156d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extracts all the features associated with a multi-level mask.  <a href="#a9cf2d7a6697b3a1bd8ffee04a39156d0">More...</a><br /></td></tr>
<tr class="separator:a9cf2d7a6697b3a1bd8ffee04a39156d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__segment_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions used to segment/interpret images. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 19990321 </dd>
<dd>
Modified: 20131231 </dd></dl>

<p>Definition in file <a class="el" href="img__segment_8cpp_source.html">img_segment.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="acc946f28ddabdac9ddf571ed347c1f66"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_blobs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>min_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>max_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>setvalue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sign</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Identifies contiguous regions above a given threshold (blobs) and eliminate those less than a minimum size. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image. </td></tr>
    <tr><td class="paramname">threshold</td><td>threshold to define contiguous regions. </td></tr>
    <tr><td class="paramname">min_size</td><td>minimum number of voxels to keep a region. </td></tr>
    <tr><td class="paramname">max_size</td><td>maximum number of voxels to keep a region. </td></tr>
    <tr><td class="paramname">setvalue</td><td>value to assign to deleted regions (typically set to threshold). </td></tr>
    <tr><td class="paramname">sign</td><td>sign controlling direction of thresholding. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int number of voxels set to threshold. <pre class="fragment">All contiguous regions in an image are indexed and their sizes 
calculated. Whether a region is contiguous is defined by a
threshold. Regions smaller than a minimum number of voxels are
set to the threshold value. The input image is modified and
left as a floating point image.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__segment_8cpp_source.html#l00037">37</a> of file <a class="el" href="img__segment_8cpp_source.html">img_segment.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="adf86a1e65978bd1e7afe8f02e788af3f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_check_neighbors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check neighbors in feature map and assign a value if a neighbor is assigned. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>the integer image mask. </td></tr>
    <tr><td class="paramname">index</td><td>index in multi-image. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int new value assigned. <pre class="fragment">The mask must be of type integer.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__segment_8cpp_source.html#l00731">731</a> of file <a class="el" href="img__segment_8cpp_source.html">img_segment.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9cf2d7a6697b3a1bd8ffee04a39156d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_excise_all_features </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pfeature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extracts all the features associated with a multi-level mask. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>density map. </td></tr>
    <tr><td class="paramname">*pfeature</td><td>multi-level feature mask map. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* image with excised features. <pre class="fragment">The feature index is found in a feature map and the corresponding voxels
in the density maps are extracted.
An image is assumed to have density represented by higher (white) values.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__segment_8cpp_source.html#l00944">944</a> of file <a class="el" href="img__segment_8cpp_source.html">img_segment.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4ff2a7070cda8be40cb3bda9db5605cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_excise_feature </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pfeature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmarker.html">Bmarker</a> *&#160;</td>
          <td class="paramname"><em>markers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the density around a voxel associated with a particular feature. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>density map (modified, omission map). </td></tr>
    <tr><td class="paramname">*pfeature</td><td>feature map. </td></tr>
    <tr><td class="paramname">*markers</td><td>marker coordinates within features to be extracted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* image with excised feature. <pre class="fragment">The feature index is found in a feature map and the corresponding voxels
in the density maps are extracted.
An image is assumed to have density represented by higher (white) values.
Each voxel is specified as x, y, z and image number.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__segment_8cpp_source.html#l00850">850</a> of file <a class="el" href="img__segment_8cpp_source.html">img_segment.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab706b6dfc3a58000904a69034b1bed65"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long img_find_highest_in_kernel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the highest value in a kernel excluding the central voxel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image. </td></tr>
    <tr><td class="paramname">index</td><td>index in multi-image. </td></tr>
    <tr><td class="paramname">size</td><td>kernel edge half size </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int index of highest value. <pre class="fragment">The image must be floating point.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__segment_8cpp_source.html#l00796">796</a> of file <a class="el" href="img__segment_8cpp_source.html">img_segment.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a15cb308b4a52cabcee5ab7b49757b79d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float img_find_threshold </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>img_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mol_weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>rho</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the density threshold associated with a particular molecular weight. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image. </td></tr>
    <tr><td class="paramname">img_num</td><td>sub-image number (first = 0, -1 means all). </td></tr>
    <tr><td class="paramname">mol_weight</td><td>molecular weight. </td></tr>
    <tr><td class="paramname">rho</td><td>protein density in Da/A3. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>float threshold. <pre class="fragment">A threshold value is determined which contour a density such that
it corresponds to 100% of the given molecular weight.
An image is assumed to have density represented by higher (white) values.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__segment_8cpp_source.html#l00127">127</a> of file <a class="el" href="img__segment_8cpp_source.html">img_segment.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6515d59fb55f514e218f6183811bb98d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_flood_fill </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pfeature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>threshold_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>threshold_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>threshold_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fill_borders</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and expands a feature map from a starting to ending threshold value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>the image. </td></tr>
    <tr><td class="paramname">*pfeature</td><td>feature map (if NULL, generate from high threshold). </td></tr>
    <tr><td class="paramname">threshold_hi</td><td>the level to pick initial regions. </td></tr>
    <tr><td class="paramname">threshold_lo</td><td>the lowest level to include voxels in regions. </td></tr>
    <tr><td class="paramname">threshold_step</td><td>the incremental change in threshold. </td></tr>
    <tr><td class="paramname">fill_borders</td><td>flag to assign borders between regions (default not). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* integer image containing feature index numbers. <pre class="fragment">A feature map is calculated at the threshold furthest from the average.
The feature map is then expanded by lowering the threshold gradually 
and assigning newly included voxels to neighboring regions (i.e., flooding).
Voxels with neighbours assigned to two or more different regions are tagged
as indeterminate to indicate borders between regions. These border voxels
are counted and can be used to estimate the extent of interfaces.
The indices of all the final regions are packed into an integer data block
within a new image.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__segment_8cpp_source.html#l00439">439</a> of file <a class="el" href="img__segment_8cpp_source.html">img_segment.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="acdc16995e6d5f9bb80f10996647f31c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_flood_peaks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kernel_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a segmented image from peaks above a threshold value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>the image. </td></tr>
    <tr><td class="paramname">kernel_size</td><td>size of kernel to determine peaks. </td></tr>
    <tr><td class="paramname">threshold</td><td>the lowest level to include voxels in regions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* integer image containing region index numbers. <pre class="fragment">Every voxel with a value above the threshold is tagged by a pointer 
pointing to the highest value within a kernel. 
A peak is defined as pointing to itself, while every other voxel
points towards a peak.
The voxels in the mask are then iteratively assigned to the peaks
they point to.
The indices of all the final regions are packed into an integer data block
within a new image.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__segment_8cpp_source.html#l00612">612</a> of file <a class="el" href="img__segment_8cpp_source.html">img_segment.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a7f8f0b4452c79a95a7b23a31f9dd58f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_internal_volume </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mask_out_freq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the density threshold associated with a particular molecular weight. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image (modified to generate mask). </td></tr>
    <tr><td class="paramname">threshold</td><td>threshold to define density. </td></tr>
    <tr><td class="paramname">mask_out_freq</td><td>mask output frequency. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">A threshold value is determined which contour a density such that
it corresponds to 100% of the given molecular weight.
An image is assumed to have density represented by higher (white) values.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__segment_8cpp_source.html#l00264">264</a> of file <a class="el" href="img__segment_8cpp_source.html">img_segment.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2f3668bdd9fc03b671f910b9b19aacbb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float img_mass_at_threshold </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>img_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>rho</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the mass from the density threshold. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image. </td></tr>
    <tr><td class="paramname">img_num</td><td>sub-image number (first = 0). </td></tr>
    <tr><td class="paramname">threshold</td><td>density threshold. </td></tr>
    <tr><td class="paramname">rho</td><td>protein density in Da/A3. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>float threshold. <pre class="fragment">An image is assumed to have density represented by higher (white) values.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__segment_8cpp_source.html#l00222">222</a> of file <a class="el" href="img__segment_8cpp_source.html">img_segment.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac69c6225f24b398e460d68acaca84275"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_segment_threshold_series </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>threshold_first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>threshold_last</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>threshold_step</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Segments a map through a series of thresholds and reports results. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>the image. </td></tr>
    <tr><td class="paramname">threshold_first</td><td>the level to pick initial regions. </td></tr>
    <tr><td class="paramname">threshold_last</td><td>the lowest level to include voxels in regions. </td></tr>
    <tr><td class="paramname">threshold_step</td><td>the incremental change in threshold. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. </dd></dl>

<p>Definition at line <a class="el" href="img__segment_8cpp_source.html#l00382">382</a> of file <a class="el" href="img__segment_8cpp_source.html">img_segment.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2790788b671c64551a4392817ee9bcd6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_set_second_mask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A second level mask is added to a primary mask based on a threshold. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>the image. </td></tr>
    <tr><td class="paramname">*pmask</td><td>the integer image mask. </td></tr>
    <tr><td class="paramname">threshold</td><td>threshold for secondary mask. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">A new level is created in the mask image (i.e., max+1) for all voxels 
above the threshold and not included in the mask already.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__segment_8cpp_source.html#l00701">701</a> of file <a class="el" href="img__segment_8cpp_source.html">img_segment.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_7673ec780970b264223275c6ce2fb0e1.html">img</a></li><li class="navelem"><a class="el" href="img__segment_8cpp.html">img_segment.cpp</a></li>
    <li class="footer">Generated on Fri Aug 14 2015 18:20:08 for Bsoft by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
