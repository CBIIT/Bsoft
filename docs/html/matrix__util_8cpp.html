<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/heymannb/b20/bsoft/src/util/matrix_util.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Bsoft<span id="projectnumber">&#160;2.1.4</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('matrix__util_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">matrix_util.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Utility functions for matrices.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="matrix__util_8h.html">matrix_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_matrix_8h.html">Matrix.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="matrix__linear_8h.html">matrix_linear.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="math__util_8h.html">math_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h.html">utilities.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a72dad3674d558a983deca8b742f6d719"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="matrix__util_8cpp.html#a72dad3674d558a983deca8b742f6d719">matrix_normalize</a> (<a class="el" href="class_matrix.html">Matrix</a> &amp;m)</td></tr>
<tr class="memdesc:a72dad3674d558a983deca8b742f6d719"><td class="mdescLeft">&#160;</td><td class="mdescRight">Normalizes a matrix.  <a href="matrix__util_8cpp.html#a72dad3674d558a983deca8b742f6d719">More...</a><br /></td></tr>
<tr class="separator:a72dad3674d558a983deca8b742f6d719"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88f47aa3a1524bc7df387a8d811f94f9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="matrix__util_8cpp.html#a88f47aa3a1524bc7df387a8d811f94f9">matrix_find_cutoff_for_number</a> (<a class="el" href="class_matrix.html">Matrix</a> m, int n)</td></tr>
<tr class="memdesc:a88f47aa3a1524bc7df387a8d811f94f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a cutoff to ensure that the given number of elements fall below it.  <a href="matrix__util_8cpp.html#a88f47aa3a1524bc7df387a8d811f94f9">More...</a><br /></td></tr>
<tr class="separator:a88f47aa3a1524bc7df387a8d811f94f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab760d1b03236dc515d741650ac83e26c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="matrix__util_8cpp.html#ab760d1b03236dc515d741650ac83e26c">matrix_log_1_R</a> (<a class="el" href="class_matrix.html">Matrix</a> matrix)</td></tr>
<tr class="memdesc:ab760d1b03236dc515d741650ac83e26c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the logarithmic derivative of an R-factor in a matrix.  <a href="matrix__util_8cpp.html#ab760d1b03236dc515d741650ac83e26c">More...</a><br /></td></tr>
<tr class="separator:ab760d1b03236dc515d741650ac83e26c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f8aa85d55256063b6a8bc0b334b4f0f"><td class="memItemLeft" align="right" valign="top">int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="matrix__util_8cpp.html#a5f8aa85d55256063b6a8bc0b334b4f0f">matrix_find_linear_sequence</a> (<a class="el" href="class_matrix.html">Matrix</a> matrix, int window)</td></tr>
<tr class="memdesc:a5f8aa85d55256063b6a8bc0b334b4f0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds a linear sequence of elements based on a pairwise matrix.  <a href="matrix__util_8cpp.html#a5f8aa85d55256063b6a8bc0b334b4f0f">More...</a><br /></td></tr>
<tr class="separator:a5f8aa85d55256063b6a8bc0b334b4f0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a625d867bbc505e46d7ece6d479d101b7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="matrix__util_8cpp.html#a625d867bbc505e46d7ece6d479d101b7">matrix_permute</a> (int i, int j, <a class="el" href="class_matrix.html">Matrix</a> matrix, int *order, double *best_R, int *best_order)</td></tr>
<tr class="memdesc:a625d867bbc505e46d7ece6d479d101b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Permutes the order of a pairwise matrix and calculate a distance criterion.  <a href="matrix__util_8cpp.html#a625d867bbc505e46d7ece6d479d101b7">More...</a><br /></td></tr>
<tr class="separator:a625d867bbc505e46d7ece6d479d101b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7d7b9944998599401c54eaf3a83516e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="matrix__util_8cpp.html#aa7d7b9944998599401c54eaf3a83516e">matrix_calc_dist_fit</a> (<a class="el" href="class_matrix.html">Matrix</a> matrix, int *order)</td></tr>
<tr class="memdesc:aa7d7b9944998599401c54eaf3a83516e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates an R-factor for a specific order of elements in a pairwise matrix.  <a href="matrix__util_8cpp.html#aa7d7b9944998599401c54eaf3a83516e">More...</a><br /></td></tr>
<tr class="separator:aa7d7b9944998599401c54eaf3a83516e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="matrix__util_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Utility functions for matrices. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20010723 </dd>
<dd>
Modified: 20150124 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aa7d7b9944998599401c54eaf3a83516e" name="aa7d7b9944998599401c54eaf3a83516e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7d7b9944998599401c54eaf3a83516e">&#9670;&nbsp;</a></span>matrix_calc_dist_fit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double matrix_calc_dist_fit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates an R-factor for a specific order of elements in a pairwise matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>pairwise square matrix. </td></tr>
    <tr><td class="paramname">*order</td><td>n-value array holding the order. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double the R-factor. <pre class="fragment">A new matrix is composed with the lower triangle taken from the input
matrix in the given order, and the upper triangle calculated as the 
sum of the diagonal elements between the indices of the element. 
I.e, if i and j are the indices of an upper triangle element, then 
it is the sum of all the diagonal elements from i to j:
    up(i,j) = sum(mat(k,k+1)) for i&lt;=k&lt;j
The difference between the lower and upper triangles is then calculated
as:
              1      up(i,j) - upmin   lo(j,i) - lomin
    R = sum(----- * (--------------- - ---------------) )
            i - j     upmax - upmin     lomax - lomin
where upmin, upmax, lomin, and lomax are the extremes in each triangle.
</pre> </dd></dl>

</div>
</div>
<a id="a88f47aa3a1524bc7df387a8d811f94f9" name="a88f47aa3a1524bc7df387a8d811f94f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88f47aa3a1524bc7df387a8d811f94f9">&#9670;&nbsp;</a></span>matrix_find_cutoff_for_number()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double matrix_find_cutoff_for_number </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a>&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a cutoff to ensure that the given number of elements fall below it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>pairwise square matrix. </td></tr>
    <tr><td class="paramname">n</td><td>number of elements below cutoff. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double cutoff. <pre class="fragment">Each column is scanned and the cutoff adjusted so that at least the
given number of elements will fall below it.
</pre> </dd></dl>

</div>
</div>
<a id="a5f8aa85d55256063b6a8bc0b334b4f0f" name="a5f8aa85d55256063b6a8bc0b334b4f0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f8aa85d55256063b6a8bc0b334b4f0f">&#9670;&nbsp;</a></span>matrix_find_linear_sequence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int * matrix_find_linear_sequence </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>window</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds a linear sequence of elements based on a pairwise matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>pairwise square matrix. </td></tr>
    <tr><td class="paramname">window</td><td>range of elements to permute. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int* the best order, NULL on error. </dd></dl>

</div>
</div>
<a id="ab760d1b03236dc515d741650ac83e26c" name="ab760d1b03236dc515d741650ac83e26c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab760d1b03236dc515d741650ac83e26c">&#9670;&nbsp;</a></span>matrix_log_1_R()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int matrix_log_1_R </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a>&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the logarithmic derivative of an R-factor in a matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>pairwise square matrix. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. </dd></dl>

</div>
</div>
<a id="a72dad3674d558a983deca8b742f6d719" name="a72dad3674d558a983deca8b742f6d719"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72dad3674d558a983deca8b742f6d719">&#9670;&nbsp;</a></span>matrix_normalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int matrix_normalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>m</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Normalizes a matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">&amp;m</td><td>matrix. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">The rows and columns are alternatively iteratively normalized until
the error is small enough.
</pre> </dd></dl>

</div>
</div>
<a id="a625d867bbc505e46d7ece6d479d101b7" name="a625d867bbc505e46d7ece6d479d101b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a625d867bbc505e46d7ece6d479d101b7">&#9670;&nbsp;</a></span>matrix_permute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int matrix_permute </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a>&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>best_R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>best_order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Permutes the order of a pairwise matrix and calculate a distance criterion. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>start of window within the order array. </td></tr>
    <tr><td class="paramname">j</td><td>end of window within the order array. </td></tr>
    <tr><td class="paramname">matrix</td><td>pairwise square matrix. </td></tr>
    <tr><td class="paramname">*order</td><td>n-value array holding the current order. </td></tr>
    <tr><td class="paramname">*best_R</td><td>R-factor for the best order. </td></tr>
    <tr><td class="paramname">*best_order</td><td>n-value array holding the best order. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">A recursive function to pass through all possible permutations
within a given window.
</pre> </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0b2caeb4b6f130be43e5a2f0267dd453" name="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2caeb4b6f130be43e5a2f0267dd453">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b7878ad5ecbf2506f4125b9d34c97e45.html">util</a></li><li class="navelem"><a class="el" href="matrix__util_8cpp.html">matrix_util.cpp</a></li>
    <li class="footer">Generated on Tue Jan 31 2023 08:21:30 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
