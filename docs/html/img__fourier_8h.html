<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Bsoft: /usr/local/bsoft/include/img_fourier.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Bsoft
   &#160;<span id="projectnumber">1.9</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('img__fourier_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">img_fourier.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>General FFT for n-dimensional data.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="rwimg_8h_source.html">rwimg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fft_8h_source.html">fft.h</a>&quot;</code><br />
</div>
<p><a href="img__fourier_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a73c569dbc595b9c37c6f5bc263a25bad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__fourier_8h.html#a73c569dbc595b9c37c6f5bc263a25bad">img_cross_correlate</a> (<a class="el" href="class_bimage.html">Bimage</a> *p1, <a class="el" href="class_bimage.html">Bimage</a> *p2, double hires, double lores, <a class="el" href="class_bimage.html">Bimage</a> *pmask)</td></tr>
<tr class="memdesc:a73c569dbc595b9c37c6f5bc263a25bad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a cross-correlation map by Fast Fourier transformation.  <a href="#a73c569dbc595b9c37c6f5bc263a25bad">More...</a><br /></td></tr>
<tr class="separator:a73c569dbc595b9c37c6f5bc263a25bad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbab481d90999cbad6f6fdab39cef1cc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__fourier_8h.html#adbab481d90999cbad6f6fdab39cef1cc">img_cross_correlate</a> (<a class="el" href="class_bimage.html">Bimage</a> *p1, <a class="el" href="class_bimage.html">Bimage</a> *p2, double hires, double lores, <a class="el" href="class_bimage.html">Bimage</a> *pmask, <a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a> planf, <a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a> planb)</td></tr>
<tr class="separator:adbab481d90999cbad6f6fdab39cef1cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a105e1e0869868113744a84bd9540899a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__fourier_8h.html#a105e1e0869868113744a84bd9540899a">img_find_shift</a> (<a class="el" href="class_bimage.html">Bimage</a> *pref, <a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pmask, double hires, double lores, double radius, double sigma, int refine_flag)</td></tr>
<tr class="memdesc:a105e1e0869868113744a84bd9540899a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a cross-correlation map to find the shift for the pair of images.  <a href="#a105e1e0869868113744a84bd9540899a">More...</a><br /></td></tr>
<tr class="separator:a105e1e0869868113744a84bd9540899a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27fc1caf54442d32b71f4019023aee47"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__fourier_8h.html#a27fc1caf54442d32b71f4019023aee47">img_find_shift</a> (<a class="el" href="class_bimage.html">Bimage</a> *pref, <a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pmask, double hires, double lores, double radius, double sigma, int refine_flag, <a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a> planf, <a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a> planb)</td></tr>
<tr class="separator:a27fc1caf54442d32b71f4019023aee47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a792ccd253a911a6897f5273f44f61d2c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__fourier_8h.html#a792ccd253a911a6897f5273f44f61d2c">img_find_peak</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, double radius, double sigma)</td></tr>
<tr class="memdesc:a792ccd253a911a6897f5273f44f61d2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the peak in an image to the nearest voxel.  <a href="#a792ccd253a911a6897f5273f44f61d2c">More...</a><br /></td></tr>
<tr class="separator:a792ccd253a911a6897f5273f44f61d2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b5fbe7aa005a6b0a6fe776a4b2f017a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__fourier_8h.html#a5b5fbe7aa005a6b0a6fe776a4b2f017a">img_refine_peak</a> (<a class="el" href="class_bimage.html">Bimage</a> *pc)</td></tr>
<tr class="memdesc:a5b5fbe7aa005a6b0a6fe776a4b2f017a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refines the position of a peak to sub-voxel resolution.  <a href="#a5b5fbe7aa005a6b0a6fe776a4b2f017a">More...</a><br /></td></tr>
<tr class="separator:a5b5fbe7aa005a6b0a6fe776a4b2f017a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12c26756c71129b6494628c89da72742"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__fourier_8h.html#a12c26756c71129b6494628c89da72742">img_cc_confidence</a> (<a class="el" href="class_bimage.html">Bimage</a> *p)</td></tr>
<tr class="separator:a12c26756c71129b6494628c89da72742"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6577d63de88224b93aee90ae9274a665"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__fourier_8h.html#a6577d63de88224b93aee90ae9274a665">img_phase_difference</a> (<a class="el" href="class_bimage.html">Bimage</a> *p1, <a class="el" href="class_bimage.html">Bimage</a> *p2, double resolution_hi, double resolution_lo)</td></tr>
<tr class="memdesc:a6577d63de88224b93aee90ae9274a665"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the cosine of the phase difference between two images.  <a href="#a6577d63de88224b93aee90ae9274a665">More...</a><br /></td></tr>
<tr class="separator:a6577d63de88224b93aee90ae9274a665"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addbed487e872ece274086a6f10ebf531"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__fourier_8h.html#addbed487e872ece274086a6f10ebf531">img_average_phase_difference</a> (<a class="el" href="class_bimage.html">Bimage</a> *p1, <a class="el" href="class_bimage.html">Bimage</a> *p2, double resolution_hi, double resolution_lo, int weighting)</td></tr>
<tr class="memdesc:addbed487e872ece274086a6f10ebf531"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the average of the cosine of the phase difference between two images within given resolution shells.  <a href="#addbed487e872ece274086a6f10ebf531">More...</a><br /></td></tr>
<tr class="separator:addbed487e872ece274086a6f10ebf531"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee736056b12e9fcdf1619964e20cd750"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__fourier_8h.html#aee736056b12e9fcdf1619964e20cd750">img_flip_phases</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pd)</td></tr>
<tr class="memdesc:aee736056b12e9fcdf1619964e20cd750"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flips the phases of an image based on a phase difference map.  <a href="#aee736056b12e9fcdf1619964e20cd750">More...</a><br /></td></tr>
<tr class="separator:aee736056b12e9fcdf1619964e20cd750"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>General FFT for n-dimensional data. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 19980805 </dd>
<dd>
Modified: 20150710 Implementing the FFTW library </dd></dl>

<p>Definition in file <a class="el" href="img__fourier_8h_source.html">img_fourier.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="addbed487e872ece274086a6f10ebf531"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_average_phase_difference </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>weighting</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the average of the cosine of the phase difference between two images within given resolution shells. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p1</td><td>real space image. </td></tr>
    <tr><td class="paramname">*p2</td><td>real space image. </td></tr>
    <tr><td class="paramname">resolution_hi</td><td>upper resolution limit. </td></tr>
    <tr><td class="paramname">resolution_lo</td><td>lower resolution limit. </td></tr>
    <tr><td class="paramname">weighting</td><td>weighting type: 0, none; 1, p1-amp; 2, p2-amp; 3, both amps </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double average of the cosine of the phase difference. <pre class="fragment">Both images are Fourier transformed and the cosine of the phase
difference calculated and averaged.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__fourier_8cpp_source.html#l00570">570</a> of file <a class="el" href="img__fourier_8cpp_source.html">img_fourier.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a12c26756c71129b6494628c89da72742"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* img_cc_confidence </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a73c569dbc595b9c37c6f5bc263a25bad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_cross_correlate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a cross-correlation map by Fast Fourier transformation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p1</td><td>first image. </td></tr>
    <tr><td class="paramname">*p2</td><td>second image. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">*pmask</td><td>binary mask (only 0 and 1), NULL if not desired. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* cross-correlation image. <pre class="fragment">FFTW library (www.fftw.org).
Two equally sized multi-image 1D, 2D and 3D real space data sets are 
packed into a complex data set and transformed forward. The transform
is unpacked before the first transform is multiplied with the complex 
conjugate of the second transform. This is then back-transformed to 
obtain the cross-correlation map in real space.
The low resolution limit can be 0, in which case no limits are applied.
The resultant cross-correlation image data type is floating point.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__fourier_8cpp_source.html#l00045">45</a> of file <a class="el" href="img__fourier_8cpp_source.html">img_fourier.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="adbab481d90999cbad6f6fdab39cef1cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_cross_correlate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__fourier_8cpp_source.html#l00085">85</a> of file <a class="el" href="img__fourier_8cpp_source.html">img_fourier.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a792ccd253a911a6897f5273f44f61d2c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_find_peak </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the peak in an image to the nearest voxel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image (not altered). </td></tr>
    <tr><td class="paramname">radius</td><td>search radius (if &lt; 1, default 1e30). </td></tr>
    <tr><td class="paramname">sigma</td><td>attenuation around radius. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. <pre class="fragment">An image is searched for the global maximum (typically used to find
the shift vector in a cross-correlation map).
The peak vectors returned are in actual pixel coordinates (no wrapping).
The location around which to search is taken from the image origins.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__fourier_8cpp_source.html#l00262">262</a> of file <a class="el" href="img__fourier_8cpp_source.html">img_fourier.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a105e1e0869868113744a84bd9540899a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_find_shift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>refine_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a cross-correlation map to find the shift for the pair of images. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pref</td><td>reference image. </td></tr>
    <tr><td class="paramname">*p</td><td>image to be shifted. </td></tr>
    <tr><td class="paramname">*pmask</td><td>binary mask (only 0 and 1). </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">radius</td><td>search radius (if &lt; 1, default 1e30). </td></tr>
    <tr><td class="paramname">sigma</td><td>attenuation around radius. </td></tr>
    <tr><td class="paramname">refine_flag</td><td>set to refine shift to subpixel resolution. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. <pre class="fragment">FFTW library (www.fftw.org).
Two equally sized multi-image 1D, 2D and 3D data sets are transformed 
forward, the first transform multiplied by the complex conjugate of
the second transform, followed by backward transformation and 
rescaling by 1/(N*N). Data beyond the resolution set in the first 
image structure are not used. Therefore the correct setting 
of units and resolution in the image are required. Defaults for the 
units are usually 1 Angstrom/voxel and a zero resolution would
include the whole image (i.e., no resolution limitation).
A shift vector for each pair of images is calculated to
determine the cross-correlation peak to sub-pixel resolution.
Note: The first image is the reference and the shift returned is to
    transform the second to fit the first.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__fourier_8cpp_source.html#l00154">154</a> of file <a class="el" href="img__fourier_8cpp_source.html">img_fourier.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a27fc1caf54442d32b71f4019023aee47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_find_shift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>refine_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__fourier_8cpp_source.html#l00201">201</a> of file <a class="el" href="img__fourier_8cpp_source.html">img_fourier.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aee736056b12e9fcdf1619964e20cd750"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_flip_phases </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flips the phases of an image based on a phase difference map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>real space or reciprocal space image. </td></tr>
    <tr><td class="paramname">*pd</td><td>reciprocal space phase difference map. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. </dd></dl>

<p>Definition at line <a class="el" href="img__fourier_8cpp_source.html#l00666">666</a> of file <a class="el" href="img__fourier_8cpp_source.html">img_fourier.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6577d63de88224b93aee90ae9274a665"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_phase_difference </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution_lo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the cosine of the phase difference between two images. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p1</td><td>real space image. </td></tr>
    <tr><td class="paramname">*p2</td><td>real space image. </td></tr>
    <tr><td class="paramname">resolution_hi</td><td>upper resolution limit. </td></tr>
    <tr><td class="paramname">resolution_lo</td><td>lower resolution limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* phase difference image. <pre class="fragment">Both images are Fourier transformed and the cosine of the phase
difference calculated.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__fourier_8cpp_source.html#l00479">479</a> of file <a class="el" href="img__fourier_8cpp_source.html">img_fourier.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a5b5fbe7aa005a6b0a6fe776a4b2f017a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_refine_peak </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refines the position of a peak to sub-voxel resolution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pc</td><td>cross-correlation image (not altered). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. <pre class="fragment">The sub-voxel resolution peak in the vicinity of a voxel is defined 
by fitting a 2D/3D second order function around the voxel.
(typically used to find the shift vector in a cross-correlation map).</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__fourier_8cpp_source.html#l00341">341</a> of file <a class="el" href="img__fourier_8cpp_source.html">img_fourier.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="img__fourier_8h.html">img_fourier.h</a></li>
    <li class="footer">Generated on Sun Oct 4 2015 17:09:16 for Bsoft by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
