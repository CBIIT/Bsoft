<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/heymannb/b20/bsoft/src/mg/mg_ctf_fit.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Bsoft<span id="projectnumber">&#160;2.1.4</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mg__ctf__fit_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">mg_ctf_fit.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Functions for CTF (contrast transfer function) processing.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="rwimg_8h.html">rwimg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__ctf_8h.html">mg_ctf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__ctf__fit_8h.html">mg_ctf_fit.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__processing_8h.html">mg_processing.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="simplex_8h.html">simplex.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="moving__average_8h.html">moving_average.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h.html">utilities.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timer_8h.html">timer.h</a>&quot;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a867a2a0e82f3ab593948b74f9947d5c0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a867a2a0e82f3ab593948b74f9947d5c0">ctf_fit_baseline</a> (<a class="el" href="class_bimage.html">Bimage</a> *prad, double real_size, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires)</td></tr>
<tr class="separator:a867a2a0e82f3ab593948b74f9947d5c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c0ac26623ce6c2108fcc099dc8dd3d9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a1c0ac26623ce6c2108fcc099dc8dd3d9">ctf_fit_envelope</a> (<a class="el" href="class_bimage.html">Bimage</a> *prad, double real_size, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires)</td></tr>
<tr class="separator:a1c0ac26623ce6c2108fcc099dc8dd3d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a4e5dbcd9cdfa3018f329f3a1620bad"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a2a4e5dbcd9cdfa3018f329f3a1620bad">img_aberration_phase_fit_iter</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long nn, double lores, double hires, int flag, long iter, map&lt; pair&lt; long, long &gt;, double &gt; &amp;wa)</td></tr>
<tr class="separator:a2a4e5dbcd9cdfa3018f329f3a1620bad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8eb74fa60f7510d359f9639d4aec697"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#ae8eb74fa60f7510d359f9639d4aec697">complete_weights</a> (map&lt; pair&lt; long, long &gt;, double &gt; &amp;w, int flag)</td></tr>
<tr class="separator:ae8eb74fa60f7510d359f9639d4aec697"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f8dba604710ff1a72c85cd134229659"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a9f8dba604710ff1a72c85cd134229659">img_ctf_radial_average</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf)</td></tr>
<tr class="memdesc:a9f8dba604710ff1a72c85cd134229659"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the power spectrum radial average corrected for astigmatism.  <a href="mg__ctf__fit_8cpp.html#a9f8dba604710ff1a72c85cd134229659">More...</a><br /></td></tr>
<tr class="separator:a9f8dba604710ff1a72c85cd134229659"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3f850c2617d06151a1ef4d67e65c62d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#ab3f850c2617d06151a1ef4d67e65c62d">img_ctf_fit_residual</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires)</td></tr>
<tr class="separator:ab3f850c2617d06151a1ef4d67e65c62d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5671f57a87501e88064762cecb05286"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#ad5671f57a87501e88064762cecb05286">img_ctf_find_defocus2</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires, double def_start, double def_end, double def_inc)</td></tr>
<tr class="separator:ad5671f57a87501e88064762cecb05286"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6ab427c1285cfc00e0faba9dc1262b2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#ae6ab427c1285cfc00e0faba9dc1262b2">img_manage_power_spectrum_peak</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pb, long radius)</td></tr>
<tr class="separator:ae6ab427c1285cfc00e0faba9dc1262b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d1d50f9e54ffedd85e17af8dcfd7347"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a4d1d50f9e54ffedd85e17af8dcfd7347">img_ctf_fit_prepare</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, double sigma)</td></tr>
<tr class="separator:a4d1d50f9e54ffedd85e17af8dcfd7347"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab41fb97e6dae699e58039a5e42525690"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#ab41fb97e6dae699e58039a5e42525690">img_ctf_fit_prepare</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, double sigma)</td></tr>
<tr class="separator:ab41fb97e6dae699e58039a5e42525690"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a939a7083c613d4db1d057d6b64001a4c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a939a7083c613d4db1d057d6b64001a4c">img_ctf_fit_old</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires, double def_start, double def_end, double def_inc, int flag)</td></tr>
<tr class="memdesc:a939a7083c613d4db1d057d6b64001a4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the CTF parameters from a power spectrum.  <a href="mg__ctf__fit_8cpp.html#a939a7083c613d4db1d057d6b64001a4c">More...</a><br /></td></tr>
<tr class="separator:a939a7083c613d4db1d057d6b64001a4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a658fe7498c17794706048a00a858c7cc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a658fe7498c17794706048a00a858c7cc">img_ctf_fit</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires, double def_start, double def_end, double def_inc, int flag)</td></tr>
<tr class="separator:a658fe7498c17794706048a00a858c7cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a804fa46726d940f0c0ed88f2da0a6825"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a804fa46726d940f0c0ed88f2da0a6825">img_ctf_fit_baseline</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires)</td></tr>
<tr class="memdesc:a804fa46726d940f0c0ed88f2da0a6825"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fits only the baseline for a given CTF.  <a href="mg__ctf__fit_8cpp.html#a804fa46726d940f0c0ed88f2da0a6825">More...</a><br /></td></tr>
<tr class="separator:a804fa46726d940f0c0ed88f2da0a6825"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0cc671d77d351f03aa631bb40927eca"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#ac0cc671d77d351f03aa631bb40927eca">img_ctf_fit_envelope</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires)</td></tr>
<tr class="memdesc:ac0cc671d77d351f03aa631bb40927eca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fits only the envelope for a given CTF.  <a href="mg__ctf__fit_8cpp.html#ac0cc671d77d351f03aa631bb40927eca">More...</a><br /></td></tr>
<tr class="separator:ac0cc671d77d351f03aa631bb40927eca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73539b7ed4d1edd32ca8702d415636d0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a73539b7ed4d1edd32ca8702d415636d0">ctf_test_defocus</a> (<a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double def, double step_size, vector&lt; double &gt; &amp;r, long rmin, long rmax)</td></tr>
<tr class="separator:a73539b7ed4d1edd32ca8702d415636d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af985f1e858d119ade8d519e2f14ed128"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#af985f1e858d119ade8d519e2f14ed128">ctf_find_defocus</a> (vector&lt; double &gt; &amp;v, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, long rmin, long rmax, double step_size, double def_start, double def_end, double def_inc)</td></tr>
<tr class="separator:af985f1e858d119ade8d519e2f14ed128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cd8d919510e3b6e516cb29b7f8b9221"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a7cd8d919510e3b6e516cb29b7f8b9221">img_ctf_find_defocus</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires, double def_start, double def_end, double def_inc)</td></tr>
<tr class="memdesc:a7cd8d919510e3b6e516cb29b7f8b9221"><td class="mdescLeft">&#160;</td><td class="mdescRight">Searches for the defocus based on correlation.  <a href="mg__ctf__fit_8cpp.html#a7cd8d919510e3b6e516cb29b7f8b9221">More...</a><br /></td></tr>
<tr class="separator:a7cd8d919510e3b6e516cb29b7f8b9221"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9945bb5b29f4ead121dbd51a08fea589"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a9945bb5b29f4ead121dbd51a08fea589">img_ctf_radial_subtract_baseline</a> (<a class="el" href="class_bimage.html">Bimage</a> *prad, double real_size, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf)</td></tr>
<tr class="separator:a9945bb5b29f4ead121dbd51a08fea589"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaed6fd4f4799af13390f1a657283809a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#aaed6fd4f4799af13390f1a657283809a">img_ctf_astigmatism_measure</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, double real_size, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires)</td></tr>
<tr class="separator:aaed6fd4f4799af13390f1a657283809a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67531ca1d0884d83e11cf25873f1e95b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a67531ca1d0884d83e11cf25873f1e95b">img_ctf_fit_astigmatism</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires)</td></tr>
<tr class="memdesc:a67531ca1d0884d83e11cf25873f1e95b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fits the astigmatism with a given defocus, baseline and envelope.  <a href="mg__ctf__fit_8cpp.html#a67531ca1d0884d83e11cf25873f1e95b">More...</a><br /></td></tr>
<tr class="separator:a67531ca1d0884d83e11cf25873f1e95b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcf2dc4080377fa750485974281c9c3e"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; long, long &gt;, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#afcf2dc4080377fa750485974281c9c3e">img_aberration_phase_fit</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long nn, double lores, double hires, int flag)</td></tr>
<tr class="memdesc:afcf2dc4080377fa750485974281c9c3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fits a phase image with aberration functions.  <a href="mg__ctf__fit_8cpp.html#afcf2dc4080377fa750485974281c9c3e">More...</a><br /></td></tr>
<tr class="separator:afcf2dc4080377fa750485974281c9c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40eb30f1ba08484f048266e62f153dea"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a40eb30f1ba08484f048266e62f153dea">aberration_fit_R</a> (<a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;simp)</td></tr>
<tr class="separator:a40eb30f1ba08484f048266e62f153dea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65d27f71a973e9a96c4e074b78d8e520"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a65d27f71a973e9a96c4e074b78d8e520">sine_aberration_fit_R</a> (<a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;simp)</td></tr>
<tr class="separator:a65d27f71a973e9a96c4e074b78d8e520"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4dc589b1af93d2d710547af595f390a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#ab4dc589b1af93d2d710547af595f390a">cosine_aberration_fit_R</a> (<a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;simp)</td></tr>
<tr class="separator:ab4dc589b1af93d2d710547af595f390a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af638064de76ee423c167bbaa7f2887ba"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#af638064de76ee423c167bbaa7f2887ba">img_aberration_phase_fit_iter_old</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long nn, double lores, double hires, int flag, long iter, map&lt; pair&lt; long, long &gt;, double &gt; &amp;wa)</td></tr>
<tr class="separator:af638064de76ee423c167bbaa7f2887ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af41048f5b866bf43b5aa54d2e0a2d0d2"><td class="memItemLeft" align="right" valign="top">vector&lt; map&lt; pair&lt; long, long &gt;, double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#af41048f5b866bf43b5aa54d2e0a2d0d2">img_aberration_phase_fit</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, double lores, double hires, int flag, long iter)</td></tr>
<tr class="separator:af41048f5b866bf43b5aa54d2e0a2d0d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a176a2573d86c80715a90e0063cd40b69"><td class="memItemLeft" align="right" valign="top">vector&lt; map&lt; pair&lt; long, long &gt;, double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a176a2573d86c80715a90e0063cd40b69">img_aberration_phase_fit</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, double lores, double hires, vector&lt; map&lt; pair&lt; long, long &gt;, double &gt; &gt; &amp;win, int flag, long iter)</td></tr>
<tr class="memdesc:a176a2573d86c80715a90e0063cd40b69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fits a phase image with aberration terms.  <a href="mg__ctf__fit_8cpp.html#a176a2573d86c80715a90e0063cd40b69">More...</a><br /></td></tr>
<tr class="separator:a176a2573d86c80715a90e0063cd40b69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bcbb9f31ffc1676eaa64d9811f226a0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a6bcbb9f31ffc1676eaa64d9811f226a0">img_ctf_fit_aberration</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf, double lores, double hires)</td></tr>
<tr class="separator:a6bcbb9f31ffc1676eaa64d9811f226a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ac841c36d48f32c91f0439f905d9ceb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a2ac841c36d48f32c91f0439f905d9ceb">img_water_ring_index</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long img_num, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;em_ctf)</td></tr>
<tr class="memdesc:a2ac841c36d48f32c91f0439f905d9ceb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the water ring index from a power spectrum.  <a href="mg__ctf__fit_8cpp.html#a2ac841c36d48f32c91f0439f905d9ceb">More...</a><br /></td></tr>
<tr class="separator:a2ac841c36d48f32c91f0439f905d9ceb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2220d1b5ffa128bfeeedffbb5fa5dfc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#ac2220d1b5ffa128bfeeedffbb5fa5dfc">img_water_ring_index</a> (<a class="el" href="class_bimage.html">Bimage</a> *prad)</td></tr>
<tr class="memdesc:ac2220d1b5ffa128bfeeedffbb5fa5dfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the water ring index from a power spectrum.  <a href="mg__ctf__fit_8cpp.html#ac2220d1b5ffa128bfeeedffbb5fa5dfc">More...</a><br /></td></tr>
<tr class="separator:ac2220d1b5ffa128bfeeedffbb5fa5dfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cad64fbf713a7cbc42afe664f48a48e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a9cad64fbf713a7cbc42afe664f48a48e">water_ring_R</a> (<a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;simp)</td></tr>
<tr class="separator:a9cad64fbf713a7cbc42afe664f48a48e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94bac8ac210dd593060082a20198b685"><td class="memItemLeft" align="right" valign="top">vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a94bac8ac210dd593060082a20198b685">img_fit_water_ring</a> (<a class="el" href="class_bimage.html">Bimage</a> *p)</td></tr>
<tr class="separator:a94bac8ac210dd593060082a20198b685"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a569966d336a1284ff60fbbc255406f80"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a569966d336a1284ff60fbbc255406f80">gaussian_R</a> (<a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;simp)</td></tr>
<tr class="separator:a569966d336a1284ff60fbbc255406f80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9d07717353b93cdfb21ccd9d07b00d4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#af9d07717353b93cdfb21ccd9d07b00d4">gaussian_WR</a> (<a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;simp)</td></tr>
<tr class="separator:af9d07717353b93cdfb21ccd9d07b00d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac564c1d291bcfe7aafbc4fc6afa29953"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#ac564c1d291bcfe7aafbc4fc6afa29953">gaussian1_R</a> (<a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;simp)</td></tr>
<tr class="separator:ac564c1d291bcfe7aafbc4fc6afa29953"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdb055ce6dd7e885995f2403ca8fc18d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#afdb055ce6dd7e885995f2403ca8fc18d">double_gaussian_R</a> (<a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;simp)</td></tr>
<tr class="separator:afdb055ce6dd7e885995f2403ca8fc18d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acee952aea1bb8f128927bb8794328ba9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#acee952aea1bb8f128927bb8794328ba9">double_gaussian_WR</a> (<a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;simp)</td></tr>
<tr class="separator:acee952aea1bb8f128927bb8794328ba9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc3da89c9420ae9a16f73b6a80d0cffc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#abc3da89c9420ae9a16f73b6a80d0cffc">eman_baseline_R</a> (<a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;simp)</td></tr>
<tr class="separator:abc3da89c9420ae9a16f73b6a80d0cffc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fe84510f7f89419fc0b26918f9aa5b1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a7fe84510f7f89419fc0b26918f9aa5b1">ctf_fit_double_gaussian_baseline</a> (vector&lt; double &gt; &amp;x, vector&lt; double &gt; &amp;y, vector&lt; double &gt; &amp;coeff)</td></tr>
<tr class="separator:a7fe84510f7f89419fc0b26918f9aa5b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e073d84b1f0c4f18071c51bdcdf3a30"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a8e073d84b1f0c4f18071c51bdcdf3a30">ctf_fit_eman_to_baseline</a> (vector&lt; double &gt; &amp;x, vector&lt; double &gt; &amp;y, vector&lt; double &gt; &amp;coeff)</td></tr>
<tr class="separator:a8e073d84b1f0c4f18071c51bdcdf3a30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1edd1bf549fca1030146e19e732089f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#ae1edd1bf549fca1030146e19e732089f">ctf_fit_gaussian</a> (vector&lt; double &gt; &amp;x, vector&lt; double &gt; &amp;y, vector&lt; double &gt; &amp;coeff)</td></tr>
<tr class="separator:ae1edd1bf549fca1030146e19e732089f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a908e6add7ae1c678dff41b5cdcd68a55"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a908e6add7ae1c678dff41b5cdcd68a55">ctf_fit_baseline_bump</a> (vector&lt; double &gt; &amp;x, vector&lt; double &gt; &amp;y, vector&lt; double &gt; &amp;coeff)</td></tr>
<tr class="separator:a908e6add7ae1c678dff41b5cdcd68a55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6fea3378a83d7999ba19d436afa6206"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#ad6fea3378a83d7999ba19d436afa6206">ctf_fit_double_gaussian_envelope</a> (vector&lt; double &gt; &amp;x, vector&lt; double &gt; &amp;y, vector&lt; double &gt; &amp;coeff)</td></tr>
<tr class="separator:ad6fea3378a83d7999ba19d436afa6206"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__ctf__fit_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Functions for CTF (contrast transfer function) processing. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 19970715 </dd>
<dd>
Modified: 20221213 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a40eb30f1ba08484f048266e62f153dea" name="a40eb30f1ba08484f048266e62f153dea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40eb30f1ba08484f048266e62f153dea">&#9670;&nbsp;</a></span>aberration_fit_R()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double aberration_fit_R </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;&#160;</td>
          <td class="paramname"><em>simp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae8eb74fa60f7510d359f9639d4aec697" name="ae8eb74fa60f7510d359f9639d4aec697"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8eb74fa60f7510d359f9639d4aec697">&#9670;&nbsp;</a></span>complete_weights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int complete_weights </td>
          <td>(</td>
          <td class="paramtype">map&lt; pair&lt; long, long &gt;, double &gt; &amp;&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab4dc589b1af93d2d710547af595f390a" name="ab4dc589b1af93d2d710547af595f390a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4dc589b1af93d2d710547af595f390a">&#9670;&nbsp;</a></span>cosine_aberration_fit_R()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double cosine_aberration_fit_R </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;&#160;</td>
          <td class="paramname"><em>simp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af985f1e858d119ade8d519e2f14ed128" name="af985f1e858d119ade8d519e2f14ed128"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af985f1e858d119ade8d519e2f14ed128">&#9670;&nbsp;</a></span>ctf_find_defocus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_find_defocus </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>rmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>rmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>step_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_inc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a867a2a0e82f3ab593948b74f9947d5c0" name="a867a2a0e82f3ab593948b74f9947d5c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a867a2a0e82f3ab593948b74f9947d5c0">&#9670;&nbsp;</a></span>ctf_fit_baseline()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_fit_baseline </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>prad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>real_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a908e6add7ae1c678dff41b5cdcd68a55" name="a908e6add7ae1c678dff41b5cdcd68a55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a908e6add7ae1c678dff41b5cdcd68a55">&#9670;&nbsp;</a></span>ctf_fit_baseline_bump()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_fit_baseline_bump </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>coeff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7fe84510f7f89419fc0b26918f9aa5b1" name="a7fe84510f7f89419fc0b26918f9aa5b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fe84510f7f89419fc0b26918f9aa5b1">&#9670;&nbsp;</a></span>ctf_fit_double_gaussian_baseline()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_fit_double_gaussian_baseline </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>coeff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad6fea3378a83d7999ba19d436afa6206" name="ad6fea3378a83d7999ba19d436afa6206"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6fea3378a83d7999ba19d436afa6206">&#9670;&nbsp;</a></span>ctf_fit_double_gaussian_envelope()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_fit_double_gaussian_envelope </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>coeff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8e073d84b1f0c4f18071c51bdcdf3a30" name="a8e073d84b1f0c4f18071c51bdcdf3a30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e073d84b1f0c4f18071c51bdcdf3a30">&#9670;&nbsp;</a></span>ctf_fit_eman_to_baseline()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_fit_eman_to_baseline </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>coeff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1c0ac26623ce6c2108fcc099dc8dd3d9" name="a1c0ac26623ce6c2108fcc099dc8dd3d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c0ac26623ce6c2108fcc099dc8dd3d9">&#9670;&nbsp;</a></span>ctf_fit_envelope()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_fit_envelope </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>prad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>real_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae1edd1bf549fca1030146e19e732089f" name="ae1edd1bf549fca1030146e19e732089f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1edd1bf549fca1030146e19e732089f">&#9670;&nbsp;</a></span>ctf_fit_gaussian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_fit_gaussian </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>coeff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a73539b7ed4d1edd32ca8702d415636d0" name="a73539b7ed4d1edd32ca8702d415636d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73539b7ed4d1edd32ca8702d415636d0">&#9670;&nbsp;</a></span>ctf_test_defocus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_test_defocus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>step_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>rmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>rmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afdb055ce6dd7e885995f2403ca8fc18d" name="afdb055ce6dd7e885995f2403ca8fc18d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdb055ce6dd7e885995f2403ca8fc18d">&#9670;&nbsp;</a></span>double_gaussian_R()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double double_gaussian_R </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;&#160;</td>
          <td class="paramname"><em>simp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acee952aea1bb8f128927bb8794328ba9" name="acee952aea1bb8f128927bb8794328ba9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acee952aea1bb8f128927bb8794328ba9">&#9670;&nbsp;</a></span>double_gaussian_WR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double double_gaussian_WR </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;&#160;</td>
          <td class="paramname"><em>simp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abc3da89c9420ae9a16f73b6a80d0cffc" name="abc3da89c9420ae9a16f73b6a80d0cffc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc3da89c9420ae9a16f73b6a80d0cffc">&#9670;&nbsp;</a></span>eman_baseline_R()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double eman_baseline_R </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;&#160;</td>
          <td class="paramname"><em>simp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac564c1d291bcfe7aafbc4fc6afa29953" name="ac564c1d291bcfe7aafbc4fc6afa29953"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac564c1d291bcfe7aafbc4fc6afa29953">&#9670;&nbsp;</a></span>gaussian1_R()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gaussian1_R </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;&#160;</td>
          <td class="paramname"><em>simp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a569966d336a1284ff60fbbc255406f80" name="a569966d336a1284ff60fbbc255406f80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a569966d336a1284ff60fbbc255406f80">&#9670;&nbsp;</a></span>gaussian_R()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gaussian_R </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;&#160;</td>
          <td class="paramname"><em>simp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af9d07717353b93cdfb21ccd9d07b00d4" name="af9d07717353b93cdfb21ccd9d07b00d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9d07717353b93cdfb21ccd9d07b00d4">&#9670;&nbsp;</a></span>gaussian_WR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gaussian_WR </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;&#160;</td>
          <td class="paramname"><em>simp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af41048f5b866bf43b5aa54d2e0a2d0d2" name="af41048f5b866bf43b5aa54d2e0a2d0d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af41048f5b866bf43b5aa54d2e0a2d0d2">&#9670;&nbsp;</a></span>img_aberration_phase_fit() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; map&lt; pair&lt; long, long &gt;, double &gt; &gt; img_aberration_phase_fit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>iter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a176a2573d86c80715a90e0063cd40b69" name="a176a2573d86c80715a90e0063cd40b69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a176a2573d86c80715a90e0063cd40b69">&#9670;&nbsp;</a></span>img_aberration_phase_fit() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; map&lt; pair&lt; long, long &gt;, double &gt; &gt; img_aberration_phase_fit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; map&lt; pair&lt; long, long &gt;, double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>win</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>iter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fits a phase image with aberration terms. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>phase image. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">win</td><td>initial aberration parameters. </td></tr>
    <tr><td class="paramname">flag</td><td>0=full, 1=odd, 2=even. </td></tr>
    <tr><td class="paramname">iter</td><td>maximum number of iterations. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>vector&lt;map&lt;pair&lt;long,long&gt;,double&gt;&gt; vector of aberration weights. </dd></dl>

</div>
</div>
<a id="afcf2dc4080377fa750485974281c9c3e" name="afcf2dc4080377fa750485974281c9c3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcf2dc4080377fa750485974281c9c3e">&#9670;&nbsp;</a></span>img_aberration_phase_fit() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">map&lt; pair&lt; long, long &gt;, double &gt; img_aberration_phase_fit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fits a phase image with aberration functions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">nn</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">flag</td><td>0=full, 1=odd, 2=even. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>map&lt;pair&lt;long,long&gt;,double&gt; aberration weights. <pre class="fragment">The aberration terms are calculated for each pixel and added to a symmetric matrix.
The matrix is inverted and the aberration weights calculated.
The origin of the image must be at {0,0}.
</pre> </dd></dl>

</div>
</div>
<a id="a2a4e5dbcd9cdfa3018f329f3a1620bad" name="a2a4e5dbcd9cdfa3018f329f3a1620bad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a4e5dbcd9cdfa3018f329f3a1620bad">&#9670;&nbsp;</a></span>img_aberration_phase_fit_iter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_aberration_phase_fit_iter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">map&lt; pair&lt; long, long &gt;, double &gt; &amp;&#160;</td>
          <td class="paramname"><em>wa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af638064de76ee423c167bbaa7f2887ba" name="af638064de76ee423c167bbaa7f2887ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af638064de76ee423c167bbaa7f2887ba">&#9670;&nbsp;</a></span>img_aberration_phase_fit_iter_old()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_aberration_phase_fit_iter_old </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">map&lt; pair&lt; long, long &gt;, double &gt; &amp;&#160;</td>
          <td class="paramname"><em>wa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aaed6fd4f4799af13390f1a657283809a" name="aaed6fd4f4799af13390f1a657283809a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaed6fd4f4799af13390f1a657283809a">&#9670;&nbsp;</a></span>img_ctf_astigmatism_measure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_astigmatism_measure </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>real_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7cd8d919510e3b6e516cb29b7f8b9221" name="a7cd8d919510e3b6e516cb29b7f8b9221"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cd8d919510e3b6e516cb29b7f8b9221">&#9670;&nbsp;</a></span>img_ctf_find_defocus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_find_defocus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_inc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Searches for the defocus based on correlation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">&amp;em_ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">def_start</td><td>defocus search start (default 1e3). </td></tr>
    <tr><td class="paramname">def_end</td><td>defocus search end (default 2e5). </td></tr>
    <tr><td class="paramname">def_inc</td><td>defocus search increment (default 1e3). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double R factor. <pre class="fragment">A radial power spectrum is calculated.
A range of defocus values is tested (1000-200000 angstrom, 0.1-20 um), 
and the best fitting value accepted.
The new parameters are written into the CTFparam structure.
</pre> </dd></dl>

</div>
</div>
<a id="ad5671f57a87501e88064762cecb05286" name="ad5671f57a87501e88064762cecb05286"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5671f57a87501e88064762cecb05286">&#9670;&nbsp;</a></span>img_ctf_find_defocus2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_find_defocus2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_inc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a658fe7498c17794706048a00a858c7cc" name="a658fe7498c17794706048a00a858c7cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a658fe7498c17794706048a00a858c7cc">&#9670;&nbsp;</a></span>img_ctf_fit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_inc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6bcbb9f31ffc1676eaa64d9811f226a0" name="a6bcbb9f31ffc1676eaa64d9811f226a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bcbb9f31ffc1676eaa64d9811f226a0">&#9670;&nbsp;</a></span>img_ctf_fit_aberration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit_aberration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a67531ca1d0884d83e11cf25873f1e95b" name="a67531ca1d0884d83e11cf25873f1e95b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67531ca1d0884d83e11cf25873f1e95b">&#9670;&nbsp;</a></span>img_ctf_fit_astigmatism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit_astigmatism </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fits the astigmatism with a given defocus, baseline and envelope. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">&amp;em_ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double objective measure (larger is better). <pre class="fragment">A radial power spectrum is calculated and the baseline subtracted.
The defocus deviation starts from a low value to get an estimate of
the astigmatism angle. The defocus deviation is modified nased on
the direction of improvements in the fit, at each iteration 
narrowing the angular search for the astigmatism angle.
The new parameters are written into the CTFparam structure.
</pre> </dd></dl>

</div>
</div>
<a id="a804fa46726d940f0c0ed88f2da0a6825" name="a804fa46726d940f0c0ed88f2da0a6825"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a804fa46726d940f0c0ed88f2da0a6825">&#9670;&nbsp;</a></span>img_ctf_fit_baseline()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit_baseline </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fits only the baseline for a given CTF. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">&amp;em_ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double R factor. <pre class="fragment">A radial power spectrum is calculated incorporating astigmatism.
The baseline of the required type is fit.
The new parameters are written into the CTFparam structure.
</pre> </dd></dl>

</div>
</div>
<a id="ac0cc671d77d351f03aa631bb40927eca" name="ac0cc671d77d351f03aa631bb40927eca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0cc671d77d351f03aa631bb40927eca">&#9670;&nbsp;</a></span>img_ctf_fit_envelope()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit_envelope </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fits only the envelope for a given CTF. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">*em_ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double R factor. <pre class="fragment">A radial power spectrum is calculated incorporating astigmatism.
The envelope is fit.
The new parameters are written into the CTFparam structure.
</pre> </dd></dl>

</div>
</div>
<a id="a939a7083c613d4db1d057d6b64001a4c" name="a939a7083c613d4db1d057d6b64001a4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a939a7083c613d4db1d057d6b64001a4c">&#9670;&nbsp;</a></span>img_ctf_fit_old()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit_old </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_inc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines the CTF parameters from a power spectrum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">&amp;em_ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit </td></tr>
    <tr><td class="paramname">def_start</td><td>defocus search start (default 1e3). </td></tr>
    <tr><td class="paramname">def_end</td><td>defocus search end (default 2e5). </td></tr>
    <tr><td class="paramname">def_inc</td><td>defocus search increment (default 1e3). </td></tr>
    <tr><td class="paramname">flag</td><td>flag to determine astigmatism. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double water ring index. <pre class="fragment">Input: Power spectrum or its logarithm.
A radial power spectrum is calculated.
A range of defocus values is tested (100-200000 angstrom, 0.01-20 um), 
defining the baseline as passing through the zeroes for each defocus 
and fitting it to a 4th order polynomial.
The envelope function is a simple gaussian on top of the baseline and
fitted to minimize the RMSD between the calculated curve and the
radial power spectrum logarithm.
The fitting is limited to the spatial frequency range between the 
first and last zeroes.
Defocus values are positive for underfocus.
Functions:
    angle = atan(y/x)
    s2 = reciprocal space distance squared
    defocus_average = (defocus_max + defocus_min)/2
    defocus_deviation = (defocus_max - defocus_min)/2
    defocus = defocus_average + defocus_deviation*cos(2*(angle - astigmatism_angle))
    phase = 0.5*PI*lambda*lambda*lambda*Cs*s2*s2 - PI*lambda*defocus*s2 - amp_shift;
    CTF = sin(phase)
The new parameters are written into the CTPparam structure.
</pre> </dd></dl>

</div>
</div>
<a id="a4d1d50f9e54ffedd85e17af8dcfd7347" name="a4d1d50f9e54ffedd85e17af8dcfd7347"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d1d50f9e54ffedd85e17af8dcfd7347">&#9670;&nbsp;</a></span>img_ctf_fit_prepare() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_ctf_fit_prepare </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab41fb97e6dae699e58039a5e42525690" name="ab41fb97e6dae699e58039a5e42525690"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab41fb97e6dae699e58039a5e42525690">&#9670;&nbsp;</a></span>img_ctf_fit_prepare() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_ctf_fit_prepare </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab3f850c2617d06151a1ef4d67e65c62d" name="ab3f850c2617d06151a1ef4d67e65c62d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3f850c2617d06151a1ef4d67e65c62d">&#9670;&nbsp;</a></span>img_ctf_fit_residual()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit_residual </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9f8dba604710ff1a72c85cd134229659" name="a9f8dba604710ff1a72c85cd134229659"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f8dba604710ff1a72c85cd134229659">&#9670;&nbsp;</a></span>img_ctf_radial_average()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_ctf_radial_average </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>em_ctf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the power spectrum radial average corrected for astigmatism. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">&amp;em_ctf</td><td>CTF parameter structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* radial average, NULL on error. <pre class="fragment">A power spectrum with its origin at the center.
Functions:
    angle = atan(y/x) - astigmatism_angle
    s2 = reciprocal space distance squared
    defocus_min = defocus_avg - defocus_dev
    defocus_max = defocus_avg + defocus_dev
    smin2 = 1 - defocus_dev/defocus_avg
    smax2 = 1 + defocus_dev/defocus_avg
    radius = sqrt(2*s2*(smax2*cos(angle)*cos(angle)+
                smin2*sin(angle)*sin(angle))/(smax2+smin2))
The radial average is returned as a new 1D image.
</pre> </dd></dl>

</div>
</div>
<a id="a9945bb5b29f4ead121dbd51a08fea589" name="a9945bb5b29f4ead121dbd51a08fea589"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9945bb5b29f4ead121dbd51a08fea589">&#9670;&nbsp;</a></span>img_ctf_radial_subtract_baseline()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_ctf_radial_subtract_baseline </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>prad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>real_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>em_ctf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a94bac8ac210dd593060082a20198b685" name="a94bac8ac210dd593060082a20198b685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94bac8ac210dd593060082a20198b685">&#9670;&nbsp;</a></span>img_fit_water_ring()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; double &gt; img_fit_water_ring </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae6ab427c1285cfc00e0faba9dc1262b2" name="ae6ab427c1285cfc00e0faba9dc1262b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6ab427c1285cfc00e0faba9dc1262b2">&#9670;&nbsp;</a></span>img_manage_power_spectrum_peak()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_manage_power_spectrum_peak </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>radius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2ac841c36d48f32c91f0439f905d9ceb" name="a2ac841c36d48f32c91f0439f905d9ceb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ac841c36d48f32c91f0439f905d9ceb">&#9670;&nbsp;</a></span>img_water_ring_index() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_water_ring_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>img_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>em_ctf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the water ring index from a power spectrum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>power spectrum. </td></tr>
    <tr><td class="paramname">img_num</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">&amp;em_ctf</td><td>CTF parameter structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double water ing index. <pre class="fragment">A radial power spectrum is calculated.
The the water ring index is defined as:
    wri = wp/b - 1
where wp is the intensity at s=0.26 (3.8 Å) and b is the background.
The background is estimated as the average of sections before and after 
the water peak:
    b1 between s=0.1 and s=0.2
    b2 between s=0.3 and s=0.4
</pre> </dd></dl>

</div>
</div>
<a id="ac2220d1b5ffa128bfeeedffbb5fa5dfc" name="ac2220d1b5ffa128bfeeedffbb5fa5dfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2220d1b5ffa128bfeeedffbb5fa5dfc">&#9670;&nbsp;</a></span>img_water_ring_index() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_water_ring_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>prad</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the water ring index from a power spectrum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*prad</td><td>radial power spectrum. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double water ing index. <pre class="fragment">The the water ring index is defined as:
    wri = wp/b - 1
where wp is the average intensity between 0.2 and 0.3, covering the 
peak at s=0.26 (3.8 Å).
The background, b, is estimated as the average of sections before and after 
the water peak:
    b1 between s=0.1 and s=0.2
    b2 between s=0.3 and s=0.4
</pre> </dd></dl>

</div>
</div>
<a id="a65d27f71a973e9a96c4e074b78d8e520" name="a65d27f71a973e9a96c4e074b78d8e520"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65d27f71a973e9a96c4e074b78d8e520">&#9670;&nbsp;</a></span>sine_aberration_fit_R()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sine_aberration_fit_R </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;&#160;</td>
          <td class="paramname"><em>simp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9cad64fbf713a7cbc42afe664f48a48e" name="a9cad64fbf713a7cbc42afe664f48a48e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cad64fbf713a7cbc42afe664f48a48e">&#9670;&nbsp;</a></span>water_ring_R()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double water_ring_R </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;&#160;</td>
          <td class="paramname"><em>simp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0b2caeb4b6f130be43e5a2f0267dd453" name="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2caeb4b6f130be43e5a2f0267dd453">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_1d197ef0d9947f4cc1ac44e7f59e2b57.html">mg</a></li><li class="navelem"><a class="el" href="mg__ctf__fit_8cpp.html">mg_ctf_fit.cpp</a></li>
    <li class="footer">Generated on Tue Jan 31 2023 08:21:29 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
