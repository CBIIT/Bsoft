<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Bsoft: /usr/local/bsoft/src/img/img_helix.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Bsoft
   &#160;<span id="projectnumber">1.9</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('img__helix_8cpp.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">img_helix.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Dealing with images with helical symmetry.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="_bimage_8h_source.html">Bimage.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="img__helix_8h_source.html">img_helix.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__reconstruct_8h_source.html">mg_reconstruct.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="matrix__linear_8h_source.html">matrix_linear.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="trigonometry_8h_source.html">trigonometry.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="symmetry_8h_source.html">symmetry.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h_source.html">utilities.h</a>&quot;</code><br />
</div>
<p><a href="img__helix_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4d8e7055b5565c8d5b61e805e9e2ec11"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bplot.html">Bplot</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__helix_8cpp.html#a4d8e7055b5565c8d5b61e805e9e2ec11">img_find_helix_parameters</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, double angle_start, double angle_end, double angle_step, int bin, double hires, double lores, double radius)</td></tr>
<tr class="memdesc:a4d8e7055b5565c8d5b61e805e9e2ec11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the best helix parameters for helical map.  <a href="#a4d8e7055b5565c8d5b61e805e9e2ec11">More...</a><br /></td></tr>
<tr class="separator:a4d8e7055b5565c8d5b61e805e9e2ec11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f17b533b092c662871c1170fc9a87b7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bplot.html">Bplot</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__helix_8cpp.html#a4f17b533b092c662871c1170fc9a87b7">img_find_helix_parameters</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, double rise_start, double rise_end, double rise_step, double angle_start, double angle_end, double angle_step, int bin, double radius)</td></tr>
<tr class="memdesc:a4f17b533b092c662871c1170fc9a87b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the best helix parameters for helical map.  <a href="#a4f17b533b092c662871c1170fc9a87b7">More...</a><br /></td></tr>
<tr class="separator:a4f17b533b092c662871c1170fc9a87b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaaaaff136b62dcfa9f57a292126eb30"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__helix_8cpp.html#acaaaaff136b62dcfa9f57a292126eb30">img_helix_segment_correlation_one</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long i, double angle_start, double angle_end, double angle_step, int bin, double hires, double lores, double radius, <a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a> planf, <a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a> planb, double *cc)</td></tr>
<tr class="separator:acaaaaff136b62dcfa9f57a292126eb30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07d99929fa9a667a12aac0ef60a63e65"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bplot.html">Bplot</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__helix_8cpp.html#a07d99929fa9a667a12aac0ef60a63e65">img_helix_segment_correlation</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, int thickness, double angle_start, double angle_end, double angle_step, int bin, double hires, double lores, double radius)</td></tr>
<tr class="memdesc:a07d99929fa9a667a12aac0ef60a63e65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the correlation over rotation angles between helical segments.  <a href="#a07d99929fa9a667a12aac0ef60a63e65">More...</a><br /></td></tr>
<tr class="separator:a07d99929fa9a667a12aac0ef60a63e65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a373e50eb9a37ef627ed7f6f1d0c42785"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__helix_8cpp.html#a373e50eb9a37ef627ed7f6f1d0c42785">img_distort_elliptically</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, double angle, double shift)</td></tr>
<tr class="memdesc:a373e50eb9a37ef627ed7f6f1d0c42785"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transforms a tubular cylinder to an elliptical profile.  <a href="#a373e50eb9a37ef627ed7f6f1d0c42785">More...</a><br /></td></tr>
<tr class="separator:a373e50eb9a37ef627ed7f6f1d0c42785"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0edf41dfef4dda31ce85519ad19e58bf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__helix_8cpp.html#a0edf41dfef4dda31ce85519ad19e58bf">img_transform_lines</a> (<a class="el" href="class_bimage.html">Bimage</a> *p)</td></tr>
<tr class="separator:a0edf41dfef4dda31ce85519ad19e58bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb418d028a8ab51cebbff278f9031efd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__helix_8cpp.html#adb418d028a8ab51cebbff278f9031efd">img_helical_cross_section</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, double helix_rise, double helix_angle, double scale, double hires)</td></tr>
<tr class="memdesc:adb418d028a8ab51cebbff278f9031efd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a helical cross section from line transforms of a filament.  <a href="#adb418d028a8ab51cebbff278f9031efd">More...</a><br /></td></tr>
<tr class="separator:adb418d028a8ab51cebbff278f9031efd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f34f4a2d456134536bc2f95468287d7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__helix_8cpp.html#a5f34f4a2d456134536bc2f95468287d7">img_snvariance</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, double snradius)</td></tr>
<tr class="memdesc:a5f34f4a2d456134536bc2f95468287d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the ratio of variance inside and outside a given radius.  <a href="#a5f34f4a2d456134536bc2f95468287d7">More...</a><br /></td></tr>
<tr class="separator:a5f34f4a2d456134536bc2f95468287d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a798c20dd8c4b7cb04e4b4f6bab3517da"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__helix_8cpp.html#a798c20dd8c4b7cb04e4b4f6bab3517da">img_extrude_cross_section</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, int length, double helix_rise, double helix_angle, int fill_type, double fill)</td></tr>
<tr class="memdesc:a798c20dd8c4b7cb04e4b4f6bab3517da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extrudes a 2D cross section into a 3D continuous helix.  <a href="#a798c20dd8c4b7cb04e4b4f6bab3517da">More...</a><br /></td></tr>
<tr class="separator:a798c20dd8c4b7cb04e4b4f6bab3517da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f75f93889b15db90508d0ce11054d4a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bplot.html">Bplot</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__helix_8cpp.html#a4f75f93889b15db90508d0ce11054d4a">img_filament_width</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, int width, int lim_lo, int lim_hi)</td></tr>
<tr class="memdesc:a4f75f93889b15db90508d0ce11054d4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimates the width of a filament.  <a href="#a4f75f93889b15db90508d0ce11054d4a">More...</a><br /></td></tr>
<tr class="separator:a4f75f93889b15db90508d0ce11054d4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03e7595533cf32dce1786092deb74332"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__helix_8cpp.html#a03e7595533cf32dce1786092deb74332">img_filament_density</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, double width)</td></tr>
<tr class="memdesc:a03e7595533cf32dce1786092deb74332"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimates the density per pixel length of a filament.  <a href="#a03e7595533cf32dce1786092deb74332">More...</a><br /></td></tr>
<tr class="separator:a03e7595533cf32dce1786092deb74332"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__helix_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Dealing with images with helical symmetry. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20021127 </dd>
<dd>
Modified: 20151128 </dd></dl>

<p>Definition in file <a class="el" href="img__helix_8cpp_source.html">img_helix.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a373e50eb9a37ef627ed7f6f1d0c42785"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_distort_elliptically </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transforms a tubular cylinder to an elliptical profile. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>3D image. </td></tr>
    <tr><td class="paramname">angle</td><td>angle of elliptical maximum. </td></tr>
    <tr><td class="paramname">shift</td><td>outward shift at elliptical maximum radius. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">The density is shifted towards or away from the origin by a specific
amount and in a direction determined by an elliptical profile.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__helix_8cpp_source.html#l00489">489</a> of file <a class="el" href="img__helix_8cpp_source.html">img_helix.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a798c20dd8c4b7cb04e4b4f6bab3517da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_extrude_cross_section </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>helix_rise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>helix_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fill_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fill</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extrudes a 2D cross section into a 3D continuous helix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image (converted to floating point). </td></tr>
    <tr><td class="paramname">length</td><td>length in z. </td></tr>
    <tr><td class="paramname">helix_rise</td><td>helical subunit rise in angstrom. </td></tr>
    <tr><td class="paramname">helix_angle</td><td>helical subunit rotation in radians. </td></tr>
    <tr><td class="paramname">fill_type</td><td>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </td></tr>
    <tr><td class="paramname">fill</td><td>value of edge voxels. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">The helical axis is at the origin and alongthe a axis.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__helix_8cpp_source.html#l00782">782</a> of file <a class="el" href="img__helix_8cpp_source.html">img_helix.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a03e7595533cf32dce1786092deb74332"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_filament_density </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>width</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Estimates the density per pixel length of a filament. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>the image with the filament along the y axis. </td></tr>
    <tr><td class="paramname">width</td><td>filament width (pixels). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* one dimensional image with line integrals. <pre class="fragment">The filament axis must be along the long axis (x or y).
The filament width must be about half of the image width.
The background is calculated for each line from the regions 
outside the width of the filament and subtracted from all
values in the line.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__helix_8cpp_source.html#l00941">941</a> of file <a class="el" href="img__helix_8cpp_source.html">img_helix.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4f75f93889b15db90508d0ce11054d4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bplot.html">Bplot</a>* img_filament_width </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lim_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lim_hi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Estimates the width of a filament. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>the image with the filament along the y axis. </td></tr>
    <tr><td class="paramname">width</td><td>window size. </td></tr>
    <tr><td class="paramname">lim_lo</td><td>minimum filament width. </td></tr>
    <tr><td class="paramname">lim_hi</td><td>maximum filament width. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bplot* plot of filament widths. <pre class="fragment">The filament axis must be along the y axis.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__helix_8cpp_source.html#l00837">837</a> of file <a class="el" href="img__helix_8cpp_source.html">img_helix.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4d8e7055b5565c8d5b61e805e9e2ec11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bplot.html">Bplot</a>* img_find_helix_parameters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the best helix parameters for helical map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image to be tested. </td></tr>
    <tr><td class="paramname">angle_start</td><td>start value for angle. </td></tr>
    <tr><td class="paramname">angle_end</td><td>end value for angle. </td></tr>
    <tr><td class="paramname">angle_step</td><td>step size for angle. </td></tr>
    <tr><td class="paramname">bin</td><td>bin image for faster searching (limited to 1,2,3). </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit in angstroms. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit in angstroms. </td></tr>
    <tr><td class="paramname">radius</td><td>radius for mask (voxels). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bplot* plot with search results. <pre class="fragment">An incremental search is done for the rotation angle, with the rise
inferred from the cross-correlation shift.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__helix_8cpp_source.html#l00037">37</a> of file <a class="el" href="img__helix_8cpp_source.html">img_helix.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4f17b533b092c662871c1170fc9a87b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bplot.html">Bplot</a>* img_find_helix_parameters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rise_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rise_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rise_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the best helix parameters for helical map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image to be tested. </td></tr>
    <tr><td class="paramname">rise_start</td><td>start value for rise. </td></tr>
    <tr><td class="paramname">rise_end</td><td>end value for rise. </td></tr>
    <tr><td class="paramname">rise_step</td><td>step size for rise. </td></tr>
    <tr><td class="paramname">angle_start</td><td>start value for angle. </td></tr>
    <tr><td class="paramname">angle_end</td><td>end value for angle. </td></tr>
    <tr><td class="paramname">angle_step</td><td>step size for angle. </td></tr>
    <tr><td class="paramname">bin</td><td>bin image for faster searching (limited to 1,2,3). </td></tr>
    <tr><td class="paramname">radius</td><td>radius for mask (voxels). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bplot* plot with search results. <pre class="fragment">An incremental search is done for the rise and rotation angle.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__helix_8cpp_source.html#l00189">189</a> of file <a class="el" href="img__helix_8cpp_source.html">img_helix.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="adb418d028a8ab51cebbff278f9031efd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_helical_cross_section </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>helix_rise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>helix_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a helical cross section from line transforms of a filament. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image (converted to floating point). </td></tr>
    <tr><td class="paramname">helix_rise</td><td>helical subunit rise in angstrom. </td></tr>
    <tr><td class="paramname">helix_angle</td><td>helical subunit rotation in radians. </td></tr>
    <tr><td class="paramname">scale</td><td>scale of cross section. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* 2D cross section image. <pre class="fragment">The filament image must be oriented with the helical axis coinciding with 
the y axis. Each row of pixels is transformed and written into a
2D transform based on an orientation calculated from given helical
parameters.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__helix_8cpp_source.html#l00607">607</a> of file <a class="el" href="img__helix_8cpp_source.html">img_helix.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a07d99929fa9a667a12aac0ef60a63e65"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bplot.html">Bplot</a>* img_helix_segment_correlation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>thickness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the correlation over rotation angles between helical segments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image to be tested. </td></tr>
    <tr><td class="paramname">thickness</td><td>segment thickness. </td></tr>
    <tr><td class="paramname">angle_start</td><td>start value for angle. </td></tr>
    <tr><td class="paramname">angle_end</td><td>end value for angle. </td></tr>
    <tr><td class="paramname">angle_step</td><td>step size for angle. </td></tr>
    <tr><td class="paramname">bin</td><td>bin image for faster searching (limited to 1,2,3). </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit in angstroms. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit in angstroms. </td></tr>
    <tr><td class="paramname">radius</td><td>radius for mask (voxels). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bplot* plot with coefficients over all rotations results. <pre class="fragment">The image is split up into segments in the z direction. Every adjacent pair
of segments are cross-correlated over an angular range to find the best
rotation. The cross-correlation can be resolution-limited. The image may
also be masked beyond a radius and binned to speed up execution.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__helix_8cpp_source.html#l00368">368</a> of file <a class="el" href="img__helix_8cpp_source.html">img_helix.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="acaaaaff136b62dcfa9f57a292126eb30"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_helix_segment_correlation_one </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__helix_8cpp_source.html#l00325">325</a> of file <a class="el" href="img__helix_8cpp_source.html">img_helix.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a5f34f4a2d456134536bc2f95468287d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_snvariance </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>snradius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the ratio of variance inside and outside a given radius. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image (converted to floating point). </td></tr>
    <tr><td class="paramname">snradius</td><td>radius of signal. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double the SNR. <pre class="fragment">The region outside the radial limit is considered noise and the region
inside is considered signal plus noise.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__helix_8cpp_source.html#l00717">717</a> of file <a class="el" href="img__helix_8cpp_source.html">img_helix.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0edf41dfef4dda31ce85519ad19e58bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_transform_lines </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__helix_8cpp_source.html#l00550">550</a> of file <a class="el" href="img__helix_8cpp_source.html">img_helix.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_7673ec780970b264223275c6ce2fb0e1.html">img</a></li><li class="navelem"><a class="el" href="img__helix_8cpp.html">img_helix.cpp</a></li>
    <li class="footer">Generated on Mon Mar 28 2016 18:33:18 for Bsoft by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
