<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/heymannb/b20/bsoft/src/mol/molecule_to_map.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Bsoft<span id="projectnumber">&#160;2.1.4</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('molecule__to__map_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">molecule_to_map.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Functions to calculate a 3D map from atomic coordinates.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="molecule__to__map_8h.html">molecule_to_map.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="scatter_8h.html">scatter.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_complex_8h.html">Complex.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_unit_cell_8h.html">UnitCell.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="linked__list_8h.html">linked_list.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h.html">utilities.h</a>&quot;</code><br />
<code>#include &lt;fstream&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad419f2b3c00bc72917da247d53185987"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule__to__map_8cpp.html#ad419f2b3c00bc72917da247d53185987">MAXSID</a>&#160;&#160;&#160;1024</td></tr>
<tr class="separator:ad419f2b3c00bc72917da247d53185987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e0fa705e3cada0affeb47a62c08e2ec"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule__to__map_8cpp.html#a5e0fa705e3cada0affeb47a62c08e2ec">MAXSCAT</a>&#160;&#160;&#160;100</td></tr>
<tr class="separator:a5e0fa705e3cada0affeb47a62c08e2ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38db2df72431d81d10b615a01a77c950"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule__to__map_8cpp.html#a38db2df72431d81d10b615a01a77c950">MAXRAD</a>&#160;&#160;&#160;100</td></tr>
<tr class="separator:a38db2df72431d81d10b615a01a77c950"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4ac56f27e88e4dc10710b54496377cf7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule__to__map_8cpp.html#a4ac56f27e88e4dc10710b54496377cf7">mol_to_image</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="struct_batomtype.html">Batomtype</a> *atompar, double resolution, double Bfactor, int wrap, int gextype)</td></tr>
<tr class="separator:a4ac56f27e88e4dc10710b54496377cf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7569a9ba38adb1fc94709efed4757042"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule__to__map_8cpp.html#a7569a9ba38adb1fc94709efed4757042">mol_to_structure_factors</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="struct_batomtype.html">Batomtype</a> *atompar, double resolution, int wrap, double Bfactor)</td></tr>
<tr class="separator:a7569a9ba38adb1fc94709efed4757042"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22ad715a84d11353aeebff3e8322531a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule__to__map_8cpp.html#a22ad715a84d11353aeebff3e8322531a">img_from_molecule</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; origin, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; <a class="el" href="use__ctf_8inc.html#a7a2f2f92a2bbfc2ea0b2e85f0056ca4e">size</a>, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; sampling, double resolution, double Bfactor, int wrap, int gextype, int spacegroup, <a class="el" href="class_unit_cell.html">UnitCell</a> unit_cell)</td></tr>
<tr class="memdesc:a22ad715a84d11353aeebff3e8322531a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a 3D density map from a set of atomic coordinates.  <a href="molecule__to__map_8cpp.html#a22ad715a84d11353aeebff3e8322531a">More...</a><br /></td></tr>
<tr class="separator:a22ad715a84d11353aeebff3e8322531a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6932a99e443e01ee795bc949815a070"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule__to__map_8cpp.html#ad6932a99e443e01ee795bc949815a070">compare_mol_map</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_bimage.html">Bimage</a> *pcalc, <a class="el" href="class_bimage.html">Bimage</a> *p)</td></tr>
<tr class="memdesc:ad6932a99e443e01ee795bc949815a070"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compares reference and calculated maps and calculates an occupancy for every atom in the molecule set.  <a href="molecule__to__map_8cpp.html#ad6932a99e443e01ee795bc949815a070">More...</a><br /></td></tr>
<tr class="separator:ad6932a99e443e01ee795bc949815a070"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3077a16f1fcff086bd9202546ebaf83"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule__to__map_8cpp.html#ac3077a16f1fcff086bd9202546ebaf83">img_sf_from_molecule</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; origin, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; <a class="el" href="use__ctf_8inc.html#a7a2f2f92a2bbfc2ea0b2e85f0056ca4e">size</a>, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; sampling, double resolution, int spacegroup, <a class="el" href="class_unit_cell.html">UnitCell</a> unit_cell, int wrap, double Bfactor, <a class="el" href="class_bstring.html">Bstring</a> &amp;paramfile)</td></tr>
<tr class="memdesc:ac3077a16f1fcff086bd9202546ebaf83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a 3D set of structure factors from a set of atomic coordinates.  <a href="molecule__to__map_8cpp.html#ac3077a16f1fcff086bd9202546ebaf83">More...</a><br /></td></tr>
<tr class="separator:ac3077a16f1fcff086bd9202546ebaf83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e542758a0cdbda503ea77e29536f886"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule__to__map_8cpp.html#a3e542758a0cdbda503ea77e29536f886">one_sf</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_bimage.html">Bimage</a> *p, long i, double s, double scale, double *scat)</td></tr>
<tr class="separator:a3e542758a0cdbda503ea77e29536f886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05327bbb27d6c5afa51fca3d9839e1c2"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule__to__map_8cpp.html#a05327bbb27d6c5afa51fca3d9839e1c2">get_potential_curves</a> (<a class="el" href="struct_batomtype.html">Batomtype</a> *atompar, double interval)</td></tr>
<tr class="separator:a05327bbb27d6c5afa51fca3d9839e1c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36420e6db798b7b4ed702957a48a0a8b"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule__to__map_8cpp.html#a36420e6db798b7b4ed702957a48a0a8b">get_scattering_curves</a> (<a class="el" href="struct_batomtype.html">Batomtype</a> *atompar, double Bfactor, double recip_interval, long &amp;nscat)</td></tr>
<tr class="separator:a36420e6db798b7b4ed702957a48a0a8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4b135beaa18d031242d4276e6971894"><td class="memItemLeft" align="right" valign="top">map&lt; string, vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule__to__map_8cpp.html#ad4b135beaa18d031242d4276e6971894">get_scattering_curves</a> (map&lt; string, <a class="el" href="class_bcomptype.html">Bcomptype</a> &gt; &amp;types, double Bfactor, double recip_interval)</td></tr>
<tr class="separator:ad4b135beaa18d031242d4276e6971894"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule__to__map_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Functions to calculate a 3D map from atomic coordinates. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 19970914 </dd>
<dd>
Modified: 20210216 </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a38db2df72431d81d10b615a01a77c950" name="a38db2df72431d81d10b615a01a77c950"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38db2df72431d81d10b615a01a77c950">&#9670;&nbsp;</a></span>MAXRAD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXRAD&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5e0fa705e3cada0affeb47a62c08e2ec" name="a5e0fa705e3cada0affeb47a62c08e2ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e0fa705e3cada0affeb47a62c08e2ec">&#9670;&nbsp;</a></span>MAXSCAT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXSCAT&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad419f2b3c00bc72917da247d53185987" name="ad419f2b3c00bc72917da247d53185987"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad419f2b3c00bc72917da247d53185987">&#9670;&nbsp;</a></span>MAXSID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXSID&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad6932a99e443e01ee795bc949815a070" name="ad6932a99e443e01ee795bc949815a070"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6932a99e443e01ee795bc949815a070">&#9670;&nbsp;</a></span>compare_mol_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int compare_mol_map </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pcalc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compares reference and calculated maps and calculates an occupancy for every atom in the molecule set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>set of molecules with atomic coordinates. </td></tr>
    <tr><td class="paramname">*pcalc</td><td>map calculated from the set of molecules. </td></tr>
    <tr><td class="paramname">*p</td><td>reference map. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. </dd></dl>

</div>
</div>
<a id="a05327bbb27d6c5afa51fca3d9839e1c2" name="a05327bbb27d6c5afa51fca3d9839e1c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05327bbb27d6c5afa51fca3d9839e1c2">&#9670;&nbsp;</a></span>get_potential_curves()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double * get_potential_curves </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_batomtype.html">Batomtype</a> *&#160;</td>
          <td class="paramname"><em>atompar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>interval</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a36420e6db798b7b4ed702957a48a0a8b" name="a36420e6db798b7b4ed702957a48a0a8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36420e6db798b7b4ed702957a48a0a8b">&#9670;&nbsp;</a></span>get_scattering_curves() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double * get_scattering_curves </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_batomtype.html">Batomtype</a> *&#160;</td>
          <td class="paramname"><em>atompar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Bfactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>recip_interval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long &amp;&#160;</td>
          <td class="paramname"><em>nscat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad4b135beaa18d031242d4276e6971894" name="ad4b135beaa18d031242d4276e6971894"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4b135beaa18d031242d4276e6971894">&#9670;&nbsp;</a></span>get_scattering_curves() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">map&lt; string, vector&lt; double &gt; &gt; get_scattering_curves </td>
          <td>(</td>
          <td class="paramtype">map&lt; string, <a class="el" href="class_bcomptype.html">Bcomptype</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>types</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Bfactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>recip_interval</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a22ad715a84d11353aeebff3e8322531a" name="a22ad715a84d11353aeebff3e8322531a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22ad715a84d11353aeebff3e8322531a">&#9670;&nbsp;</a></span>img_from_molecule()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_from_molecule </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>sampling</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Bfactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wrap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gextype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>spacegroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_unit_cell.html">UnitCell</a>&#160;</td>
          <td class="paramname"><em>unit_cell</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a 3D density map from a set of atomic coordinates. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>set of molecules with atomic coordinates. </td></tr>
    <tr><td class="paramname">origin</td><td>3-valued origin vector (angstrom). </td></tr>
    <tr><td class="paramname">size</td><td>3-valued size vector (voxels). </td></tr>
    <tr><td class="paramname">sampling</td><td>sampling/voxel size (angstrom/voxel). </td></tr>
    <tr><td class="paramname">resolution</td><td>resolution (angstrom). </td></tr>
    <tr><td class="paramname">Bfactor</td><td>global B-factor to use, if 0, use individual atom B-factors </td></tr>
    <tr><td class="paramname">wrap</td><td>wrapping flag. </td></tr>
    <tr><td class="paramname">gextype</td><td>type of gaussian used: 0 = single, 1 = atomic potential </td></tr>
    <tr><td class="paramname">spacegroup</td><td>crystal space group. </td></tr>
    <tr><td class="paramname">unit_cell</td><td>6-valued vector of unit cell parameters. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* the new map. <pre class="fragment">A 3D map is calculated from atomic coordinates by placing a gaussian
sphere at each set of atomic coordinates. The resolution is set as
twice the sigma coefficient of the gaussian function. The amplitude
of the gaussian function is set so that the total density calculated
equals the atomic mass. The resultant map therefore has the density
units of Dalton/voxel.
The statistics of the new image is calculated.
</pre> </dd></dl>

</div>
</div>
<a id="ac3077a16f1fcff086bd9202546ebaf83" name="ac3077a16f1fcff086bd9202546ebaf83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3077a16f1fcff086bd9202546ebaf83">&#9670;&nbsp;</a></span>img_sf_from_molecule()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_sf_from_molecule </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>sampling</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>spacegroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_unit_cell.html">UnitCell</a>&#160;</td>
          <td class="paramname"><em>unit_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wrap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Bfactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>paramfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a 3D set of structure factors from a set of atomic coordinates. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>set of molecules with atomic coordinates. </td></tr>
    <tr><td class="paramname">origin</td><td>3-valued origin vector (voxels). </td></tr>
    <tr><td class="paramname">size</td><td>3-valued size vector (voxels). </td></tr>
    <tr><td class="paramname">sampling</td><td>sampling/voxel size (angstrom/voxel). </td></tr>
    <tr><td class="paramname">resolution</td><td>resolution (angstrom). </td></tr>
    <tr><td class="paramname">spacegroup</td><td>crystal space group. </td></tr>
    <tr><td class="paramname">unit_cell</td><td>6-valued vector of unit cell parameters. </td></tr>
    <tr><td class="paramname">wrap</td><td>0=cut atoms outside box, 1=wrap coordinates within unit cell. </td></tr>
    <tr><td class="paramname">Bfactor</td><td>constant for decay curve. </td></tr>
    <tr><td class="paramname">&amp;paramfile</td><td>parameter file with scattering coefficients. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* the new structure factors. <pre class="fragment">All structure factors within a given resolution are calculated from
all the selected atomic coordinates. The coordinates are fractionalized
to fit into the given size box. If the size of the box is not given,
it defaults to:
    x_size = (max(x_coor) - min(x_coor)) / x_sampling
The atomic scattering profiles are read from the STAR database as the
amplitudes and B-factors of reciprocal space gaussians. For each profile,
a lookup table is calculated to speed up further calculations.
The statistics of the new image is calculated.
</pre> </dd></dl>

</div>
</div>
<a id="a4ac56f27e88e4dc10710b54496377cf7" name="a4ac56f27e88e4dc10710b54496377cf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ac56f27e88e4dc10710b54496377cf7">&#9670;&nbsp;</a></span>mol_to_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mol_to_image </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_batomtype.html">Batomtype</a> *&#160;</td>
          <td class="paramname"><em>atompar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Bfactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wrap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gextype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7569a9ba38adb1fc94709efed4757042" name="a7569a9ba38adb1fc94709efed4757042"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7569a9ba38adb1fc94709efed4757042">&#9670;&nbsp;</a></span>mol_to_structure_factors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mol_to_structure_factors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_batomtype.html">Batomtype</a> *&#160;</td>
          <td class="paramname"><em>atompar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wrap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Bfactor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3e542758a0cdbda503ea77e29536f886" name="a3e542758a0cdbda503ea77e29536f886"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e542758a0cdbda503ea77e29536f886">&#9670;&nbsp;</a></span>one_sf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double one_sf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>scat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0b2caeb4b6f130be43e5a2f0267dd453" name="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2caeb4b6f130be43e5a2f0267dd453">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_d222c3909b771dd1cf1b375528c5865e.html">mol</a></li><li class="navelem"><a class="el" href="molecule__to__map_8cpp.html">molecule_to_map.cpp</a></li>
    <li class="footer">Generated on Tue Jan 31 2023 08:21:29 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
