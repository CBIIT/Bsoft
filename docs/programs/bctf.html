<HTML>
<HEAD>
	<meta name="Author" content="Bernard Heymann">
	<TITLE>Bsoft: bctf </TITLE>
	<link type="image/png" href="Bsoft_16x16.png" rel="icon">
</HEAD>
<BODY bgcolor="#FFFFFF">
<h2><i><font color="#000099">Bsoft program</font></i></h2>
<center><h1><font color="#FF0000">bctf</font></h1></center>  <h3>Usage: bctf [options] input.star/input.img [input2.star/output.img]</h3>
Applies, determines or corrects for the CTF (contrast transfer function) in electron micrographs. <br>
  <h3>Actions:</h3>
<table><tbody>
<tr><td>-action correct</td><td>Action: 1=flip, 2=apply, 3=correct, 4=wienerfilter,</td></tr>
<tr><td></td><td>                         5=baseline, 6=baseline2, 7=baseflip, 8=basecorrect,</td></tr>
<tr><td></td><td>                         11=prepare, 12=fit, 13=prepfit (default 0=none).</td></tr>
<tr><td>-invertaxis</td><td>Inverts the tilt axis to correct for improper setup.</td></tr>
<tr><td>-filter</td><td>Filter extremes before doing anything with the image.</td></tr>
<tr><td>-background</td><td>Correct background after applying CTF (default not).</td></tr>
<tr><td>-fitastigmatism 2</td><td>Fit astigmatism for individual micrographs (1) or combined (2) (default not).</td></tr>
<tr><td>-toparticle</td><td>Transfer micrograph CTF parameters to particle records (default not).</td></tr>
<tr><td>-ctf 512,512,2</td><td>Generate a CTF image of this size with flag: 1=center, 2=power, 3=both.</td></tr>
<tr><td>-simulate</td><td>Simulate a tilted CTF for each x or y-line.</td></tr>
<tr><td></td><td> </td></tr>
</tbody></table><br>
<h3>Parameters:</h3>
<table><tbody>
<tr><td>-verbose 7</td><td>Verbosity of output.</td></tr>
<tr><td>-datatype u</td><td>Force writing of a new data type.</td></tr>
<tr><td>-mgpath dir/subdir</td><td>Set the micrograph file paths.</td></tr>
<tr><td>-pspath dir/subdir</td><td>Set the power spectrum file paths.</td></tr>
<tr><td>-partpath dir/subdir</td><td>Set the particle file paths.</td></tr>
<tr><td>-tile 1024,1024,1</td><td>Size of power spectrum generated during preparation (default 512,512,1).</td></tr>
<tr><td>-micrograph</td><td>Use micrograph file given in parameter file instead of particle file.</td></tr>
<tr><td>-frames</td><td>Use micrograph frames file given in parameter file instead of particle file.</td></tr>
<tr><td>-sampling 1.5,1.5,1.5</td><td>Sampling (angstrom/pixel, a single value sets all three).</td></tr>
<tr><td>-resolution 27.5,125.3</td><td>Resolution limits for CTF determination and application (default 0.1,1e6).</td></tr>
<tr><td>-wiener 0.15</td><td>Wiener factor for CTF correction (default 0.2).</td></tr>
<tr><td></td><td> </td></tr>
<tr><td></td><td>Microscope parameters:</td></tr>
<tr><td>-Volt 100</td><td>Set the acceleration voltage (default 120 kV).</td></tr>
<tr><td>-Amplitude 0.07</td><td>Set the amplitude contrast (default 0.07).</td></tr>
<tr><td>-Cs 2.0</td><td>Set the spherical aberration, Cs (default 2.0 mm).</td></tr>
<tr><td>-Cc 2.0</td><td>Set the chromatic aberration, Cc (default 2.0 mm).</td></tr>
<tr><td>-alpha 0.15</td><td>Set the illumination half-angle (default 0.1 milliradians).</td></tr>
<tr><td>-energyspread 0.9</td><td>Set the effective energy spread (default 1 eV).</td></tr>
<tr><td>-aperture 100</td><td>Aperture size (default 100 Âµm).</td></tr>
<tr><td>-focallength 2.5</td><td>Focal length (default 3.5 mm).</td></tr>
<tr><td>-slitwidth 25</td><td>Energy filter slit width (default 0 eV - no filter).</td></tr>
<tr><td></td><td> </td></tr>
<tr><td></td><td>Imaging parameters:</td></tr>
<tr><td>-Defocus 1.2,1.0,47</td><td>Defocus average & deviation, and astigmatism angle (default 2 um, 0 um, 0).</td></tr>
<tr><td>-Astigmatism 0.3,-34</td><td>Set defocus deviation and astigmatism angle (um, degrees).</td></tr>
<tr><td>-axis 74.7</td><td>Tilt axis angle relative to x-axis (default 0 or from parameter file).</td></tr>
<tr><td>-tilt 15</td><td>Tilt angle (default from parameter file).</td></tr>
<tr><td>-basetype 2</td><td>Baseline type: (default 1)</td></tr>
<tr><td></td><td>                         Type 1: Polynomial with 5 coefficients.</td></tr>
<tr><td></td><td>                         Type 2: Double Gaussian with 5 coefficients.</td></tr>
<tr><td></td><td>                         Type 3: EMAN style with 4 coefficients.</td></tr>
<tr><td></td><td>                         Types 4-6: 1-3 with gaussian fit of water ring (only for high resolution limit < 3 A).</td></tr>
<tr><td>-baseline</td><td>1,1.5,-2.6,12.9,30,118 Baseline type and 4 or 5 coefficients: (default 1,0,0,0,0)</td></tr>
<tr><td>-envtype 3</td><td>Envelope type: (default 4)</td></tr>
<tr><td></td><td>                         Type 1: Single gaussian (2 coefficients).</td></tr>
<tr><td></td><td>                         Type 2: Single gaussian with constant (3 coefficients).</td></tr>
<tr><td></td><td>                         Type 3: Double gaussian (4 coefficients).</td></tr>
<tr><td></td><td>                         Type 4: Double gaussian with constant (5 coefficients).</td></tr>
<tr><td>-envelope</td><td>28,-563,0.78,-215 Envelope coefficients: Double gaussian with 4 coefficients (default 1,-10,0,0).</td></tr>
<tr><td></td><td> </td></tr>
<tr><td></td><td>Fitting parameters:</td></tr>
<tr><td>-Range 0.6,3.5,0.2</td><td>Defocus minimum, maximum and increment for fitting (default 0.1,20,0.1 um).</td></tr>
<tr><td></td><td> </td></tr>
</tbody></table><br>
<h3>Input:</h3>
<table><tbody>
<tr><td>-json file.json</td><td>Input JSON file with CTF parameters.</td></tr>
<tr><td></td><td> </td></tr>
</tbody></table><br>
<h3>Output:</h3>
<table><tbody>
<tr><td>-output file.star</td><td>Output parameter file.</td></tr>
<tr><td>-jsonout file.json</td><td>Output CTF parameters to a JSON file.</td></tr>
<tr><td>-PSaverage file.mrc</td><td>Output average power spectrum.</td></tr>
<tr><td>-Postscript file.ps</td><td>Postscript output file name for CTF fit.</td></tr>
<tr><td>-Histogram file.ps</td><td>Postscript output file name for defocus histogram.</td></tr>
<tr><td>-Plotastigmatism file.ps</td><td>Postscript output file name for astigmatism.</td></tr>
<tr><td>-Average file.ps</td><td>Postscript output file name for average of all CTF curves.</td></tr>
<tr><td>-Zeroes file.ps</td><td>Postscript output file name for defocus-vs-zeroes plot.</td></tr>
<tr><td>-Envelope file.ps</td><td>Envelope curve output file name.</td></tr>
<tr><td>-Pointspread file.ps</td><td>Point spread curve output file name.</td></tr>
<tr><td>-Function ctf.mrc</td><td>Contrast transfer function output file name.</td></tr>
<tr><td></td><td> </td></tr>
</tbody></table><br>
<h3>Examples:</h3>
<table><tbody>
<tr><td></td><td>To apply the CTF:</td></tr>
<tr><td></td><td>bctf -verbose 7 -action apply -Defocus 2.3 input.img distorted.img</td></tr>
<tr><td></td><td> </td></tr>
<tr><td></td><td>To prepare a power spectrum from a micrograph and to fit the CTF:</td></tr>
<tr><td></td><td>bctf -v 7 -datatype float -action prepfit -sam 1.842 -out new.star mg0001.tif mg0001_ps.pif</td></tr>
<tr><td></td><td>	This is a good way to generate the initial STAR file for each micrograph</td></tr>
<tr><td></td><td>	of a single particle analysis effort, as well as a power spectrum file.</td></tr>
<tr><td></td><td>	Subsequently, the automatic fit should be checked and corrected in bshow.</td></tr>
<tr><td></td><td> </td></tr>
<tr><td></td><td>To correct for the CTF by simply flipping the phases in every second Thon ring:</td></tr>
<tr><td></td><td>bctf -verbose 7 -action flip -Defocus 1.4 part.pif part_flip.pif</td></tr>
<tr><td></td><td>	Applying the same flipping operation twice will recover the original image.</td></tr>
<tr><td></td><td> </td></tr>
<tr><td></td><td>To correct for the CTF:</td></tr>
<tr><td></td><td>bctf -v 7 -action correct -Defocus 1.9 -wiener 0.1 part.pif part_corr.pif</td></tr>
<tr><td></td><td>	The equation used for the correction is:</td></tr>
<tr><td></td><td>		U = I*C/(C^2 + w)</td></tr>
<tr><td></td><td>	where:</td></tr>
<tr><td></td><td>		U: corrected image</td></tr>
<tr><td></td><td>		I: distorted image</td></tr>
<tr><td></td><td>		C: CTF</td></tr>
<tr><td></td><td>		w: Wiener factor, default 0.2</td></tr>
<tr><td></td><td> </td></tr>
<tr><td></td><td>To correct for the CTF with baseline compensation:</td></tr>
<tr><td></td><td>bctf -v 7 -act baseline -Def 1.2 -wien 0.2 -base 1,1.5,-2.6,12.9,30,118 part.pif part_corr.pif</td></tr>
<tr><td></td><td>	The equation used for the correction is:</td></tr>
<tr><td></td><td>		U = I*C/(B*C^2 + w)</td></tr>
<tr><td></td><td>	where:</td></tr>
<tr><td></td><td>		U: corrected image</td></tr>
<tr><td></td><td>		I: distorted image</td></tr>
<tr><td></td><td>		C: CTF</td></tr>
<tr><td></td><td>		B: baseline</td></tr>
<tr><td></td><td>		w: Wiener factor, default 0.2</td></tr>
<tr><td></td><td>	Baseline equations:</td></tr>
<tr><td></td><td>		1.	a0 + a1*s + a2*s^2 + a3*s^3 + a4*s^4</td></tr>
<tr><td></td><td>		2.	a0 + a1*e^(a2*s^2) + a3*e^(a4*s^2)</td></tr>
<tr><td></td><td>		3.	a0 + a1*e^(a2*s^0.5 + a3*s^2)</td></tr>
<tr><td></td><td> </td></tr>
</tbody></table>
<br>Bsoft version 2.0.7-20200917 (64 bit)<br>
<HR WIDTH="100%"><BR>
Generated by bdoc.pl on Mon Oct 26 08:20:11 2020 <BR>
<HR WIDTH="100%"><BR>
<center><a href="bsoft.html">Back to the Bsoft home</a></center>
<HR WIDTH="100%"><BR>
</BODY>
</HTML>
