<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Bsoft: /usr/local/bsoft/src/img/img_reconstruct.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Bsoft
   &#160;<span id="projectnumber">1.9</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('img__reconstruct_8cpp.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">img_reconstruct.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>2D and 3D reconstruction from single particle images  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="mg__processing_8h_source.html">mg_processing.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="img__reconstruct_8h_source.html">img_reconstruct.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="img__ctf_8h_source.html">img_ctf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_matrix3_8h_source.html">Matrix3.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_complex_8h_source.html">Complex.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="linked__list_8h_source.html">linked_list.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rwimg_8h_source.html">rwimg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h_source.html">utilities.h</a>&quot;</code><br />
</div>
<p><a href="img__reconstruct_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4cb33a49e2d5b3f5382cd08ed342f3b3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__reconstruct_8cpp.html#a4cb33a49e2d5b3f5382cd08ed342f3b3">img_reconstruction_interpolation</a> (<a class="el" href="class_complex.html">Complex</a>&lt; float &gt; cv, <a class="el" href="class_bimage.html">Bimage</a> *pmap, <a class="el" href="singleton_vector3.html">Vector3</a>&lt; double &gt; m, float *weight, float *weight2, double part_weight, int interp_type, <a class="el" href="singleton_vector3.html">Vector3</a>&lt; double &gt; vscale)</td></tr>
<tr class="separator:a4cb33a49e2d5b3f5382cd08ed342f3b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3529ce7f2bd93e761dc16d1370a50f05"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__reconstruct_8cpp.html#a3529ce7f2bd93e761dc16d1370a50f05">img_pack_2D_in_recip_space</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pmap, float *weight, float *weight2, <a class="el" href="struct_bsymmetry.html">Bsymmetry</a> *sym, double hi_res, double scale, int ft_size, <a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a> plan, double part_weight, int interp_type, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, int ctf_action)</td></tr>
<tr class="memdesc:a3529ce7f2bd93e761dc16d1370a50f05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Packs a 2D Fourier transform into a 3D reciprocal space volume.  <a href="#a3529ce7f2bd93e761dc16d1370a50f05">More...</a><br /></td></tr>
<tr class="separator:a3529ce7f2bd93e761dc16d1370a50f05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81d17eab7781b85c904af0fd99709e73"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__reconstruct_8cpp.html#a81d17eab7781b85c904af0fd99709e73">part_ft_size</a> (int xsize, double scale, int pad_factor)</td></tr>
<tr class="memdesc:a81d17eab7781b85c904af0fd99709e73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the Fourier transform size for 2D particle images for reconstruction.  <a href="#a81d17eab7781b85c904af0fd99709e73">More...</a><br /></td></tr>
<tr class="separator:a81d17eab7781b85c904af0fd99709e73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10f9bd2c82b2b62f59208d1092c2fec1"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__reconstruct_8cpp.html#a10f9bd2c82b2b62f59208d1092c2fec1">img_reconstruction_weigh</a> (<a class="el" href="class_bimage.html">Bimage</a> *prec)</td></tr>
<tr class="memdesc:a10f9bd2c82b2b62f59208d1092c2fec1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Weighs a reconstruction.  <a href="#a10f9bd2c82b2b62f59208d1092c2fec1">More...</a><br /></td></tr>
<tr class="separator:a10f9bd2c82b2b62f59208d1092c2fec1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7e321cd3bf6ae9c977166ba66266ba7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__reconstruct_8cpp.html#ab7e321cd3bf6ae9c977166ba66266ba7">img_reconstruction_sum_weigh</a> (<a class="el" href="class_bimage.html">Bimage</a> **pacc, int imap, int nmaps, int nthreads, double hi_res)</td></tr>
<tr class="memdesc:ab7e321cd3bf6ae9c977166ba66266ba7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Combines and weighs a map from several partial maps and weight sets.  <a href="#ab7e321cd3bf6ae9c977166ba66266ba7">More...</a><br /></td></tr>
<tr class="separator:ab7e321cd3bf6ae9c977166ba66266ba7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a957c3fc6d36e3f62a0bd6435cdeed3b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__reconstruct_8cpp.html#a957c3fc6d36e3f62a0bd6435cdeed3b5">img_reconstruction_stats</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, double resolution)</td></tr>
<tr class="memdesc:a957c3fc6d36e3f62a0bd6435cdeed3b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates Fourier shell statistics.  <a href="#a957c3fc6d36e3f62a0bd6435cdeed3b5">More...</a><br /></td></tr>
<tr class="separator:a957c3fc6d36e3f62a0bd6435cdeed3b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3bb2f883899cd6aeec4a8f838c97dc0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__reconstruct_8cpp.html#ab3bb2f883899cd6aeec4a8f838c97dc0">img_backprojection_accumulate</a> (<a class="el" href="class_bimage.html">Bimage</a> **pacc, int imap, int nmaps, int nthreads)</td></tr>
<tr class="memdesc:ab3bb2f883899cd6aeec4a8f838c97dc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accumulates multiple backprojections.  <a href="#ab3bb2f883899cd6aeec4a8f838c97dc0">More...</a><br /></td></tr>
<tr class="separator:ab3bb2f883899cd6aeec4a8f838c97dc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__reconstruct_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>2D and 3D reconstruction from single particle images </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20010403 </dd>
<dd>
Modified: 20151101 </dd></dl>

<p>Definition in file <a class="el" href="img__reconstruct_8cpp_source.html">img_reconstruct.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ab3bb2f883899cd6aeec4a8f838c97dc0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_backprojection_accumulate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> **&#160;</td>
          <td class="paramname"><em>pacc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>imap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nmaps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nthreads</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accumulates multiple backprojections. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">**pacc</td><td>array of partial maps with linked weight maps. </td></tr>
    <tr><td class="paramname">imap</td><td>which output map to weigh. </td></tr>
    <tr><td class="paramname">nmaps</td><td>number of output maps (1,2,3). </td></tr>
    <tr><td class="paramname">nthreads</td><td>number of threads per map (= number of partial maps). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. </dd></dl>

<p>Definition at line <a class="el" href="img__reconstruct_8cpp_source.html#l00629">629</a> of file <a class="el" href="img__reconstruct_8cpp_source.html">img_reconstruct.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a3529ce7f2bd93e761dc16d1370a50f05"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_pack_2D_in_recip_space </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>weight2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bsymmetry.html">Bsymmetry</a> *&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ft_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a>&#160;</td>
          <td class="paramname"><em>plan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>part_weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interp_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ctf_action</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Packs a 2D Fourier transform into a 3D reciprocal space volume. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>particle image. </td></tr>
    <tr><td class="paramname">*pmap</td><td>3D reciprocal space volume. </td></tr>
    <tr><td class="paramname">*weight</td><td>weight array. </td></tr>
    <tr><td class="paramname">*weight2</td><td>weight squared array. </td></tr>
    <tr><td class="paramname">*sym</td><td>point group symmetry. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">scale</td><td>scale of reconstruction and particle magnification. </td></tr>
    <tr><td class="paramname">ft_size</td><td>Fourier transform size. </td></tr>
    <tr><td class="paramname">plan</td><td>Fourier transform plan. </td></tr>
    <tr><td class="paramname">part_weight</td><td>weight of particle (usually 1). </td></tr>
    <tr><td class="paramname">interp_type</td><td>interpolation type (0=nearest neighbor, 1=weighted nearest neigbor, 2=trilinear). </td></tr>
    <tr><td class="paramname">*em_ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">ctf_action</td><td>CTF correction to make (0=none). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0, &lt;0 on error. <pre class="fragment">The rotation matrix is used to determine the plane in reciprocal space
to which the 2D transform data is added. The map is assumed to be cubic
and the 2D transform square. The orientation parameters must be written
into the image structure. The real space 2D image must be supplied.
This is then padded to more than twice its original size, fourier
transformed, and packed into the 3D reciprocal space block.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__reconstruct_8cpp_source.html#l00108">108</a> of file <a class="el" href="img__reconstruct_8cpp_source.html">img_reconstruct.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4cb33a49e2d5b3f5382cd08ed342f3b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_reconstruction_interpolation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_complex.html">Complex</a>&lt; float &gt;&#160;</td>
          <td class="paramname"><em>cv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="singleton_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>weight2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>part_weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interp_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="singleton_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>vscale</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__reconstruct_8cpp_source.html#l00021">21</a> of file <a class="el" href="img__reconstruct_8cpp_source.html">img_reconstruct.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a957c3fc6d36e3f62a0bd6435cdeed3b5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_reconstruction_stats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates Fourier shell statistics. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image with reciprocal space FOM calculated. </td></tr>
    <tr><td class="paramname">resolution</td><td>high resolution limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">The average FOM and number of FOM values in each resolution shell is determined.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__reconstruct_8cpp_source.html#l00439">439</a> of file <a class="el" href="img__reconstruct_8cpp_source.html">img_reconstruct.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab7e321cd3bf6ae9c977166ba66266ba7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_reconstruction_sum_weigh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> **&#160;</td>
          <td class="paramname"><em>pacc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>imap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nmaps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nthreads</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Combines and weighs a map from several partial maps and weight sets. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">**pacc</td><td>array of partial maps with linked weight maps. </td></tr>
    <tr><td class="paramname">imap</td><td>which output map to weigh. </td></tr>
    <tr><td class="paramname">nmaps</td><td>number of output maps (1,2,3). </td></tr>
    <tr><td class="paramname">nthreads</td><td>number of threads per map (= number of partial maps). </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* weighed reconstruction with FOM block. <pre class="fragment">The input is a set of partially integrated complex maps with associated 
weigths as follows:
    voxel power sums            FOM block of map.
    voxel weight sums           linked image.
    voxel weight squared sums   linked image FOM block.
The partial sums are completed into corresponding blocks in three possible
ways based on the value of imap and nmap:
    nmap    imap    result
    1       0       one map from all input maps
    2       0,1     one map from half of the input maps
    3       0       one map from all input maps
    3       1,2     one map from half of the input maps
The output map has a FOM block with an SNR value for each voxel.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__reconstruct_8cpp_source.html#l00315">315</a> of file <a class="el" href="img__reconstruct_8cpp_source.html">img_reconstruct.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a10f9bd2c82b2b62f59208d1092c2fec1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t img_reconstruction_weigh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>prec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Weighs a reconstruction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*prec</td><td>reconstruction with a pointer to a weight image. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>size_t coverage. <pre class="fragment">The FOM block contains the sum of powers, the next image conatins the
weight sum, and the next image FOM block contains the sum of the
weight squared.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__reconstruct_8cpp_source.html#l00256">256</a> of file <a class="el" href="img__reconstruct_8cpp_source.html">img_reconstruct.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a81d17eab7781b85c904af0fd99709e73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int part_ft_size </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pad_factor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the Fourier transform size for 2D particle images for reconstruction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xsize</td><td>size of x dimension. </td></tr>
    <tr><td class="paramname">scale</td><td>scale of reconstruction. </td></tr>
    <tr><td class="paramname">pad_factor</td><td>factor that determines image padding. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int transform size. <pre class="fragment">The reconstruction size must be set.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__reconstruct_8cpp_source.html#l00221">221</a> of file <a class="el" href="img__reconstruct_8cpp_source.html">img_reconstruct.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_7673ec780970b264223275c6ce2fb0e1.html">img</a></li><li class="navelem"><a class="el" href="img__reconstruct_8cpp.html">img_reconstruct.cpp</a></li>
    <li class="footer">Generated on Mon Dec 28 2015 09:05:30 for Bsoft by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
