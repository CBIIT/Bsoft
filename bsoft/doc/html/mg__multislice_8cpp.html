<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/bernard/b20/bsoft/src/mg/mg_multislice.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bsoft
   &#160;<span id="projectnumber">2.1.0</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('mg__multislice_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mg_multislice.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Generates and manipulates projects for multislice calculations.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="mg__processing_8h_source.html">mg_processing.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__ctf_8h_source.html">mg_ctf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="molecule__to__map_8h_source.html">molecule_to_map.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mol__transform_8h_source.html">mol_transform.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mol__edit_8h_source.html">mol_edit.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_complex_8h_source.html">Complex.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_vector3_8h_source.html">Vector3.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="linked__list_8h_source.html">linked_list.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="random__numbers_8h_source.html">random_numbers.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h_source.html">utilities.h</a>&quot;</code><br />
</div>
<p><a href="mg__multislice_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1765f63c04d4545c5ab016ea65866845"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__multislice_8cpp.html#a1765f63c04d4545c5ab016ea65866845">img_calc_wave_propagator</a> (<a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; size, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; sam, double thickness, double volt, double resolution)</td></tr>
<tr class="memdesc:a1765f63c04d4545c5ab016ea65866845"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the wave propagation function between slices.  <a href="mg__multislice_8cpp.html#a1765f63c04d4545c5ab016ea65866845">More...</a><br /></td></tr>
<tr class="separator:a1765f63c04d4545c5ab016ea65866845"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a8f6e26f63cef8e906bd2d07a7101df"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__multislice_8cpp.html#a1a8f6e26f63cef8e906bd2d07a7101df">img_calc_multi_slice</a> (<a class="el" href="class_bimage.html">Bimage</a> *pgrate, double thickness, double volt, double resolution)</td></tr>
<tr class="memdesc:a1a8f6e26f63cef8e906bd2d07a7101df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulates the electron imaging process using a multi-slice approach.  <a href="mg__multislice_8cpp.html#a1a8f6e26f63cef8e906bd2d07a7101df">More...</a><br /></td></tr>
<tr class="separator:a1a8f6e26f63cef8e906bd2d07a7101df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67d3ef4c7e35619dc2a6a8005efe098b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__multislice_8cpp.html#a67d3ef4c7e35619dc2a6a8005efe098b">img_calc_potential</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; size, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; origin, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; sam, double thickness, double resolution, double Bfactor, <a class="el" href="class_bstring.html">Bstring</a> &amp;paramfile, int type)</td></tr>
<tr class="memdesc:a67d3ef4c7e35619dc2a6a8005efe098b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the atomic potential.  <a href="mg__multislice_8cpp.html#a67d3ef4c7e35619dc2a6a8005efe098b">More...</a><br /></td></tr>
<tr class="separator:a67d3ef4c7e35619dc2a6a8005efe098b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea3c099478dc4eac1f08ecc7531ae7c7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__multislice_8cpp.html#aea3c099478dc4eac1f08ecc7531ae7c7">img_calc_phase_grating</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, double volt)</td></tr>
<tr class="memdesc:aea3c099478dc4eac1f08ecc7531ae7c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the phase grating approximation from the atomic potential.  <a href="mg__multislice_8cpp.html#aea3c099478dc4eac1f08ecc7531ae7c7">More...</a><br /></td></tr>
<tr class="separator:aea3c099478dc4eac1f08ecc7531ae7c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a9f3881ebb474b7d02477443d7209f1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__multislice_8cpp.html#a5a9f3881ebb474b7d02477443d7209f1">img_apply_complex_CTF</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, double def_avg, double def_dev, double ast_angle, double volts, double Cs, double Cc, double amp_shift, double alpha, double energy_spread)</td></tr>
<tr class="memdesc:a5a9f3881ebb474b7d02477443d7209f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies a complex CTF function to a Fourier transform.  <a href="mg__multislice_8cpp.html#a5a9f3881ebb474b7d02477443d7209f1">More...</a><br /></td></tr>
<tr class="separator:a5a9f3881ebb474b7d02477443d7209f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99d7ee18e575805516931636cd167f5c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__multislice_8cpp.html#a99d7ee18e575805516931636cd167f5c">project_generate</a> (int nfield, int nmg, int npart, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; pixel_size, double img_origin, double volt, double Cs, double Cc, double alpha, double energy_spread, double amp_shift, double def_min, double def_max, double dose, double tsigma, <a class="el" href="class_bstring.html">Bstring</a> &amp;fieldbase, <a class="el" href="class_bstring.html">Bstring</a> &amp;mgbase, <a class="el" href="class_bstring.html">Bstring</a> &amp;partbase, int fieldnumber, int mgnumber, int partnumber)</td></tr>
<tr class="memdesc:a99d7ee18e575805516931636cd167f5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a project for multislice simulations.  <a href="mg__multislice_8cpp.html#a99d7ee18e575805516931636cd167f5c">More...</a><br /></td></tr>
<tr class="separator:a99d7ee18e575805516931636cd167f5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46300b65a659f8d6e1ebf2e84e46fa10"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__multislice_8cpp.html#a46300b65a659f8d6e1ebf2e84e46fa10">project_generate_asu</a> (<a class="el" href="class_bstring.html">Bstring</a> &amp;symmetry_string, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; pixel_size, double img_origin, double theta_step, double phi_step, double volt, double Cs, double Cc, double alpha, double energy_spread, double amp_shift, double defocus, double dose, <a class="el" href="class_bstring.html">Bstring</a> &amp;mgbase, <a class="el" href="class_bstring.html">Bstring</a> &amp;partbase)</td></tr>
<tr class="memdesc:a46300b65a659f8d6e1ebf2e84e46fa10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a project for multislice calculations of an asymmetric unit.  <a href="mg__multislice_8cpp.html#a46300b65a659f8d6e1ebf2e84e46fa10">More...</a><br /></td></tr>
<tr class="separator:a46300b65a659f8d6e1ebf2e84e46fa10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41697c48743be269fef37b7d3d608990"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__multislice_8cpp.html#a41697c48743be269fef37b7d3d608990">project_generate_potential</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *water, <a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bstring.html">Bstring</a> &amp;fieldname, <a class="el" href="class_bstring.html">Bstring</a> &amp;mgname, int partselect, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; size, double thickness, double resolution, double Bfactor, int pottype, <a class="el" href="class_bstring.html">Bstring</a> &amp;paramfile)</td></tr>
<tr class="memdesc:a41697c48743be269fef37b7d3d608990"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates potential images using a multislice calculation.  <a href="mg__multislice_8cpp.html#a41697c48743be269fef37b7d3d608990">More...</a><br /></td></tr>
<tr class="separator:a41697c48743be269fef37b7d3d608990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fb9b1ab1b7fab5e208b1e07cfc63e62"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__multislice_8cpp.html#a7fb9b1ab1b7fab5e208b1e07cfc63e62">project_generate_image</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, double thickness, double resolution)</td></tr>
<tr class="memdesc:a7fb9b1ab1b7fab5e208b1e07cfc63e62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates final images from a multislice calculation.  <a href="mg__multislice_8cpp.html#a7fb9b1ab1b7fab5e208b1e07cfc63e62">More...</a><br /></td></tr>
<tr class="separator:a7fb9b1ab1b7fab5e208b1e07cfc63e62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a972742c60c2e72d99a38bad116aa61"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__multislice_8cpp.html#a2a972742c60c2e72d99a38bad116aa61">project_apply_distortions</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int poisson, double gauss, double kmtf)</td></tr>
<tr class="memdesc:a2a972742c60c2e72d99a38bad116aa61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies imaging distortions to the final images from a multislice calculation.  <a href="mg__multislice_8cpp.html#a2a972742c60c2e72d99a38bad116aa61">More...</a><br /></td></tr>
<tr class="separator:a2a972742c60c2e72d99a38bad116aa61"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__multislice_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Generates and manipulates projects for multislice calculations. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20030805 </dd>
<dd>
Modified: 20160604 </dd></dl>

<p class="definition">Definition in file <a class="el" href="mg__multislice_8cpp_source.html">mg_multislice.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a5a9f3881ebb474b7d02477443d7209f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a9f3881ebb474b7d02477443d7209f1">&#9670;&nbsp;</a></span>img_apply_complex_CTF()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_apply_complex_CTF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_avg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ast_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>volts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Cc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>amp_shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>energy_spread</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies a complex CTF function to a Fourier transform. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>complex Fourier transform (modified). </td></tr>
    <tr><td class="paramname">def_avg</td><td>defocus minimum (angstrom). </td></tr>
    <tr><td class="paramname">def_dev</td><td>defocus maximum (angstrom). </td></tr>
    <tr><td class="paramname">ast_angle</td><td>astigmatism angle (radians). </td></tr>
    <tr><td class="paramname">volts</td><td>acceleration voltage (volts). </td></tr>
    <tr><td class="paramname">Cs</td><td>spherical aberration (angstrom). </td></tr>
    <tr><td class="paramname">Cc</td><td>chromatic aberration (angstrom). </td></tr>
    <tr><td class="paramname">amp_shift</td><td>amplitude contrast phase shift (radian). </td></tr>
    <tr><td class="paramname">alpha</td><td>beam source size (radians). </td></tr>
    <tr><td class="paramname">energy_spread</td><td>effective energy spread (fraction: typically 10^-5) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0.</dd></dl>
<pre class="fragment">The CTF is applied as a multiplication with a complex number:
    new_datum.re = datum.re*amp_fac*cos(dphi) - datum.im*phi_fac*sin(dphi)
    new_datum.re = datum.re*phi_fac*sin(dphi) + datum.im*amp_fac*cos(dphi)
Both input and output are complex transforms.
</pre> 
<p class="definition">Definition at line <a class="el" href="mg__multislice_8cpp_source.html#l00252">252</a> of file <a class="el" href="mg__multislice_8cpp_source.html">mg_multislice.cpp</a>.</p>

</div>
</div>
<a id="a1a8f6e26f63cef8e906bd2d07a7101df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a8f6e26f63cef8e906bd2d07a7101df">&#9670;&nbsp;</a></span>img_calc_multi_slice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_calc_multi_slice </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pgrate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thickness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>volt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulates the electron imaging process using a multi-slice approach. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pgrate</td><td>phase grating multi-image. </td></tr>
    <tr><td class="paramname">thickness</td><td>slice thickness (in angstrom). </td></tr>
    <tr><td class="paramname">volt</td><td>acceleration voltage (volt). </td></tr>
    <tr><td class="paramname">resolution</td><td>resolution limit (angstrom). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* simulated projection image transform. <pre class="fragment">The passage of the electron beam is simulated as the interaction of
a planar wave with successive planar phase gratings spaced at regular 
intervals, with the wave propagated between the 2D gratings. The
phase gratings are derived from slabs of the atomic potential 
calculated from the atomic structure using scattering profiles.
Note: The final product is a 2D transform of the exit wave.
Reference: Cowley, J. M. (1995) Diffraction Physics. 3rd Rev. Ed. 
    Elsevier Science, Amsterdam.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__multislice_8cpp_source.html#l00089">89</a> of file <a class="el" href="mg__multislice_8cpp_source.html">mg_multislice.cpp</a>.</p>

</div>
</div>
<a id="aea3c099478dc4eac1f08ecc7531ae7c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea3c099478dc4eac1f08ecc7531ae7c7">&#9670;&nbsp;</a></span>img_calc_phase_grating()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_calc_phase_grating </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>volt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the phase grating approximation from the atomic potential. </p>
<pre class="fragment">All calculations are complex.
</pre> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>atomic potential image (modified). </td></tr>
    <tr><td class="paramname">volt</td><td>acceleration voltage (volt). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__multislice_8cpp_source.html#l00206">206</a> of file <a class="el" href="mg__multislice_8cpp_source.html">mg_multislice.cpp</a>.</p>

</div>
</div>
<a id="a67d3ef4c7e35619dc2a6a8005efe098b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67d3ef4c7e35619dc2a6a8005efe098b">&#9670;&nbsp;</a></span>img_calc_potential()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_calc_potential </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>sam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thickness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Bfactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>paramfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the atomic potential. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>set of molecules. </td></tr>
    <tr><td class="paramname">size</td><td>size of projection image (z = 1). </td></tr>
    <tr><td class="paramname">origin</td><td>origin in x and y. </td></tr>
    <tr><td class="paramname">sam</td><td>voxel size. </td></tr>
    <tr><td class="paramname">thickness</td><td>slice thickness (in angstrom). </td></tr>
    <tr><td class="paramname">resolution</td><td>resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">Bfactor</td><td>overall temperature factor. </td></tr>
    <tr><td class="paramname">&amp;paramfile</td><td>parameter file for atomic scattering coefficients. </td></tr>
    <tr><td class="paramname">type</td><td>type of potential calculation: 0=reciprocal space, 1=real space, 2=gaussian </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* complex potential image. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__multislice_8cpp_source.html#l00139">139</a> of file <a class="el" href="mg__multislice_8cpp_source.html">mg_multislice.cpp</a>.</p>

</div>
</div>
<a id="a1765f63c04d4545c5ab016ea65866845"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1765f63c04d4545c5ab016ea65866845">&#9670;&nbsp;</a></span>img_calc_wave_propagator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_calc_wave_propagator </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>sam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thickness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>volt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the wave propagation function between slices. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>size of projection image (z = 1). </td></tr>
    <tr><td class="paramname">sam</td><td>pixel size in x and y, slice thickness in z. </td></tr>
    <tr><td class="paramname">thickness</td><td>slice thickness (in angstrom). </td></tr>
    <tr><td class="paramname">volt</td><td>acceleration voltage (volt). </td></tr>
    <tr><td class="paramname">resolution</td><td>resolution limit (angstrom). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* wave propagation function image. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__multislice_8cpp_source.html#l00032">32</a> of file <a class="el" href="mg__multislice_8cpp_source.html">mg_multislice.cpp</a>.</p>

</div>
</div>
<a id="a2a972742c60c2e72d99a38bad116aa61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a972742c60c2e72d99a38bad116aa61">&#9670;&nbsp;</a></span>project_apply_distortions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int project_apply_distortions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>poisson</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gauss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kmtf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies imaging distortions to the final images from a multislice calculation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project structure with parameters. </td></tr>
    <tr><td class="paramname">poisson</td><td>flag to add Poisson noise. </td></tr>
    <tr><td class="paramname">gauss</td><td>width of gaussian noise to add (0=no noise). </td></tr>
    <tr><td class="paramname">kmtf</td><td>mass transfer decay constant (0=no decay). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__multislice_8cpp_source.html#l00675">675</a> of file <a class="el" href="mg__multislice_8cpp_source.html">mg_multislice.cpp</a>.</p>

</div>
</div>
<a id="a99d7ee18e575805516931636cd167f5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99d7ee18e575805516931636cd167f5c">&#9670;&nbsp;</a></span>project_generate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bproject.html">Bproject</a>* project_generate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfield</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nmg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>npart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>pixel_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>img_origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>volt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Cc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>energy_spread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>amp_shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tsigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>fieldbase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>mgbase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>partbase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fieldnumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mgnumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>partnumber</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a project for multislice simulations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nfield</td><td>number of fields-of-view. </td></tr>
    <tr><td class="paramname">nmg</td><td>number of micrographs per field-of-view. </td></tr>
    <tr><td class="paramname">npart</td><td>number of particles per micrograph. </td></tr>
    <tr><td class="paramname">pixel_size</td><td>micrograph pixel size. </td></tr>
    <tr><td class="paramname">img_origin</td><td>image origin within the simulation box. </td></tr>
    <tr><td class="paramname">volt</td><td>acceleration voltage (volts). </td></tr>
    <tr><td class="paramname">Cs</td><td>spherical aberration coefficient (angstrom). </td></tr>
    <tr><td class="paramname">Cc</td><td>chromatic aberration coefficient (angstrom). </td></tr>
    <tr><td class="paramname">alpha</td><td>beam divergence angle (radians). </td></tr>
    <tr><td class="paramname">energy_spread</td><td>energy spread (relative units). </td></tr>
    <tr><td class="paramname">amp_shift</td><td>amplitude contribution phase shift (radian). </td></tr>
    <tr><td class="paramname">def_min</td><td>defocus minimum (angstrom). </td></tr>
    <tr><td class="paramname">def_max</td><td>defocus maximum (angstrom). </td></tr>
    <tr><td class="paramname">dose</td><td>electron dose (e/angstrom^2). </td></tr>
    <tr><td class="paramname">tsigma</td><td>translation standard deviation (pixels). </td></tr>
    <tr><td class="paramname">&amp;fieldbase</td><td>field base name. </td></tr>
    <tr><td class="paramname">&amp;mgbase</td><td>micrograph base name. </td></tr>
    <tr><td class="paramname">&amp;partbase</td><td>particle image base name. </td></tr>
    <tr><td class="paramname">fieldnumber</td><td>field-of-view number. </td></tr>
    <tr><td class="paramname">mgnumber</td><td>micrograph number. </td></tr>
    <tr><td class="paramname">partnumber</td><td>particle number. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bproject* project structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__multislice_8cpp_source.html#l00344">344</a> of file <a class="el" href="mg__multislice_8cpp_source.html">mg_multislice.cpp</a>.</p>

</div>
</div>
<a id="a46300b65a659f8d6e1ebf2e84e46fa10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46300b65a659f8d6e1ebf2e84e46fa10">&#9670;&nbsp;</a></span>project_generate_asu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bproject.html">Bproject</a>* project_generate_asu </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>symmetry_string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>pixel_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>img_origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>volt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Cc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>energy_spread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>amp_shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>defocus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>mgbase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>partbase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a project for multislice calculations of an asymmetric unit. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">&amp;symmetry_string</td><td>symmetry designation. </td></tr>
    <tr><td class="paramname">pixel_size</td><td>micrograph pixel size. </td></tr>
    <tr><td class="paramname">img_origin</td><td>image origin within the simulation box. </td></tr>
    <tr><td class="paramname">theta_step</td><td>step size in theta (radians). </td></tr>
    <tr><td class="paramname">phi_step</td><td>step size in phi (radians). </td></tr>
    <tr><td class="paramname">volt</td><td>acceleration voltage (volts). </td></tr>
    <tr><td class="paramname">Cs</td><td>spherical aberration coefficient (angstrom). </td></tr>
    <tr><td class="paramname">Cc</td><td>chromatic aberration coefficient (angstrom). </td></tr>
    <tr><td class="paramname">alpha</td><td>beam divergence angle (radians). </td></tr>
    <tr><td class="paramname">energy_spread</td><td>energy spread (relative units). </td></tr>
    <tr><td class="paramname">amp_shift</td><td>amplitude contribution (fraction). </td></tr>
    <tr><td class="paramname">defocus</td><td>defocus minimum (angstrom). </td></tr>
    <tr><td class="paramname">dose</td><td>electron dose (e/angstrom^2). </td></tr>
    <tr><td class="paramname">&amp;mgbase</td><td>micrograph base name. </td></tr>
    <tr><td class="paramname">&amp;partbase</td><td>particle image base name. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bproject* project structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__multislice_8cpp_source.html#l00442">442</a> of file <a class="el" href="mg__multislice_8cpp_source.html">mg_multislice.cpp</a>.</p>

</div>
</div>
<a id="a7fb9b1ab1b7fab5e208b1e07cfc63e62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fb9b1ab1b7fab5e208b1e07cfc63e62">&#9670;&nbsp;</a></span>project_generate_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int project_generate_image </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thickness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates final images from a multislice calculation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project structure with parameters. </td></tr>
    <tr><td class="paramname">thickness</td><td>thickness of slices for the multislice calculation (angstrom). </td></tr>
    <tr><td class="paramname">resolution</td><td>resolution for the multislice calculation (angstrom). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__multislice_8cpp_source.html#l00603">603</a> of file <a class="el" href="mg__multislice_8cpp_source.html">mg_multislice.cpp</a>.</p>

</div>
</div>
<a id="a41697c48743be269fef37b7d3d608990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41697c48743be269fef37b7d3d608990">&#9670;&nbsp;</a></span>project_generate_potential()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int project_generate_potential </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>water</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>fieldname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>mgname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>partselect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thickness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Bfactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pottype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>paramfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates potential images using a multislice calculation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecule group structure. </td></tr>
    <tr><td class="paramname">*water</td><td>block of water as solvent. </td></tr>
    <tr><td class="paramname">*project</td><td>project structure with parameters. </td></tr>
    <tr><td class="paramname">&amp;fieldname</td><td>selected field name (if "" do all). </td></tr>
    <tr><td class="paramname">&amp;mgname</td><td>selected micrograph (if "" do all). </td></tr>
    <tr><td class="paramname">partselect</td><td>selected particle ( if &lt;1 do all). </td></tr>
    <tr><td class="paramname">size</td><td>size of simulation block (angstrom). </td></tr>
    <tr><td class="paramname">thickness</td><td>thickness of slices for the multislice calculation (angstrom). </td></tr>
    <tr><td class="paramname">resolution</td><td>resolution for the multislice calculation (angstrom). </td></tr>
    <tr><td class="paramname">Bfactor</td><td>B-factor to apply to the multislice calculation (angstrom^2). </td></tr>
    <tr><td class="paramname">pottype</td><td>type of potential to calculate (???). </td></tr>
    <tr><td class="paramname">&amp;paramfile</td><td>parameter file for scattering curves (???). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__multislice_8cpp_source.html#l00503">503</a> of file <a class="el" href="mg__multislice_8cpp_source.html">mg_multislice.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2caeb4b6f130be43e5a2f0267dd453">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_1d197ef0d9947f4cc1ac44e7f59e2b57.html">mg</a></li><li class="navelem"><a class="el" href="mg__multislice_8cpp.html">mg_multislice.cpp</a></li>
    <li class="footer">Generated on Wed Sep 1 2021 09:22:04 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
