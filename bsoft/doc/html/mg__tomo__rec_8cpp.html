<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/bernard/b20/bsoft/src/mg/mg_tomo_rec.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bsoft
   &#160;<span id="projectnumber">2.1.0</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('mg__tomo__rec_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mg_tomo_rec.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions to do a tomographic reconstruction.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="mg__tomo__rec_8h_source.html">mg_tomo_rec.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__reconstruct_8h_source.html">mg_reconstruct.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__tomography_8h_source.html">mg_tomography.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__select_8h_source.html">mg_select.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__ctf_8h_source.html">mg_ctf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_complex_8h_source.html">Complex.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="linked__list_8h_source.html">linked_list.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h_source.html">utilities.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timer_8h_source.html">timer.h</a>&quot;</code><br />
<code>#include &lt;fstream&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
</div>
<p><a href="mg__tomo__rec_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6e0be2a33924440984c9038fb4d2c84a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#a6e0be2a33924440984c9038fb4d2c84a">img_backtransform_z_lines</a> (fstream *ftemp, <a class="el" href="class_bimage.html">Bimage</a> *p)</td></tr>
<tr class="separator:a6e0be2a33924440984c9038fb4d2c84a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab732409522b4e8ff7bcb71b743a54a2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#aab732409522b4e8ff7bcb71b743a54a2">img_write_data_block_with_type</a> (fstream *ftemp, <a class="el" href="class_bimage.html">Bimage</a> *p, double avg, double std, double cutmin, double cutmax)</td></tr>
<tr class="separator:aab732409522b4e8ff7bcb71b743a54a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8618b6fbbfd8dbdb2799a6dc1120b0a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#ad8618b6fbbfd8dbdb2799a6dc1120b0a">mg_tomo_rec_prepare</a> (<a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg, int ft_size, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; rec_size, double edge_width, double marker_radius, int fill_type, double fill, int action, double wiener, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; tile_size, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> plan)</td></tr>
<tr class="separator:ad8618b6fbbfd8dbdb2799a6dc1120b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad278516c74499cc3a2e571c3ceac1a43"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#ad278516c74499cc3a2e571c3ceac1a43">project_tomo_reconstruct</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, double hi_res, double scale, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; size, int interp_type, int pad_factor, double edge_width, double marker_radius, int fill_type, double fill, int action, double wiener)</td></tr>
<tr class="memdesc:ad278516c74499cc3a2e571c3ceac1a43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reciprocal space reconstruction from the images in a multi-image file. <br  />
  <a href="mg__tomo__rec_8cpp.html#ad278516c74499cc3a2e571c3ceac1a43">More...</a><br /></td></tr>
<tr class="separator:ad278516c74499cc3a2e571c3ceac1a43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56126ce6933914a8c06bae3704800d17"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#a56126ce6933914a8c06bae3704800d17">project_fourier_reconstruction_slab</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, double hi_res, double scale, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; size, int slab_start, int slab_end, double marker_radius, int fill_type, double fill, int action, double wiener)</td></tr>
<tr class="memdesc:a56126ce6933914a8c06bae3704800d17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reciprocal space reconstruction from the images in a multi-image file. <br  />
  <a href="mg__tomo__rec_8cpp.html#a56126ce6933914a8c06bae3704800d17">More...</a><br /></td></tr>
<tr class="separator:a56126ce6933914a8c06bae3704800d17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1c4304e685f8fc4c244529a65f67f60"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#ae1c4304e685f8fc4c244529a65f67f60">particle_tomo_reconstruct</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bparticle.html">Bparticle</a> *recpart, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; recsize, double resolution, int interp_type, long ft_size, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; scale, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> planp, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> planr, int ctf_action, double wiener, <a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;sym, <a class="el" href="class_bstring.html">Bstring</a> &amp;partbase, <a class="el" href="class_bstring.html">Bstring</a> &amp;partpath, <a class="el" href="class_bstring.html">Bstring</a> &amp;partext)</td></tr>
<tr class="memdesc:ae1c4304e685f8fc4c244529a65f67f60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reconstructs individual particles from a tilt series.  <a href="mg__tomo__rec_8cpp.html#ae1c4304e685f8fc4c244529a65f67f60">More...</a><br /></td></tr>
<tr class="separator:ae1c4304e685f8fc4c244529a65f67f60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a253c6d7a5b22c9dd1272768514d694dc"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#a253c6d7a5b22c9dd1272768514d694dc">project_tomo_reconstruct_particles</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, double resolution, int interp_type, int pad_factor, int ctf_action, double wiener, <a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;sym, <a class="el" href="class_bstring.html">Bstring</a> &amp;partbase, <a class="el" href="class_bstring.html">Bstring</a> &amp;partpath, <a class="el" href="class_bstring.html">Bstring</a> &amp;partext)</td></tr>
<tr class="memdesc:a253c6d7a5b22c9dd1272768514d694dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reconstructs particles from a tilt series.  <a href="mg__tomo__rec_8cpp.html#a253c6d7a5b22c9dd1272768514d694dc">More...</a><br /></td></tr>
<tr class="separator:a253c6d7a5b22c9dd1272768514d694dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7223caf92e4a93f5a205da6d0382f96"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#ad7223caf92e4a93f5a205da6d0382f96">img_backtransform_slices</a> (<a class="el" href="class_bimage.html">Bimage</a> *p)</td></tr>
<tr class="memdesc:ad7223caf92e4a93f5a205da6d0382f96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Backtransforms 2D slices in a 3D volume. <br  />
  <a href="mg__tomo__rec_8cpp.html#ad7223caf92e4a93f5a205da6d0382f96">More...</a><br /></td></tr>
<tr class="separator:ad7223caf92e4a93f5a205da6d0382f96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1142db4f55925935dd3c264f85cfb250"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#a1142db4f55925935dd3c264f85cfb250">img_pack_2D_in_recip_space_slab</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *prec, long zsize, long slab_start, float *weight, float *weight2, double hi_res, <a class="el" href="class_matrix3.html">Matrix3</a> mat, double scale)</td></tr>
<tr class="memdesc:a1142db4f55925935dd3c264f85cfb250"><td class="mdescLeft">&#160;</td><td class="mdescRight">Packs a 2D Fourier transform into a 3D reciprocal space volume. <br  />
  <a href="mg__tomo__rec_8cpp.html#a1142db4f55925935dd3c264f85cfb250">More...</a><br /></td></tr>
<tr class="separator:a1142db4f55925935dd3c264f85cfb250"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa976d053c150f485c17ce8f3c7f69535"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#aa976d053c150f485c17ce8f3c7f69535">img_phase_shift_slab_to_origin</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, int zsize, int slab_start)</td></tr>
<tr class="memdesc:aa976d053c150f485c17ce8f3c7f69535"><td class="mdescLeft">&#160;</td><td class="mdescRight">Phase shifts a set of reflections to the image origin.  <a href="mg__tomo__rec_8cpp.html#aa976d053c150f485c17ce8f3c7f69535">More...</a><br /></td></tr>
<tr class="separator:aa976d053c150f485c17ce8f3c7f69535"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addce77847a1997c354f5f489d1dd8fef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#addce77847a1997c354f5f489d1dd8fef">mg_fft_write</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_vector3.html">Vector3</a>&lt; int &gt; size, double scale, int pad_factor, <a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a> datatype, double marker_radius, int fill_type, double fill)</td></tr>
<tr class="memdesc:addce77847a1997c354f5f489d1dd8fef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fourier transform micrographs and write to disk. <br  />
  <a href="mg__tomo__rec_8cpp.html#addce77847a1997c354f5f489d1dd8fef">More...</a><br /></td></tr>
<tr class="separator:addce77847a1997c354f5f489d1dd8fef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30366f649d6aa26b48c160cb6de91041"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#a30366f649d6aa26b48c160cb6de91041">img_extract_ytile</a> (<a class="el" href="class_bstring.html">Bstring</a> *<a class="el" href="file__util_8cpp.html#a3c3411ced4b9632566ecc66ffa64a72a">file_list</a>, int ystart, int ysize)</td></tr>
<tr class="memdesc:a30366f649d6aa26b48c160cb6de91041"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extracts a tile from the image with limits in y. <br  />
  <a href="mg__tomo__rec_8cpp.html#a30366f649d6aa26b48c160cb6de91041">More...</a><br /></td></tr>
<tr class="separator:a30366f649d6aa26b48c160cb6de91041"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb9ec69619552c39c734e2442136e577"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#afb9ec69619552c39c734e2442136e577">img_backtransform_z_on_disk</a> (<a class="el" href="class_bstring.html">Bstring</a> *<a class="el" href="file__util_8cpp.html#a3c3411ced4b9632566ecc66ffa64a72a">file_list</a>, <a class="el" href="class_bstring.html">Bstring</a> &amp;recfile, <a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a> datatype, double avg, double std, double cutmin, double cutmax)</td></tr>
<tr class="memdesc:afb9ec69619552c39c734e2442136e577"><td class="mdescLeft">&#160;</td><td class="mdescRight">The lines along the z-dimensions of a disk-based block is Fourier back-transformed. <br  />
  <a href="mg__tomo__rec_8cpp.html#afb9ec69619552c39c734e2442136e577">More...</a><br /></td></tr>
<tr class="separator:afb9ec69619552c39c734e2442136e577"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee689abb683ac7efbd2cbd96d82ea3ec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#aee689abb683ac7efbd2cbd96d82ea3ec">img_backtransform_one_y_plane</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> plan, int y)</td></tr>
<tr class="separator:aee689abb683ac7efbd2cbd96d82ea3ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aaf1c9d4ea7afd06937fb5c083da1a0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#a5aaf1c9d4ea7afd06937fb5c083da1a0">img_backtransform_one_y_plane</a> (fstream *ftemp, <a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> plan, int y, <a class="el" href="class_complex.html">Complex</a>&lt; float &gt; *zline, <a class="el" href="class_complex.html">Complex</a>&lt; float &gt; *cfdata)</td></tr>
<tr class="separator:a5aaf1c9d4ea7afd06937fb5c083da1a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a041526572728d553dd3c80a3d2ef387b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#a041526572728d553dd3c80a3d2ef387b">img_backtransform_z_lines</a> (<a class="el" href="class_bimage.html">Bimage</a> *p)</td></tr>
<tr class="memdesc:a041526572728d553dd3c80a3d2ef387b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The lines along the z-dimensions of a disk-based block is Fourier back-transformed. <br  />
  <a href="mg__tomo__rec_8cpp.html#a041526572728d553dd3c80a3d2ef387b">More...</a><br /></td></tr>
<tr class="separator:a041526572728d553dd3c80a3d2ef387b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfff88622e660019a1b041afb0eeab68"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#acfff88622e660019a1b041afb0eeab68">gettypesize</a> (<a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a> type)</td></tr>
<tr class="memdesc:acfff88622e660019a1b041afb0eeab68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the size of a datatype.  <a href="mg__tomo__rec_8cpp.html#acfff88622e660019a1b041afb0eeab68">More...</a><br /></td></tr>
<tr class="separator:acfff88622e660019a1b041afb0eeab68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6bc4b1bd8f695fb4a6c8f86fbc1f6b7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#ac6bc4b1bd8f695fb4a6c8f86fbc1f6b7">set_value_with_datatype</a> (char *ptr, double value, <a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a> datatype)</td></tr>
<tr class="memdesc:ac6bc4b1bd8f695fb4a6c8f86fbc1f6b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a pointer to a value with a given data type.  <a href="mg__tomo__rec_8cpp.html#ac6bc4b1bd8f695fb4a6c8f86fbc1f6b7">More...</a><br /></td></tr>
<tr class="separator:ac6bc4b1bd8f695fb4a6c8f86fbc1f6b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c8a5148f0492456835a080a8375eaee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#a4c8a5148f0492456835a080a8375eaee">project_missing_mask</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; size, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; origin, double hi_res, double scale)</td></tr>
<tr class="memdesc:a4c8a5148f0492456835a080a8375eaee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a reciprocal space mask from the tilt series orientations. <br  />
  <a href="mg__tomo__rec_8cpp.html#a4c8a5148f0492456835a080a8375eaee">More...</a><br /></td></tr>
<tr class="separator:a4c8a5148f0492456835a080a8375eaee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__rec_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions to do a tomographic reconstruction. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20020416 </dd>
<dd>
Modified: 20181221 </dd></dl>

<p class="definition">Definition in file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="acfff88622e660019a1b041afb0eeab68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfff88622e660019a1b041afb0eeab68">&#9670;&nbsp;</a></span>gettypesize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long gettypesize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the size of a datatype. </p>
<pre class="fragment">This function is used for calculating image data sizes for allocating
memory and reading the data.
</pre> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>data type (defined in <a class="el" href="rwimg_8h.html" title="Header file for 2D and 3D image I/O.">rwimg.h</a>). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long size of data type, if &lt; 0 the data type is not supported. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l01395">1395</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="aee689abb683ac7efbd2cbd96d82ea3ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee689abb683ac7efbd2cbd96d82ea3ec">&#9670;&nbsp;</a></span>img_backtransform_one_y_plane() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_backtransform_one_y_plane </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>plan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l01251">1251</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="a5aaf1c9d4ea7afd06937fb5c083da1a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aaf1c9d4ea7afd06937fb5c083da1a0">&#9670;&nbsp;</a></span>img_backtransform_one_y_plane() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_backtransform_one_y_plane </td>
          <td>(</td>
          <td class="paramtype">fstream *&#160;</td>
          <td class="paramname"><em>ftemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>plan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_complex.html">Complex</a>&lt; float &gt; *&#160;</td>
          <td class="paramname"><em>zline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_complex.html">Complex</a>&lt; float &gt; *&#160;</td>
          <td class="paramname"><em>cfdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l01271">1271</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="ad7223caf92e4a93f5a205da6d0382f96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7223caf92e4a93f5a205da6d0382f96">&#9670;&nbsp;</a></span>img_backtransform_slices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_backtransform_slices </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Backtransforms 2D slices in a 3D volume. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>3D complex volume. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">Each slice is extracted, backtransformed and copied back into the
original volume.
Note: The phases are now not hermitian any more.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l00764">764</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="a041526572728d553dd3c80a3d2ef387b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a041526572728d553dd3c80a3d2ef387b">&#9670;&nbsp;</a></span>img_backtransform_z_lines() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_backtransform_z_lines </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The lines along the z-dimensions of a disk-based block is Fourier back-transformed. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image header information (statistics updated). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">Each 2D xz plane is read from the raw complex data block.
Each z-line in the plane is back-transformed.
The transformed 2D plane is written back into the raw data block.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l01322">1322</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="a6e0be2a33924440984c9038fb4d2c84a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e0be2a33924440984c9038fb4d2c84a">&#9670;&nbsp;</a></span>img_backtransform_z_lines() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_backtransform_z_lines </td>
          <td>(</td>
          <td class="paramtype">fstream *&#160;</td>
          <td class="paramname"><em>ftemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l01350">1350</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="afb9ec69619552c39c734e2442136e577"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb9ec69619552c39c734e2442136e577">&#9670;&nbsp;</a></span>img_backtransform_z_on_disk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_backtransform_z_on_disk </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> *&#160;</td>
          <td class="paramname"><em>file_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>recfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a>&#160;</td>
          <td class="paramname"><em>datatype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>avg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The lines along the z-dimensions of a disk-based block is Fourier back-transformed. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*file_list</td><td>list of image file names. </td></tr>
    <tr><td class="paramname">&amp;recfile</td><td>new reconstruction file name. </td></tr>
    <tr><td class="paramname">datatype</td><td>data type for new reconstruction file. </td></tr>
    <tr><td class="paramname">avg</td><td>target average. </td></tr>
    <tr><td class="paramname">std</td><td>target standard deviation. </td></tr>
    <tr><td class="paramname">cutmin</td><td>minimum for truncation. </td></tr>
    <tr><td class="paramname">cutmax</td><td>maximum for truncation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">Each 2D xz plane is read from the raw complex data block.
Each z-line in the plane is back-transformed.
The transformed 2D plane is written back into the raw data block.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l01173">1173</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="a30366f649d6aa26b48c160cb6de91041"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30366f649d6aa26b48c160cb6de91041">&#9670;&nbsp;</a></span>img_extract_ytile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_extract_ytile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> *&#160;</td>
          <td class="paramname"><em>file_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ystart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ysize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extracts a tile from the image with limits in y. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*file_list</td><td>list of image file names. </td></tr>
    <tr><td class="paramname">ystart</td><td>first y index. </td></tr>
    <tr><td class="paramname">ysize</td><td>size in y. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* tile, NULL on failure. <pre class="fragment">From a series of z-slab images, tiles are extracted from a defined start in y,
and with a defined size in y.
A file indicating the origins of the tiles, "y.tiles", is written to
be used with bpatch to assemble the tiles.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l01072">1072</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="a1142db4f55925935dd3c264f85cfb250"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1142db4f55925935dd3c264f85cfb250">&#9670;&nbsp;</a></span>img_pack_2D_in_recip_space_slab()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long img_pack_2D_in_recip_space_slab </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>prec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>zsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>slab_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>weight2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_matrix3.html">Matrix3</a>&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Packs a 2D Fourier transform into a 3D reciprocal space volume. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>2D Fourier transform </td></tr>
    <tr><td class="paramname">*prec</td><td>3D reciprocal space slab volume. </td></tr>
    <tr><td class="paramname">zsize</td><td>intentional z dimension of reconstruction. </td></tr>
    <tr><td class="paramname">slab_start</td><td>start of current slab. </td></tr>
    <tr><td class="paramname">*weight</td><td>weigth array. </td></tr>
    <tr><td class="paramname">*weight2</td><td>weight squared array. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">mat</td><td>affine matrix. </td></tr>
    <tr><td class="paramname">scale</td><td>scale of reconstruction and particle magnification. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long 0. <pre class="fragment">The rotation matrix is used to determine the plane in reciprocal space
to which the 2D transform data is added. The map is assumed to be cubic
and the 2D transform square. The real space 2D image must be supplied.
This is then padded to more than twice its original size, fourier
transformed, and packed into the 3D reciprocal space block.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l00815">815</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="aa976d053c150f485c17ce8f3c7f69535"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa976d053c150f485c17ce8f3c7f69535">&#9670;&nbsp;</a></span>img_phase_shift_slab_to_origin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_phase_shift_slab_to_origin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>zsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slab_start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Phase shifts a set of reflections to the image origin. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>complex image. </td></tr>
    <tr><td class="paramname">zsize</td><td>slab thickness. </td></tr>
    <tr><td class="paramname">slab_start</td><td>slab start. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">A real space translation with wrapping is equivalent to phase shifting
in reciprocal space. The phases are shifted based on the embedded
sub-image origins.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l00924">924</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="aab732409522b4e8ff7bcb71b743a54a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab732409522b4e8ff7bcb71b743a54a2">&#9670;&nbsp;</a></span>img_write_data_block_with_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_write_data_block_with_type </td>
          <td>(</td>
          <td class="paramtype">fstream *&#160;</td>
          <td class="paramname"><em>ftemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>avg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l01486">1486</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="addce77847a1997c354f5f489d1dd8fef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addce77847a1997c354f5f489d1dd8fef">&#9670;&nbsp;</a></span>mg_fft_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mg_fft_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pad_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a>&#160;</td>
          <td class="paramname"><em>datatype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>marker_radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fill_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fill</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fourier transform micrographs and write to disk. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>image processing parameter structure. </td></tr>
    <tr><td class="paramname">size</td><td>intended reconstruction size. </td></tr>
    <tr><td class="paramname">scale</td><td>reconstruction scale. </td></tr>
    <tr><td class="paramname">pad_factor</td><td>factor that determines image padding. </td></tr>
    <tr><td class="paramname">datatype</td><td>datatype (default complex float). </td></tr>
    <tr><td class="paramname">marker_radius</td><td>flag to mask out markers. </td></tr>
    <tr><td class="paramname">fill_type</td><td>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER </td></tr>
    <tr><td class="paramname">fill</td><td>value to paint markers. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* reconstruction, NULL on failure. <pre class="fragment">Each micrograph is padded to a square size that has power of 2
dimensions. The micrograph is transformed and the phases shifted
to the origin.
A pad factor of zero indicates use of original size.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l00977">977</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="ad8618b6fbbfd8dbdb2799a6dc1120b0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8618b6fbbfd8dbdb2799a6dc1120b0a">&#9670;&nbsp;</a></span>mg_tomo_rec_prepare()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* mg_tomo_rec_prepare </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ft_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>rec_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>edge_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>marker_radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fill_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fill</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiener</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>tile_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>plan</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l00031">31</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="ae1c4304e685f8fc4c244529a65f67f60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1c4304e685f8fc4c244529a65f67f60">&#9670;&nbsp;</a></span>particle_tomo_reconstruct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long particle_tomo_reconstruct </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bparticle.html">Bparticle</a> *&#160;</td>
          <td class="paramname"><em>recpart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>recsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interp_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>ft_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ctf_action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiener</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>partbase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>partpath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>partext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reconstructs individual particles from a tilt series. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>micrograph project. </td></tr>
    <tr><td class="paramname">*recpart</td><td>3D particle within the project. </td></tr>
    <tr><td class="paramname">recsize</td><td>particle reconstructions ize </td></tr>
    <tr><td class="paramname">resolution</td><td>high resolution limit for reconstruction. </td></tr>
    <tr><td class="paramname">interp_type</td><td>interpolation type. </td></tr>
    <tr><td class="paramname">ft_size</td><td>2D Fourier transform size. </td></tr>
    <tr><td class="paramname">scale</td><td>reconstruction scale. </td></tr>
    <tr><td class="paramname">planp</td><td>2D Fourier transform plan. </td></tr>
    <tr><td class="paramname">planr</td><td>3D Fourier transform plan. </td></tr>
    <tr><td class="paramname">ctf_action</td><td>flag to apply CTF to projections. </td></tr>
    <tr><td class="paramname">wiener</td><td>Wiener factor. </td></tr>
    <tr><td class="paramname">*sym</td><td>always C1. </td></tr>
    <tr><td class="paramname">&amp;partbase</td><td>particle base name for new particle reconstructions. </td></tr>
    <tr><td class="paramname">&amp;partpath</td><td>directory for new particle reconstructions. </td></tr>
    <tr><td class="paramname">&amp;partext</td><td>extension of new reconstructions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of particles. <pre class="fragment">Requires the particles to be defined in all micrographs.
The partbase, partpath and partext arguments can be left empty to
use defaults.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l00548">548</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="a56126ce6933914a8c06bae3704800d17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56126ce6933914a8c06bae3704800d17">&#9670;&nbsp;</a></span>project_fourier_reconstruction_slab()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* project_fourier_reconstruction_slab </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slab_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slab_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>marker_radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fill_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fill</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiener</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reciprocal space reconstruction from the images in a multi-image file. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>image processing parameter structure. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">scale</td><td>scale of reconstruction. </td></tr>
    <tr><td class="paramname">size</td><td>size of reconstruction. </td></tr>
    <tr><td class="paramname">slab_start</td><td>start of reconstruction slab. </td></tr>
    <tr><td class="paramname">slab_end</td><td>end of reconstruction slab. </td></tr>
    <tr><td class="paramname">marker_radius</td><td>flag and radius to mask out markers. </td></tr>
    <tr><td class="paramname">fill_type</td><td>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER </td></tr>
    <tr><td class="paramname">fill</td><td>value to paint markers. </td></tr>
    <tr><td class="paramname">action</td><td>flag to apply CTF to projections. </td></tr>
    <tr><td class="paramname">wiener</td><td>Wiener factor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* reconstruction, NULL on failure. <pre class="fragment">The orientation parameters, view vector, angle of rotation and origin,
must all be set. Each image is padded to at least two times its size 
and its Fourier transform packed into 3D reciprocal space.
The figure-of-merit calculated for each reciprocal space voxel is:
           sum(w*re)^2 + sum(w*im)^2
    FOM = ---------------------------
          sum(w)*sum(w*(re^2 + im^2))
where
    re  real part
    im  imaginary part
    w   weight (inverse distance of image pixel to closest grid point)
For voxels with only one data pixel contributing to it, FOM = 0.
An image is used in the reconstruction if its selection flag has been set.
If the selection number is less than zero, all particles with selection flags
greater than zero are used. If the selection number is zero or above, all
particles with the selection flag set to the same number are used.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l00329">329</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="a4c8a5148f0492456835a080a8375eaee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c8a5148f0492456835a080a8375eaee">&#9670;&nbsp;</a></span>project_missing_mask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* project_missing_mask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a reciprocal space mask from the tilt series orientations. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">size</td><td>size of mask. </td></tr>
    <tr><td class="paramname">origin</td><td>origin of mask. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">scale</td><td>scale of mask. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* mask, NULL on failure. <pre class="fragment">The orientation parameters of the micrographs must all be set. 
A 2D mask is overlayed onto the 3D image for each micrograph.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l01582">1582</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="ad278516c74499cc3a2e571c3ceac1a43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad278516c74499cc3a2e571c3ceac1a43">&#9670;&nbsp;</a></span>project_tomo_reconstruct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* project_tomo_reconstruct </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interp_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pad_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>edge_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>marker_radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fill_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fill</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiener</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reciprocal space reconstruction from the images in a multi-image file. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>image processing parameter structure. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">scale</td><td>scale of reconstruction. </td></tr>
    <tr><td class="paramname">size</td><td>size of reconstruction. </td></tr>
    <tr><td class="paramname">interp_type</td><td>interpolation type. </td></tr>
    <tr><td class="paramname">pad_factor</td><td>factor that determines image padding. </td></tr>
    <tr><td class="paramname">edge_width</td><td>edge smoothing width for masks. </td></tr>
    <tr><td class="paramname">marker_radius</td><td>flag and radius to mask out markers. </td></tr>
    <tr><td class="paramname">fill_type</td><td>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER </td></tr>
    <tr><td class="paramname">fill</td><td>value to paint markers. </td></tr>
    <tr><td class="paramname">action</td><td>flag to apply CTF to projections. </td></tr>
    <tr><td class="paramname">wiener</td><td>Wiener factor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* reconstruction, NULL on failure. <pre class="fragment">The orientation parameters, view vector, angle of rotation and origin,
must all be set. Each image is padded to at least two times its size 
and its Fourier transform packed into 3D reciprocal space.
The figure-of-merit calculated for each reciprocal space voxel is:
           sum(w*re)^2 + sum(w*im)^2
    FOM = ---------------------------
          sum(w)*sum(w*(re^2 + im^2))
where
    re  real part
    im  imaginary part
    w   weight (inverse distance of image pixel to closest grid point)
For voxels with only one data pixel contributing to it, FOM = 0.
An image is used in the reconstruction if its selection flag has been set.
If the selection number is less than zero, all particles with selection flags
greater than zero are used. If the selection number is zero or above, all
particles with the selection flag set to the same number are used.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l00131">131</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="a253c6d7a5b22c9dd1272768514d694dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a253c6d7a5b22c9dd1272768514d694dc">&#9670;&nbsp;</a></span>project_tomo_reconstruct_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long project_tomo_reconstruct_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interp_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pad_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ctf_action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiener</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>partbase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>partpath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>partext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reconstructs particles from a tilt series. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>micrograph project. </td></tr>
    <tr><td class="paramname">resolution</td><td>high resolution limit for reconstruction. </td></tr>
    <tr><td class="paramname">interp_type</td><td>interpolation type. </td></tr>
    <tr><td class="paramname">pad_factor</td><td>factor that determines image padding. </td></tr>
    <tr><td class="paramname">ctf_action</td><td>flag to apply CTF to projections. </td></tr>
    <tr><td class="paramname">wiener</td><td>Wiener factor. </td></tr>
    <tr><td class="paramname">*sym</td><td>point group symmetry. </td></tr>
    <tr><td class="paramname">&amp;partbase</td><td>particle base name for new particle reconstructions. </td></tr>
    <tr><td class="paramname">&amp;partpath</td><td>directory for new particle reconstructions. </td></tr>
    <tr><td class="paramname">&amp;partext</td><td>extension of new reconstructions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of particles. <pre class="fragment">Requires the particles to be defined in all micrographs.
The partbase, partpath and partext arguments can be left empty to
use defaults.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l00634">634</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<a id="ac6bc4b1bd8f695fb4a6c8f86fbc1f6b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6bc4b1bd8f695fb4a6c8f86fbc1f6b7">&#9670;&nbsp;</a></span>set_value_with_datatype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int set_value_with_datatype </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a>&#160;</td>
          <td class="paramname"><em>datatype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a pointer to a value with a given data type. </p>
<pre class="fragment">A value is inserted into a given location with the given data type.
The size of the allocated memory is channels*typesize.
</pre> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*ptr</td><td>pointer to location. </td></tr>
    <tr><td class="paramname">value</td><td>the value. </td></tr>
    <tr><td class="paramname">datatype</td><td>data type (defined in <a class="el" href="rwimg_8h.html" title="Header file for 2D and 3D image I/O.">rwimg.h</a>). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0, &lt;0 on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__tomo__rec_8cpp_source.html#l01425">1425</a> of file <a class="el" href="mg__tomo__rec_8cpp_source.html">mg_tomo_rec.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2caeb4b6f130be43e5a2f0267dd453">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_1d197ef0d9947f4cc1ac44e7f59e2b57.html">mg</a></li><li class="navelem"><a class="el" href="mg__tomo__rec_8cpp.html">mg_tomo_rec.cpp</a></li>
    <li class="footer">Generated on Wed Sep 1 2021 09:22:04 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
