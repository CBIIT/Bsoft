<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/bernard/b20/bsoft/include/mg_orient.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bsoft
   &#160;<span id="projectnumber">2.1.0</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('mg__orient_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mg_orient.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Library routines for single particle analysis.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="mg__processing_8h_source.html">mg_processing.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rwimg_8h_source.html">rwimg.h</a>&quot;</code><br />
</div>
<p><a href="mg__orient_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a1ba1303ebb6bb2986185390e558bfcc8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__orient_8h.html#a1ba1303ebb6bb2986185390e558bfcc8">TEMP_PROJ_FILE</a>&#160;&#160;&#160;&quot;temp_proj.spi&quot;</td></tr>
<tr class="separator:a1ba1303ebb6bb2986185390e558bfcc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad62bb5342e9aba2d51dcf0f20c6d4fcf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__orient_8h.html#ad62bb5342e9aba2d51dcf0f20c6d4fcf">project_prepare_2D_references</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, long first, long number, int bin=1, int ctf_action=0, double wiener=0.2)</td></tr>
<tr class="memdesc:ad62bb5342e9aba2d51dcf0f20c6d4fcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare reference images from particles.  <a href="mg__orient_8h.html#ad62bb5342e9aba2d51dcf0f20c6d4fcf">More...</a><br /></td></tr>
<tr class="separator:ad62bb5342e9aba2d51dcf0f20c6d4fcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd23893858214bfb88a681288493f35a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__orient_8h.html#acd23893858214bfb88a681288493f35a">img_prepare_projections</a> (<a class="el" href="class_bstring.html">Bstring</a> &amp;filename, <a class="el" href="class_bstring.html">Bstring</a> &amp;mask_file, int bin, <a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;sym, double theta_step, double phi_step, double side_ang)</td></tr>
<tr class="memdesc:acd23893858214bfb88a681288493f35a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate projections if a 3D file, otherwise clean projections.  <a href="mg__orient_8h.html#acd23893858214bfb88a681288493f35a">More...</a><br /></td></tr>
<tr class="separator:acd23893858214bfb88a681288493f35a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b63f8ac4c02590dbbc897b574169b50"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__orient_8h.html#a3b63f8ac4c02590dbbc897b574169b50">project_determine_orientations</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *proj, <a class="el" href="class_bstring.html">Bstring</a> &amp;mask_file, int bin, <a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;sym, int <a class="el" href="tcltk__bmg_8cpp.html#a66823305785303716aa59f76b0e3359d">part_select</a>, vector&lt; double &gt; &amp;band, double res_lo, double res_hi, double res_polar, int ann_min, int ann_max, double shift_limit, double angle_limit, double edge_radius, int flags)</td></tr>
<tr class="memdesc:a3b63f8ac4c02590dbbc897b574169b50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the orientation and origin of every image in a project.  <a href="mg__orient_8h.html#a3b63f8ac4c02590dbbc897b574169b50">More...</a><br /></td></tr>
<tr class="separator:a3b63f8ac4c02590dbbc897b574169b50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1d1759de82413331dce2c09c43ba89d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__orient_8h.html#aa1d1759de82413331dce2c09c43ba89d">project_determine_orientations2</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *proj, <a class="el" href="class_bstring.html">Bstring</a> &amp;mask_file, int bin, <a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;sym, int <a class="el" href="tcltk__bmg_8cpp.html#a66823305785303716aa59f76b0e3359d">part_select</a>, vector&lt; double &gt; &amp;band, double res_lo, double res_hi, double res_polar, int ann_min, int ann_max, double shift_limit, double angle_limit, double edge_radius, int flags)</td></tr>
<tr class="memdesc:aa1d1759de82413331dce2c09c43ba89d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the orientation and origin of every image in a project.  <a href="mg__orient_8h.html#aa1d1759de82413331dce2c09c43ba89d">More...</a><br /></td></tr>
<tr class="separator:aa1d1759de82413331dce2c09c43ba89d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58e14b1a2e60a4e93b2b6fbdbef91260"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__orient_8h.html#a58e14b1a2e60a4e93b2b6fbdbef91260">project_determine_origins</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *proj, int bin, <a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;sym, int <a class="el" href="tcltk__bmg_8cpp.html#a66823305785303716aa59f76b0e3359d">part_select</a>, double res_lo, double res_hi, double shift_limit, int flags)</td></tr>
<tr class="memdesc:a58e14b1a2e60a4e93b2b6fbdbef91260"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the origin of every image in a project.  <a href="mg__orient_8h.html#a58e14b1a2e60a4e93b2b6fbdbef91260">More...</a><br /></td></tr>
<tr class="separator:a58e14b1a2e60a4e93b2b6fbdbef91260"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f053d00a50b2030ebcb3a044e02acbc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__orient_8h.html#a0f053d00a50b2030ebcb3a044e02acbc">img_cross_validate</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pref, <a class="el" href="class_bimage.html">Bimage</a> *pmask, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</a>)</td></tr>
<tr class="memdesc:a0f053d00a50b2030ebcb3a044e02acbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotates and shifts a reference image and calculates a cross-validation coefficient.  <a href="mg__orient_8h.html#a0f053d00a50b2030ebcb3a044e02acbc">More...</a><br /></td></tr>
<tr class="separator:a0f053d00a50b2030ebcb3a044e02acbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Library routines for single particle analysis. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann and David M. Belnap </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20010403 </dd>
<dd>
Modified: 20190826 (BH) </dd></dl>

<p class="definition">Definition in file <a class="el" href="mg__orient_8h_source.html">mg_orient.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a1ba1303ebb6bb2986185390e558bfcc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ba1303ebb6bb2986185390e558bfcc8">&#9670;&nbsp;</a></span>TEMP_PROJ_FILE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TEMP_PROJ_FILE&#160;&#160;&#160;&quot;temp_proj.spi&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mg__orient_8h_source.html#l00012">12</a> of file <a class="el" href="mg__orient_8h_source.html">mg_orient.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0f053d00a50b2030ebcb3a044e02acbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f053d00a50b2030ebcb3a044e02acbc">&#9670;&nbsp;</a></span>img_cross_validate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_cross_validate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>prs_mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotates and shifts a reference image and calculates a cross-validation coefficient. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>2D image. </td></tr>
    <tr><td class="paramname">*pref</td><td>reference 2D image. </td></tr>
    <tr><td class="paramname">*prs_mask</td><td>dual mask. </td></tr>
    <tr><td class="paramname">planf</td><td>FFT forward plan. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double cross-validation coefficient. <pre class="fragment">The reference image is first rotated by the difference in the angles
between the image and the reference, then shifted to the same origin
as the image. Both are then Fourier transformed, the negative values in
the mask used to select reciprocal space areas, and the complex product
calculated. The sum of the zeroeth pixel then gives the cross-validation
coefficient.
The input images must be equal-sized square 2D images.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__orient_8cpp_source.html#l01425">1425</a> of file <a class="el" href="mg__orient_8cpp_source.html">mg_orient.cpp</a>.</p>

</div>
</div>
<a id="acd23893858214bfb88a681288493f35a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd23893858214bfb88a681288493f35a">&#9670;&nbsp;</a></span>img_prepare_projections()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_prepare_projections </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>mask_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>side_ang</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate projections if a 3D file, otherwise clean projections. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">&amp;filename</td><td>file containing reference map or projections. </td></tr>
    <tr><td class="paramname">&amp;mask_file</td><td>mask to apply to projections. </td></tr>
    <tr><td class="paramname">bin</td><td>data compression by binning. </td></tr>
    <tr><td class="paramname">*sym</td><td>point group symmetry structure. </td></tr>
    <tr><td class="paramname">theta_step</td><td>angular step size from primary symmetry axis (radians). </td></tr>
    <tr><td class="paramname">phi_step</td><td>angular step size around primary symmetry axis (radians). </td></tr>
    <tr><td class="paramname">side_ang</td><td>angular devaition from eqautor (radians). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* projection images, NULL on error. <pre class="fragment">If the input file is a 3D map, a set of projections are generated
given the point group symmetry.
Flags:
    FULL_ASU    projections for full asymmetric unit
    MULTI_FILE  projections in multiple files   
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__orient_8cpp_source.html#l00157">157</a> of file <a class="el" href="mg__orient_8cpp_source.html">mg_orient.cpp</a>.</p>

</div>
</div>
<a id="a3b63f8ac4c02590dbbc897b574169b50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b63f8ac4c02590dbbc897b574169b50">&#9670;&nbsp;</a></span>project_determine_orientations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int project_determine_orientations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>proj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>mask_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>part_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_polar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ann_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ann_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>edge_radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the orientation and origin of every image in a project. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>image processing parameter structure. </td></tr>
    <tr><td class="paramname">*proj</td><td>reference projections. </td></tr>
    <tr><td class="paramname">&amp;mask_file</td><td>mask to apply to particles. </td></tr>
    <tr><td class="paramname">bin</td><td>data compression by binning. </td></tr>
    <tr><td class="paramname">*sym</td><td>point group symmetry structure. </td></tr>
    <tr><td class="paramname">part_select</td><td>particle selection for processing. </td></tr>
    <tr><td class="paramname">*band</td><td>array of reciprocal space bands. </td></tr>
    <tr><td class="paramname">res_lo</td><td>low resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">res_hi</td><td>high resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">res_polar</td><td>resolution limit for in-plane angular alignment (angstrom). </td></tr>
    <tr><td class="paramname">ann_min</td><td>minimum annulus (&gt;=0). </td></tr>
    <tr><td class="paramname">ann_max</td><td>maximum annulus (&lt; image radius). </td></tr>
    <tr><td class="paramname">shift_limit</td><td>maximum shift from nominal origin of box. </td></tr>
    <tr><td class="paramname">angle_limit</td><td>maximum rotation from original in-plane rotation angle. </td></tr>
    <tr><td class="paramname">edge_radius</td><td>edge radius to mask background using previous origin. </td></tr>
    <tr><td class="paramname">flags</td><td>option flags. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. <pre class="fragment">The polar power spectrum (pps) of the reference projection is cross correlated
with that of the image in order to find the angle of rotation.  The image
is transformed using this angle and the shift found by cross correlation (cc).
A  second iterative comparison is done with real space polar images
to find the angle followed by cross correlation to find the shift.
How much of this second comparison is done depends on the mode flag:
    mode=0  pps     projection selected only based on pps comparison
    mode=1  scc     several projections selected based on cutoff for pps cc's
    mode=2  ccc     all projections selected
The angle and the x and y values are stored in the view_angle, and ox and oy 
arrays of the micrograph parameter structure.
The projections must already be binned.
Flags:
    MODE        projection matching mode
    APPLY_CTF   apply CTF to projections
    PART_LOG    write log files in log directory
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__orient_8cpp_source.html#l00330">330</a> of file <a class="el" href="mg__orient_8cpp_source.html">mg_orient.cpp</a>.</p>

</div>
</div>
<a id="aa1d1759de82413331dce2c09c43ba89d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1d1759de82413331dce2c09c43ba89d">&#9670;&nbsp;</a></span>project_determine_orientations2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int project_determine_orientations2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>proj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>mask_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>part_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>band</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_polar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ann_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ann_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>edge_radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the orientation and origin of every image in a project. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>image processing parameter structure. </td></tr>
    <tr><td class="paramname">*proj</td><td>reference projections. </td></tr>
    <tr><td class="paramname">&amp;mask_file</td><td>mask to apply to particles. </td></tr>
    <tr><td class="paramname">bin</td><td>data compression by binning. </td></tr>
    <tr><td class="paramname">*sym</td><td>point group symmetry structure. </td></tr>
    <tr><td class="paramname">part_select</td><td>particle selection for processing. </td></tr>
    <tr><td class="paramname">*band</td><td>array of reciprocal space bands. </td></tr>
    <tr><td class="paramname">res_lo</td><td>low resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">res_hi</td><td>high resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">res_polar</td><td>resolution limit for in-plane angular alignment (angstrom). </td></tr>
    <tr><td class="paramname">ann_min</td><td>minimum annulus (&gt;=0). </td></tr>
    <tr><td class="paramname">ann_max</td><td>maximum annulus (&lt; image radius). </td></tr>
    <tr><td class="paramname">shift_limit</td><td>maximum shift from nominal origin of box. </td></tr>
    <tr><td class="paramname">angle_limit</td><td>maximum rotation from original in-plane rotation angle. </td></tr>
    <tr><td class="paramname">edge_radius</td><td>edge radius to mask background using previous origin. </td></tr>
    <tr><td class="paramname">flags</td><td>option flags. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. <pre class="fragment">The polar power spectrum (pps) of the reference projection is cross correlated
with that of the image in order to find the angle of rotation.  The image
is transformed using this angle and the shift found by cross correlation (cc).
A  second iterative comparison is done with real space polar images
to find the angle followed by cross correlation to find the shift.
How much of this second comparison is done depends on the mode flag:
    mode=0  pps     projection selected only based on pps comparison
    mode=1  scc     several projections selected based on cutoff for pps cc's
    mode=2  ccc     all projections selected
The angle and the x and y values are stored in the view_angle, and ox and oy
arrays of the micrograph parameter structure.
The projections must already be binned.
Flags:
    MODE        projection matching mode
    APPLY_CTF   apply CTF to projections
    PART_LOG    write log files in log directory
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__orient_8cpp_source.html#l01048">1048</a> of file <a class="el" href="mg__orient_8cpp_source.html">mg_orient.cpp</a>.</p>

</div>
</div>
<a id="a58e14b1a2e60a4e93b2b6fbdbef91260"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58e14b1a2e60a4e93b2b6fbdbef91260">&#9670;&nbsp;</a></span>project_determine_origins()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int project_determine_origins </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>proj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>part_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the origin of every image in a project. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>image processing parameter structure. </td></tr>
    <tr><td class="paramname">*proj</td><td>reference projections. </td></tr>
    <tr><td class="paramname">bin</td><td>data compression by binning. </td></tr>
    <tr><td class="paramname">sym</td><td>point group symmetry structure. </td></tr>
    <tr><td class="paramname">part_select</td><td>particle selection for processing. </td></tr>
    <tr><td class="paramname">res_lo</td><td>low resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">res_hi</td><td>high resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">shift_limit</td><td>maximum shift from nominal origin of box. </td></tr>
    <tr><td class="paramname">flags</td><td>option flags. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. <pre class="fragment">The input view is used to find the corresponding reference projection.
This projection is then rotated by the input view angle and cross-correlated 
with the image to find the shift.
Flags:
    PART_LOG    write log files in log directory
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__orient_8cpp_source.html#l01246">1246</a> of file <a class="el" href="mg__orient_8cpp_source.html">mg_orient.cpp</a>.</p>

</div>
</div>
<a id="ad62bb5342e9aba2d51dcf0f20c6d4fcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad62bb5342e9aba2d51dcf0f20c6d4fcf">&#9670;&nbsp;</a></span>project_prepare_2D_references()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* project_prepare_2D_references </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ctf_action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiener</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepare reference images from particles. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">project</td><td>micrograph project structure. </td></tr>
    <tr><td class="paramname">first</td><td>first particle image to use. </td></tr>
    <tr><td class="paramname">number</td><td>number of particle images to use. </td></tr>
    <tr><td class="paramname">bin</td><td>data compression by binning. </td></tr>
    <tr><td class="paramname">ctf_action</td><td>flag to apply CTF to projections. </td></tr>
    <tr><td class="paramname">wiener</td><td>Wiener factor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* reference images, NULL on error. <pre class="fragment">The particle images are shifted to center their origins.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__orient_8cpp_source.html#l00065">65</a> of file <a class="el" href="mg__orient_8cpp_source.html">mg_orient.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="mg__orient_8h.html">mg_orient.h</a></li>
    <li class="footer">Generated on Wed Sep 1 2021 09:22:03 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
