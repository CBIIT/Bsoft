<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/heymannb/b20/bsoft/src/mol/mol_md.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Bsoft<span id="projectnumber">&#160;2.1.4</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mol__md_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">mol_md.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Functions for molecular dynamics.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="mol__md_8h.html">mol_md.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mol__bonds_8h.html">mol_bonds.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rwmolecule_8h.html">rwmolecule.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="random__numbers_8h.html">random_numbers.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_matrix_8h.html">Matrix.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="linked__list_8h.html">linked_list.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h.html">utilities.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a57f04c177084945af9279729874f0243"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__md_8cpp.html#a57f04c177084945af9279729874f0243">md_leapfrog</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="struct_bmd.html">Bmd</a> *md, int max_iter, double velocitylimit)</td></tr>
<tr class="memdesc:a57f04c177084945af9279729874f0243"><td class="mdescLeft">&#160;</td><td class="mdescRight">Molecular dynamics using the leapfrog integrator.  <a href="mol__md_8cpp.html#a57f04c177084945af9279729874f0243">More...</a><br /></td></tr>
<tr class="separator:a57f04c177084945af9279729874f0243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a711e368b3ed80addcd7f6b1510d44760"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__md_8cpp.html#a711e368b3ed80addcd7f6b1510d44760">md_zero_forces</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup)</td></tr>
<tr class="memdesc:a711e368b3ed80addcd7f6b1510d44760"><td class="mdescLeft">&#160;</td><td class="mdescRight">Zero all atomic forces.  <a href="mol__md_8cpp.html#a711e368b3ed80addcd7f6b1510d44760">More...</a><br /></td></tr>
<tr class="separator:a711e368b3ed80addcd7f6b1510d44760"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97e3497ef9aeac29780673c7db3336bd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__md_8cpp.html#a97e3497ef9aeac29780673c7db3336bd">md_bond_forces</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, double Kbond, int wrap)</td></tr>
<tr class="memdesc:a97e3497ef9aeac29780673c7db3336bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the covalent bond length forces and energy.  <a href="mol__md_8cpp.html#a97e3497ef9aeac29780673c7db3336bd">More...</a><br /></td></tr>
<tr class="separator:a97e3497ef9aeac29780673c7db3336bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d1faf5e7d196b0507114f7ef61f7a7b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__md_8cpp.html#a2d1faf5e7d196b0507114f7ef61f7a7b">md_angular_forces</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, double Kangle, int wrap)</td></tr>
<tr class="memdesc:a2d1faf5e7d196b0507114f7ef61f7a7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the covalent bond angular forces and energy.  <a href="mol__md_8cpp.html#a2d1faf5e7d196b0507114f7ef61f7a7b">More...</a><br /></td></tr>
<tr class="separator:a2d1faf5e7d196b0507114f7ef61f7a7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af839292d431e7dd6d9aa0d8d3be47151"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__md_8cpp.html#af839292d431e7dd6d9aa0d8d3be47151">md_nonbonded_forces</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="struct_bmd.html">Bmd</a> *md)</td></tr>
<tr class="memdesc:af839292d431e7dd6d9aa0d8d3be47151"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the non-bonded forces and energy.  <a href="mol__md_8cpp.html#af839292d431e7dd6d9aa0d8d3be47151">More...</a><br /></td></tr>
<tr class="separator:af839292d431e7dd6d9aa0d8d3be47151"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af070c79251e3b66371f325bcd1370229"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__md_8cpp.html#af070c79251e3b66371f325bcd1370229">atom_nonbonded_forces</a> (<a class="el" href="struct_batom.html">Batom</a> *atom, <a class="el" href="struct_batom.html">Batom</a> *atom2, <a class="el" href="struct_bmd.html">Bmd</a> *md, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; box)</td></tr>
<tr class="memdesc:af070c79251e3b66371f325bcd1370229"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the non-bonded forces and energy between two atoms.  <a href="mol__md_8cpp.html#af070c79251e3b66371f325bcd1370229">More...</a><br /></td></tr>
<tr class="separator:af070c79251e3b66371f325bcd1370229"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a191fb86d97a74414d5b73d6c7c187966"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__md_8cpp.html#a191fb86d97a74414d5b73d6c7c187966">md_point_force</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; point, double Kpoint, double decay)</td></tr>
<tr class="memdesc:a191fb86d97a74414d5b73d6c7c187966"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the atomic forces and energy resulting from a single point force.  <a href="mol__md_8cpp.html#a191fb86d97a74414d5b73d6c7c187966">More...</a><br /></td></tr>
<tr class="separator:a191fb86d97a74414d5b73d6c7c187966"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__md_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Functions for molecular dynamics. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20010828 </dd>
<dd>
Modified: 20110816 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af070c79251e3b66371f325bcd1370229" name="af070c79251e3b66371f325bcd1370229"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af070c79251e3b66371f325bcd1370229">&#9670;&nbsp;</a></span>atom_nonbonded_forces()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int atom_nonbonded_forces </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_batom.html">Batom</a> *&#160;</td>
          <td class="paramname"><em>atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_batom.html">Batom</a> *&#160;</td>
          <td class="paramname"><em>atom2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmd.html">Bmd</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>box</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the non-bonded forces and energy between two atoms. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*atom</td><td>central atom. </td></tr>
    <tr><td class="paramname">*atom2</td><td>second atom. </td></tr>
    <tr><td class="paramname">*md</td><td>molecular dynamics structure. </td></tr>
    <tr><td class="paramname">box</td><td>dynamics box. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double total non-bonded energy. <pre class="fragment">The energy is defined as a Lennard-Jones term for the Van der Waals 
interactions based on a reference length, ro, and a Coulomb term for 
electrostatic interactions based on the atomic charges, q1 and q2: 
    Enb = Kvdw*((1/12)*(|ro|/|r|)^12 - (1/6)*(|ro|/|r|)^6) + Kelec*q1*q2/|r|
The force is the derivative of the energy:
    Fnb = -Kvdw*((|ro|/|r|)^12 - (|ro|/|r|)^6)*r/|r| + Kelec*q1*q2*r/|r|^3
where r is the distance vector, Kvdw is the Van der Waals energy constant
and Kelec is the electrostatic energy constant.
</pre> </dd></dl>

</div>
</div>
<a id="a2d1faf5e7d196b0507114f7ef61f7a7b" name="a2d1faf5e7d196b0507114f7ef61f7a7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d1faf5e7d196b0507114f7ef61f7a7b">&#9670;&nbsp;</a></span>md_angular_forces()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double md_angular_forces </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kangle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wrap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the covalent bond angular forces and energy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecular structure. </td></tr>
    <tr><td class="paramname">Kangle</td><td>bond angle energy constant. </td></tr>
    <tr><td class="paramname">wrap</td><td>flag to wrap around periodic boundaries. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double total bond angle energy. <pre class="fragment">The energy is defined as a harmonic function around the reference 
bond angle, a0:
    Ea = Ka*(cos(a0)-r1*r2/(|r1|*|r2|))^2
The force is the derivative of the energy on the first and last atoms:
    Fa1 = 2*Ka*(cos(a0)-r1*r2/(|r1|*|r2|))/(|r1|*|r2|) * ((r1*r2/|r1|)*r1-r2)
    Fa3 = 2*Ka*(cos(a0)-r1*r2/(|r1|*|r2|))/(|r1|*|r2|) * ((r1*r2/|r2|)*r2-r1)
where r1 is the vector from atom 2 to atom 1, r2 is the vector from
atom 2 to atom 3, and Ka is the bond angle energy constant.
</pre> </dd></dl>

</div>
</div>
<a id="a97e3497ef9aeac29780673c7db3336bd" name="a97e3497ef9aeac29780673c7db3336bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97e3497ef9aeac29780673c7db3336bd">&#9670;&nbsp;</a></span>md_bond_forces()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double md_bond_forces </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kbond</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wrap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the covalent bond length forces and energy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecular structure. </td></tr>
    <tr><td class="paramname">Kbond</td><td>bond energy constant. </td></tr>
    <tr><td class="paramname">wrap</td><td>flag to wrap around periodic boundaries. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double total bond length energy. <pre class="fragment">The energy is defined as a harmonic function around the reference 
bond length, |ro|:
    Eb = Kb*(|r|-|ro|)^2
The force is the derivative of the energy:
    Fb = -2*Kb*(|r|-|ro|)*r/|r|
where r is the distance vector and Kb is the bond energy constant.
</pre> </dd></dl>

</div>
</div>
<a id="a57f04c177084945af9279729874f0243" name="a57f04c177084945af9279729874f0243"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57f04c177084945af9279729874f0243">&#9670;&nbsp;</a></span>md_leapfrog()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double md_leapfrog </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmd.html">Bmd</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>velocitylimit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Molecular dynamics using the leapfrog integrator. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecular structure. </td></tr>
    <tr><td class="paramname">*md</td><td>molecular dynamics parameters. </td></tr>
    <tr><td class="paramname">max_iter</td><td>maximum number of iterations to run. </td></tr>
    <tr><td class="paramname">velocitylimit</td><td>limit on velocity per time step. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double energy. <pre class="fragment">Leapfrog integration for any coordinate x, velocity vx and force Fx:
    x(t+1) = x(t) + vx(t+1) * dt
    vx(t+1) = (Fx(t) * dt/m + vx(t)) * kf
    where
        kf: friction constant (1=no friction)
        dt: time step
        m: atomic mass
The velocity is limited each time step to damp chaotic oscillations.
</pre> </dd></dl>

</div>
</div>
<a id="af839292d431e7dd6d9aa0d8d3be47151" name="af839292d431e7dd6d9aa0d8d3be47151"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af839292d431e7dd6d9aa0d8d3be47151">&#9670;&nbsp;</a></span>md_nonbonded_forces()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double md_nonbonded_forces </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmd.html">Bmd</a> *&#160;</td>
          <td class="paramname"><em>md</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the non-bonded forces and energy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecular structure. </td></tr>
    <tr><td class="paramname">*md</td><td>molecular dynamics structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double total non-bonded energy. <pre class="fragment">The energy is defined as a Lennard-Jones term for the Van der Waals 
interactions based on a reference length, ro, and a Coulomb term for 
electrostatic interactions based on the atomic charges, q1 and q2: 
    Enb = Kvdw*((1/12)*(|ro|/|r|)^12 - (1/6)*(|ro|/|r|)^6) + Kelec*q1*q2/|r|
The force is the derivative of the energy:
    Fnb = -Kvdw*((|ro|/|r|)^12 - (|ro|/|r|)^6)*r/|r| + Kelec*q1*q2*r/|r|^3
where r is the distance vector, Kvdw is the Van der Waals energy constant
and Kelec is the electrostatic energy constant.
</pre> </dd></dl>

</div>
</div>
<a id="a191fb86d97a74414d5b73d6c7c187966" name="a191fb86d97a74414d5b73d6c7c187966"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a191fb86d97a74414d5b73d6c7c187966">&#9670;&nbsp;</a></span>md_point_force()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double md_point_force </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>decay</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the atomic forces and energy resulting from a single point force. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecular structure. </td></tr>
    <tr><td class="paramname">point</td><td>center of point force. </td></tr>
    <tr><td class="paramname">Kpoint</td><td>point force constant. </td></tr>
    <tr><td class="paramname">decay</td><td>energy decay with distance. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double point force energy. <pre class="fragment">The energy is defined as an exponential decay over distance from the 
center of the point force:
    Ep = Kp * exp(-decay*dist)
The force is the derivative of the energy:
    Fp = Kp * decay * dir * exp(-decay*dist)
where Kp is the point force constant, dist is the distance of the atom 
from the center of the point force, decay is the energy decay with distance
from the point force center, and dir is the normalized direction vector
pointing from the point force center to the atom, indicating the direction
of force.
</pre> </dd></dl>

</div>
</div>
<a id="a711e368b3ed80addcd7f6b1510d44760" name="a711e368b3ed80addcd7f6b1510d44760"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a711e368b3ed80addcd7f6b1510d44760">&#9670;&nbsp;</a></span>md_zero_forces()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int md_zero_forces </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Zero all atomic forces. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecular structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0b2caeb4b6f130be43e5a2f0267dd453" name="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2caeb4b6f130be43e5a2f0267dd453">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_d222c3909b771dd1cf1b375528c5865e.html">mol</a></li><li class="navelem"><a class="el" href="mol__md_8cpp.html">mol_md.cpp</a></li>
    <li class="footer">Generated on Tue Jan 31 2023 08:21:29 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
