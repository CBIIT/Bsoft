<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/heymannb/b20/bsoft/src/mg/mg_pick.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Bsoft<span id="projectnumber">&#160;2.1.4</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mg__pick_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">mg_pick.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Functions for picking single particle images from a micrograph.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="mg__pick_8h.html">mg_pick.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__processing_8h.html">mg_processing.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__select_8h.html">mg_select.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="linked__list_8h.html">linked_list.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h.html">utilities.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6ebf251be095ca8aeb22269f87578832"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a6ebf251be095ca8aeb22269f87578832">img_prepare_for_picking</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, int flags, long sigma, long bin)</td></tr>
<tr class="separator:a6ebf251be095ca8aeb22269f87578832"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adafb94de68397ef63981a874f0cda185"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bparticle.html">Bparticle</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#adafb94de68397ef63981a874f0cda185">particles_from_peaks</a> (<a class="el" href="class_bimage.html">Bimage</a> *pcc, long bin, double excl_dist, double part_ori, double &amp;fommin, double fommax, long maxnum, double pix_min, double pix_max)</td></tr>
<tr class="memdesc:adafb94de68397ef63981a874f0cda185"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the peaks in a cross-correlation map corresponding to particles.  <a href="mg__pick_8cpp.html#adafb94de68397ef63981a874f0cda185">More...</a><br /></td></tr>
<tr class="separator:adafb94de68397ef63981a874f0cda185"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39590fc8946a89aa1d18fce600b4551a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bparticle.html">Bparticle</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a39590fc8946a89aa1d18fce600b4551a">particles_pick_cc</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *ptemp, <a class="el" href="class_bimage.html">Bimage</a> *pmask, double hires, double lores, double fommin, double fommax, double excl_dist, long bin)</td></tr>
<tr class="memdesc:a39590fc8946a89aa1d18fce600b4551a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Picks particles using cross-correlation.  <a href="mg__pick_8cpp.html#a39590fc8946a89aa1d18fce600b4551a">More...</a><br /></td></tr>
<tr class="separator:a39590fc8946a89aa1d18fce600b4551a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20be79f55d41a6d7d4c1c052d301ba1f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a20be79f55d41a6d7d4c1c052d301ba1f">gauss_find_intersection</a> (long ngauss, vector&lt; double &gt; &amp;gauss)</td></tr>
<tr class="separator:a20be79f55d41a6d7d4c1c052d301ba1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41f010e0265a26e0b1c9dbfec846c9ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bparticle.html">Bparticle</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a41f010e0265a26e0b1c9dbfec846c9ae">particles_pick_var</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long avg_kernel, long var_kernel, double nsig, double part_ori, double excl_dist, long bin)</td></tr>
<tr class="memdesc:a41f010e0265a26e0b1c9dbfec846c9ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Picks particles in variance map.  <a href="mg__pick_8cpp.html#a41f010e0265a26e0b1c9dbfec846c9ae">More...</a><br /></td></tr>
<tr class="separator:a41f010e0265a26e0b1c9dbfec846c9ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bbdfca1dc0f0dae41e88e6b9709a5ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bparticle.html">Bparticle</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a0bbdfca1dc0f0dae41e88e6b9709a5ae">particles_pick_var</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long avg_kernel, long var_kernel, double cutmin, double cutmax, double part_ori, double excl_dist, long bin)</td></tr>
<tr class="separator:a0bbdfca1dc0f0dae41e88e6b9709a5ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae35c6e3be8c7fbf99fa5653aace3761f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bparticle.html">Bparticle</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#ae35c6e3be8c7fbf99fa5653aace3761f">particles_pick_cc</a> (<a class="el" href="class_bstring.html">Bstring</a> &amp;filename, long img_num, <a class="el" href="class_bimage.html">Bimage</a> *ptemp, <a class="el" href="class_bimage.html">Bimage</a> *pmask, double hires, double lores, double fommin, double fommax, double excl_dist, long bin)</td></tr>
<tr class="memdesc:ae35c6e3be8c7fbf99fa5653aace3761f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Picks particles using cross-correlation.  <a href="mg__pick_8cpp.html#ae35c6e3be8c7fbf99fa5653aace3761f">More...</a><br /></td></tr>
<tr class="separator:ae35c6e3be8c7fbf99fa5653aace3761f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3e9d2aa7b3eb34a61c94def897f76eb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bparticle.html">Bparticle</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#aa3e9d2aa7b3eb34a61c94def897f76eb">particles_pick_var</a> (<a class="el" href="class_bstring.html">Bstring</a> &amp;filename, long img_num, long avg_kernel, long var_kernel, double nsig, double part_ori, double excl_dist, long bin)</td></tr>
<tr class="memdesc:aa3e9d2aa7b3eb34a61c94def897f76eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Picks particles in variance map.  <a href="mg__pick_8cpp.html#aa3e9d2aa7b3eb34a61c94def897f76eb">More...</a><br /></td></tr>
<tr class="separator:aa3e9d2aa7b3eb34a61c94def897f76eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ed8ad2c0073e2dc73df1085cce3e704"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a4ed8ad2c0073e2dc73df1085cce3e704">img_marker_set_difference_at_voxel</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long i, <a class="el" href="struct_bmarker.html">Bmarker</a> *markin, <a class="el" href="struct_bmarker.html">Bmarker</a> *markout)</td></tr>
<tr class="separator:a4ed8ad2c0073e2dc73df1085cce3e704"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89d12ae234297d528cc44a64d87a88fa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a89d12ae234297d528cc44a64d87a88fa">img_marker_set_difference</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="struct_bmarker.html">Bmarker</a> *markin, <a class="el" href="struct_bmarker.html">Bmarker</a> *markout, int contrast)</td></tr>
<tr class="memdesc:a89d12ae234297d528cc44a64d87a88fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the average difference between voxels tagged by two marker sets.  <a href="mg__pick_8cpp.html#a89d12ae234297d528cc44a64d87a88fa">More...</a><br /></td></tr>
<tr class="separator:a89d12ae234297d528cc44a64d87a88fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0860e54bc2cedb27331d323df001bf4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#ad0860e54bc2cedb27331d323df001bf4">mg_pick_particles</a> (<a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg, <a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="struct_bmarker.html">Bmarker</a> *markin, <a class="el" href="struct_bmarker.html">Bmarker</a> *markout, int avg_kernel, int contrast)</td></tr>
<tr class="memdesc:ad0860e54bc2cedb27331d323df001bf4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locates particles using a fore/background difference measure.  <a href="mg__pick_8cpp.html#ad0860e54bc2cedb27331d323df001bf4">More...</a><br /></td></tr>
<tr class="separator:ad0860e54bc2cedb27331d323df001bf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55548a3e01919c369449304470bb943a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a55548a3e01919c369449304470bb943a">project_pick_particles</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *ptemp, <a class="el" href="class_bimage.html">Bimage</a> *pmask, double hires, double lores, double fommin, double fommax, double excl_dist, long bin)</td></tr>
<tr class="memdesc:a55548a3e01919c369449304470bb943a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Picks particles using cross-correlation.  <a href="mg__pick_8cpp.html#a55548a3e01919c369449304470bb943a">More...</a><br /></td></tr>
<tr class="separator:a55548a3e01919c369449304470bb943a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39a9e60bf38238658363118fe02ff4e1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a39a9e60bf38238658363118fe02ff4e1">project_pick_particles</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, long avg_kernel, long var_kernel, double nsig, double part_ori, double excl_dist, long bin)</td></tr>
<tr class="memdesc:a39a9e60bf38238658363118fe02ff4e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Picks particles in variance map.  <a href="mg__pick_8cpp.html#a39a9e60bf38238658363118fe02ff4e1">More...</a><br /></td></tr>
<tr class="separator:a39a9e60bf38238658363118fe02ff4e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3577fe340636129fd51e37f2e57aaa8b"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a3577fe340636129fd51e37f2e57aaa8b">project_pick_particles</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, double din, double dout, int avg_kernel, double ainc, int flags, int contrast)</td></tr>
<tr class="memdesc:a3577fe340636129fd51e37f2e57aaa8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locates particles using a fore/background difference measure.  <a href="mg__pick_8cpp.html#a3577fe340636129fd51e37f2e57aaa8b">More...</a><br /></td></tr>
<tr class="separator:a3577fe340636129fd51e37f2e57aaa8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1b90ebc741c215015a8e05492d5ff0f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#ad1b90ebc741c215015a8e05492d5ff0f">part_mask_particles</a> (<a class="el" href="class_bparticle.html">Bparticle</a> *part, <a class="el" href="class_bimage.html">Bimage</a> *pmask, long box_size)</td></tr>
<tr class="separator:ad1b90ebc741c215015a8e05492d5ff0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5398812e2a860737e856e6647ea1cf3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#ad5398812e2a860737e856e6647ea1cf3">img_mask_above_threshold</a> (<a class="el" href="class_bimage.html">Bimage</a> *pvar, <a class="el" href="class_bimage.html">Bimage</a> *p, double threshold)</td></tr>
<tr class="separator:ad5398812e2a860737e856e6647ea1cf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9901599332dc0c19c617db248307dfc0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a9901599332dc0c19c617db248307dfc0">mg_pick_background</a> (<a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg, <a class="el" href="class_bimage.html">Bimage</a> *p, long number, long avg_kernel, long var_kernel, double excl_dist)</td></tr>
<tr class="separator:a9901599332dc0c19c617db248307dfc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25588a61db3299794495002b33963e51"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a25588a61db3299794495002b33963e51">rec_pick_background</a> (<a class="el" href="class_breconstruction.html">Breconstruction</a> *rec, <a class="el" href="class_bimage.html">Bimage</a> *p, long number, long avg_kernel, long var_kernel, double excl_dist)</td></tr>
<tr class="separator:a25588a61db3299794495002b33963e51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29f9a520066032bae08b70c9c9ed7450"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a29f9a520066032bae08b70c9c9ed7450">project_pick_background</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, long number, long avg_kernel, long var_kernel, double excl_dist)</td></tr>
<tr class="memdesc:a29f9a520066032bae08b70c9c9ed7450"><td class="mdescLeft">&#160;</td><td class="mdescRight">Picks background areas not overlapping existing particles.  <a href="mg__pick_8cpp.html#a29f9a520066032bae08b70c9c9ed7450">More...</a><br /></td></tr>
<tr class="separator:a29f9a520066032bae08b70c9c9ed7450"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5e7c547ca61045ea29b6d7dedc10545"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bparticle.html">Bparticle</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#ac5e7c547ca61045ea29b6d7dedc10545">part_pick_sym_axis</a> (<a class="el" href="class_bparticle.html">Bparticle</a> *part, <a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;sym, <a class="el" href="class_view.html">View</a> &amp;refview, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; refori, double axis_dist)</td></tr>
<tr class="separator:ac5e7c547ca61045ea29b6d7dedc10545"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26bb7fcc279d123048308edcc26e93f9"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a26bb7fcc279d123048308edcc26e93f9">project_pick_sym_axis</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;sym, int sym_axis, double axis_dist)</td></tr>
<tr class="memdesc:a26bb7fcc279d123048308edcc26e93f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Picks subregions in 3D particles on the given symmetry axis.  <a href="mg__pick_8cpp.html#a26bb7fcc279d123048308edcc26e93f9">More...</a><br /></td></tr>
<tr class="separator:a26bb7fcc279d123048308edcc26e93f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ec5d42b095d0b712c76804e0497a000"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a6ec5d42b095d0b712c76804e0497a000">img_prepare_projections</a> (<a class="el" href="class_bstring.html">Bstring</a> &amp;tempfile, <a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;sym, double hires, long bin)</td></tr>
<tr class="separator:a6ec5d42b095d0b712c76804e0497a000"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99c154e42c6bbebbb37444a403be042e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a99c154e42c6bbebbb37444a403be042e">img_prepare_orientations</a> (<a class="el" href="class_bstring.html">Bstring</a> &amp;tempfile, <a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;sym, double hires, long bin)</td></tr>
<tr class="separator:a99c154e42c6bbebbb37444a403be042e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c1234b97e051060f9e6fe9fba805a9e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a1c1234b97e051060f9e6fe9fba805a9e">part_align</a> (<a class="el" href="class_bparticle.html">Bparticle</a> *part, <a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *ptemp, double hires, double lores, double shift_limit, long bin, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</a>, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a9ec8849996c5e210d7b7e8e05b98639d">planb</a>)</td></tr>
<tr class="separator:a1c1234b97e051060f9e6fe9fba805a9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a320a594b42f5ddeebb418f2ed09a758a"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a320a594b42f5ddeebb418f2ed09a758a">mg_extract_orient_particles</a> (<a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg, <a class="el" href="class_bimage.html">Bimage</a> *ptemp, double hires, double lores, long bin, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</a>, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a9ec8849996c5e210d7b7e8e05b98639d">planb</a>)</td></tr>
<tr class="memdesc:a320a594b42f5ddeebb418f2ed09a758a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the centers of picked particles within a micrograph.  <a href="mg__pick_8cpp.html#a320a594b42f5ddeebb418f2ed09a758a">More...</a><br /></td></tr>
<tr class="separator:a320a594b42f5ddeebb418f2ed09a758a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a954f63aefec2a16273c03efb20d0310b"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a954f63aefec2a16273c03efb20d0310b">rec_extract_orient_particles</a> (<a class="el" href="class_breconstruction.html">Breconstruction</a> *rec, <a class="el" href="class_bimage.html">Bimage</a> *ptemp, double hires, double lores, long bin, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</a>, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a9ec8849996c5e210d7b7e8e05b98639d">planb</a>)</td></tr>
<tr class="separator:a954f63aefec2a16273c03efb20d0310b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dae4e50317671edde11c61bb12a6ede"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a8dae4e50317671edde11c61bb12a6ede">project_extract_orient_particles</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bstring.html">Bstring</a> &amp;tempfile, <a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;sym, double hires, double lores, long bin)</td></tr>
<tr class="memdesc:a8dae4e50317671edde11c61bb12a6ede"><td class="mdescLeft">&#160;</td><td class="mdescRight">Picks particles using cross-correlation.  <a href="mg__pick_8cpp.html#a8dae4e50317671edde11c61bb12a6ede">More...</a><br /></td></tr>
<tr class="separator:a8dae4e50317671edde11c61bb12a6ede"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__pick_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Functions for picking single particle images from a micrograph. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20000505 </dd>
<dd>
Modified: 20210510 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a20be79f55d41a6d7d4c1c052d301ba1f" name="a20be79f55d41a6d7d4c1c052d301ba1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20be79f55d41a6d7d4c1c052d301ba1f">&#9670;&nbsp;</a></span>gauss_find_intersection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gauss_find_intersection </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>ngauss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>gauss</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a89d12ae234297d528cc44a64d87a88fa" name="a89d12ae234297d528cc44a64d87a88fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89d12ae234297d528cc44a64d87a88fa">&#9670;&nbsp;</a></span>img_marker_set_difference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_marker_set_difference </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmarker.html">Bmarker</a> *&#160;</td>
          <td class="paramname"><em>markin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmarker.html">Bmarker</a> *&#160;</td>
          <td class="paramname"><em>markout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>contrast</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the average difference between voxels tagged by two marker sets. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image. </td></tr>
    <tr><td class="paramname">*markin</td><td>inner marker set (relates to particle). </td></tr>
    <tr><td class="paramname">*markout</td><td>outer marker set (relates to background). </td></tr>
    <tr><td class="paramname">contrast</td><td>contrast direction (foreground: white=1, black=0). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* map with resultant differences. <pre class="fragment">The values in the image corresponding to the coordinates of the
inner marker set is subtracted from those of the outer marker set.
</pre> </dd></dl>

</div>
</div>
<a id="a4ed8ad2c0073e2dc73df1085cce3e704" name="a4ed8ad2c0073e2dc73df1085cce3e704"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ed8ad2c0073e2dc73df1085cce3e704">&#9670;&nbsp;</a></span>img_marker_set_difference_at_voxel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_marker_set_difference_at_voxel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmarker.html">Bmarker</a> *&#160;</td>
          <td class="paramname"><em>markin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmarker.html">Bmarker</a> *&#160;</td>
          <td class="paramname"><em>markout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad5398812e2a860737e856e6647ea1cf3" name="ad5398812e2a860737e856e6647ea1cf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5398812e2a860737e856e6647ea1cf3">&#9670;&nbsp;</a></span>img_mask_above_threshold()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_mask_above_threshold </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pvar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6ebf251be095ca8aeb22269f87578832" name="a6ebf251be095ca8aeb22269f87578832"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ebf251be095ca8aeb22269f87578832">&#9670;&nbsp;</a></span>img_prepare_for_picking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_prepare_for_picking </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a99c154e42c6bbebbb37444a403be042e" name="a99c154e42c6bbebbb37444a403be042e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99c154e42c6bbebbb37444a403be042e">&#9670;&nbsp;</a></span>img_prepare_orientations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_prepare_orientations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>tempfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6ec5d42b095d0b712c76804e0497a000" name="a6ec5d42b095d0b712c76804e0497a000"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ec5d42b095d0b712c76804e0497a000">&#9670;&nbsp;</a></span>img_prepare_projections()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_prepare_projections </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>tempfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a320a594b42f5ddeebb418f2ed09a758a" name="a320a594b42f5ddeebb418f2ed09a758a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a320a594b42f5ddeebb418f2ed09a758a">&#9670;&nbsp;</a></span>mg_extract_orient_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long mg_extract_orient_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>ptemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the centers of picked particles within a micrograph. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*mg</td><td>micrograph parameter structure. </td></tr>
    <tr><td class="paramname">*ptemp</td><td>template image. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">bin</td><td>level of image binning. </td></tr>
    <tr><td class="paramname">planf</td><td>FFT forward plan. </td></tr>
    <tr><td class="paramname">planb</td><td>FFT backward plan. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of particles. <pre class="fragment">An image processing parameter structure loaded with micrograph
information is used to extract particle images from the micrograph
image using the particle coordinates in the parameter structure.
The extracted particle images are each rotated by PI and the shift
found by cross-correlation between the unrotated and rotated images.
The particle coordinates in the parameter structure are updated with
the shift.
</pre> </dd></dl>

</div>
</div>
<a id="a9901599332dc0c19c617db248307dfc0" name="a9901599332dc0c19c617db248307dfc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9901599332dc0c19c617db248307dfc0">&#9670;&nbsp;</a></span>mg_pick_background()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double mg_pick_background </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>avg_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>var_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>excl_dist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad0860e54bc2cedb27331d323df001bf4" name="ad0860e54bc2cedb27331d323df001bf4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0860e54bc2cedb27331d323df001bf4">&#9670;&nbsp;</a></span>mg_pick_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double mg_pick_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmarker.html">Bmarker</a> *&#160;</td>
          <td class="paramname"><em>markin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmarker.html">Bmarker</a> *&#160;</td>
          <td class="paramname"><em>markout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>avg_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>contrast</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Locates particles using a fore/background difference measure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*mg</td><td>micrograph parameter structure. </td></tr>
    <tr><td class="paramname">*p</td><td>micrograph image, if NULL, read from mg. </td></tr>
    <tr><td class="paramname">*markin</td><td>foreground marker set. </td></tr>
    <tr><td class="paramname">*markout</td><td>background marker set. </td></tr>
    <tr><td class="paramname">avg_kernel</td><td>averaging kernle to smooth difference map. </td></tr>
    <tr><td class="paramname">contrast</td><td>contrast direction (foreground: white=1, black=0). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double threshold used to accept peaks. <pre class="fragment">The two marker sets are used to calculate a difference
between the foreground and background as an estimate of the
presence of a particle.
The resultant image is smoothed by an averaging kernel and rescaled to [0,1].
This image is then scanned to identify particles.
</pre> </dd></dl>

</div>
</div>
<a id="a1c1234b97e051060f9e6fe9fba805a9e" name="a1c1234b97e051060f9e6fe9fba805a9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c1234b97e051060f9e6fe9fba805a9e">&#9670;&nbsp;</a></span>part_align()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double part_align </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bparticle.html">Bparticle</a> *&#160;</td>
          <td class="paramname"><em>part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>ptemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad1b90ebc741c215015a8e05492d5ff0f" name="ad1b90ebc741c215015a8e05492d5ff0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1b90ebc741c215015a8e05492d5ff0f">&#9670;&nbsp;</a></span>part_mask_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int part_mask_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bparticle.html">Bparticle</a> *&#160;</td>
          <td class="paramname"><em>part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>box_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac5e7c547ca61045ea29b6d7dedc10545" name="ac5e7c547ca61045ea29b6d7dedc10545"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5e7c547ca61045ea29b6d7dedc10545">&#9670;&nbsp;</a></span>part_pick_sym_axis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bparticle.html">Bparticle</a> * part_pick_sym_axis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bparticle.html">Bparticle</a> *&#160;</td>
          <td class="paramname"><em>part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_view.html">View</a> &amp;&#160;</td>
          <td class="paramname"><em>refview</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>refori</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>axis_dist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adafb94de68397ef63981a874f0cda185" name="adafb94de68397ef63981a874f0cda185"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adafb94de68397ef63981a874f0cda185">&#9670;&nbsp;</a></span>particles_from_peaks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bparticle.html">Bparticle</a> * particles_from_peaks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pcc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>excl_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>part_ori</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>fommin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fommax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>maxnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pix_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pix_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the peaks in a cross-correlation map corresponding to particles. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pcc</td><td>peak map (after binning). </td></tr>
    <tr><td class="paramname">bin</td><td>binning to speed up calculations. </td></tr>
    <tr><td class="paramname">excl_dist</td><td>distance between peaks. </td></tr>
    <tr><td class="paramname">part_ori</td><td>particle origin. </td></tr>
    <tr><td class="paramname">fommin</td><td>minimum threshold to accept peaks. </td></tr>
    <tr><td class="paramname">fommax</td><td>maximum threshold to accept peaks. </td></tr>
    <tr><td class="paramname">maxnum</td><td>maximum number of peaks to pick. </td></tr>
    <tr><td class="paramname">pix_min</td><td>minimum peak width. </td></tr>
    <tr><td class="paramname">pix_max</td><td>maximum peak width. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bparticle* list of particles. <pre class="fragment">The map is searched in increments of the particle radius to identify
peaks above the threshold and within a box the size of the
particle radius. The identified peaks are further examined to eliminate 
ones that are too close to a higher scoring peak. The acceptable distance
between peaks is set to 1.8 times the particle radius.
</pre> </dd></dl>

</div>
</div>
<a id="a39590fc8946a89aa1d18fce600b4551a" name="a39590fc8946a89aa1d18fce600b4551a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39590fc8946a89aa1d18fce600b4551a">&#9670;&nbsp;</a></span>particles_pick_cc() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bparticle.html">Bparticle</a> * particles_pick_cc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>ptemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fommin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fommax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>excl_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Picks particles using cross-correlation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image to pick from. </td></tr>
    <tr><td class="paramname">*ptemp</td><td>template image. </td></tr>
    <tr><td class="paramname">*pmask</td><td>frequency space mask. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">fommin</td><td>minimum FOM cutoff. </td></tr>
    <tr><td class="paramname">fommax</td><td>maximum FOM cutoff. </td></tr>
    <tr><td class="paramname">excl_dist</td><td>minimum distance between particles. </td></tr>
    <tr><td class="paramname">bin</td><td>level of image binning. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bparticle* list of particles. <pre class="fragment">A template is cross-correlated with the input image including
bandpass filtering to target the size of the particle.
</pre> </dd></dl>

</div>
</div>
<a id="ae35c6e3be8c7fbf99fa5653aace3761f" name="ae35c6e3be8c7fbf99fa5653aace3761f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae35c6e3be8c7fbf99fa5653aace3761f">&#9670;&nbsp;</a></span>particles_pick_cc() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bparticle.html">Bparticle</a> * particles_pick_cc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>img_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>ptemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fommin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fommax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>excl_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Picks particles using cross-correlation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">&amp;filename</td><td>image to pick from. </td></tr>
    <tr><td class="paramname">img_num</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">*ptemp</td><td>template image. </td></tr>
    <tr><td class="paramname">*pmask</td><td>frequency space mask. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">fommin</td><td>minimum FOM cutoff. </td></tr>
    <tr><td class="paramname">fommax</td><td>maximum FOM cutoff. </td></tr>
    <tr><td class="paramname">excl_dist</td><td>minimum distance between particles. </td></tr>
    <tr><td class="paramname">bin</td><td>level of image binning. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bparticle* list of particles. <pre class="fragment">A template is cross-correlated with the input image including
bandpass filtering to target the size of the particle.
The template must have the correct pixel size.
</pre> </dd></dl>

</div>
</div>
<a id="a0bbdfca1dc0f0dae41e88e6b9709a5ae" name="a0bbdfca1dc0f0dae41e88e6b9709a5ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bbdfca1dc0f0dae41e88e6b9709a5ae">&#9670;&nbsp;</a></span>particles_pick_var() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bparticle.html">Bparticle</a> * particles_pick_var </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>avg_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>var_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>part_ori</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>excl_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a41f010e0265a26e0b1c9dbfec846c9ae" name="a41f010e0265a26e0b1c9dbfec846c9ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41f010e0265a26e0b1c9dbfec846c9ae">&#9670;&nbsp;</a></span>particles_pick_var() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bparticle.html">Bparticle</a> * particles_pick_var </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>avg_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>var_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>nsig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>part_ori</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>excl_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Picks particles in variance map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image to pick from. </td></tr>
    <tr><td class="paramname">avg_kernel</td><td>averaging kernel size. </td></tr>
    <tr><td class="paramname">var_kernel</td><td>variance kernel size. </td></tr>
    <tr><td class="paramname">nsig</td><td>multiple of sigma above variance average to accept peaks. </td></tr>
    <tr><td class="paramname">part_ori</td><td>particle origin. </td></tr>
    <tr><td class="paramname">excl_dist</td><td>minimum distance between particles. </td></tr>
    <tr><td class="paramname">bin</td><td>level of image binning. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bparticle* list of particles. <pre class="fragment">A copy of the micrograph is filtered with an averaging kernel
and a variance map calculated. The variance map is then used to
find high variance peaks as candidate locations for particles.
</pre> </dd></dl>

</div>
</div>
<a id="aa3e9d2aa7b3eb34a61c94def897f76eb" name="aa3e9d2aa7b3eb34a61c94def897f76eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3e9d2aa7b3eb34a61c94def897f76eb">&#9670;&nbsp;</a></span>particles_pick_var() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bparticle.html">Bparticle</a> * particles_pick_var </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>img_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>avg_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>var_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>nsig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>part_ori</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>excl_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Picks particles in variance map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">&amp;filename</td><td>image to pick from. </td></tr>
    <tr><td class="paramname">img_num</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">avg_kernel</td><td>averaging kernel size. </td></tr>
    <tr><td class="paramname">var_kernel</td><td>variance kernel size. </td></tr>
    <tr><td class="paramname">nsig</td><td>multiple of sigma above variance average to accept peaks. </td></tr>
    <tr><td class="paramname">part_ori</td><td>particle origin. </td></tr>
    <tr><td class="paramname">excl_dist</td><td>minimum distance between particles. </td></tr>
    <tr><td class="paramname">bin</td><td>level of image binning. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bparticle* list of particles. <pre class="fragment">A copy of the micrograph is filtered with an averaging kernel
and a variance map calculated. The variance map is then used to
find high variance peaks as candidate locations for particles.
</pre> </dd></dl>

</div>
</div>
<a id="a8dae4e50317671edde11c61bb12a6ede" name="a8dae4e50317671edde11c61bb12a6ede"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dae4e50317671edde11c61bb12a6ede">&#9670;&nbsp;</a></span>project_extract_orient_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double project_extract_orient_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>tempfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Picks particles using cross-correlation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">&amp;tempfile</td><td>template image. </td></tr>
    <tr><td class="paramname">sym</td><td>point group symmetry. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">bin</td><td>level of image binning. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double minimum threshold used to accept peaks. <pre class="fragment">Each micrograph is cross-correlated with the template image including
bandpass filtering and frequency space masking.
</pre> </dd></dl>

</div>
</div>
<a id="a29f9a520066032bae08b70c9c9ed7450" name="a29f9a520066032bae08b70c9c9ed7450"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29f9a520066032bae08b70c9c9ed7450">&#9670;&nbsp;</a></span>project_pick_background()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long project_pick_background </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>avg_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>var_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>excl_dist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Picks background areas not overlapping existing particles. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">number</td><td>maximum number of background images to pick. </td></tr>
    <tr><td class="paramname">avg_kernel</td><td>averaging kernel to smooth the image. </td></tr>
    <tr><td class="paramname">var_kernel</td><td>kernel to calculate a local variance image. </td></tr>
    <tr><td class="paramname">excl_dist</td><td>exclusion distance between areas. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of background areas. </dd></dl>

</div>
</div>
<a id="a55548a3e01919c369449304470bb943a" name="a55548a3e01919c369449304470bb943a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55548a3e01919c369449304470bb943a">&#9670;&nbsp;</a></span>project_pick_particles() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double project_pick_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>ptemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fommin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fommax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>excl_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Picks particles using cross-correlation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">*ptemp</td><td>template image. </td></tr>
    <tr><td class="paramname">*pmask</td><td>frequency space mask. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">fommin</td><td>minimum FOM cutoff. </td></tr>
    <tr><td class="paramname">fommax</td><td>maximum FOM cutoff. </td></tr>
    <tr><td class="paramname">excl_dist</td><td>minimum distance between particles. </td></tr>
    <tr><td class="paramname">bin</td><td>level of image binning. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double minimum threshold used to accept peaks. <pre class="fragment">Each micrograph is cross-correlated with the template image including
bandpass filtering and frequency space masking.
</pre> </dd></dl>

</div>
</div>
<a id="a3577fe340636129fd51e37f2e57aaa8b" name="a3577fe340636129fd51e37f2e57aaa8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3577fe340636129fd51e37f2e57aaa8b">&#9670;&nbsp;</a></span>project_pick_particles() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long project_pick_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>din</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>avg_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ainc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>contrast</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Locates particles using a fore/background difference measure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">din</td><td>inner diameter corresponding to particle edge. </td></tr>
    <tr><td class="paramname">dout</td><td>outer diameter corresponding to background. </td></tr>
    <tr><td class="paramname">avg_kernel</td><td>averaging kernle to smooth difference map. </td></tr>
    <tr><td class="paramname">ainc</td><td>angular increment. </td></tr>
    <tr><td class="paramname">flags</td><td>flags: bit 1 = filter extremes. </td></tr>
    <tr><td class="paramname">contrast</td><td>contrast direction (foreground: white=1, black=0). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of particles. <pre class="fragment">Two marker sets are generated at the indicated diameters.
At each pixel, the marker sets are used to calculate a difference
between the foreground and background as an estimate of the
presence of a particle.
</pre> </dd></dl>

</div>
</div>
<a id="a39a9e60bf38238658363118fe02ff4e1" name="a39a9e60bf38238658363118fe02ff4e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39a9e60bf38238658363118fe02ff4e1">&#9670;&nbsp;</a></span>project_pick_particles() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double project_pick_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>avg_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>var_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>nsig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>part_ori</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>excl_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Picks particles in variance map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">avg_kernel</td><td>averaging kernel size. </td></tr>
    <tr><td class="paramname">var_kernel</td><td>variance kernel size. </td></tr>
    <tr><td class="paramname">nsig</td><td>multiple of sigma above variance average to accept peaks. </td></tr>
    <tr><td class="paramname">part_ori</td><td>particle origin. </td></tr>
    <tr><td class="paramname">excl_dist</td><td>minimum distance between particles. </td></tr>
    <tr><td class="paramname">bin</td><td>level of image binning. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double minimum threshold used to accept peaks. <pre class="fragment">A copy of the micrograph is filtered with an averaging kernel
and a variance map calculated. The variance map is then used to
find high variance peaks as candidate locations for particles.
</pre> </dd></dl>

</div>
</div>
<a id="a26bb7fcc279d123048308edcc26e93f9" name="a26bb7fcc279d123048308edcc26e93f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26bb7fcc279d123048308edcc26e93f9">&#9670;&nbsp;</a></span>project_pick_sym_axis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long project_pick_sym_axis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sym_axis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>axis_dist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Picks subregions in 3D particles on the given symmetry axis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>parameter structure with all parameters. </td></tr>
    <tr><td class="paramname">sym</td><td>point group symmetry. </td></tr>
    <tr><td class="paramname">sym_axis</td><td>symmetry axis to pick subregions. </td></tr>
    <tr><td class="paramname">axis_dist</td><td>distance along symmetry axis. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of new particles. <pre class="fragment">The existing particles are replaced by the new particles.
</pre> </dd></dl>

</div>
</div>
<a id="a954f63aefec2a16273c03efb20d0310b" name="a954f63aefec2a16273c03efb20d0310b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a954f63aefec2a16273c03efb20d0310b">&#9670;&nbsp;</a></span>rec_extract_orient_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long rec_extract_orient_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_breconstruction.html">Breconstruction</a> *&#160;</td>
          <td class="paramname"><em>rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>ptemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a25588a61db3299794495002b33963e51" name="a25588a61db3299794495002b33963e51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25588a61db3299794495002b33963e51">&#9670;&nbsp;</a></span>rec_pick_background()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double rec_pick_background </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_breconstruction.html">Breconstruction</a> *&#160;</td>
          <td class="paramname"><em>rec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>avg_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>var_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>excl_dist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0b2caeb4b6f130be43e5a2f0267dd453" name="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2caeb4b6f130be43e5a2f0267dd453">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_1d197ef0d9947f4cc1ac44e7f59e2b57.html">mg</a></li><li class="navelem"><a class="el" href="mg__pick_8cpp.html">mg_pick.cpp</a></li>
    <li class="footer">Generated on Fri Jan 7 2022 02:32:17 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
