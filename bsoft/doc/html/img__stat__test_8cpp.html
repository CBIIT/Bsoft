<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Bsoft: /usr/local/bsoft/src/img/img_stat_test.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Bsoft
   &#160;<span id="projectnumber">1.9</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('img__stat__test_8cpp.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">img_stat_test.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions for statistical tests.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="_bimage_8h_source.html">Bimage.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="math__util_8h_source.html">math_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h_source.html">utilities.h</a>&quot;</code><br />
</div>
<p><a href="img__stat__test_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ada258d56da4eb2126541168279670779"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__stat__test_8cpp.html#ada258d56da4eb2126541168279670779">img_students_t_test</a> (int n, <a class="el" href="class_bimage.html">Bimage</a> *p, float *weight)</td></tr>
<tr class="memdesc:ada258d56da4eb2126541168279670779"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the Student's t-test to one set of images.  <a href="#ada258d56da4eb2126541168279670779">More...</a><br /></td></tr>
<tr class="separator:ada258d56da4eb2126541168279670779"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86697a05fec28b99fc67f20b553748e8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__stat__test_8cpp.html#a86697a05fec28b99fc67f20b553748e8">img_students_t_test_equal</a> (int set1, int set2, <a class="el" href="class_bimage.html">Bimage</a> *p1, <a class="el" href="class_bimage.html">Bimage</a> *p2, float *weight)</td></tr>
<tr class="memdesc:a86697a05fec28b99fc67f20b553748e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the Student's t-test to two sets of images, assumes the two distributions have approximately the same variance.  <a href="#a86697a05fec28b99fc67f20b553748e8">More...</a><br /></td></tr>
<tr class="separator:a86697a05fec28b99fc67f20b553748e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bc45de353195d50513075dff6926159"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__stat__test_8cpp.html#a1bc45de353195d50513075dff6926159">img_students_t_test_unequal</a> (int set1, int set2, <a class="el" href="class_bimage.html">Bimage</a> *p1, <a class="el" href="class_bimage.html">Bimage</a> *p2, float *weight)</td></tr>
<tr class="memdesc:a1bc45de353195d50513075dff6926159"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the Student's t-test to two sets of images, assumes the two distributions have unequal variance.  <a href="#a1bc45de353195d50513075dff6926159">More...</a><br /></td></tr>
<tr class="separator:a1bc45de353195d50513075dff6926159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebe987a13e43d676fe25021314190d58"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__stat__test_8cpp.html#aebe987a13e43d676fe25021314190d58">img_f_test</a> (int set1, int set2, <a class="el" href="class_bimage.html">Bimage</a> *p1, <a class="el" href="class_bimage.html">Bimage</a> *p2, float *weight)</td></tr>
<tr class="memdesc:aebe987a13e43d676fe25021314190d58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the F-test to two sets of images.  <a href="#aebe987a13e43d676fe25021314190d58">More...</a><br /></td></tr>
<tr class="separator:aebe987a13e43d676fe25021314190d58"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__stat__test_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions for statistical tests. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann and David Belnap </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20010505 </dd>
<dd>
Modified: 20111029 (BH) </dd></dl>

<p>Definition in file <a class="el" href="img__stat__test_8cpp_source.html">img_stat_test.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aebe987a13e43d676fe25021314190d58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_f_test </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>set1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>set2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>weight</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies the F-test to two sets of images. </p>
<dl class="section author"><dt>Author</dt><dd>David Belnap </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">set1</td><td>number of files in set 1. </td></tr>
    <tr><td class="paramname">set2</td><td>number of files in set 2. </td></tr>
    <tr><td class="paramname">*p1</td><td>average image with variance (FOM), set 1 </td></tr>
    <tr><td class="paramname">*p2</td><td>average image with variance (FOM), set 2 </td></tr>
    <tr><td class="paramname">*weight</td><td>list of weights. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* F-test image and significance image (as FOM). <pre class="fragment">The F value is computed for each pixel:
        F(i) = var1(i) / var2(i)

Variance (as FOM of an average image) is input.  The significance 
level is computed and stored as FOM of F-test image.  Output is
in floating point.
</pre> Reference: Press W.H. et al (1992) Numerical Recipes in C. </dd></dl>

<p>Definition at line <a class="el" href="img__stat__test_8cpp_source.html#l00264">264</a> of file <a class="el" href="img__stat__test_8cpp_source.html">img_stat_test.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ada258d56da4eb2126541168279670779"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_students_t_test </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>weight</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies the Student's t-test to one set of images. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>number of files in the set. </td></tr>
    <tr><td class="paramname">*p</td><td>average and variance of the set. </td></tr>
    <tr><td class="paramname">*weight</td><td>list of weights. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* significant level image (floating point). <pre class="fragment">First, average (avg) and variance (var) images are calculated:
        var = [1/(N-1)] sum(x - avgx)^2
Second, the t value is computed and returned as an image:
        t = avg / sqrt[ var/N ]
Finally, the significance is calculated and returned as the FOM of the image:
        sig = betai(dof/2, 0.5, dof/(dof + t*t))
where dof (degrees-of-freedom) is calculated as:
        dof = ws*(1 - 1.0L/N)
and ws is the weight sum.
All images are converted to floating point.
</pre> Reference: Press W.H. et al (1992) Numerical Recipes in C. Milligan and Flicker (1987) J. Cell Biol. 105:29-39. </dd></dl>

<p>Definition at line <a class="el" href="img__stat__test_8cpp_source.html#l00037">37</a> of file <a class="el" href="img__stat__test_8cpp_source.html">img_stat_test.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a86697a05fec28b99fc67f20b553748e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_students_t_test_equal </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>set1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>set2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>weight</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies the Student's t-test to two sets of images, assumes the two distributions have approximately the same variance. </p>
<dl class="section author"><dt>Author</dt><dd>David Belnap and Bernard Heymann </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">set1</td><td>number of files in set 1. </td></tr>
    <tr><td class="paramname">set2</td><td>number of files in set 2. </td></tr>
    <tr><td class="paramname">*p1</td><td>average image with variance (FOM), set 1 </td></tr>
    <tr><td class="paramname">*p2</td><td>average image with variance (FOM), set 2 </td></tr>
    <tr><td class="paramname">*weight</td><td>list of weights. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* t-test image and significance image (as FOM). <pre class="fragment">Input average images for sets 1 and 2, with variance as FOM portion
of the images.  The numerator portion of the variance (Vn) is 
computed from the variance.  The "standard error of the difference 
of the means" is computed:
SD = sqrt[ ( (Vn1 + Vn2) / degrees_of_freedom ) * (1/set1 + 1/set2) ]

and used to compute the t value:
            t = ( avg1 - avg2 ) / SD

Finally, the significance level (probability) is computed.
</pre></dd></dl>
<p>Reference: Press W.H. et al (1992) Numerical Recipes in C. Milligan and Flicker (1987) J. Cell Biol. 105:29-39. </p>

<p>Definition at line <a class="el" href="img__stat__test_8cpp_source.html#l00106">106</a> of file <a class="el" href="img__stat__test_8cpp_source.html">img_stat_test.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a1bc45de353195d50513075dff6926159"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_students_t_test_unequal </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>set1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>set2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>weight</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies the Student's t-test to two sets of images, assumes the two distributions have unequal variance. </p>
<dl class="section author"><dt>Author</dt><dd>David Belnap </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">set1</td><td>number of files in set 1. </td></tr>
    <tr><td class="paramname">set2</td><td>number of files in set 2. </td></tr>
    <tr><td class="paramname">*p1</td><td>average image with variance (FOM), set 1 </td></tr>
    <tr><td class="paramname">*p2</td><td>average image with variance (FOM), set 2 </td></tr>
    <tr><td class="paramname">*weight</td><td>list of weights. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* t-test image and significance image (as FOM). <pre class="fragment">Input average images for sets 1 and 2, with variance as FOM portion
of the images.  The t value is computed:
        t = ( avg1 - avg2 ) / sqrt[ var1/ws1 + var2/ws2 ]

(ws = weighted sum, default = N).  The significance level 
(probability) is computed.  Output is in floating point.
</pre></dd></dl>
<p>Reference: Press W.H. et al (1992) Numerical Recipes in C. Milligan and Flicker (1987) J. Cell Biol. 105:29-39. </p>

<p>Definition at line <a class="el" href="img__stat__test_8cpp_source.html#l00189">189</a> of file <a class="el" href="img__stat__test_8cpp_source.html">img_stat_test.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_7673ec780970b264223275c6ce2fb0e1.html">img</a></li><li class="navelem"><a class="el" href="img__stat__test_8cpp.html">img_stat_test.cpp</a></li>
    <li class="footer">Generated on Wed Jun 1 2016 17:39:25 for Bsoft by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
