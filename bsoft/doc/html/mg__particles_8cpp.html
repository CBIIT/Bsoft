<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/heymannb/b20/bsoft/src/mg/mg_particles.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Bsoft<span id="projectnumber">&#160;2.1.4</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mg__particles_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">mg_particles.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Analyzes and manipulates single particle images.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="mg__processing_8h.html">mg_processing.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__particles_8h.html">mg_particles.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__particle__select_8h.html">mg_particle_select.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__select_8h.html">mg_select.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__img__proc_8h.html">mg_img_proc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__ctf_8h.html">mg_ctf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rwimg_8h.html">rwimg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="matrix__linear_8h.html">matrix_linear.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="file__util_8h.html">file_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h.html">utilities.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timer_8h.html">timer.h</a>&quot;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a21b160ebd1952bd2a46dfed95e5f8c91"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a21b160ebd1952bd2a46dfed95e5f8c91">project_align_particles</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int <a class="el" href="tcltk__bmg_8cpp.html#a90ddad2f6a8d24d79c31ed061cd69f91">part_select</a>, double nuavg, double nustd)</td></tr>
<tr class="memdesc:a21b160ebd1952bd2a46dfed95e5f8c91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aligns single particle images based on orientation parameters.  <a href="mg__particles_8cpp.html#a21b160ebd1952bd2a46dfed95e5f8c91">More...</a><br /></td></tr>
<tr class="separator:a21b160ebd1952bd2a46dfed95e5f8c91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a572792d8d3510bcab5f2bd2bd36a99bf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a572792d8d3510bcab5f2bd2bd36a99bf">project_center_particles</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int <a class="el" href="tcltk__bmg_8cpp.html#a90ddad2f6a8d24d79c31ed061cd69f91">part_select</a>, double nuavg, double nustd)</td></tr>
<tr class="memdesc:a572792d8d3510bcab5f2bd2bd36a99bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Centers single particle images based on the parametric center. <br  />
  <a href="mg__particles_8cpp.html#a572792d8d3510bcab5f2bd2bd36a99bf">More...</a><br /></td></tr>
<tr class="separator:a572792d8d3510bcab5f2bd2bd36a99bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf39e793a5acc4d24cc9e28b74489273"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#adf39e793a5acc4d24cc9e28b74489273">project_set_particle_centers</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *pref, int <a class="el" href="tcltk__bmg_8cpp.html#a90ddad2f6a8d24d79c31ed061cd69f91">part_select</a>, double hires, double lores)</td></tr>
<tr class="memdesc:adf39e793a5acc4d24cc9e28b74489273"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates centers of single particle images by cross-correlation with a reference. <br  />
  <a href="mg__particles_8cpp.html#adf39e793a5acc4d24cc9e28b74489273">More...</a><br /></td></tr>
<tr class="separator:adf39e793a5acc4d24cc9e28b74489273"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a4fb292d5310e7a79bb2c1c07f82b64"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a6a4fb292d5310e7a79bb2c1c07f82b64">project_find_part_centers_in_mgs</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, double hires, double lores, int filter_flag)</td></tr>
<tr class="memdesc:a6a4fb292d5310e7a79bb2c1c07f82b64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the centers of picked particles within a micrograph.  <a href="mg__particles_8cpp.html#a6a4fb292d5310e7a79bb2c1c07f82b64">More...</a><br /></td></tr>
<tr class="separator:a6a4fb292d5310e7a79bb2c1c07f82b64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20b479d1317983b450baec2e144adda0"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a20b479d1317983b450baec2e144adda0">mg_find_part_centers</a> (<a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg, double hires, double lores, int filter_flag)</td></tr>
<tr class="memdesc:a20b479d1317983b450baec2e144adda0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the centers of picked particles within a micrograph.  <a href="mg__particles_8cpp.html#a20b479d1317983b450baec2e144adda0">More...</a><br /></td></tr>
<tr class="separator:a20b479d1317983b450baec2e144adda0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38fff5de743dc58c53bb5a7ad67b822a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a38fff5de743dc58c53bb5a7ad67b822a">project_find_particle_centers</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int max_iter, int <a class="el" href="tcltk__bmg_8cpp.html#a90ddad2f6a8d24d79c31ed061cd69f91">part_select</a>, double hires, double lores)</td></tr>
<tr class="memdesc:a38fff5de743dc58c53bb5a7ad67b822a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates centers of single particle images. <br  />
  <a href="mg__particles_8cpp.html#a38fff5de743dc58c53bb5a7ad67b822a">More...</a><br /></td></tr>
<tr class="separator:a38fff5de743dc58c53bb5a7ad67b822a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a0ac471269c6e536c61d12589c7148e"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a2a0ac471269c6e536c61d12589c7148e">particles_mask</a> (<a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg, <a class="el" href="class_bimage.html">Bimage</a> *pmask, <a class="el" href="class_bstring.html">Bstring</a> &amp;partpath)</td></tr>
<tr class="separator:a2a0ac471269c6e536c61d12589c7148e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1d281fc53acc8dd1c0851d3ff48d0ac"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#ab1d281fc53acc8dd1c0851d3ff48d0ac">project_mask_particles</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *pmask, <a class="el" href="class_bstring.html">Bstring</a> &amp;partpath)</td></tr>
<tr class="memdesc:ab1d281fc53acc8dd1c0851d3ff48d0ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates centers of single particle images. <br  />
  <a href="mg__particles_8cpp.html#ab1d281fc53acc8dd1c0851d3ff48d0ac">More...</a><br /></td></tr>
<tr class="separator:ab1d281fc53acc8dd1c0851d3ff48d0ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f91e58c5f4aee2b1192291c63332fc1"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a7f91e58c5f4aee2b1192291c63332fc1">project_compare_particles</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bproject.html">Bproject</a> *projcomp)</td></tr>
<tr class="memdesc:a7f91e58c5f4aee2b1192291c63332fc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compares the coordinates of particles between two files. <br  />
  <a href="mg__particles_8cpp.html#a7f91e58c5f4aee2b1192291c63332fc1">More...</a><br /></td></tr>
<tr class="separator:a7f91e58c5f4aee2b1192291c63332fc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab98bc39b1c1bbe3b81859cb195334493"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#ab98bc39b1c1bbe3b81859cb195334493">project_tilt_from_particle_defocus</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>)</td></tr>
<tr class="memdesc:ab98bc39b1c1bbe3b81859cb195334493"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the tilt axis from refined particle defocus values. <br  />
  <a href="mg__particles_8cpp.html#ab98bc39b1c1bbe3b81859cb195334493">More...</a><br /></td></tr>
<tr class="separator:ab98bc39b1c1bbe3b81859cb195334493"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abec758ec2e9044e54a28b398bb206811"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#abec758ec2e9044e54a28b398bb206811">project_set_particle_defocus_from_tilt</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, double axis, double tilt)</td></tr>
<tr class="memdesc:abec758ec2e9044e54a28b398bb206811"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the tilt axis from refined particle defocus values. <br  />
  <a href="mg__particles_8cpp.html#abec758ec2e9044e54a28b398bb206811">More...</a><br /></td></tr>
<tr class="separator:abec758ec2e9044e54a28b398bb206811"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19f79089513679bc24b4e7e2583f2b41"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a19f79089513679bc24b4e7e2583f2b41">particle_correlation_sum</a> (<a class="el" href="class_bparticle.html">Bparticle</a> *part, <a class="el" href="class_bimage.html">Bimage</a> *pref, double hires, <a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *<a class="el" href="structkernel.html">kernel</a>, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</a>)</td></tr>
<tr class="separator:a19f79089513679bc24b4e7e2583f2b41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb7b2241d24b46407d31b12f798186c8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#adb7b2241d24b46407d31b12f798186c8">project_correlation_sum</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *pref, double hires, <a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *<a class="el" href="structkernel.html">kernel</a>)</td></tr>
<tr class="memdesc:adb7b2241d24b46407d31b12f798186c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Correlates each particle with the CTF applied reference projection and sum the correlations.  <a href="mg__particles_8cpp.html#adb7b2241d24b46407d31b12f798186c8">More...</a><br /></td></tr>
<tr class="separator:adb7b2241d24b46407d31b12f798186c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a311c4c21d2ed82d17e2db2286dabcca5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a311c4c21d2ed82d17e2db2286dabcca5">img_add_aberration_terms</a> (<a class="el" href="class_bimage.html">Bimage</a> *psum, <a class="el" href="class_bimage.html">Bimage</a> *psec, <a class="el" href="class_bimage.html">Bimage</a> *ppart, <a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;cp)</td></tr>
<tr class="separator:a311c4c21d2ed82d17e2db2286dabcca5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a723ace5df859b2f19c6b9278a50a4896"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a723ace5df859b2f19c6b9278a50a4896">particle_aberration_sum</a> (<a class="el" href="class_bparticle.html">Bparticle</a> *part, <a class="el" href="class_bimage.html">Bimage</a> *pref, double hires, <a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *<a class="el" href="structkernel.html">kernel</a>, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</a>)</td></tr>
<tr class="separator:a723ace5df859b2f19c6b9278a50a4896"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae08d4c489a34469c1882e3813eb3037e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#ae08d4c489a34469c1882e3813eb3037e">img_check_contrast</a> (<a class="el" href="class_bimage.html">Bimage</a> *psum)</td></tr>
<tr class="separator:ae08d4c489a34469c1882e3813eb3037e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61e3a11088f2cd74ace13c125f968211"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a61e3a11088f2cd74ace13c125f968211">img_calculate_phase_differences</a> (<a class="el" href="class_bimage.html">Bimage</a> *psum)</td></tr>
<tr class="separator:a61e3a11088f2cd74ace13c125f968211"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31c14ba0d78431e826cbd9a06e547ce5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a31c14ba0d78431e826cbd9a06e547ce5">project_aberration_phase_difference</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *pref, double hires, <a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *<a class="el" href="structkernel.html">kernel</a>)</td></tr>
<tr class="memdesc:a31c14ba0d78431e826cbd9a06e547ce5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the aberration phase difference from a set of particles.  <a href="mg__particles_8cpp.html#a31c14ba0d78431e826cbd9a06e547ce5">More...</a><br /></td></tr>
<tr class="separator:a31c14ba0d78431e826cbd9a06e547ce5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Analyzes and manipulates single particle images. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20080424 </dd>
<dd>
Modified: 20221130 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a311c4c21d2ed82d17e2db2286dabcca5" name="a311c4c21d2ed82d17e2db2286dabcca5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a311c4c21d2ed82d17e2db2286dabcca5">&#9670;&nbsp;</a></span>img_add_aberration_terms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_add_aberration_terms </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>psum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>psec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>ppart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> &amp;&#160;</td>
          <td class="paramname"><em>cp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a61e3a11088f2cd74ace13c125f968211" name="a61e3a11088f2cd74ace13c125f968211"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61e3a11088f2cd74ace13c125f968211">&#9670;&nbsp;</a></span>img_calculate_phase_differences()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_calculate_phase_differences </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>psum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae08d4c489a34469c1882e3813eb3037e" name="ae08d4c489a34469c1882e3813eb3037e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae08d4c489a34469c1882e3813eb3037e">&#9670;&nbsp;</a></span>img_check_contrast()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_check_contrast </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>psum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a20b479d1317983b450baec2e144adda0" name="a20b479d1317983b450baec2e144adda0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20b479d1317983b450baec2e144adda0">&#9670;&nbsp;</a></span>mg_find_part_centers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long mg_find_part_centers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>filter_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the centers of picked particles within a micrograph. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*mg</td><td>micrograph parameter structure. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">filter_flag</td><td>flag to filter extremes in particles. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of particles. <pre class="fragment">An image processing parameter structure loaded with micrograph
information is used to extract particle images from the micrograph
image using the particle coordinates in the parameter structure.
The extracted particle images are each rotated by PI and the shift
found by cross-correlation between the unrotated and rotated images.
The particle coordinates in the parameter structure are updated with
the shift.
</pre> </dd></dl>

</div>
</div>
<a id="a723ace5df859b2f19c6b9278a50a4896" name="a723ace5df859b2f19c6b9278a50a4896"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a723ace5df859b2f19c6b9278a50a4896">&#9670;&nbsp;</a></span>particle_aberration_sum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * particle_aberration_sum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bparticle.html">Bparticle</a> *&#160;</td>
          <td class="paramname"><em>part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *&#160;</td>
          <td class="paramname"><em>kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a19f79089513679bc24b4e7e2583f2b41" name="a19f79089513679bc24b4e7e2583f2b41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19f79089513679bc24b4e7e2583f2b41">&#9670;&nbsp;</a></span>particle_correlation_sum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * particle_correlation_sum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bparticle.html">Bparticle</a> *&#160;</td>
          <td class="paramname"><em>part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *&#160;</td>
          <td class="paramname"><em>kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2a0ac471269c6e536c61d12589c7148e" name="a2a0ac471269c6e536c61d12589c7148e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a0ac471269c6e536c61d12589c7148e">&#9670;&nbsp;</a></span>particles_mask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long particles_mask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>partpath</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a31c14ba0d78431e826cbd9a06e547ce5" name="a31c14ba0d78431e826cbd9a06e547ce5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31c14ba0d78431e826cbd9a06e547ce5">&#9670;&nbsp;</a></span>project_aberration_phase_difference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * project_aberration_phase_difference </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *&#160;</td>
          <td class="paramname"><em>kernel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the aberration phase difference from a set of particles. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">*pref</td><td>reference map. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">*kernel</td><td>frequency space interpolation kernel lookup table. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* aberration phase differences as a complex image. <pre class="fragment">Uses the method as described in Zivanov et al (2020).
The return image is complex with the even and odd phase differences
in real and imaginary parts, respectively.
</pre> </dd></dl>

</div>
</div>
<a id="a21b160ebd1952bd2a46dfed95e5f8c91" name="a21b160ebd1952bd2a46dfed95e5f8c91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21b160ebd1952bd2a46dfed95e5f8c91">&#9670;&nbsp;</a></span>project_align_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int project_align_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>part_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>nuavg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>nustd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aligns single particle images based on orientation parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>micrograph processing parameter structure. </td></tr>
    <tr><td class="paramname">part_select</td><td>selection number from the selection column. </td></tr>
    <tr><td class="paramname">nuavg</td><td>rescale to new average. </td></tr>
    <tr><td class="paramname">nustd</td><td>rescale to new standard deviation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">Each selected particle image is rotated and shifted.
</pre> </dd></dl>

</div>
</div>
<a id="a572792d8d3510bcab5f2bd2bd36a99bf" name="a572792d8d3510bcab5f2bd2bd36a99bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a572792d8d3510bcab5f2bd2bd36a99bf">&#9670;&nbsp;</a></span>project_center_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int project_center_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>part_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>nuavg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>nustd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Centers single particle images based on the parametric center. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>micrograph processing parameter structure. </td></tr>
    <tr><td class="paramname">part_select</td><td>selection number from the selection column. </td></tr>
    <tr><td class="paramname">nuavg</td><td>rescale to new average. </td></tr>
    <tr><td class="paramname">nustd</td><td>rescale to new standard deviation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">Each particle image is shifted to center the origin.
</pre> </dd></dl>

</div>
</div>
<a id="a7f91e58c5f4aee2b1192291c63332fc1" name="a7f91e58c5f4aee2b1192291c63332fc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f91e58c5f4aee2b1192291c63332fc1">&#9670;&nbsp;</a></span>project_compare_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long project_compare_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>projcomp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compares the coordinates of particles between two files. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">*projcomp</td><td>comparable project parameter structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of common particles. <pre class="fragment">The coordinates of particles in one parameter file is compared to
that of a reference parameter file.
The two parameter files must have the same field and micrograph ID's.
</pre> </dd></dl>

</div>
</div>
<a id="adb7b2241d24b46407d31b12f798186c8" name="adb7b2241d24b46407d31b12f798186c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb7b2241d24b46407d31b12f798186c8">&#9670;&nbsp;</a></span>project_correlation_sum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * project_correlation_sum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *&#160;</td>
          <td class="paramname"><em>kernel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Correlates each particle with the CTF applied reference projection and sum the correlations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">*pref</td><td>reference map. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">*kernel</td><td>frequency space interpolation kernel lookup table. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* sum of cross-correlations. </dd></dl>

</div>
</div>
<a id="a6a4fb292d5310e7a79bb2c1c07f82b64" name="a6a4fb292d5310e7a79bb2c1c07f82b64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a4fb292d5310e7a79bb2c1c07f82b64">&#9670;&nbsp;</a></span>project_find_part_centers_in_mgs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long project_find_part_centers_in_mgs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>filter_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the centers of picked particles within a micrograph. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">filter_flag</td><td>flag to filter extremes in particles. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">An image processing parameter structure loaded with micrograph
information is used to extract particle images from the micrograph
image using the particle coordinates in the parameter structure.
The extracted particle images are each rotated by PI and the shift
found by cross-correlation between the unrotated and rotated images.
The particle coordinates in the parameter structure are updated with
the shift.
</pre> </dd></dl>

</div>
</div>
<a id="a38fff5de743dc58c53bb5a7ad67b822a" name="a38fff5de743dc58c53bb5a7ad67b822a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38fff5de743dc58c53bb5a7ad67b822a">&#9670;&nbsp;</a></span>project_find_particle_centers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * project_find_particle_centers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>part_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates centers of single particle images. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>image processing parameter structure. </td></tr>
    <tr><td class="paramname">max_iter</td><td>maximum number of iterations. </td></tr>
    <tr><td class="paramname">part_select</td><td>selection number from the selection column. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* final image composite reference. <pre class="fragment">A composite image is generated from the selected particles and radially
symmetrized. Each image shift is then determined by cross correlation.
This is repeated until the chnage in image shifts decreases below
a threshold.
</pre> </dd></dl>

</div>
</div>
<a id="ab1d281fc53acc8dd1c0851d3ff48d0ac" name="ab1d281fc53acc8dd1c0851d3ff48d0ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1d281fc53acc8dd1c0851d3ff48d0ac">&#9670;&nbsp;</a></span>project_mask_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long project_mask_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>partpath</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates centers of single particle images. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>image processing parameter structure. </td></tr>
    <tr><td class="paramname">*pmask</td><td>3D volume mask to be projected. </td></tr>
    <tr><td class="paramname">&amp;partpath</td><td>new path to particle files. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of particles masked. <pre class="fragment">A 3D mask is projected into each particle view and the particle image masked.
</pre> </dd></dl>

</div>
</div>
<a id="adf39e793a5acc4d24cc9e28b74489273" name="adf39e793a5acc4d24cc9e28b74489273"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf39e793a5acc4d24cc9e28b74489273">&#9670;&nbsp;</a></span>project_set_particle_centers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int project_set_particle_centers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>part_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates centers of single particle images by cross-correlation with a reference. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>micrograph processing parameter structure. </td></tr>
    <tr><td class="paramname">*pref</td><td>reference image. </td></tr>
    <tr><td class="paramname">part_select</td><td>selection number from the selection column. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">Each particle image shift is determined by cross correlation with
the reference image.
The reference must be the same size as the particle images.
</pre> </dd></dl>

</div>
</div>
<a id="abec758ec2e9044e54a28b398bb206811" name="abec758ec2e9044e54a28b398bb206811"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abec758ec2e9044e54a28b398bb206811">&#9670;&nbsp;</a></span>project_set_particle_defocus_from_tilt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long project_set_particle_defocus_from_tilt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>axis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the tilt axis from refined particle defocus values. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">axis</td><td>tilt axis angle (radians). </td></tr>
    <tr><td class="paramname">tilt</td><td>tilt angle (radians). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of selected particles. </dd></dl>

</div>
</div>
<a id="ab98bc39b1c1bbe3b81859cb195334493" name="ab98bc39b1c1bbe3b81859cb195334493"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab98bc39b1c1bbe3b81859cb195334493">&#9670;&nbsp;</a></span>project_tilt_from_particle_defocus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double project_tilt_from_particle_defocus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the tilt axis from refined particle defocus values. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double average tilt axis. </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0b2caeb4b6f130be43e5a2f0267dd453" name="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2caeb4b6f130be43e5a2f0267dd453">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_1d197ef0d9947f4cc1ac44e7f59e2b57.html">mg</a></li><li class="navelem"><a class="el" href="mg__particles_8cpp.html">mg_particles.cpp</a></li>
    <li class="footer">Generated on Tue Jan 31 2023 08:21:29 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
