<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/bernard/b20/bsoft/src/mg/mg_particles.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bsoft
   &#160;<span id="projectnumber">2.1.0</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('mg__particles_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mg_particles.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Calculates centers of single particle images.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="mg__processing_8h_source.html">mg_processing.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__particles_8h_source.html">mg_particles.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__select_8h_source.html">mg_select.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__img__proc_8h_source.html">mg_img_proc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rwimg_8h_source.html">rwimg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="matrix__linear_8h_source.html">matrix_linear.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="file__util_8h_source.html">file_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h_source.html">utilities.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timer_8h_source.html">timer.h</a>&quot;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
</div>
<p><a href="mg__particles_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a21b160ebd1952bd2a46dfed95e5f8c91"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a21b160ebd1952bd2a46dfed95e5f8c91">project_align_particles</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int <a class="el" href="tcltk__bmg_8cpp.html#a66823305785303716aa59f76b0e3359d">part_select</a>, double nuavg, double nustd)</td></tr>
<tr class="memdesc:a21b160ebd1952bd2a46dfed95e5f8c91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aligns single particle images based on orientation parameters.  <a href="mg__particles_8cpp.html#a21b160ebd1952bd2a46dfed95e5f8c91">More...</a><br /></td></tr>
<tr class="separator:a21b160ebd1952bd2a46dfed95e5f8c91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a572792d8d3510bcab5f2bd2bd36a99bf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a572792d8d3510bcab5f2bd2bd36a99bf">project_center_particles</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int <a class="el" href="tcltk__bmg_8cpp.html#a66823305785303716aa59f76b0e3359d">part_select</a>, double nuavg, double nustd)</td></tr>
<tr class="memdesc:a572792d8d3510bcab5f2bd2bd36a99bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Centers single particle images based on the parametric center. <br  />
  <a href="mg__particles_8cpp.html#a572792d8d3510bcab5f2bd2bd36a99bf">More...</a><br /></td></tr>
<tr class="separator:a572792d8d3510bcab5f2bd2bd36a99bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf39e793a5acc4d24cc9e28b74489273"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#adf39e793a5acc4d24cc9e28b74489273">project_set_particle_centers</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *pref, int <a class="el" href="tcltk__bmg_8cpp.html#a66823305785303716aa59f76b0e3359d">part_select</a>, double hires, double lores)</td></tr>
<tr class="memdesc:adf39e793a5acc4d24cc9e28b74489273"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates centers of single particle images by cross-correlation with a reference. <br  />
  <a href="mg__particles_8cpp.html#adf39e793a5acc4d24cc9e28b74489273">More...</a><br /></td></tr>
<tr class="separator:adf39e793a5acc4d24cc9e28b74489273"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a4fb292d5310e7a79bb2c1c07f82b64"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a6a4fb292d5310e7a79bb2c1c07f82b64">project_find_part_centers_in_mgs</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, double hires, double lores, int filter_flag)</td></tr>
<tr class="memdesc:a6a4fb292d5310e7a79bb2c1c07f82b64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the centers of picked particles within a micrograph.  <a href="mg__particles_8cpp.html#a6a4fb292d5310e7a79bb2c1c07f82b64">More...</a><br /></td></tr>
<tr class="separator:a6a4fb292d5310e7a79bb2c1c07f82b64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20b479d1317983b450baec2e144adda0"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a20b479d1317983b450baec2e144adda0">mg_find_part_centers</a> (<a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg, double hires, double lores, int filter_flag)</td></tr>
<tr class="memdesc:a20b479d1317983b450baec2e144adda0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the centers of picked particles within a micrograph.  <a href="mg__particles_8cpp.html#a20b479d1317983b450baec2e144adda0">More...</a><br /></td></tr>
<tr class="separator:a20b479d1317983b450baec2e144adda0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a003fec362a2a3956ea28da37316251e2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a003fec362a2a3956ea28da37316251e2">project_find_particle_centers</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int max_iter, int <a class="el" href="tcltk__bmg_8cpp.html#a66823305785303716aa59f76b0e3359d">part_select</a>, double hires, double lores)</td></tr>
<tr class="memdesc:a003fec362a2a3956ea28da37316251e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates centers of single particle images. <br  />
  <a href="mg__particles_8cpp.html#a003fec362a2a3956ea28da37316251e2">More...</a><br /></td></tr>
<tr class="separator:a003fec362a2a3956ea28da37316251e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a0ac471269c6e536c61d12589c7148e"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a2a0ac471269c6e536c61d12589c7148e">particles_mask</a> (<a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg, <a class="el" href="class_bimage.html">Bimage</a> *pmask, <a class="el" href="class_bstring.html">Bstring</a> &amp;partpath)</td></tr>
<tr class="separator:a2a0ac471269c6e536c61d12589c7148e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1d281fc53acc8dd1c0851d3ff48d0ac"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#ab1d281fc53acc8dd1c0851d3ff48d0ac">project_mask_particles</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *pmask, <a class="el" href="class_bstring.html">Bstring</a> &amp;partpath)</td></tr>
<tr class="memdesc:ab1d281fc53acc8dd1c0851d3ff48d0ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates centers of single particle images. <br  />
  <a href="mg__particles_8cpp.html#ab1d281fc53acc8dd1c0851d3ff48d0ac">More...</a><br /></td></tr>
<tr class="separator:ab1d281fc53acc8dd1c0851d3ff48d0ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f91e58c5f4aee2b1192291c63332fc1"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a7f91e58c5f4aee2b1192291c63332fc1">project_compare_particles</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bproject.html">Bproject</a> *projcomp)</td></tr>
<tr class="memdesc:a7f91e58c5f4aee2b1192291c63332fc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compares the coordinates of particles between two files. <br  />
  <a href="mg__particles_8cpp.html#a7f91e58c5f4aee2b1192291c63332fc1">More...</a><br /></td></tr>
<tr class="separator:a7f91e58c5f4aee2b1192291c63332fc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab98bc39b1c1bbe3b81859cb195334493"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#ab98bc39b1c1bbe3b81859cb195334493">project_tilt_from_particle_defocus</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>)</td></tr>
<tr class="memdesc:ab98bc39b1c1bbe3b81859cb195334493"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the tilt axis from refined particle defocus values. <br  />
  <a href="mg__particles_8cpp.html#ab98bc39b1c1bbe3b81859cb195334493">More...</a><br /></td></tr>
<tr class="separator:ab98bc39b1c1bbe3b81859cb195334493"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abec758ec2e9044e54a28b398bb206811"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#abec758ec2e9044e54a28b398bb206811">project_set_particle_defocus_from_tilt</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, double axis, double tilt)</td></tr>
<tr class="memdesc:abec758ec2e9044e54a28b398bb206811"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the tilt axis from refined particle defocus values. <br  />
  <a href="mg__particles_8cpp.html#abec758ec2e9044e54a28b398bb206811">More...</a><br /></td></tr>
<tr class="separator:abec758ec2e9044e54a28b398bb206811"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__particles_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Calculates centers of single particle images. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20080424 </dd>
<dd>
Modified: 20200401 </dd></dl>

<p class="definition">Definition in file <a class="el" href="mg__particles_8cpp_source.html">mg_particles.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a20b479d1317983b450baec2e144adda0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20b479d1317983b450baec2e144adda0">&#9670;&nbsp;</a></span>mg_find_part_centers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long mg_find_part_centers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>filter_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the centers of picked particles within a micrograph. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*mg</td><td>micrograph parameter structure. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">filter_flag</td><td>flag to filter extremes in particles. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of particles. <pre class="fragment">An image processing parameter structure loaded with micrograph
information is used to extract particle images from the micrograph
image using the particle coordinates in the parameter structure.
The extracted particle images are each rotated by PI and the shift
found by cross-correlation between the unrotated and rotated images.
The particle coordinates in the parameter structure are updated with
the shift.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__particles_8cpp_source.html#l00357">357</a> of file <a class="el" href="mg__particles_8cpp_source.html">mg_particles.cpp</a>.</p>

</div>
</div>
<a id="a2a0ac471269c6e536c61d12589c7148e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a0ac471269c6e536c61d12589c7148e">&#9670;&nbsp;</a></span>particles_mask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long particles_mask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>partpath</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mg__particles_8cpp_source.html#l00513">513</a> of file <a class="el" href="mg__particles_8cpp_source.html">mg_particles.cpp</a>.</p>

</div>
</div>
<a id="a21b160ebd1952bd2a46dfed95e5f8c91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21b160ebd1952bd2a46dfed95e5f8c91">&#9670;&nbsp;</a></span>project_align_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int project_align_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>part_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>nuavg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>nustd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aligns single particle images based on orientation parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>micrograph processing parameter structure. </td></tr>
    <tr><td class="paramname">part_select</td><td>selection number from the selection column. </td></tr>
    <tr><td class="paramname">nuavg</td><td>rescale to new average. </td></tr>
    <tr><td class="paramname">nustd</td><td>rescale to new standard deviation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">Each selected particle image is rotated and shifted.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__particles_8cpp_source.html#l00036">36</a> of file <a class="el" href="mg__particles_8cpp_source.html">mg_particles.cpp</a>.</p>

</div>
</div>
<a id="a572792d8d3510bcab5f2bd2bd36a99bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a572792d8d3510bcab5f2bd2bd36a99bf">&#9670;&nbsp;</a></span>project_center_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int project_center_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>part_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>nuavg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>nustd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Centers single particle images based on the parametric center. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>micrograph processing parameter structure. </td></tr>
    <tr><td class="paramname">part_select</td><td>selection number from the selection column. </td></tr>
    <tr><td class="paramname">nuavg</td><td>rescale to new average. </td></tr>
    <tr><td class="paramname">nustd</td><td>rescale to new standard deviation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">Each particle image is shifted to center the origin.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__particles_8cpp_source.html#l00138">138</a> of file <a class="el" href="mg__particles_8cpp_source.html">mg_particles.cpp</a>.</p>

</div>
</div>
<a id="a7f91e58c5f4aee2b1192291c63332fc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f91e58c5f4aee2b1192291c63332fc1">&#9670;&nbsp;</a></span>project_compare_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long project_compare_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>projcomp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compares the coordinates of particles between two files. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">*projcomp</td><td>comparable project parameter structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of common particles. <pre class="fragment">The coordinates of particles in one parameter file is compared to
that of a reference parameter file.
The two parameter files must have the same field and micrograph ID's.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__particles_8cpp_source.html#l00651">651</a> of file <a class="el" href="mg__particles_8cpp_source.html">mg_particles.cpp</a>.</p>

</div>
</div>
<a id="a6a4fb292d5310e7a79bb2c1c07f82b64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a4fb292d5310e7a79bb2c1c07f82b64">&#9670;&nbsp;</a></span>project_find_part_centers_in_mgs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long project_find_part_centers_in_mgs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>filter_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the centers of picked particles within a micrograph. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">filter_flag</td><td>flag to filter extremes in particles. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">An image processing parameter structure loaded with micrograph
information is used to extract particle images from the micrograph
image using the particle coordinates in the parameter structure.
The extracted particle images are each rotated by PI and the shift
found by cross-correlation between the unrotated and rotated images.
The particle coordinates in the parameter structure are updated with
the shift.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__particles_8cpp_source.html#l00322">322</a> of file <a class="el" href="mg__particles_8cpp_source.html">mg_particles.cpp</a>.</p>

</div>
</div>
<a id="a003fec362a2a3956ea28da37316251e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a003fec362a2a3956ea28da37316251e2">&#9670;&nbsp;</a></span>project_find_particle_centers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* project_find_particle_centers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>part_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates centers of single particle images. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>image processing parameter structure. </td></tr>
    <tr><td class="paramname">max_iter</td><td>maximum number of iterations. </td></tr>
    <tr><td class="paramname">part_select</td><td>selection number from the selection column. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* final image composite reference. <pre class="fragment">A composite image is generated from the selected particles and radially
symmetrized. Each image shift is then determined by cross correlation.
This is repeated until the chnage in image shifts decreases below
a threshold.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__particles_8cpp_source.html#l00411">411</a> of file <a class="el" href="mg__particles_8cpp_source.html">mg_particles.cpp</a>.</p>

</div>
</div>
<a id="ab1d281fc53acc8dd1c0851d3ff48d0ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1d281fc53acc8dd1c0851d3ff48d0ac">&#9670;&nbsp;</a></span>project_mask_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long project_mask_particles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>partpath</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates centers of single particle images. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>image processing parameter structure. </td></tr>
    <tr><td class="paramname">*pmask</td><td>3D volume mask to be projected. </td></tr>
    <tr><td class="paramname">&amp;partpath</td><td>new path to particle files. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of particles masked. <pre class="fragment">A 3D mask is projected into each particle view and the particle image masked.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__particles_8cpp_source.html#l00580">580</a> of file <a class="el" href="mg__particles_8cpp_source.html">mg_particles.cpp</a>.</p>

</div>
</div>
<a id="adf39e793a5acc4d24cc9e28b74489273"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf39e793a5acc4d24cc9e28b74489273">&#9670;&nbsp;</a></span>project_set_particle_centers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int project_set_particle_centers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>part_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates centers of single particle images by cross-correlation with a reference. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>micrograph processing parameter structure. </td></tr>
    <tr><td class="paramname">*pref</td><td>reference image. </td></tr>
    <tr><td class="paramname">part_select</td><td>selection number from the selection column. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">Each particle image shift is determined by cross correlation with
the reference image.
The reference must be the same size as the particle images.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__particles_8cpp_source.html#l00263">263</a> of file <a class="el" href="mg__particles_8cpp_source.html">mg_particles.cpp</a>.</p>

</div>
</div>
<a id="abec758ec2e9044e54a28b398bb206811"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abec758ec2e9044e54a28b398bb206811">&#9670;&nbsp;</a></span>project_set_particle_defocus_from_tilt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long project_set_particle_defocus_from_tilt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>axis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the tilt axis from refined particle defocus values. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">axis</td><td>tilt axis angle (radians). </td></tr>
    <tr><td class="paramname">tilt</td><td>tilt angle (radians). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of selected particles. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__particles_8cpp_source.html#l00803">803</a> of file <a class="el" href="mg__particles_8cpp_source.html">mg_particles.cpp</a>.</p>

</div>
</div>
<a id="ab98bc39b1c1bbe3b81859cb195334493"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab98bc39b1c1bbe3b81859cb195334493">&#9670;&nbsp;</a></span>project_tilt_from_particle_defocus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double project_tilt_from_particle_defocus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the tilt axis from refined particle defocus values. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double average tilt axis. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__particles_8cpp_source.html#l00710">710</a> of file <a class="el" href="mg__particles_8cpp_source.html">mg_particles.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2caeb4b6f130be43e5a2f0267dd453">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_1d197ef0d9947f4cc1ac44e7f59e2b57.html">mg</a></li><li class="navelem"><a class="el" href="mg__particles_8cpp.html">mg_particles.cpp</a></li>
    <li class="footer">Generated on Wed Sep 1 2021 09:22:04 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
