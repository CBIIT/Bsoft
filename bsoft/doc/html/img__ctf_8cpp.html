<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Bsoft: /usr/local/bsoft/src/img/img_ctf.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bsoft
   &#160;<span id="projectnumber">1.9</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('img__ctf_8cpp.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">img_ctf.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions to apply and/or determine the CTF (contrast transfer function) in electron micrographs.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="_bimage_8h_source.html">Bimage.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ctf_8h_source.html">ctf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="img__ctf_8h_source.html">img_ctf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="simplex_8h_source.html">simplex.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="moving__average_8h_source.html">moving_average.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_matrix_8h_source.html">Matrix.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="matrix__linear_8h_source.html">matrix_linear.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h_source.html">utilities.h</a>&quot;</code><br />
</div>
<p><a href="img__ctf_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a01a5e4d578970b2a3b9a31da4064b31a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a01a5e4d578970b2a3b9a31da4064b31a">img_ctf_fit_astigmatism_new</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, double lores, double hires)</td></tr>
<tr class="separator:a01a5e4d578970b2a3b9a31da4064b31a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a962899e7965d9ee949b145147960347a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a962899e7965d9ee949b145147960347a">ctf_fit_baseline</a> (<a class="el" href="class_bimage.html">Bimage</a> *prad, double real_size, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, double lores, double hires)</td></tr>
<tr class="separator:a962899e7965d9ee949b145147960347a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc31d1328c1a48b4560f0ed7c9215bb4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#acc31d1328c1a48b4560f0ed7c9215bb4">ctf_fit_envelope</a> (<a class="el" href="class_bimage.html">Bimage</a> *prad, double real_size, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, double lores, double hires)</td></tr>
<tr class="separator:acc31d1328c1a48b4560f0ed7c9215bb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5354c933e263edbc15655b0d1e83ffc3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a5354c933e263edbc15655b0d1e83ffc3">ctf_fit_eman_to_baseline</a> (long n, double *x, double *y, double *coeff)</td></tr>
<tr class="separator:a5354c933e263edbc15655b0d1e83ffc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a101865c3c341e44013bbb8c3c5b1eff6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a101865c3c341e44013bbb8c3c5b1eff6">eman_baseline_R</a> (<a class="el" href="class_bsimplex.html">Bsimplex</a> *simp)</td></tr>
<tr class="separator:a101865c3c341e44013bbb8c3c5b1eff6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e0f9dc4a03f17ae08748bb26314b807"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a1e0f9dc4a03f17ae08748bb26314b807">ctf_fit_gaussian</a> (long n, double *x, double *y, double *coeff)</td></tr>
<tr class="separator:a1e0f9dc4a03f17ae08748bb26314b807"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36ca7efc93036c2ded4eadf17cc007e8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a36ca7efc93036c2ded4eadf17cc007e8">gaussian_R</a> (<a class="el" href="class_bsimplex.html">Bsimplex</a> *simp)</td></tr>
<tr class="separator:a36ca7efc93036c2ded4eadf17cc007e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f25e483d09dcc63215e213e7a97cd3f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a2f25e483d09dcc63215e213e7a97cd3f">ctf_fit_double_gaussian_baseline</a> (long n, double *x, double *y, double *coeff)</td></tr>
<tr class="separator:a2f25e483d09dcc63215e213e7a97cd3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a986af44e870d7a7194e665786992db96"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a986af44e870d7a7194e665786992db96">ctf_fit_double_gaussian_envelope</a> (long n, double *x, double *y, double *coeff)</td></tr>
<tr class="separator:a986af44e870d7a7194e665786992db96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbf9820e481085f08669ef8b27643c29"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#abbf9820e481085f08669ef8b27643c29">double_gaussian_R</a> (<a class="el" href="class_bsimplex.html">Bsimplex</a> *simp)</td></tr>
<tr class="separator:abbf9820e481085f08669ef8b27643c29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5525706af7bd7887a7f7b37abd9fd809"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a5525706af7bd7887a7f7b37abd9fd809">img_ctf_calculate</a> (<a class="el" href="class_c_t_fparam.html">CTFparam</a> cp, int action, double wiener, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; size, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; sampling, double lores, double hires)</td></tr>
<tr class="memdesc:a5525706af7bd7887a7f7b37abd9fd809"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a CTF complex image.  <a href="#a5525706af7bd7887a7f7b37abd9fd809">More...</a><br /></td></tr>
<tr class="separator:a5525706af7bd7887a7f7b37abd9fd809"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a536b61dd210a473520c47d6048f1ab15"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a536b61dd210a473520c47d6048f1ab15">img_wave_aberration</a> (<a class="el" href="class_c_t_fparam.html">CTFparam</a> cp, <a class="el" href="class_vector3.html">Vector3</a>&lt; int &gt; size, <a class="el" href="class_vector3.html">Vector3</a>&lt; float &gt; sampling)</td></tr>
<tr class="memdesc:a536b61dd210a473520c47d6048f1ab15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a wave aberration function.  <a href="#a536b61dd210a473520c47d6048f1ab15">More...</a><br /></td></tr>
<tr class="separator:a536b61dd210a473520c47d6048f1ab15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d6ce602ea6a1b787734706663263f94"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a8d6ce602ea6a1b787734706663263f94">img_ctf_apply</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, int action, double wiener, double lores, double hires)</td></tr>
<tr class="memdesc:a8d6ce602ea6a1b787734706663263f94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies or corrects for the contrast transfer function (CTF).  <a href="#a8d6ce602ea6a1b787734706663263f94">More...</a><br /></td></tr>
<tr class="separator:a8d6ce602ea6a1b787734706663263f94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a265c4b5ca4dbff56c125b1d1b655a002"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a265c4b5ca4dbff56c125b1d1b655a002">img_ctf_apply</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, int action, double wiener, double lores, double hires, <a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a> planf_2D, <a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a> planb_2D)</td></tr>
<tr class="separator:a265c4b5ca4dbff56c125b1d1b655a002"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20333447400a51121faff5c61c4391b4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a20333447400a51121faff5c61c4391b4">img_ttf_apply_one</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long nn, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *ctf, int action, double wiener, double def, double res_lo, double res_hi, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; psize, <a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a> planf, <a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a> planb)</td></tr>
<tr class="separator:a20333447400a51121faff5c61c4391b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6171faf92363be12c204d5491e7323fb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a6171faf92363be12c204d5491e7323fb">img_ctf_apply_to_proj</a> (<a class="el" href="class_bimage.html">Bimage</a> *proj, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, double defocus, double res_lo, double res_hi, <a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a> planf_2D, <a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a> planb_2D)</td></tr>
<tr class="memdesc:a6171faf92363be12c204d5491e7323fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies a CTF to a projection image.  <a href="#a6171faf92363be12c204d5491e7323fb">More...</a><br /></td></tr>
<tr class="separator:a6171faf92363be12c204d5491e7323fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b93a26a5b7b500db82e33201d7f0b35"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a4b93a26a5b7b500db82e33201d7f0b35">img_ttf_apply</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *ctf, int action, double wiener, <a class="el" href="class_vector3.html">Vector3</a>&lt; int &gt; tile_size, double tilt, double axis, double res_lo, double res_hi)</td></tr>
<tr class="memdesc:a4b93a26a5b7b500db82e33201d7f0b35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies or corrects for the tilted contrast transfer function (TTF).  <a href="#a4b93a26a5b7b500db82e33201d7f0b35">More...</a><br /></td></tr>
<tr class="separator:a4b93a26a5b7b500db82e33201d7f0b35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae09c9eaf3294996cabbe825acd344d34"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#ae09c9eaf3294996cabbe825acd344d34">img_ctf_radial_average</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf)</td></tr>
<tr class="memdesc:ae09c9eaf3294996cabbe825acd344d34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the power spectrum radial average corrected for astigmatism.  <a href="#ae09c9eaf3294996cabbe825acd344d34">More...</a><br /></td></tr>
<tr class="separator:ae09c9eaf3294996cabbe825acd344d34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53de52f36090b6d315a0abd6d707b883"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a53de52f36090b6d315a0abd6d707b883">img_ctf_radial_subtract_baseline</a> (<a class="el" href="class_bimage.html">Bimage</a> *prad, double real_size, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf)</td></tr>
<tr class="separator:a53de52f36090b6d315a0abd6d707b883"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2014b647e158f2d2ed6b52330dddc88"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#ae2014b647e158f2d2ed6b52330dddc88">img_ctf_fit</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, double lores, double hires)</td></tr>
<tr class="memdesc:ae2014b647e158f2d2ed6b52330dddc88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines the CTF parameters from a power spectrum.  <a href="#ae2014b647e158f2d2ed6b52330dddc88">More...</a><br /></td></tr>
<tr class="separator:ae2014b647e158f2d2ed6b52330dddc88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5f5d198c73dfbaab5630254cd7a22b6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#ad5f5d198c73dfbaab5630254cd7a22b6">img_ctf_astigmatism_measure</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, double real_size, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, double lores, double hires)</td></tr>
<tr class="separator:ad5f5d198c73dfbaab5630254cd7a22b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7612d95f82bd88f472d8831f8dceb5bf"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a7612d95f82bd88f472d8831f8dceb5bf">img_ctf_fit_baseline</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, double lores, double hires)</td></tr>
<tr class="memdesc:a7612d95f82bd88f472d8831f8dceb5bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fits only the baseline for a given CTF.  <a href="#a7612d95f82bd88f472d8831f8dceb5bf">More...</a><br /></td></tr>
<tr class="separator:a7612d95f82bd88f472d8831f8dceb5bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af054f0ee402588fa31930a58a9247d79"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#af054f0ee402588fa31930a58a9247d79">img_ctf_fit_envelope</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, double lores, double hires)</td></tr>
<tr class="memdesc:af054f0ee402588fa31930a58a9247d79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fits only the envelope for a given CTF.  <a href="#af054f0ee402588fa31930a58a9247d79">More...</a><br /></td></tr>
<tr class="separator:af054f0ee402588fa31930a58a9247d79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a0844bf36ff7f4a21b285d7d5c36846"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a5a0844bf36ff7f4a21b285d7d5c36846">ctf_test_defocus</a> (<a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, double def, long nx, double step_size, double *r, long rmin, long rmax)</td></tr>
<tr class="separator:a5a0844bf36ff7f4a21b285d7d5c36846"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d5eb103b82651d3b6a5e9408c479c3d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a7d5eb103b82651d3b6a5e9408c479c3d">img_ctf_find_defocus</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, double lores, double hires, double def_start, double def_end, double def_inc)</td></tr>
<tr class="memdesc:a7d5eb103b82651d3b6a5e9408c479c3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Searches for the defocus based on correlation.  <a href="#a7d5eb103b82651d3b6a5e9408c479c3d">More...</a><br /></td></tr>
<tr class="separator:a7d5eb103b82651d3b6a5e9408c479c3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6602f5e9c4d9060d394b7d1fe29b2d96"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a6602f5e9c4d9060d394b7d1fe29b2d96">img_ctf_fit_astigmatism</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, long n, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, double lores, double hires)</td></tr>
<tr class="memdesc:a6602f5e9c4d9060d394b7d1fe29b2d96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fits the astigmatism with a given defocus, baseline and envelope.  <a href="#a6602f5e9c4d9060d394b7d1fe29b2d96">More...</a><br /></td></tr>
<tr class="separator:a6602f5e9c4d9060d394b7d1fe29b2d96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e6d481a639fcce76fa0283904cfc04c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a0e6d481a639fcce76fa0283904cfc04c">ctf_R</a> (<a class="el" href="class_bsimplex.html">Bsimplex</a> *simp)</td></tr>
<tr class="separator:a0e6d481a639fcce76fa0283904cfc04c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__ctf_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions to apply and/or determine the CTF (contrast transfer function) in electron micrographs. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20000426 </dd>
<dd>
Modified: 20160520 </dd></dl>

<p>Definition in file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a962899e7965d9ee949b145147960347a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_fit_baseline </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>prad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>real_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l01264">1264</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2f25e483d09dcc63215e213e7a97cd3f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_fit_double_gaussian_baseline </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>coeff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l01547">1547</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a986af44e870d7a7194e665786992db96"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_fit_double_gaussian_envelope </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>coeff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l01583">1583</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a5354c933e263edbc15655b0d1e83ffc3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_fit_eman_to_baseline </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>coeff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l01453">1453</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="acc31d1328c1a48b4560f0ed7c9215bb4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_fit_envelope </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>prad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>real_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l01354">1354</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a1e0f9dc4a03f17ae08748bb26314b807"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_fit_gaussian </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>coeff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l01501">1501</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0e6d481a639fcce76fa0283904cfc04c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_R </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bsimplex.html">Bsimplex</a> *&#160;</td>
          <td class="paramname"><em>simp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l01213">1213</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a5a0844bf36ff7f4a21b285d7d5c36846"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ctf_test_defocus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>step_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>rmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>rmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l00904">904</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="abbf9820e481085f08669ef8b27643c29"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double double_gaussian_R </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bsimplex.html">Bsimplex</a> *&#160;</td>
          <td class="paramname"><em>simp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l01606">1606</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a101865c3c341e44013bbb8c3c5b1eff6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double eman_baseline_R </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bsimplex.html">Bsimplex</a> *&#160;</td>
          <td class="paramname"><em>simp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l01472">1472</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a36ca7efc93036c2ded4eadf17cc007e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gaussian_R </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bsimplex.html">Bsimplex</a> *&#160;</td>
          <td class="paramname"><em>simp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l01519">1519</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a8d6ce602ea6a1b787734706663263f94"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_ctf_apply </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiener</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies or corrects for the contrast transfer function (CTF). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image (modified). </td></tr>
    <tr><td class="paramname">*em_ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">action</td><td>action to be taken. </td></tr>
    <tr><td class="paramname">wiener</td><td>Wiener factor (fraction). </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0, &lt;0 on error. <pre class="fragment">The actions for this funtion are:
1   flip phase (multiply by the sign of the CTF)
2   apply a CTF (multiply with the CTF)
3   correct for the CTF: ctf/(ctf^2 + wiener_factor)
4   correct for the CTF: env*ctf/((env*ctf)^2 + noise^2)
5   correct for the CTF with baseline: ctf/(ctf^2*noise^2 + wiener_factor)
6   correct for the CTF with baseline: 1/(ctf*noise + sign*wiener_factor)
Functions:
    angle = atan(y/x)
    s2 = x*x + y*y
    defocus_average = (defocus_max + defocus_min)/2
    defocus_deviation = (defocus_max - defocus_min)/2
    defocus = defocus_average + defocus_deviation*cos(2*(angle - astigmatism_angle))
    phase = 0.5*PI*lambda*lambda*lambda*Cs*s2*s2 - PI*lambda*defocus*s2;
    phi_fac = sqrt(1-amp_fac*amp_fac)
    CTF = amp_fac*cos(phase) - phi_fac*sin(phase)
Note: Defocus is positive for underfocus and negative for overfocus.
All of the parameters required to calculate the CTF, envelope and baseline
functions are embedded in the CTF structure.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l00268">268</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a265c4b5ca4dbff56c125b1d1b655a002"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_ctf_apply </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiener</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf_2D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planb_2D</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l00299">299</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6171faf92363be12c204d5491e7323fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_ctf_apply_to_proj </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>proj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>defocus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf_2D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planb_2D</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies a CTF to a projection image. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*proj</td><td>projection image. </td></tr>
    <tr><td class="paramname">*em_ctf</td><td>CTF parameters. </td></tr>
    <tr><td class="paramname">defocus</td><td>defocus. </td></tr>
    <tr><td class="paramname">res_lo</td><td>low resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">res_hi</td><td>high resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">planf_2D</td><td>2D forward fourier transform plan. </td></tr>
    <tr><td class="paramname">planb_2D</td><td>2D backward fourier transform plan. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. </dd></dl>

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l00379">379</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad5f5d198c73dfbaab5630254cd7a22b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_astigmatism_measure </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>real_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l00783">783</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a5525706af7bd7887a7f7b37abd9fd809"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_ctf_calculate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a>&#160;</td>
          <td class="paramname"><em>cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiener</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>sampling</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a CTF complex image. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cp</td><td>CTF parameters. </td></tr>
    <tr><td class="paramname">action</td><td>type of CTF calculated (1-8). </td></tr>
    <tr><td class="paramname">wiener</td><td>Wiener factor (fraction). </td></tr>
    <tr><td class="paramname">size</td><td>new image size. </td></tr>
    <tr><td class="paramname">sampling</td><td>new image pixel size. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* p new CTF function image. <pre class="fragment">Functions:
    angle = atan(y/x)
    s2 = x*x + y*y
    defocus_average = (defocus_max + defocus_min)/2
    defocus_deviation = (defocus_max - defocus_min)/2
    defocus = defocus_average + defocus_deviation*cos(2*(angle - astigmatism_angle))
    phase = 0.5*PI*lambda*lambda*lambda*Cs*s2*s2 - PI*lambda*defocus*s2;
    CTF = cos(phase) + i*sin(phase)
Note: Defocus is positive for underfocus and negative for overfocus.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l00055">55</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a7d5eb103b82651d3b6a5e9408c479c3d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_find_defocus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_inc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Searches for the defocus based on correlation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">*em_ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">def_start</td><td>defocus search start (default 1e3). </td></tr>
    <tr><td class="paramname">def_end</td><td>defocus search end (default 2e5). </td></tr>
    <tr><td class="paramname">def_inc</td><td>defocus search increment (default 1e3). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double R factor. <pre class="fragment">A radial power spectrum is calculated.
A range of defocus values is tested (1000-200000 angstrom, 0.1-20 um), 
and the best fitting value accepted.
The new parameters are written into the CTFparam structure.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l00942">942</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae2014b647e158f2d2ed6b52330dddc88"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines the CTF parameters from a power spectrum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">*em_ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double first zero. <pre class="fragment">Input: Power spectrum or its logarithm.
A radial power spectrum is calculated.
A range of defocus values is tested (100-200000 angstrom, 0.01-20 um), 
defining the baseline as passing through the zeroes for each defocus 
and fitting it to a 4th order polynomial.
The envelope function is a simple gaussian on top of the baseline and
fitted to minimize the RMSD between the calculated curve and the
radial power spectrum logarithm.
The fitting is limited to the spatial frequency range between the 
first and last zeroes.
Defocus values are positive for underfocus.
Functions:
    angle = atan(y/x)
    s2 = reciprocal space distance squared
    defocus_average = (defocus_max + defocus_min)/2
    defocus_deviation = (defocus_max - defocus_min)/2
    defocus = defocus_average + defocus_deviation*cos(2*(angle - astigmatism_angle))
    phase = 0.5*PI*lambda*lambda*lambda*Cs*s2*s2 - PI*lambda*defocus*s2;
    phi_fac = sqrt(1-amp_fac*amp_fac)
    CTF = amp_fac*cos(phase) - phi_fac*sin(phase)
The new parameters are written into the Bimage structure.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l00705">705</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6602f5e9c4d9060d394b7d1fe29b2d96"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit_astigmatism </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fits the astigmatism with a given defocus, baseline and envelope. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">*em_ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double objective measure (larger is better). <pre class="fragment">A radial power spectrum is calculated and the baseline subtracted.
The defocus deviation starts from a low value to get an estimate of
the astigmatism angle. The defocus deviation is modified nased on
the direction of improvements in the fit, at each iteration 
narrowing the angular search for the astigmatism angle.
The new parameters are written into the CTFparam structure.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l01024">1024</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a01a5e4d578970b2a3b9a31da4064b31a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit_astigmatism_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l01099">1099</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a7612d95f82bd88f472d8831f8dceb5bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit_baseline </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fits only the baseline for a given CTF. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">*em_ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double R factor. <pre class="fragment">A radial power spectrum is calculated incorporating astigmatism.
The baseline of the required type is fit.
The new parameters are written into the CTFparam structure.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l00852">852</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="af054f0ee402588fa31930a58a9247d79"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_ctf_fit_envelope </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fits only the envelope for a given CTF. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">*em_ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double R factor. <pre class="fragment">A radial power spectrum is calculated incorporating astigmatism.
The envelope is fit.
The new parameters are written into the CTFparam structure.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l00885">885</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae09c9eaf3294996cabbe825acd344d34"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_ctf_radial_average </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the power spectrum radial average corrected for astigmatism. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image structure. </td></tr>
    <tr><td class="paramname">n</td><td>sub-image number. </td></tr>
    <tr><td class="paramname">*em_ctf</td><td>CTF parameter structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* radial average, NULL on error. <pre class="fragment">A power spectrum with its origin at the center.
Functions:
    angle = atan(y/x) - astigmatism_angle
    s2 = reciprocal space distance squared
    defocus_min = defocus_avg - defocus_dev
    defocus_max = defocus_avg + defocus_dev
    smin2 = 1 - defocus_dev/defocus_avg
    smax2 = 1 + defocus_dev/defocus_avg
    radius = sqrt(2*s2*(smax2*cos(angle)*cos(angle)+
                smin2*sin(angle)*sin(angle))/(smax2+smin2))
The radial average is returned as a new 1D image.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l00554">554</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a53de52f36090b6d315a0abd6d707b883"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_ctf_radial_subtract_baseline </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>prad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>real_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l00659">659</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4b93a26a5b7b500db82e33201d7f0b35"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_ttf_apply </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiener</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>tile_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tilt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>axis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_hi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies or corrects for the tilted contrast transfer function (TTF). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image (modified). </td></tr>
    <tr><td class="paramname">*ctf</td><td>CTF parameter structure. </td></tr>
    <tr><td class="paramname">action</td><td>action to be taken. </td></tr>
    <tr><td class="paramname">wiener</td><td>Wiener factor (fraction). </td></tr>
    <tr><td class="paramname">tile_size</td><td>tile size for tilted CTF operations. </td></tr>
    <tr><td class="paramname">tilt</td><td>tilt angle (radians). </td></tr>
    <tr><td class="paramname">axis</td><td>tilt axis angle (radians). </td></tr>
    <tr><td class="paramname">res_lo</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">res_hi</td><td>low resolution limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0, &lt;0 on error. <pre class="fragment">The actions for this funtion are:
1   flip phase (multiply by the sign of the CTF)
2   apply a CTF (multiply with the CTF)
3   correct for the CTF: ctf/(ctf^2 + wiener_factor)
4   correct for the CTF: env*ctf/((env*ctf)^2 + noise^2)
5   correct for the CTF with baseline: ctf/(ctf^2*noise^2 + wiener_factor)
6   correct for the CTF with baseline: 1/(ctf*noise + sign*wiener_factor)
Functions:
    angle = atan(y/x)
    s2 = x*x + y*y
    defocus_average = (defocus_max + defocus_min)/2
    defocus_deviation = (defocus_max - defocus_min)/2
    defocus = defocus_average + defocus_deviation*cos(2*(angle - astigmatism_angle))
    phase = 0.5*PI*lambda*lambda*lambda*Cs*s2*s2 - PI*lambda*defocus*s2;
    phi_fac = sqrt(1-amp_fac*amp_fac)
    CTF = amp_fac*cos(phase) - phi_fac*sin(phase)
Note: Defocus is positive for underfocus and negative for overfocus.
All of the parameters required to calculate the CTF, envelope and baseline
functions are embedded in the CTF structure.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l00431">431</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a20333447400a51121faff5c61c4391b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_ttf_apply_one </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiener</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>psize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a195a5eedf2ee4171d58b4fe33e93c80d">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l00337">337</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a536b61dd210a473520c47d6048f1ab15"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_wave_aberration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a>&#160;</td>
          <td class="paramname"><em>cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; int &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; float &gt;&#160;</td>
          <td class="paramname"><em>sampling</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a wave aberration function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cp</td><td>CTF parameters. </td></tr>
    <tr><td class="paramname">size</td><td>new image size. </td></tr>
    <tr><td class="paramname">sampling</td><td>new image pixel size. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* p new wave aberration function image. <pre class="fragment">Functions:
    angle = atan(y/x)
    s2 = x*x + y*y
    defocus_average = (defocus_max + defocus_min)/2
    defocus_deviation = (defocus_max - defocus_min)/2
    defocus = defocus_average + defocus_deviation*cos(2*(angle - astigmatism_angle))
    phase = 0.5*PI*lambda*lambda*lambda*Cs*s2*s2 - PI*lambda*defocus*s2;
Note: Defocus is positive for underfocus and negative for overfocus.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__ctf_8cpp_source.html#l00193">193</a> of file <a class="el" href="img__ctf_8cpp_source.html">img_ctf.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_7673ec780970b264223275c6ce2fb0e1.html">img</a></li><li class="navelem"><a class="el" href="img__ctf_8cpp.html">img_ctf.cpp</a></li>
    <li class="footer">Generated on Mon Jun 6 2016 13:50:59 for Bsoft by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
