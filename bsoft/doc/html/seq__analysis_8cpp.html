<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/heymannb/b20/bsoft/src/mol/seq_analysis.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Bsoft<span id="projectnumber">&#160;2.1.4</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('seq__analysis_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">seq_analysis.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Analysis of protein sequences.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="seq__analysis_8h.html">seq_analysis.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="seq__util_8h.html">seq_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ps__sequence_8h.html">ps_sequence.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="moving__average_8h.html">moving_average.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="linked__list_8h.html">linked_list.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h.html">utilities.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3263a80ec4d193a5a71ddabb07abf9be"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="seq__analysis_8cpp.html#a3263a80ec4d193a5a71ddabb07abf9be">log_2</a> (double a)</td></tr>
<tr class="separator:a3263a80ec4d193a5a71ddabb07abf9be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae63e986b2072c8dd374e972801278443"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="seq__analysis_8cpp.html#ae63e986b2072c8dd374e972801278443">seq_limit</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_bstring.html">Bstring</a> &amp;refseq)</td></tr>
<tr class="memdesc:ae63e986b2072c8dd374e972801278443"><td class="mdescLeft">&#160;</td><td class="mdescRight">Limits the selection to the reference sequence in an aligned set.  <a href="seq__analysis_8cpp.html#ae63e986b2072c8dd374e972801278443">More...</a><br /></td></tr>
<tr class="separator:ae63e986b2072c8dd374e972801278443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af59ab959240bc0fb3ed8dcfe80a077ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_matrix.html">Matrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="seq__analysis_8cpp.html#af59ab959240bc0fb3ed8dcfe80a077ee">seq_aligned_identity</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup)</td></tr>
<tr class="memdesc:af59ab959240bc0fb3ed8dcfe80a077ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the pairwise identities between aligned sequences.  <a href="seq__analysis_8cpp.html#af59ab959240bc0fb3ed8dcfe80a077ee">More...</a><br /></td></tr>
<tr class="separator:af59ab959240bc0fb3ed8dcfe80a077ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2001a9ef78ad6a78096bafaaf14db48a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_matrix.html">Matrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="seq__analysis_8cpp.html#a2001a9ef78ad6a78096bafaaf14db48a">seq_aligned_similarity</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, double threshold, <a class="el" href="struct_bresidue__matrix.html">Bresidue_matrix</a> *simat)</td></tr>
<tr class="memdesc:a2001a9ef78ad6a78096bafaaf14db48a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the pairwise similarities between aligned sequences.  <a href="seq__analysis_8cpp.html#a2001a9ef78ad6a78096bafaaf14db48a">More...</a><br /></td></tr>
<tr class="separator:a2001a9ef78ad6a78096bafaaf14db48a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7bbfbb31c4f0105fcfc428c96dd50ba"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="seq__analysis_8cpp.html#ab7bbfbb31c4f0105fcfc428c96dd50ba">seq_select</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, long minlen, long maxlen)</td></tr>
<tr class="memdesc:ab7bbfbb31c4f0105fcfc428c96dd50ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Selects sequences within a range of lengths.  <a href="seq__analysis_8cpp.html#ab7bbfbb31c4f0105fcfc428c96dd50ba">More...</a><br /></td></tr>
<tr class="separator:ab7bbfbb31c4f0105fcfc428c96dd50ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae565b62640f8f3f1509750d025f0c1d0"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="seq__analysis_8cpp.html#ae565b62640f8f3f1509750d025f0c1d0">seq_select</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_matrix.html">Matrix</a> mat, long ref, double cutoff)</td></tr>
<tr class="memdesc:ae565b62640f8f3f1509750d025f0c1d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Selects sequences based on a comparison matrix of aligned sequences.  <a href="seq__analysis_8cpp.html#ae565b62640f8f3f1509750d025f0c1d0">More...</a><br /></td></tr>
<tr class="separator:ae565b62640f8f3f1509750d025f0c1d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07152153a8fef5bb924dc3f6942c8254"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="seq__analysis_8cpp.html#a07152153a8fef5bb924dc3f6942c8254">seq_delete</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_matrix.html">Matrix</a> mat)</td></tr>
<tr class="memdesc:a07152153a8fef5bb924dc3f6942c8254"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes non-selected sequences and corresponding elelments of a comparison matrix.  <a href="seq__analysis_8cpp.html#a07152153a8fef5bb924dc3f6942c8254">More...</a><br /></td></tr>
<tr class="separator:a07152153a8fef5bb924dc3f6942c8254"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca6f84917da8feae585df8682b1ed7d6"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="seq__analysis_8cpp.html#aca6f84917da8feae585df8682b1ed7d6">seq_aligned_profile</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup)</td></tr>
<tr class="memdesc:aca6f84917da8feae585df8682b1ed7d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a PROSITE format profile from an aligned set of sequences.  <a href="seq__analysis_8cpp.html#aca6f84917da8feae585df8682b1ed7d6">More...</a><br /></td></tr>
<tr class="separator:aca6f84917da8feae585df8682b1ed7d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0bf64706aa52e370e6b0b9478a8484e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="seq__analysis_8cpp.html#ac0bf64706aa52e370e6b0b9478a8484e">seq_aligned_information</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, int window, <a class="el" href="class_bstring.html">Bstring</a> &amp;psfile)</td></tr>
<tr class="memdesc:ac0bf64706aa52e370e6b0b9478a8484e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the sequence logo representation for an alignment.  <a href="seq__analysis_8cpp.html#ac0bf64706aa52e370e6b0b9478a8484e">More...</a><br /></td></tr>
<tr class="separator:ac0bf64706aa52e370e6b0b9478a8484e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1046c781c78bce22535ae13ea69dd5c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="seq__analysis_8cpp.html#ab1046c781c78bce22535ae13ea69dd5c">seq_aligned_hydrophobicity</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, int window, double threshold, <a class="el" href="class_bstring.html">Bstring</a> &amp;hphobfile, <a class="el" href="class_bstring.html">Bstring</a> &amp;psfile)</td></tr>
<tr class="memdesc:ab1046c781c78bce22535ae13ea69dd5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the average hydrophobicity at every position in an alignment.  <a href="seq__analysis_8cpp.html#ab1046c781c78bce22535ae13ea69dd5c">More...</a><br /></td></tr>
<tr class="separator:ab1046c781c78bce22535ae13ea69dd5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac544fbd3077ec2560b7e87d5f183a48"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="class_complex.html">Complex</a>&lt; float &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="seq__analysis_8cpp.html#aac544fbd3077ec2560b7e87d5f183a48">seq_frequency_analysis</a> (long win, long start, long end, vector&lt; double &gt; &amp;data)</td></tr>
<tr class="memdesc:aac544fbd3077ec2560b7e87d5f183a48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fourier transforms a vector for frequency analysis.  <a href="seq__analysis_8cpp.html#aac544fbd3077ec2560b7e87d5f183a48">More...</a><br /></td></tr>
<tr class="separator:aac544fbd3077ec2560b7e87d5f183a48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e42dbd01100249b0650ebda9876898b"><td class="memItemLeft" align="right" valign="top">vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="seq__analysis_8cpp.html#a8e42dbd01100249b0650ebda9876898b">seq_aligned_weight</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup)</td></tr>
<tr class="separator:a8e42dbd01100249b0650ebda9876898b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29d606323d59e804ca0dc1c23c734878"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_matrix.html">Matrix</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="seq__analysis_8cpp.html#a29d606323d59e804ca0dc1c23c734878">seq_correlated_mutation</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_bstring.html">Bstring</a> &amp;refseqid, double cutoff, <a class="el" href="class_bstring.html">Bstring</a> &amp;simfile)</td></tr>
<tr class="memdesc:a29d606323d59e804ca0dc1c23c734878"><td class="mdescLeft">&#160;</td><td class="mdescRight">Correlated mutation analysis of an alignment.  <a href="seq__analysis_8cpp.html#a29d606323d59e804ca0dc1c23c734878">More...</a><br /></td></tr>
<tr class="separator:a29d606323d59e804ca0dc1c23c734878"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="seq__analysis_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Analysis of protein sequences. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 19990123 </dd>
<dd>
Modified: 20210426 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a3263a80ec4d193a5a71ddabb07abf9be" name="a3263a80ec4d193a5a71ddabb07abf9be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3263a80ec4d193a5a71ddabb07abf9be">&#9670;&nbsp;</a></span>log_2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double log_2 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab1046c781c78bce22535ae13ea69dd5c" name="ab1046c781c78bce22535ae13ea69dd5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1046c781c78bce22535ae13ea69dd5c">&#9670;&nbsp;</a></span>seq_aligned_hydrophobicity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int seq_aligned_hydrophobicity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>hphobfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>psfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the average hydrophobicity at every position in an alignment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>the set of sequences. </td></tr>
    <tr><td class="paramname">window</td><td>moving average window. </td></tr>
    <tr><td class="paramname">threshold</td><td>fraction of sequences with a residue in a position. </td></tr>
    <tr><td class="paramname">&amp;hphobfile</td><td>parameter file. </td></tr>
    <tr><td class="paramname">&amp;psfile</td><td>postscript output file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0.</dd></dl>
<p>The default hydrophobicity scale is the GES scale. </p>

</div>
</div>
<a id="af59ab959240bc0fb3ed8dcfe80a077ee" name="af59ab959240bc0fb3ed8dcfe80a077ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af59ab959240bc0fb3ed8dcfe80a077ee">&#9670;&nbsp;</a></span>seq_aligned_identity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_matrix.html">Matrix</a> seq_aligned_identity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the pairwise identities between aligned sequences. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>the set of sequences. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="class_matrix.html">Matrix</a> the matrix of identities.</dd></dl>
<p>The identity between two sequences is defined as: number of identical residues identity = -------------------------&mdash; overlap where the overlap is the number of positions with residues in both sequences. </p>

</div>
</div>
<a id="ac0bf64706aa52e370e6b0b9478a8484e" name="ac0bf64706aa52e370e6b0b9478a8484e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0bf64706aa52e370e6b0b9478a8484e">&#9670;&nbsp;</a></span>seq_aligned_information()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int seq_aligned_information </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>psfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the sequence logo representation for an alignment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>the set of sequences. </td></tr>
    <tr><td class="paramname">window</td><td>window for calculating the moving average. </td></tr>
    <tr><td class="paramname">&amp;psfile</td><td>the postscript file name. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0.</dd></dl>
<p>The information content of each position in an alignment is calculated as: information = log_2(n) - sum(pi * log_2(pi) ) fi pi = ----&mdash; sum(fi) fi = frequency of residue type i at this position n = sum(fi) if sum(fi) &lt; 20, otherwise n = 20 A moving average of the information is calculated over a given window to smooth the resultant data. The sequence logo representation for the occurrence of every residue type at every position is generated and written into a postscript file. </p>

</div>
</div>
<a id="aca6f84917da8feae585df8682b1ed7d6" name="aca6f84917da8feae585df8682b1ed7d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca6f84917da8feae585df8682b1ed7d6">&#9670;&nbsp;</a></span>seq_aligned_profile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string seq_aligned_profile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a PROSITE format profile from an aligned set of sequences. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>the set of sequences. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string profile in PROSITE format.</dd></dl>
<p>At each position in the alignment, the number of distinct residue types are counted. If there are more than 3 residue types represented at a position, or there is a gap, it is designated as variable by an "x". The profile finally contains 1-3 residue type possibilities for highly conserved positions interspersed by variable length gaps. </p>

</div>
</div>
<a id="a2001a9ef78ad6a78096bafaaf14db48a" name="a2001a9ef78ad6a78096bafaaf14db48a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2001a9ef78ad6a78096bafaaf14db48a">&#9670;&nbsp;</a></span>seq_aligned_similarity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_matrix.html">Matrix</a> seq_aligned_similarity </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bresidue__matrix.html">Bresidue_matrix</a> *&#160;</td>
          <td class="paramname"><em>simat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the pairwise similarities between aligned sequences. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>the set of sequences. </td></tr>
    <tr><td class="paramname">threshold</td><td>threshold to accept residues as similar. </td></tr>
    <tr><td class="paramname">*simat</td><td>residue similarity matrix. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="class_matrix.html">Matrix</a> the matrix of similarities.</dd></dl>
<p>The similarity between two sequences is defined as: sum(residue similarity) similarity = --------------------&mdash; overlap number of residues with similarity &gt; threshold fraction similarity = -------------------------------------------&mdash; overlap where the overlap is the number of positions with residues in both sequences. The residue similarity is taken from a residue substitution matrix. The default substitution matrix is BLOSUM62. </p>

</div>
</div>
<a id="a8e42dbd01100249b0650ebda9876898b" name="a8e42dbd01100249b0650ebda9876898b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e42dbd01100249b0650ebda9876898b">&#9670;&nbsp;</a></span>seq_aligned_weight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; double &gt; seq_aligned_weight </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a29d606323d59e804ca0dc1c23c734878" name="a29d606323d59e804ca0dc1c23c734878"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29d606323d59e804ca0dc1c23c734878">&#9670;&nbsp;</a></span>seq_correlated_mutation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_matrix.html">Matrix</a> seq_correlated_mutation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>refseqid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>simfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Correlated mutation analysis of an alignment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>the set of aligned sequences. </td></tr>
    <tr><td class="paramname">refseqid</td><td>reference sequence to report on. </td></tr>
    <tr><td class="paramname">cutoff</td><td>cutoff for reporting correlated mutations. </td></tr>
    <tr><td class="paramname">&amp;simfile</td><td>similarity matrix file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="class_matrix.html">Matrix</a> the analysis result matrix.</dd></dl>
<p>Reference: Gobel, Sander &amp; Schneider (1994) Proteins 18, 309-317. Mutation (residue variation) correlation is defined as: 1 r(i,j) = ----------&mdash; sum(w(k,l)*(s(i,k,l) - &lt;s(i)&gt;)*(s(j,k,l) - &lt;s(j)&gt;)) m^2*o(i)*o(j) where: m: number of sequences o(i): standard deviation of similarities at alignment position i w(k,l): weight for sequences k and l (1 - fractional identity: see function seq_aligned_identity) s(i,k,l): similarity for alignment position i between sequences k and l &lt;s(i)&gt;: average similarity at alignment position i Individual high-scoring correlations (using the given cutoff value) are reported as follows: Res1 Num1 Res2 Num2 Total Corr T 9 I 17 210 0.631 TAIIIVVVIVVVIVIIIIIII IILLLLLLLLLLLLLLLLLLL The first 4 values gives the type and alignment position of the correlating residues. The total is the number of comparisons made: maximally m*(m-1)/2 The last number is the correlation coefficient. The following two lines gives the corresponding residues at the two alignment positions for all the sequences, allowing the user to see on what basis this is a high correlation. </p>

</div>
</div>
<a id="a07152153a8fef5bb924dc3f6942c8254" name="a07152153a8fef5bb924dc3f6942c8254"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07152153a8fef5bb924dc3f6942c8254">&#9670;&nbsp;</a></span>seq_delete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long seq_delete </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a>&#160;</td>
          <td class="paramname"><em>mat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deletes non-selected sequences and corresponding elelments of a comparison matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>the set of sequences. </td></tr>
    <tr><td class="paramname">mat</td><td>comparison matrix. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of sequences retained. </dd></dl>

</div>
</div>
<a id="aac544fbd3077ec2560b7e87d5f183a48" name="aac544fbd3077ec2560b7e87d5f183a48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac544fbd3077ec2560b7e87d5f183a48">&#9670;&nbsp;</a></span>seq_frequency_analysis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; <a class="el" href="class_complex.html">Complex</a>&lt; float &gt; &gt; seq_frequency_analysis </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>win</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fourier transforms a vector for frequency analysis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">win</td><td>window size. </td></tr>
    <tr><td class="paramname">start</td><td>start within window. </td></tr>
    <tr><td class="paramname">end</td><td>end within window. </td></tr>
    <tr><td class="paramname">*data</td><td>sequence. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0.</dd></dl>
<p>A brute force Fourier transform is done. </p>

</div>
</div>
<a id="ae63e986b2072c8dd374e972801278443" name="ae63e986b2072c8dd374e972801278443"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae63e986b2072c8dd374e972801278443">&#9670;&nbsp;</a></span>seq_limit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long seq_limit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>refseq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Limits the selection to the reference sequence in an aligned set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>the set of sequences. </td></tr>
    <tr><td class="paramname">&amp;refseq</td><td>reference sequence identifier. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of selected residues. </dd></dl>

</div>
</div>
<a id="ab7bbfbb31c4f0105fcfc428c96dd50ba" name="ab7bbfbb31c4f0105fcfc428c96dd50ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7bbfbb31c4f0105fcfc428c96dd50ba">&#9670;&nbsp;</a></span>seq_select() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long seq_select </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>minlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>maxlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Selects sequences within a range of lengths. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>the set of sequences. </td></tr>
    <tr><td class="paramname">minlen</td><td>minimum length. </td></tr>
    <tr><td class="paramname">maxlen</td><td>maximum length. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of sequences retained. </dd></dl>

</div>
</div>
<a id="ae565b62640f8f3f1509750d025f0c1d0" name="ae565b62640f8f3f1509750d025f0c1d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae565b62640f8f3f1509750d025f0c1d0">&#9670;&nbsp;</a></span>seq_select() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long seq_select </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a>&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Selects sequences based on a comparison matrix of aligned sequences. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>the set of sequences. </td></tr>
    <tr><td class="paramname">mat</td><td>comparison matrix. </td></tr>
    <tr><td class="paramname">ref</td><td>reference sequence number (starting at 1). </td></tr>
    <tr><td class="paramname">cutoff</td><td>threshold for selecting sequences. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of sequences retained. </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0b2caeb4b6f130be43e5a2f0267dd453" name="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2caeb4b6f130be43e5a2f0267dd453">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_d222c3909b771dd1cf1b375528c5865e.html">mol</a></li><li class="navelem"><a class="el" href="seq__analysis_8cpp.html">seq_analysis.cpp</a></li>
    <li class="footer">Generated on Tue Jan 31 2023 08:21:29 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
