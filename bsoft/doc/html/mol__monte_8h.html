<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/heymannb/b20/bsoft/include/mol_monte.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Bsoft<span id="projectnumber">&#160;2.1.4</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mol__monte_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">mol_monte.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Headers of functions using a monte carlo metroplis algorithm to energy minimize molecular positions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="rwmolecule_8h.html">rwmolecule.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rwimg_8h.html">rwimg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rwmodel_8h.html">rwmodel.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rwmd_8h.html">rwmd.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8e1b7b4346b5d5b40a1ad3616137582a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__monte_8h.html#a8e1b7b4346b5d5b40a1ad3616137582a">monte_carlo_metropolis</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="struct_bmd.html">Bmd</a> *md, <a class="el" href="class_bimage.html">Bimage</a> *map, double <a class="el" href="ctf_8cpp.html#a58af9b95ad67fce3014a21a4248db61b">beta</a>, double max_angle, double max_shift, long max_iter, int rigid, double(Efunc)(<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *, <a class="el" href="class_bimage.html">Bimage</a> *, <a class="el" href="struct_bmd.html">Bmd</a> *), int(Tfunc)(<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *, double, double))</td></tr>
<tr class="separator:a8e1b7b4346b5d5b40a1ad3616137582a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeac8ca7d67392a8482cebbf8dd77342b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__monte_8h.html#aeac8ca7d67392a8482cebbf8dd77342b">molgroup_generate_masked_grid_list</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_bimage.html">Bimage</a> *pmask, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; grid_sampling, <a class="el" href="class_bstring.html">Bstring</a> filename)</td></tr>
<tr class="memdesc:aeac8ca7d67392a8482cebbf8dd77342b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates multiple versions of a molecule at different locations. <br  />
  <a href="mol__monte_8h.html#aeac8ca7d67392a8482cebbf8dd77342b">More...</a><br /></td></tr>
<tr class="separator:aeac8ca7d67392a8482cebbf8dd77342b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7292f4ee06b652997d51f2be0d2ef51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__monte_8h.html#ae7292f4ee06b652997d51f2be0d2ef51">molgroup_generate_masked_grid_list</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; grid_sampling, <a class="el" href="class_bimage.html">Bimage</a> *pmask)</td></tr>
<tr class="separator:ae7292f4ee06b652997d51f2be0d2ef51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a729d8b2a943b26e5a4250beff299da45"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__monte_8h.html#a729d8b2a943b26e5a4250beff299da45">molgroup_generate_orientation_list</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, double angle_step, <a class="el" href="class_bstring.html">Bstring</a> filename, int whole)</td></tr>
<tr class="memdesc:a729d8b2a943b26e5a4250beff299da45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates multiple versions of a molecule at different locations. <br  />
  <a href="mol__monte_8h.html#a729d8b2a943b26e5a4250beff299da45">More...</a><br /></td></tr>
<tr class="separator:a729d8b2a943b26e5a4250beff299da45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03b702bfca6bccd2e7f91a9d3b3e8863"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__monte_8h.html#a03b702bfca6bccd2e7f91a9d3b3e8863">molgroup_generate_orientation_list</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, double angle_step)</td></tr>
<tr class="separator:a03b702bfca6bccd2e7f91a9d3b3e8863"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9273c4f74f442e80d73914c7c600736"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__monte_8h.html#ae9273c4f74f442e80d73914c7c600736">mcm_molecule_list</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="struct_bmd.html">Bmd</a> *md, <a class="el" href="class_bimage.html">Bimage</a> *map, double <a class="el" href="ctf_8cpp.html#a58af9b95ad67fce3014a21a4248db61b">beta</a>, double max_angle, double max_shift, long max_iter, int rigid)</td></tr>
<tr class="separator:ae9273c4f74f442e80d73914c7c600736"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98b0d7174ff9ef48e695e597563c54f3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__monte_8h.html#a98b0d7174ff9ef48e695e597563c54f3">mcm_molecule_groups</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="struct_bmd.html">Bmd</a> *md, <a class="el" href="class_bimage.html">Bimage</a> *map, double <a class="el" href="ctf_8cpp.html#a58af9b95ad67fce3014a21a4248db61b">beta</a>, double max_angle, double max_shift, long max_iter, int rigid)</td></tr>
<tr class="memdesc:a98b0d7174ff9ef48e695e597563c54f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Monte Carlo fit of a set of molecule groups. <br  />
  <a href="mol__monte_8h.html#a98b0d7174ff9ef48e695e597563c54f3">More...</a><br /></td></tr>
<tr class="separator:a98b0d7174ff9ef48e695e597563c54f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9aa092b968c6ab13f21d182388362b06"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__monte_8h.html#a9aa092b968c6ab13f21d182388362b06">mcm_molecule_list</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="struct_bmd.html">Bmd</a> *md, <a class="el" href="class_bimage.html">Bimage</a> *map, double <a class="el" href="ctf_8cpp.html#a58af9b95ad67fce3014a21a4248db61b">beta</a>, double max_angle, double max_shift, long max_iter, int rigid)</td></tr>
<tr class="memdesc:a9aa092b968c6ab13f21d182388362b06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Monte Carlo fit of a molecule to a list of locations and orientations. <br  />
  <a href="mol__monte_8h.html#a9aa092b968c6ab13f21d182388362b06">More...</a><br /></td></tr>
<tr class="separator:a9aa092b968c6ab13f21d182388362b06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c4bc3872e0c842b2106f5fdfe7ec33d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__monte_8h.html#a6c4bc3872e0c842b2106f5fdfe7ec33d">molgroup_set_box_to_map_boundaries</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_bimage.html">Bimage</a> *map)</td></tr>
<tr class="memdesc:a6c4bc3872e0c842b2106f5fdfe7ec33d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the box in a molgroup to that defined by the map boundaries. <br  />
  <a href="mol__monte_8h.html#a6c4bc3872e0c842b2106f5fdfe7ec33d">More...</a><br /></td></tr>
<tr class="separator:a6c4bc3872e0c842b2106f5fdfe7ec33d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3bcb80040f8e92050aea61dadaf9daf"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__monte_8h.html#aa3bcb80040f8e92050aea61dadaf9daf">molgroup_test_if_within_box</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; min, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; max)</td></tr>
<tr class="memdesc:aa3bcb80040f8e92050aea61dadaf9daf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests if a molecule overlaps with a defined box. <br  />
  <a href="mol__monte_8h.html#aa3bcb80040f8e92050aea61dadaf9daf">More...</a><br /></td></tr>
<tr class="separator:aa3bcb80040f8e92050aea61dadaf9daf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bf35d11dd1e96be923bfe269d5f76fb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__monte_8h.html#a6bf35d11dd1e96be923bfe269d5f76fb">monte_rigid_body_fit_energy</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_bimage.html">Bimage</a> *map, <a class="el" href="struct_bmd.html">Bmd</a> *md)</td></tr>
<tr class="memdesc:a6bf35d11dd1e96be923bfe269d5f76fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the potential energy for rigid body fitting.  <a href="mol__monte_8h.html#a6bf35d11dd1e96be923bfe269d5f76fb">More...</a><br /></td></tr>
<tr class="separator:a6bf35d11dd1e96be923bfe269d5f76fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8453d679157329d610be72baf16370ad"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__monte_8h.html#a8453d679157329d610be72baf16370ad">monte_atom_fit_energy</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_bimage.html">Bimage</a> *map, <a class="el" href="struct_bmd.html">Bmd</a> *md)</td></tr>
<tr class="memdesc:a8453d679157329d610be72baf16370ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the potential energy for fitting atoms to a map.  <a href="mol__monte_8h.html#a8453d679157329d610be72baf16370ad">More...</a><br /></td></tr>
<tr class="separator:a8453d679157329d610be72baf16370ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d6982e80371cfa37305f77c589d1828"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__monte_8h.html#a9d6982e80371cfa37305f77c589d1828">monte_bond_fit_energy</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_bimage.html">Bimage</a> *map, <a class="el" href="struct_bmd.html">Bmd</a> *md)</td></tr>
<tr class="memdesc:a9d6982e80371cfa37305f77c589d1828"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the potential energy for fitting bonds to a map.  <a href="mol__monte_8h.html#a9d6982e80371cfa37305f77c589d1828">More...</a><br /></td></tr>
<tr class="separator:a9d6982e80371cfa37305f77c589d1828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6b0295903b13c93f3daeb778af88306"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__monte_8h.html#ad6b0295903b13c93f3daeb778af88306">molgroup_atom_overlap</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="struct_bmd.html">Bmd</a> *md)</td></tr>
<tr class="memdesc:ad6b0295903b13c93f3daeb778af88306"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates an energy term based on atom overlap.  <a href="mol__monte_8h.html#ad6b0295903b13c93f3daeb778af88306">More...</a><br /></td></tr>
<tr class="separator:ad6b0295903b13c93f3daeb778af88306"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3aedc423fdaaa395f6b431bc98f610be"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__monte_8h.html#a3aedc423fdaaa395f6b431bc98f610be">molgroup_rigid_body_transform</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, double max_angle, double shift_std)</td></tr>
<tr class="memdesc:a3aedc423fdaaa395f6b431bc98f610be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Randomly transforms a molecule or molecule group.  <a href="mol__monte_8h.html#a3aedc423fdaaa395f6b431bc98f610be">More...</a><br /></td></tr>
<tr class="separator:a3aedc423fdaaa395f6b431bc98f610be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a225462c77f816d6ef49e874e8251913c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__monte_8h.html#a225462c77f816d6ef49e874e8251913c">molgroup_move_atoms_down_energy</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, double max_angle, double max_shift)</td></tr>
<tr class="memdesc:a225462c77f816d6ef49e874e8251913c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move atoms random distances down the energy gradient.  <a href="mol__monte_8h.html#a225462c77f816d6ef49e874e8251913c">More...</a><br /></td></tr>
<tr class="separator:a225462c77f816d6ef49e874e8251913c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Headers of functions using a monte carlo metroplis algorithm to energy minimize molecular positions. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20041230 </dd>
<dd>
Modified: 20071223 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a98b0d7174ff9ef48e695e597563c54f3" name="a98b0d7174ff9ef48e695e597563c54f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98b0d7174ff9ef48e695e597563c54f3">&#9670;&nbsp;</a></span>mcm_molecule_groups()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mcm_molecule_groups </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmd.html">Bmd</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rigid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Monte Carlo fit of a set of molecule groups. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecule group. </td></tr>
    <tr><td class="paramname">*model</td><td>model parameters (modified). </td></tr>
    <tr><td class="paramname">*md</td><td>molecular dynamics structure. </td></tr>
    <tr><td class="paramname">*map</td><td>map. </td></tr>
    <tr><td class="paramname">beta</td><td>equivalent of 1/kT. </td></tr>
    <tr><td class="paramname">max_angle</td><td>maximum allowed angular step size. </td></tr>
    <tr><td class="paramname">max_shift</td><td>maximum allowed shift. </td></tr>
    <tr><td class="paramname">max_iter</td><td>maximum number of iterations. </td></tr>
    <tr><td class="paramname">rigid</td><td>selection of mode. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bmolgroup* new molecule group list. <pre class="fragment">For each model, the molecule group is first transformed to the model 
location and orientation. The whole ensemble is then refined with the 
Monte Carlo Metropolis algorithm and the model parameters updated.
</pre> </dd></dl>

</div>
</div>
<a id="ae9273c4f74f442e80d73914c7c600736" name="ae9273c4f74f442e80d73914c7c600736"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9273c4f74f442e80d73914c7c600736">&#9670;&nbsp;</a></span>mcm_molecule_list() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> * mcm_molecule_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmd.html">Bmd</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rigid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9aa092b968c6ab13f21d182388362b06" name="a9aa092b968c6ab13f21d182388362b06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9aa092b968c6ab13f21d182388362b06">&#9670;&nbsp;</a></span>mcm_molecule_list() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mcm_molecule_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmd.html">Bmd</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rigid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Monte Carlo fit of a molecule to a list of locations and orientations. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecule group. </td></tr>
    <tr><td class="paramname">*model</td><td>model parameters (modified). </td></tr>
    <tr><td class="paramname">*md</td><td>molecular dynamics structure. </td></tr>
    <tr><td class="paramname">*map</td><td>map. </td></tr>
    <tr><td class="paramname">beta</td><td>equivalent of 1/kT. </td></tr>
    <tr><td class="paramname">max_angle</td><td>maximum allowed angular step size. </td></tr>
    <tr><td class="paramname">max_shift</td><td>maximum allowed shift. </td></tr>
    <tr><td class="paramname">max_iter</td><td>maximum number of iterations. </td></tr>
    <tr><td class="paramname">rigid</td><td>selection of mode. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bmolgroup* new molecule group list. <pre class="fragment">For each model, the molecule group is first transformed to the model 
location and orientation. This is then refined with the Monte Carlo
Metropolis algorithm and the model parameters updated.
</pre> </dd></dl>

</div>
</div>
<a id="ad6b0295903b13c93f3daeb778af88306" name="ad6b0295903b13c93f3daeb778af88306"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6b0295903b13c93f3daeb778af88306">&#9670;&nbsp;</a></span>molgroup_atom_overlap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double molgroup_atom_overlap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmd.html">Bmd</a> *&#160;</td>
          <td class="paramname"><em>md</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates an energy term based on atom overlap. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecular structure. </td></tr>
    <tr><td class="paramname">*md</td><td>molecular dynamics structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double total overlap energy. <pre class="fragment">The energy is defined as linear decay to the reference separation distance
and zero beyond:
    Esep = Ksep * (1 - d/dsep)  for  d &lt; dsep, zero otherwise
</pre> </dd></dl>

</div>
</div>
<a id="aeac8ca7d67392a8482cebbf8dd77342b" name="aeac8ca7d67392a8482cebbf8dd77342b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeac8ca7d67392a8482cebbf8dd77342b">&#9670;&nbsp;</a></span>molgroup_generate_masked_grid_list() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> * molgroup_generate_masked_grid_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>grid_sampling</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a>&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates multiple versions of a molecule at different locations. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecule group. </td></tr>
    <tr><td class="paramname">*pmask</td><td>mask to get limit grid positions. </td></tr>
    <tr><td class="paramname">grid_sampling</td><td>sampling for grid search. </td></tr>
    <tr><td class="paramname">filename</td><td>output base file name. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bmolgroup* linked list of molecule groups. <pre class="fragment">The locations of the molecules are defined on the intersection of a 
grid and a user-defined mask.
The numbered output filename is also set.
Note: the molecule group minima and maxima should be set to the 
volume to be searched before calling this function.
</pre> </dd></dl>

</div>
</div>
<a id="ae7292f4ee06b652997d51f2be0d2ef51" name="ae7292f4ee06b652997d51f2be0d2ef51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7292f4ee06b652997d51f2be0d2ef51">&#9670;&nbsp;</a></span>molgroup_generate_masked_grid_list() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bmodel.html">Bmodel</a> * molgroup_generate_masked_grid_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>grid_sampling</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a03b702bfca6bccd2e7f91a9d3b3e8863" name="a03b702bfca6bccd2e7f91a9d3b3e8863"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03b702bfca6bccd2e7f91a9d3b3e8863">&#9670;&nbsp;</a></span>molgroup_generate_orientation_list() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bmodel.html">Bmodel</a> * molgroup_generate_orientation_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle_step</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a729d8b2a943b26e5a4250beff299da45" name="a729d8b2a943b26e5a4250beff299da45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a729d8b2a943b26e5a4250beff299da45">&#9670;&nbsp;</a></span>molgroup_generate_orientation_list() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> * molgroup_generate_orientation_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a>&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>whole</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates multiple versions of a molecule at different locations. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecule group. </td></tr>
    <tr><td class="paramname">angle_step</td><td>angular step size in radians. </td></tr>
    <tr><td class="paramname">filename</td><td>output base file name. </td></tr>
    <tr><td class="paramname">whole</td><td>treat the whole ensemble as a rigid body. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bmolgroup* linked list of molecule groups. <pre class="fragment">The molecule group is rotated in place to give all orientations
with a given angle step size between the views.
The numbered output filename is also set.
</pre> </dd></dl>

</div>
</div>
<a id="a225462c77f816d6ef49e874e8251913c" name="a225462c77f816d6ef49e874e8251913c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a225462c77f816d6ef49e874e8251913c">&#9670;&nbsp;</a></span>molgroup_move_atoms_down_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int molgroup_move_atoms_down_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_shift</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Move atoms random distances down the energy gradient. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecular structure. </td></tr>
    <tr><td class="paramname">max_angle</td><td>(not used). </td></tr>
    <tr><td class="paramname">max_shift</td><td>maximum shift for each atom. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double 0. <pre class="fragment">The distance of movement is limited to the maximum shift.
</pre> </dd></dl>

</div>
</div>
<a id="a3aedc423fdaaa395f6b431bc98f610be" name="a3aedc423fdaaa395f6b431bc98f610be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3aedc423fdaaa395f6b431bc98f610be">&#9670;&nbsp;</a></span>molgroup_rigid_body_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int molgroup_rigid_body_transform </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_std</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Randomly transforms a molecule or molecule group. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecular structure. </td></tr>
    <tr><td class="paramname">max_angle</td><td>maximum rotation angle. </td></tr>
    <tr><td class="paramname">shift_std</td><td>gaussian length for shift vector. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">The transformation is calculted as a random angular rotation and a
random shift. The shift is sampled from a random vector with a
gaussian length distribution.
</pre> </dd></dl>

</div>
</div>
<a id="a6c4bc3872e0c842b2106f5fdfe7ec33d" name="a6c4bc3872e0c842b2106f5fdfe7ec33d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c4bc3872e0c842b2106f5fdfe7ec33d">&#9670;&nbsp;</a></span>molgroup_set_box_to_map_boundaries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int molgroup_set_box_to_map_boundaries </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the box in a molgroup to that defined by the map boundaries. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecule group. </td></tr>
    <tr><td class="paramname">*map</td><td>map to get boundaries from. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. </dd></dl>

</div>
</div>
<a id="aa3bcb80040f8e92050aea61dadaf9daf" name="aa3bcb80040f8e92050aea61dadaf9daf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3bcb80040f8e92050aea61dadaf9daf">&#9670;&nbsp;</a></span>molgroup_test_if_within_box()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long molgroup_test_if_within_box </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests if a molecule overlaps with a defined box. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecule group. </td></tr>
    <tr><td class="paramname">min</td><td>start of box. </td></tr>
    <tr><td class="paramname">max</td><td>end of box. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long 0. </dd></dl>

</div>
</div>
<a id="a8453d679157329d610be72baf16370ad" name="a8453d679157329d610be72baf16370ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8453d679157329d610be72baf16370ad">&#9670;&nbsp;</a></span>monte_atom_fit_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double monte_atom_fit_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmd.html">Bmd</a> *&#160;</td>
          <td class="paramname"><em>md</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the potential energy for fitting atoms to a map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecular structure. </td></tr>
    <tr><td class="paramname">*map</td><td>density map. </td></tr>
    <tr><td class="paramname">*md</td><td>molecular dynamics structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double potential energy. <pre class="fragment">The energy is the sum of the bond, angle, and map energies.
</pre> </dd></dl>

</div>
</div>
<a id="a9d6982e80371cfa37305f77c589d1828" name="a9d6982e80371cfa37305f77c589d1828"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d6982e80371cfa37305f77c589d1828">&#9670;&nbsp;</a></span>monte_bond_fit_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double monte_bond_fit_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmd.html">Bmd</a> *&#160;</td>
          <td class="paramname"><em>md</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the potential energy for fitting bonds to a map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecular structure. </td></tr>
    <tr><td class="paramname">*map</td><td>density map. </td></tr>
    <tr><td class="paramname">*md</td><td>molecular dynamics structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double potential energy. <pre class="fragment">The energy is the sum of the bond, angle, and map energies.
</pre> </dd></dl>

</div>
</div>
<a id="a8e1b7b4346b5d5b40a1ad3616137582a" name="a8e1b7b4346b5d5b40a1ad3616137582a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e1b7b4346b5d5b40a1ad3616137582a">&#9670;&nbsp;</a></span>monte_carlo_metropolis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> * monte_carlo_metropolis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmd.html">Bmd</a> *&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rigid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double(Efunc)(<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *, <a class="el" href="class_bimage.html">Bimage</a> *, <a class="el" href="struct_bmd.html">Bmd</a> *)&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(Tfunc)(<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *, double, double)&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6bf35d11dd1e96be923bfe269d5f76fb" name="a6bf35d11dd1e96be923bfe269d5f76fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bf35d11dd1e96be923bfe269d5f76fb">&#9670;&nbsp;</a></span>monte_rigid_body_fit_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double monte_rigid_body_fit_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bmd.html">Bmd</a> *&#160;</td>
          <td class="paramname"><em>md</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the potential energy for rigid body fitting. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecular structure. </td></tr>
    <tr><td class="paramname">*map</td><td>density map. </td></tr>
    <tr><td class="paramname">*md</td><td>molecular dynamics structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double potential energy. <pre class="fragment">The energy is the sum of the overlap, map, and point force energies.
</pre> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="mol__monte_8h.html">mol_monte.h</a></li>
    <li class="footer">Generated on Fri Jan 7 2022 02:32:16 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
