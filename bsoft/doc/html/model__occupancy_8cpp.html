<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/heymannb/b20/bsoft/src/model/model_occupancy.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Bsoft<span id="projectnumber">&#160;2.1.4</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('model__occupancy_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">model_occupancy.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Library routines to count components in maps.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="model__occupancy_8h.html">model_occupancy.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="binomial_8h.html">binomial.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ps__plot_8h.html">ps_plot.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="img__combine_8h.html">img_combine.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="model__extract__build_8h.html">model_extract_build.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="model__compare_8h.html">model_compare.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="model__util_8h.html">model_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="math__util_8h.html">math_util.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h.html">utilities.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="linked__list_8h.html">linked_list.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1703312d3fbf7759b3e817ed0841b6db"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__occupancy_8cpp.html#a1703312d3fbf7759b3e817ed0841b6db">component_coverage</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, int img_num, <a class="el" href="class_bcomponent.html">Bcomponent</a> *comp, double threshold)</td></tr>
<tr class="separator:a1703312d3fbf7759b3e817ed0841b6db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e18955e312d0c875b8b35271e4b0c9a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__occupancy_8cpp.html#a5e18955e312d0c875b8b35271e4b0c9a">model_occupancy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="class_bimage.html">Bimage</a> *pmask, double mol_weight, double rho, double cutoff, int invert_flag)</td></tr>
<tr class="memdesc:a5e18955e312d0c875b8b35271e4b0c9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the occupancy of components in a map.  <a href="model__occupancy_8cpp.html#a5e18955e312d0c875b8b35271e4b0c9a">More...</a><br /></td></tr>
<tr class="separator:a5e18955e312d0c875b8b35271e4b0c9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5e12eb2e10b1537e336a5479e311652"><td class="memItemLeft" align="right" valign="top">vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__occupancy_8cpp.html#af5e12eb2e10b1537e336a5479e311652">model_occupancy_distribution</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, double cutoff, int nfit, long &amp;ncomp, vector&lt; double &gt; &amp;prob, double &amp;R)</td></tr>
<tr class="memdesc:af5e12eb2e10b1537e336a5479e311652"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the occupancy distribution of models.  <a href="model__occupancy_8cpp.html#af5e12eb2e10b1537e336a5479e311652">More...</a><br /></td></tr>
<tr class="separator:af5e12eb2e10b1537e336a5479e311652"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ce52ade541b979afcf3d66483c75b61"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__occupancy_8cpp.html#a0ce52ade541b979afcf3d66483c75b61">model_refine_comp_for_occupancy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="class_bimage.html">Bimage</a> *pmask2, <a class="el" href="class_bimage.html">Bimage</a> *ptemp, <a class="el" href="class_bimage.html">Bimage</a> *pmask, double hires, double lores, double max_shift)</td></tr>
<tr class="memdesc:a0ce52ade541b979afcf3d66483c75b61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refines component views and positions by cross-correlation.  <a href="model__occupancy_8cpp.html#a0ce52ade541b979afcf3d66483c75b61">More...</a><br /></td></tr>
<tr class="separator:a0ce52ade541b979afcf3d66483c75b61"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__occupancy_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Library routines to count components in maps. </p>
<dl class="section author"><dt>Author</dt><dd>Daniel Nemecek and Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20091202 </dd>
<dd>
Modified: 20151110 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a1703312d3fbf7759b3e817ed0841b6db" name="a1703312d3fbf7759b3e817ed0841b6db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1703312d3fbf7759b3e817ed0841b6db">&#9670;&nbsp;</a></span>component_coverage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double component_coverage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>img_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bcomponent.html">Bcomponent</a> *&#160;</td>
          <td class="paramname"><em>comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5e18955e312d0c875b8b35271e4b0c9a" name="a5e18955e312d0c875b8b35271e4b0c9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e18955e312d0c875b8b35271e4b0c9a">&#9670;&nbsp;</a></span>model_occupancy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int model_occupancy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mol_weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>invert_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the occupancy of components in a map. </p>
<dl class="section author"><dt>Author</dt><dd>Daniel Nemecek and Bernard Heymann </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure to be modified. </td></tr>
    <tr><td class="paramname">*pmask</td><td></td></tr>
    <tr><td class="paramname">mol_weight</td><td>molecular weight to determine threshold. </td></tr>
    <tr><td class="paramname">rho</td><td>protein density in Da/A3. </td></tr>
    <tr><td class="paramname">cutoff</td><td>coverage cutoff to use for assigning occupancy. </td></tr>
    <tr><td class="paramname">invert_flag</td><td>flag to invert map density. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">The map must have positive density (higher values are considered density).
The coverage for a component is defined as the fraction of voxels within
a sphere around the component location that is above the threshold.
The threshold can be derived from the molecular weight or is taken as
the sum of the map average and standard deviation.
The radius of the sphere is taken from the component radius.
</pre> </dd></dl>

</div>
</div>
<a id="af5e12eb2e10b1537e336a5479e311652" name="af5e12eb2e10b1537e336a5479e311652"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5e12eb2e10b1537e336a5479e311652">&#9670;&nbsp;</a></span>model_occupancy_distribution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; double &gt; model_occupancy_distribution </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nfit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long &amp;&#160;</td>
          <td class="paramname"><em>ncomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>R</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the occupancy distribution of models. </p>
<dl class="section author"><dt>Author</dt><dd>Daniel Nemecek and Bernard Heymann </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure to be modified. </td></tr>
    <tr><td class="paramname">cutoff</td><td>coverage cutoff to determine occupancy. </td></tr>
    <tr><td class="paramname">nfit</td><td>number of binomial curves to fit. </td></tr>
    <tr><td class="paramname">&amp;ncomp</td><td>maximum number of components in a model. </td></tr>
    <tr><td class="paramname">*prob</td><td>weight and probability array (2*nfit). </td></tr>
    <tr><td class="paramname">&amp;R</td><td>pointer to fit residual. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>vector&lt;double&gt;&amp; occupancy distribution histogram and fits. <pre class="fragment">The component coverage must already be calculated and stored in the
FOM property of each component. A component is considered occupied
if its coverage exceeds the given cutoff value.
The distribution, error and fit array is set up with 3+nfit columns:
    Column1:    Distribution histogram
    Column2:    Standard deviations
    Column3:    Overall binomial fit curve (sum of remaining columns)
    Column4+:   nfit individual binomial curves
</pre> </dd></dl>

</div>
</div>
<a id="a0ce52ade541b979afcf3d66483c75b61" name="a0ce52ade541b979afcf3d66483c75b61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ce52ade541b979afcf3d66483c75b61">&#9670;&nbsp;</a></span>model_refine_comp_for_occupancy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int model_refine_comp_for_occupancy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>ptemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_shift</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refines component views and positions by cross-correlation. </p>
<dl class="section author"><dt>Author</dt><dd>Daniel Nemecek and Bernard Heymann </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model. </td></tr>
    <tr><td class="paramname">*pmask2</td><td>mask for the input image. </td></tr>
    <tr><td class="paramname">*ptemp</td><td>density template. </td></tr>
    <tr><td class="paramname">*pmask</td><td>cross-correlation mask. </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit for cross-correlation. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit for cross-correlation. </td></tr>
    <tr><td class="paramname">max_shift</td><td>maximum shift in coordinates (angstrom). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">The density origin is positioned on the component.
The component views must already be set.
The density and search radii are derived from the radius of each component.
When a shift is out-of-range, returns to the initial position.
The size of the template determines the search area.
</pre> </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0b2caeb4b6f130be43e5a2f0267dd453" name="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2caeb4b6f130be43e5a2f0267dd453">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_5dd65160827af56e6353642206b80129.html">model</a></li><li class="navelem"><a class="el" href="model__occupancy_8cpp.html">model_occupancy.cpp</a></li>
    <li class="footer">Generated on Tue Jan 31 2023 08:21:29 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
