<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/bernard/b20/bsoft/src/mg/mg_refine.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bsoft
   &#160;<span id="projectnumber">2.1.0</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('mg__refine_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mg_refine.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Reciprocal space refinement of orientation parameters of particle images.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="mg__processing_8h_source.html">mg_processing.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__refine_8h_source.html">mg_refine.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rwmg_8h_source.html">rwmg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__ctf_8h_source.html">mg_ctf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rwimg_8h_source.html">rwimg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_complex_8h_source.html">Complex.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_matrix3_8h_source.html">Matrix3.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="linked__list_8h_source.html">linked_list.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="random__numbers_8h_source.html">random_numbers.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h_source.html">utilities.h</a>&quot;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
</div>
<p><a href="mg__refine_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a27009d66ec3e356f7f2e76974606799d"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__refine_8cpp.html#a27009d66ec3e356f7f2e76974606799d">part_refine_orientation</a> (<a class="el" href="class_bparticle.html">Bparticle</a> *part, <a class="el" href="class_bstring.html">Bstring</a> &amp;partfile, <a class="el" href="class_bimage.html">Bimage</a> *pref, <a class="el" href="class_bimage.html">Bimage</a> *pmask, <a class="el" href="struct_bsymmetry.html">Bsymmetry</a> sym, int max_iter, double alpha_step, double accuracy, double shift_step, double shift_accuracy, double hi_res, double lo_res, int fom_type, vector&lt; double &gt; weight, double edge_radius, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, double def_std, double shift_std, double view_std, double max_angle, double max_mag, int flags, <a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *<a class="el" href="structkernel.html">kernel</a>, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</a>)</td></tr>
<tr class="memdesc:a27009d66ec3e356f7f2e76974606799d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refine the orientation and origin of one particle with respect to a reference map.  <a href="mg__refine_8cpp.html#a27009d66ec3e356f7f2e76974606799d">More...</a><br /></td></tr>
<tr class="separator:a27009d66ec3e356f7f2e76974606799d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab279a16ea1d3aa11bdc174eba7406956"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__refine_8cpp.html#ab279a16ea1d3aa11bdc174eba7406956">img_refine_monte</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pref, double hi_res, double lo_res, int max_iter, int fom_type, vector&lt; double &gt; &amp;weight, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, double def_std, double shift_std, double view_std, double max_angle, double max_mag, <a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *<a class="el" href="structkernel.html">kernel</a>, long &amp;number)</td></tr>
<tr class="memdesc:ab279a16ea1d3aa11bdc174eba7406956"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refine the orientation and origin of one particle with respect to a reference map.  <a href="mg__refine_8cpp.html#ab279a16ea1d3aa11bdc174eba7406956">More...</a><br /></td></tr>
<tr class="separator:ab279a16ea1d3aa11bdc174eba7406956"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6abefc026ab89fe047e29333bbd6aa87"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__refine_8cpp.html#a6abefc026ab89fe047e29333bbd6aa87">img_refine_grid</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pref, double hi_res, double lo_res, double alpha_step, double accuracy, double shift_step, double shift_accuracy, double max_mag, int fom_type, vector&lt; double &gt; &amp;weight, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, double def_std, <a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *<a class="el" href="structkernel.html">kernel</a>, long &amp;number)</td></tr>
<tr class="memdesc:a6abefc026ab89fe047e29333bbd6aa87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refine the orientation and origin of one particle with respect to a reference map.  <a href="mg__refine_8cpp.html#a6abefc026ab89fe047e29333bbd6aa87">More...</a><br /></td></tr>
<tr class="separator:a6abefc026ab89fe047e29333bbd6aa87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac015a84e19818e434f79916bc2e94d87"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__refine_8cpp.html#ac015a84e19818e434f79916bc2e94d87">mg_refine_orientations</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bstring.html">Bstring</a> &amp;reffile, <a class="el" href="class_bstring.html">Bstring</a> &amp;maskfile, <a class="el" href="class_bstring.html">Bstring</a> &amp;sym_string, int <a class="el" href="tcltk__bmg_8cpp.html#a66823305785303716aa59f76b0e3359d">part_select</a>, int max_iter, double alpha_step, double accuracy, double shift_step, double shift_accuracy, int fom_type, vector&lt; double &gt; weight, double hi_res, double lo_res, int kernel_width, int kernel_power, double edge_radius, double def_std, double shift_std, double view_std, double max_angle, double max_mag, int flags)</td></tr>
<tr class="memdesc:ac015a84e19818e434f79916bc2e94d87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refine the orientation and origin with respect to a reference map.  <a href="mg__refine_8cpp.html#ac015a84e19818e434f79916bc2e94d87">More...</a><br /></td></tr>
<tr class="separator:ac015a84e19818e434f79916bc2e94d87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1331dbbf289ab81924b877ebbe99d9de"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__refine_8cpp.html#a1331dbbf289ab81924b877ebbe99d9de">project_refine_orientations</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bstring.html">Bstring</a> &amp;reffile, <a class="el" href="class_bstring.html">Bstring</a> &amp;maskfile, <a class="el" href="class_bstring.html">Bstring</a> &amp;sym_string, int <a class="el" href="tcltk__bmg_8cpp.html#a66823305785303716aa59f76b0e3359d">part_select</a>, int max_iter, double alpha_step, double accuracy, double shift_step, double shift_accuracy, int fom_type, vector&lt; double &gt; weight, double hi_res, double lo_res, int kernel_width, int kernel_power, double edge_radius, double def_std, double shift_std, double view_std, double max_angle, double max_mag, int flags)</td></tr>
<tr class="separator:a1331dbbf289ab81924b877ebbe99d9de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e64fddb32060025af5e03021151a146"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__refine_8cpp.html#a7e64fddb32060025af5e03021151a146">img_recip_space_fom</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pref, double hi_res, double lo_res, int fom_type, vector&lt; double &gt; &amp;weight, int apply_ctf, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf)</td></tr>
<tr class="separator:a7e64fddb32060025af5e03021151a146"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af90397092d5a8de64119571612f2e4f2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__refine_8cpp.html#af90397092d5a8de64119571612f2e4f2">img_fit_in_recip_space_monte</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pref, double hi_res, double lo_res, int max_iter, int fom_type, vector&lt; double &gt; &amp;weight, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, double def_std, double shift_std, <a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *<a class="el" href="structkernel.html">kernel</a>, long &amp;number)</td></tr>
<tr class="separator:af90397092d5a8de64119571612f2e4f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ad44ccbc884097f75e7b1dcaad4b571"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__refine_8cpp.html#a4ad44ccbc884097f75e7b1dcaad4b571">img_fit_in_recip_space_grid</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pref, double hi_res, double lo_res, double step, double accuracy, int fom_type, vector&lt; double &gt; &amp;weight, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *em_ctf, double def_std, <a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *<a class="el" href="structkernel.html">kernel</a>, long &amp;number)</td></tr>
<tr class="separator:a4ad44ccbc884097f75e7b1dcaad4b571"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__refine_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Reciprocal space refinement of orientation parameters of particle images. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20070115 </dd>
<dd>
Modified: 20200205 </dd></dl>

<p class="definition">Definition in file <a class="el" href="mg__refine_8cpp_source.html">mg_refine.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a4ad44ccbc884097f75e7b1dcaad4b571"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ad44ccbc884097f75e7b1dcaad4b571">&#9670;&nbsp;</a></span>img_fit_in_recip_space_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_fit_in_recip_space_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lo_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>accuracy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fom_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *&#160;</td>
          <td class="paramname"><em>kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long &amp;&#160;</td>
          <td class="paramname"><em>number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mg__refine_8cpp_source.html#l00857">857</a> of file <a class="el" href="mg__refine_8cpp_source.html">mg_refine.cpp</a>.</p>

</div>
</div>
<a id="af90397092d5a8de64119571612f2e4f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af90397092d5a8de64119571612f2e4f2">&#9670;&nbsp;</a></span>img_fit_in_recip_space_monte()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_fit_in_recip_space_monte </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lo_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fom_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *&#160;</td>
          <td class="paramname"><em>kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long &amp;&#160;</td>
          <td class="paramname"><em>number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mg__refine_8cpp_source.html#l00778">778</a> of file <a class="el" href="mg__refine_8cpp_source.html">mg_refine.cpp</a>.</p>

</div>
</div>
<a id="a7e64fddb32060025af5e03021151a146"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e64fddb32060025af5e03021151a146">&#9670;&nbsp;</a></span>img_recip_space_fom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_recip_space_fom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lo_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fom_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>apply_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mg__refine_8cpp_source.html#l00659">659</a> of file <a class="el" href="mg__refine_8cpp_source.html">mg_refine.cpp</a>.</p>

</div>
</div>
<a id="a6abefc026ab89fe047e29333bbd6aa87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6abefc026ab89fe047e29333bbd6aa87">&#9670;&nbsp;</a></span>img_refine_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_refine_grid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lo_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>accuracy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_accuracy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_mag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fom_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *&#160;</td>
          <td class="paramname"><em>kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long &amp;&#160;</td>
          <td class="paramname"><em>number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refine the orientation and origin of one particle with respect to a reference map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>particle image. </td></tr>
    <tr><td class="paramname">*pref</td><td>reference map. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">lo_res</td><td>low resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">alpha_step</td><td>grid search angular step size. </td></tr>
    <tr><td class="paramname">accuracy</td><td>grid search accuracy. </td></tr>
    <tr><td class="paramname">shift_step</td><td>grid shift size. </td></tr>
    <tr><td class="paramname">shift_accuracy</td><td>grid shift accuracy. </td></tr>
    <tr><td class="paramname">max_mag</td><td>maximum magnification adjustment. </td></tr>
    <tr><td class="paramname">fom_type</td><td>type of resolution measure: 0=FRC, 1=DPR </td></tr>
    <tr><td class="paramname">weight</td><td>1D reciprocal space weight curve. </td></tr>
    <tr><td class="paramname">*em_ctf</td><td>CTF parameters (if NULL, not used). </td></tr>
    <tr><td class="paramname">def_std</td><td>defocus step size. </td></tr>
    <tr><td class="paramname">*kernel</td><td>interpolation kernel. </td></tr>
    <tr><td class="paramname">&amp;number</td><td>number of comparisons. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double best figure-of-merit. <pre class="fragment">The orientation and origin are refined using a grid search
with selection based on the FSC or DPR.
The best result is returned in the orientation parameters of the image structure.
The FOM in the image structure is the first FOM determined, while the best
FOM is returned.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__refine_8cpp_source.html#l01079">1079</a> of file <a class="el" href="mg__refine_8cpp_source.html">mg_refine.cpp</a>.</p>

</div>
</div>
<a id="ab279a16ea1d3aa11bdc174eba7406956"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab279a16ea1d3aa11bdc174eba7406956">&#9670;&nbsp;</a></span>img_refine_monte()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_refine_monte </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lo_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fom_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>view_std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_mag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *&#160;</td>
          <td class="paramname"><em>kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long &amp;&#160;</td>
          <td class="paramname"><em>number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refine the orientation and origin of one particle with respect to a reference map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>particle image. </td></tr>
    <tr><td class="paramname">*pref</td><td>reference map. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">lo_res</td><td>low resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">max_iter</td><td>maximum number of refining iterations. </td></tr>
    <tr><td class="paramname">fom_type</td><td>type of resolution measure: 0=FRC, 1=DPR </td></tr>
    <tr><td class="paramname">weight</td><td>1D reciprocal space weight curve. </td></tr>
    <tr><td class="paramname">*em_ctf</td><td>CTF parameters (if NULL, not used). </td></tr>
    <tr><td class="paramname">def_std</td><td>random defocus standard deviation </td></tr>
    <tr><td class="paramname">shift_std</td><td>random origin shift standard deviation. </td></tr>
    <tr><td class="paramname">view_std</td><td>random view shift standard deviation. </td></tr>
    <tr><td class="paramname">max_angle</td><td>maximum random rotation angle adjustment. </td></tr>
    <tr><td class="paramname">max_mag</td><td>maximum magnification adjustment. </td></tr>
    <tr><td class="paramname">*kernel</td><td>interpolation kernel. </td></tr>
    <tr><td class="paramname">&amp;number</td><td>number of comparisons. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double best figure-of-merit. <pre class="fragment">The orientation and origin are iteratively modified in small random steps,
with selection based on the Fourier shell correlation.
The best result is returned in the orientation parameters of the image structure.
The FOM in the image structure is the first FOM determined, while the best
FOM is returned.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__refine_8cpp_source.html#l00973">973</a> of file <a class="el" href="mg__refine_8cpp_source.html">mg_refine.cpp</a>.</p>

</div>
</div>
<a id="ac015a84e19818e434f79916bc2e94d87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac015a84e19818e434f79916bc2e94d87">&#9670;&nbsp;</a></span>mg_refine_orientations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long mg_refine_orientations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>reffile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>maskfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>sym_string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>part_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>accuracy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_accuracy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fom_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lo_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kernel_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kernel_power</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>edge_radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>view_std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_mag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refine the orientation and origin with respect to a reference map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>image processing parameter structure. </td></tr>
    <tr><td class="paramname">&amp;reffile</td><td>file containing reference map. </td></tr>
    <tr><td class="paramname">&amp;maskfile</td><td>file containing a real space mask (can be empty). </td></tr>
    <tr><td class="paramname">&amp;sym_string</td><td>point group symmetry designator. </td></tr>
    <tr><td class="paramname">part_select</td><td>particle selection for processing. </td></tr>
    <tr><td class="paramname">max_iter</td><td>Monte Carlo maximum number of refining iterations. </td></tr>
    <tr><td class="paramname">alpha_step</td><td>grid search angular step size. </td></tr>
    <tr><td class="paramname">accuracy</td><td>grid search accuracy. </td></tr>
    <tr><td class="paramname">shift_step</td><td>grid shift size. </td></tr>
    <tr><td class="paramname">shift_accuracy</td><td>grid shift accuracy. </td></tr>
    <tr><td class="paramname">fom_type</td><td>type of resolution measure: 0=FRC, 1=DPR </td></tr>
    <tr><td class="paramname">weight</td><td>1D reciprocal space weight curve. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">lo_res</td><td>low resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">kernel_width</td><td>interpolation kernel width. </td></tr>
    <tr><td class="paramname">kernel_power</td><td>interpolation kernel power. </td></tr>
    <tr><td class="paramname">edge_radius</td><td>edge radius to mask background using previous origin. </td></tr>
    <tr><td class="paramname">def_std</td><td>random defocus standard deviation </td></tr>
    <tr><td class="paramname">shift_std</td><td>random origin shift standard deviation. </td></tr>
    <tr><td class="paramname">view_std</td><td>random view shift standard deviation. </td></tr>
    <tr><td class="paramname">max_angle</td><td>maximum random rotation angle adjustment. </td></tr>
    <tr><td class="paramname">max_mag</td><td>maximum magnification adjustment. </td></tr>
    <tr><td class="paramname">flags</td><td>option flags. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of comparisons, &lt;0 on error. <pre class="fragment">The orientation, origin, magnitude and defocus are refined for each particle.
The default method uses a grid search around the existing view and origin.
Specifying the maximum number of iterations switches the algorithm to a
Monte Carlo search for the best parameters.
The FOM is either based on the FSC or the DPR.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__refine_8cpp_source.html#l00077">77</a> of file <a class="el" href="mg__refine_8cpp_source.html">mg_refine.cpp</a>.</p>

</div>
</div>
<a id="a27009d66ec3e356f7f2e76974606799d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27009d66ec3e356f7f2e76974606799d">&#9670;&nbsp;</a></span>part_refine_orientation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long part_refine_orientation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bparticle.html">Bparticle</a> *&#160;</td>
          <td class="paramname"><em>part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>partfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bsymmetry.html">Bsymmetry</a>&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>accuracy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_accuracy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lo_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fom_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>edge_radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>em_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>view_std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_mag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_s_i___kernel.html">FSI_Kernel</a> *&#160;</td>
          <td class="paramname"><em>kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refine the orientation and origin of one particle with respect to a reference map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*part</td><td>particle. </td></tr>
    <tr><td class="paramname">&amp;partfile</td><td>particle filename. </td></tr>
    <tr><td class="paramname">*pref</td><td>reference map. </td></tr>
    <tr><td class="paramname">*pmask</td><td>mask. </td></tr>
    <tr><td class="paramname">*sym</td><td>symmetry structure. </td></tr>
    <tr><td class="paramname">max_iter</td><td>maximum number of refining iterations. </td></tr>
    <tr><td class="paramname">alpha_step</td><td>grid search angular step size. </td></tr>
    <tr><td class="paramname">accuracy</td><td>grid search accuracy. </td></tr>
    <tr><td class="paramname">shift_step</td><td>grid shift size. </td></tr>
    <tr><td class="paramname">shift_accuracy</td><td>grid shift accuracy. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">lo_res</td><td>low resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">fom_type</td><td>type of resolution measure: 0=FRC, 1=DPR </td></tr>
    <tr><td class="paramname">weight</td><td>1D reciprocal space weight curve. </td></tr>
    <tr><td class="paramname">edge_radius</td><td>edge radius to mask background using previous origin. </td></tr>
    <tr><td class="paramname">*em_ctf</td><td>CTF parameters (if NULL, not used). </td></tr>
    <tr><td class="paramname">def_std</td><td>random defocus standard deviation </td></tr>
    <tr><td class="paramname">shift_std</td><td>random origin shift standard deviation. </td></tr>
    <tr><td class="paramname">view_std</td><td>random view shift standard deviation. </td></tr>
    <tr><td class="paramname">max_angle</td><td>maximum random rotation angle adjustment. </td></tr>
    <tr><td class="paramname">max_mag</td><td>maximum magnification adjustment. </td></tr>
    <tr><td class="paramname">flags</td><td>option flags. </td></tr>
    <tr><td class="paramname">*kernel</td><td>interpolation kernel. </td></tr>
    <tr><td class="paramname">planf</td><td>FFT forward plan for 2D images. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number of comparisons. <pre class="fragment">The orientation and origin are iteratively modified in small random steps,
with selection based on the Fourier shell correlation.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__refine_8cpp_source.html#l00491">491</a> of file <a class="el" href="mg__refine_8cpp_source.html">mg_refine.cpp</a>.</p>

</div>
</div>
<a id="a1331dbbf289ab81924b877ebbe99d9de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1331dbbf289ab81924b877ebbe99d9de">&#9670;&nbsp;</a></span>project_refine_orientations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long project_refine_orientations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>reffile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>maskfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>sym_string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>part_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>accuracy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_accuracy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fom_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lo_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kernel_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kernel_power</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>edge_radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>def_std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>view_std</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_mag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mg__refine_8cpp_source.html#l00249">249</a> of file <a class="el" href="mg__refine_8cpp_source.html">mg_refine.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2caeb4b6f130be43e5a2f0267dd453">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_1d197ef0d9947f4cc1ac44e7f59e2b57.html">mg</a></li><li class="navelem"><a class="el" href="mg__refine_8cpp.html">mg_refine.cpp</a></li>
    <li class="footer">Generated on Wed Sep 1 2021 09:22:04 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
