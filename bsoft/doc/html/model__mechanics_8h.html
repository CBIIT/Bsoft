<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/heymannb/b20/bsoft/include/model_mechanics.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Bsoft<span id="projectnumber">&#160;2.1.4</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('model__mechanics_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">model_mechanics.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Functions to do molecular mechanics.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="rwmodel_8h.html">rwmodel.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rwmodel__param_8h.html">rwmodel_param.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rwimg_8h.html">rwimg.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a146c7646a40b4afc53f8fbf4ae0cb70c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#a146c7646a40b4afc53f8fbf4ae0cb70c">model_mechanics</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;md, int mm_type, int max_iter, double max_shift, double velocitylimit)</td></tr>
<tr class="memdesc:a146c7646a40b4afc53f8fbf4ae0cb70c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimizes the energy of a model.  <a href="model__mechanics_8h.html#a146c7646a40b4afc53f8fbf4ae0cb70c">More...</a><br /></td></tr>
<tr class="separator:a146c7646a40b4afc53f8fbf4ae0cb70c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfa114cb4ebf04dd000780ae3a56ab1a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#abfa114cb4ebf04dd000780ae3a56ab1a">model_minimize</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, double max_shift)</td></tr>
<tr class="memdesc:abfa114cb4ebf04dd000780ae3a56ab1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move components random distances down the energy gradient.  <a href="model__mechanics_8h.html#abfa114cb4ebf04dd000780ae3a56ab1a">More...</a><br /></td></tr>
<tr class="separator:abfa114cb4ebf04dd000780ae3a56ab1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4111f7274a1e0f313b249df84b8e1b8f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#a4111f7274a1e0f313b249df84b8e1b8f">model_verlet</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, double timestep, double Kfriction, double velocitylimit)</td></tr>
<tr class="memdesc:a4111f7274a1e0f313b249df84b8e1b8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Model dynamics using the velocity verlet integrator.  <a href="model__mechanics_8h.html#a4111f7274a1e0f313b249df84b8e1b8f">More...</a><br /></td></tr>
<tr class="separator:a4111f7274a1e0f313b249df84b8e1b8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac66cb3db035b84b3b101aab34ac98448"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#ac66cb3db035b84b3b101aab34ac98448">model_electrostatic_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;md)</td></tr>
<tr class="memdesc:ac66cb3db035b84b3b101aab34ac98448"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the electrostatic potentials between components.  <a href="model__mechanics_8h.html#ac66cb3db035b84b3b101aab34ac98448">More...</a><br /></td></tr>
<tr class="separator:ac66cb3db035b84b3b101aab34ac98448"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bdb91ae36845864133047f22b040f5e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#a7bdb91ae36845864133047f22b040f5e">model_distance_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;md)</td></tr>
<tr class="memdesc:a7bdb91ae36845864133047f22b040f5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the distance-related potentials between components.  <a href="model__mechanics_8h.html#a7bdb91ae36845864133047f22b040f5e">More...</a><br /></td></tr>
<tr class="separator:a7bdb91ae36845864133047f22b040f5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12722f0e2ea53fee890d09ab69af0c4a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#a12722f0e2ea53fee890d09ab69af0c4a">model_grid_distance_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;md)</td></tr>
<tr class="memdesc:a12722f0e2ea53fee890d09ab69af0c4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the non-bonded forces and energy.  <a href="model__mechanics_8h.html#a12722f0e2ea53fee890d09ab69af0c4a">More...</a><br /></td></tr>
<tr class="separator:a12722f0e2ea53fee890d09ab69af0c4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbd5167faccf5901241dae5fc4199a01"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#adbd5167faccf5901241dae5fc4199a01">model_neighbor_distance_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;md)</td></tr>
<tr class="memdesc:adbd5167faccf5901241dae5fc4199a01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the distance-related potentials between components and their neighbors.  <a href="model__mechanics_8h.html#adbd5167faccf5901241dae5fc4199a01">More...</a><br /></td></tr>
<tr class="separator:adbd5167faccf5901241dae5fc4199a01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0e5cb830160de53f08a59e03f408849"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#ad0e5cb830160de53f08a59e03f408849">model_soft_sphere_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, double Kdistance, double dist_ref)</td></tr>
<tr class="memdesc:ad0e5cb830160de53f08a59e03f408849"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the soft sphere potential between components.  <a href="model__mechanics_8h.html#ad0e5cb830160de53f08a59e03f408849">More...</a><br /></td></tr>
<tr class="separator:ad0e5cb830160de53f08a59e03f408849"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c2c49fb2f38d28db1096f236a167b49"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#a4c2c49fb2f38d28db1096f236a167b49">model_lennard_jones_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, double Kdistance, double <a class="el" href="_vector3_8h.html#aa60745aa4e45acde64f733424e37dbb9">distance</a>)</td></tr>
<tr class="memdesc:a4c2c49fb2f38d28db1096f236a167b49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the Lennard-Jones potential between components.  <a href="model__mechanics_8h.html#a4c2c49fb2f38d28db1096f236a167b49">More...</a><br /></td></tr>
<tr class="separator:a4c2c49fb2f38d28db1096f236a167b49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9aadb8e44f9c9ea98332144fd1432da"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#af9aadb8e44f9c9ea98332144fd1432da">model_morse_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, double Kdistance, double <a class="el" href="_vector3_8h.html#aa60745aa4e45acde64f733424e37dbb9">distance</a>)</td></tr>
<tr class="memdesc:af9aadb8e44f9c9ea98332144fd1432da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the Morse potential between components.  <a href="model__mechanics_8h.html#af9aadb8e44f9c9ea98332144fd1432da">More...</a><br /></td></tr>
<tr class="separator:af9aadb8e44f9c9ea98332144fd1432da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae06d71db1e4a623f5cb69c4265349415"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#ae06d71db1e4a623f5cb69c4265349415">model_link_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;md)</td></tr>
<tr class="memdesc:ae06d71db1e4a623f5cb69c4265349415"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the model link energy.  <a href="model__mechanics_8h.html#ae06d71db1e4a623f5cb69c4265349415">More...</a><br /></td></tr>
<tr class="separator:ae06d71db1e4a623f5cb69c4265349415"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a24f6e2ddd291d2707a3ca8038ef3d1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#a0a24f6e2ddd291d2707a3ca8038ef3d1">model_link_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, double Klink)</td></tr>
<tr class="memdesc:a0a24f6e2ddd291d2707a3ca8038ef3d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the model link energy.  <a href="model__mechanics_8h.html#a0a24f6e2ddd291d2707a3ca8038ef3d1">More...</a><br /></td></tr>
<tr class="separator:a0a24f6e2ddd291d2707a3ca8038ef3d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50aa3cd80e0c8953f88c44cd5795d08f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#a50aa3cd80e0c8953f88c44cd5795d08f">model_angle_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;md)</td></tr>
<tr class="memdesc:a50aa3cd80e0c8953f88c44cd5795d08f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the model angular energy.  <a href="model__mechanics_8h.html#a50aa3cd80e0c8953f88c44cd5795d08f">More...</a><br /></td></tr>
<tr class="separator:a50aa3cd80e0c8953f88c44cd5795d08f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c56f12a193aae669cadd550549876a2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#a8c56f12a193aae669cadd550549876a2">model_polygon_angle_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, double Kangle)</td></tr>
<tr class="memdesc:a8c56f12a193aae669cadd550549876a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the link angular forces and energy.  <a href="model__mechanics_8h.html#a8c56f12a193aae669cadd550549876a2">More...</a><br /></td></tr>
<tr class="separator:a8c56f12a193aae669cadd550549876a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a631dc257ac74698ad52f427cc4b8ab46"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#a631dc257ac74698ad52f427cc4b8ab46">model_polygon_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, double Kpoly)</td></tr>
<tr class="memdesc:a631dc257ac74698ad52f427cc4b8ab46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the polygon regularity energy and forces.  <a href="model__mechanics_8h.html#a631dc257ac74698ad52f427cc4b8ab46">More...</a><br /></td></tr>
<tr class="separator:a631dc257ac74698ad52f427cc4b8ab46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8da857326b0810c24bbc5daa4fe044be"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#a8da857326b0810c24bbc5daa4fe044be">model_polygon_plane_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, double Kpolyplane)</td></tr>
<tr class="memdesc:a8da857326b0810c24bbc5daa4fe044be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the polygon planarity energy and forces.  <a href="model__mechanics_8h.html#a8da857326b0810c24bbc5daa4fe044be">More...</a><br /></td></tr>
<tr class="separator:a8da857326b0810c24bbc5daa4fe044be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6dd499aa56d27ea9a2242adc07cc04d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#aa6dd499aa56d27ea9a2242adc07cc04d">model_neighbor_plane_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, double Kplane)</td></tr>
<tr class="memdesc:aa6dd499aa56d27ea9a2242adc07cc04d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the planarity energy and forces with respect to neighbors.  <a href="model__mechanics_8h.html#aa6dd499aa56d27ea9a2242adc07cc04d">More...</a><br /></td></tr>
<tr class="separator:aa6dd499aa56d27ea9a2242adc07cc04d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a251ae64cbdf6ff011001886c1e5b1337"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#a251ae64cbdf6ff011001886c1e5b1337">model_point_force</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; point, double Kpoint, double decay)</td></tr>
<tr class="memdesc:a251ae64cbdf6ff011001886c1e5b1337"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the forces and energy resulting from a single point force.  <a href="model__mechanics_8h.html#a251ae64cbdf6ff011001886c1e5b1337">More...</a><br /></td></tr>
<tr class="separator:a251ae64cbdf6ff011001886c1e5b1337"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3570cbe427325125243f2f030acf2b70"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#a3570cbe427325125243f2f030acf2b70">model_radial_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; point, double d0, double Kd)</td></tr>
<tr class="memdesc:a3570cbe427325125243f2f030acf2b70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the potential between a components and a point.  <a href="model__mechanics_8h.html#a3570cbe427325125243f2f030acf2b70">More...</a><br /></td></tr>
<tr class="separator:a3570cbe427325125243f2f030acf2b70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35695c0710d45ff27f12f7f5ff3f3472"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#a35695c0710d45ff27f12f7f5ff3f3472">model_guide_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;md)</td></tr>
<tr class="memdesc:a35695c0710d45ff27f12f7f5ff3f3472"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the potential with respect to a guide model.  <a href="model__mechanics_8h.html#a35695c0710d45ff27f12f7f5ff3f3472">More...</a><br /></td></tr>
<tr class="separator:a35695c0710d45ff27f12f7f5ff3f3472"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fccf8ef2d25e9332454fe8af95c8cb6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#a2fccf8ef2d25e9332454fe8af95c8cb6">model_polyhedron_guide_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="class_bmodel.html">Bmodel</a> *gmod, double Kguide)</td></tr>
<tr class="memdesc:a2fccf8ef2d25e9332454fe8af95c8cb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the potential with respect to a guide polyhedron.  <a href="model__mechanics_8h.html#a2fccf8ef2d25e9332454fe8af95c8cb6">More...</a><br /></td></tr>
<tr class="separator:a2fccf8ef2d25e9332454fe8af95c8cb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7d70e0e2285eddea66f5b028b3191da"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#aa7d70e0e2285eddea66f5b028b3191da">model_map_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="class_bimage.html">Bimage</a> *map, double Kmap)</td></tr>
<tr class="memdesc:aa7d70e0e2285eddea66f5b028b3191da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Energy calculation of a model into a map. <br  />
  <a href="model__mechanics_8h.html#aa7d70e0e2285eddea66f5b028b3191da">More...</a><br /></td></tr>
<tr class="separator:aa7d70e0e2285eddea66f5b028b3191da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9525b7792358d073985919e09fa95513"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#a9525b7792358d073985919e09fa95513">model_map_energy</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="class_bimage.html">Bimage</a> *map, double Kmap, double sigma)</td></tr>
<tr class="separator:a9525b7792358d073985919e09fa95513"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a000b5e3639275863d082973124a89b57"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#a000b5e3639275863d082973124a89b57">model_zero_forces</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>)</td></tr>
<tr class="memdesc:a000b5e3639275863d082973124a89b57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Zeroes the component forces.  <a href="model__mechanics_8h.html#a000b5e3639275863d082973124a89b57">More...</a><br /></td></tr>
<tr class="separator:a000b5e3639275863d082973124a89b57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaad79680c7e3577a4d6cd698371c2600"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#aaad79680c7e3577a4d6cd698371c2600">model_calculate_deviations</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>)</td></tr>
<tr class="memdesc:aaad79680c7e3577a4d6cd698371c2600"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the deviations from regularity in a polyhedral model.  <a href="model__mechanics_8h.html#aaad79680c7e3577a4d6cd698371c2600">More...</a><br /></td></tr>
<tr class="separator:aaad79680c7e3577a4d6cd698371c2600"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fd9e65f7adb7327c3fab4fb385bc29b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#a1fd9e65f7adb7327c3fab4fb385bc29b">model_calculate_deviations</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, <a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;md)</td></tr>
<tr class="separator:a1fd9e65f7adb7327c3fab4fb385bc29b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adba977349c6ecee3c9d8ef37b1e38a6b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__mechanics_8h.html#adba977349c6ecee3c9d8ef37b1e38a6b">model_regularize</a> (<a class="el" href="class_bmodel.html">Bmodel</a> *<a class="el" href="tcltk__bmodel_8cpp.html#a828359eaa8de833b547ac96934f43841">model</a>, int reg_iter, double <a class="el" href="_vector3_8h.html#aa60745aa4e45acde64f733424e37dbb9">distance</a>, double Kdistance, double Klink, double Kangle, double Kpoly, double Kpolyplane, double Kpoint, double decay)</td></tr>
<tr class="memdesc:adba977349c6ecee3c9d8ef37b1e38a6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Regularizes a model.  <a href="model__mechanics_8h.html#adba977349c6ecee3c9d8ef37b1e38a6b">More...</a><br /></td></tr>
<tr class="separator:adba977349c6ecee3c9d8ef37b1e38a6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Functions to do molecular mechanics. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20010828 </dd>
<dd>
Modified: 20210324 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a50aa3cd80e0c8953f88c44cd5795d08f" name="a50aa3cd80e0c8953f88c44cd5795d08f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50aa3cd80e0c8953f88c44cd5795d08f">&#9670;&nbsp;</a></span>model_angle_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_angle_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;&#160;</td>
          <td class="paramname"><em>md</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the model angular energy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">&amp;md</td><td>model parameters with reference angle specifications. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double angular energy. <pre class="fragment">The angular potential is a harmonic function:
    E = Ka*(a - a0)^2
The force is zero when a = reference angle (a0).
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="aaad79680c7e3577a4d6cd698371c2600" name="aaad79680c7e3577a4d6cd698371c2600"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaad79680c7e3577a4d6cd698371c2600">&#9670;&nbsp;</a></span>model_calculate_deviations() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int model_calculate_deviations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the deviations from regularity in a polyhedral model. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">Link deviation:
    d = sqrt(sum((l - l0)^2)/n)
where l is the length and l0 is the reference length.
Angle deviation:
    d = sqrt(sum((a - a0)^2)/n)
where a is the angle between two links and a0 is the reference angle:
    a0 = PI*(1 - 2/v)
where v is the number of vertices in the associated polygon.
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="a1fd9e65f7adb7327c3fab4fb385bc29b" name="a1fd9e65f7adb7327c3fab4fb385bc29b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fd9e65f7adb7327c3fab4fb385bc29b">&#9670;&nbsp;</a></span>model_calculate_deviations() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int model_calculate_deviations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;&#160;</td>
          <td class="paramname"><em>md</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7bdb91ae36845864133047f22b040f5e" name="a7bdb91ae36845864133047f22b040f5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bdb91ae36845864133047f22b040f5e">&#9670;&nbsp;</a></span>model_distance_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_distance_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;&#160;</td>
          <td class="paramname"><em>md</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the distance-related potentials between components. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">&amp;md</td><td>model parameters with distance interactions specifications. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double distance energy. <pre class="fragment">Distance potential types:
    0   none
    1   harmonic - only for explicit links
    2   soft
    3   Lennard-Jones
    4   Morse
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="ac66cb3db035b84b3b101aab34ac98448" name="ac66cb3db035b84b3b101aab34ac98448"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac66cb3db035b84b3b101aab34ac98448">&#9670;&nbsp;</a></span>model_electrostatic_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_electrostatic_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;&#160;</td>
          <td class="paramname"><em>md</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the electrostatic potentials between components. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">&amp;md</td><td>model parameters with distance interactions specifications. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double electrostatic energy. <pre class="fragment">Electrostaic potential:
    E = Ke*q1*q2/d
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="a12722f0e2ea53fee890d09ab69af0c4a" name="a12722f0e2ea53fee890d09ab69af0c4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12722f0e2ea53fee890d09ab69af0c4a">&#9670;&nbsp;</a></span>model_grid_distance_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_grid_distance_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;&#160;</td>
          <td class="paramname"><em>md</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the non-bonded forces and energy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">&amp;md</td><td>model parameters with distance interactions specifications. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double distance energy.</dd></dl>
<pre class="fragment">Distance potential types:
    0   none
    1   harmonic - only for explicit links
    2   soft
    3   Lennard-Jones
    4   Morse
</pre> 
</div>
</div>
<a id="a35695c0710d45ff27f12f7f5ff3f3472" name="a35695c0710d45ff27f12f7f5ff3f3472"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35695c0710d45ff27f12f7f5ff3f3472">&#9670;&nbsp;</a></span>model_guide_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_guide_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;&#160;</td>
          <td class="paramname"><em>md</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the potential with respect to a guide model. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">&amp;md</td><td>model aparameters. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double energy. <pre class="fragment">Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="a4c2c49fb2f38d28db1096f236a167b49" name="a4c2c49fb2f38d28db1096f236a167b49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c2c49fb2f38d28db1096f236a167b49">&#9670;&nbsp;</a></span>model_lennard_jones_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_lennard_jones_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>d0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the Lennard-Jones potential between components. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">Kd</td><td>distance force constant (Kd). </td></tr>
    <tr><td class="paramname">d0</td><td>reference distance between components (d0). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double distance energy. <pre class="fragment">The Lennard-Jones potential is given by:
    E = Kd*((d0/d)^12 - 2*(d0/d)^6)
The force is zero when d = d0.
The potential is set to zero for d &gt; 3*d0;
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="ae06d71db1e4a623f5cb69c4265349415" name="ae06d71db1e4a623f5cb69c4265349415"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae06d71db1e4a623f5cb69c4265349415">&#9670;&nbsp;</a></span>model_link_energy() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_link_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;&#160;</td>
          <td class="paramname"><em>md</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the model link energy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">&amp;md</td><td>model parameters with distance interactions specifications. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double distance energy. <pre class="fragment">The link potential is a harmonic function:
    E = Kl*(d - l0)^2
The force is zero when d = reference link length (l0).
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="a0a24f6e2ddd291d2707a3ca8038ef3d1" name="a0a24f6e2ddd291d2707a3ca8038ef3d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a24f6e2ddd291d2707a3ca8038ef3d1">&#9670;&nbsp;</a></span>model_link_energy() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_link_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Klink</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the model link energy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">Klink</td><td>link force constant (Kl). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double link energy. <pre class="fragment">The link potential is a harmonic function:
    E = Kl*(d - l0)^2
The force is zero when d = reference link length (l0).
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="aa7d70e0e2285eddea66f5b028b3191da" name="aa7d70e0e2285eddea66f5b028b3191da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7d70e0e2285eddea66f5b028b3191da">&#9670;&nbsp;</a></span>model_map_energy() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_map_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kmap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Energy calculation of a model into a map. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">*map</td><td>map. </td></tr>
    <tr><td class="paramname">Kmap</td><td>map force constant. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double energy. <pre class="fragment">The map must be possitive density.
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="a9525b7792358d073985919e09fa95513" name="a9525b7792358d073985919e09fa95513"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9525b7792358d073985919e09fa95513">&#9670;&nbsp;</a></span>model_map_energy() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_map_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a146c7646a40b4afc53f8fbf4ae0cb70c" name="a146c7646a40b4afc53f8fbf4ae0cb70c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a146c7646a40b4afc53f8fbf4ae0cb70c">&#9670;&nbsp;</a></span>model_mechanics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_mechanics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;&#160;</td>
          <td class="paramname"><em>md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mm_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>velocitylimit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Minimizes the energy of a model. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">&amp;md</td><td>model parameters. </td></tr>
    <tr><td class="paramname">mm_type</td><td>type of mechanics: 0=minimization, 1=dynamics </td></tr>
    <tr><td class="paramname">max_iter</td><td>number of minimization iterations. </td></tr>
    <tr><td class="paramname">max_shift</td><td>maximum shift per iteration. </td></tr>
    <tr><td class="paramname">velocitylimit</td><td>limit on velocity per time step. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double final energy. <pre class="fragment">The inclusion of energy terms is based on positive K-constants in the 
model parameter structure.
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="abfa114cb4ebf04dd000780ae3a56ab1a" name="abfa114cb4ebf04dd000780ae3a56ab1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfa114cb4ebf04dd000780ae3a56ab1a">&#9670;&nbsp;</a></span>model_minimize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int model_minimize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_shift</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Move components random distances down the energy gradient. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">max_shift</td><td>maximum shift for each component. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int number of components. <pre class="fragment">The distance of movement is limited to the maximum shift.
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="af9aadb8e44f9c9ea98332144fd1432da" name="af9aadb8e44f9c9ea98332144fd1432da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9aadb8e44f9c9ea98332144fd1432da">&#9670;&nbsp;</a></span>model_morse_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_morse_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>d0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the Morse potential between components. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">Kd</td><td>distance force constant (Kd). </td></tr>
    <tr><td class="paramname">d0</td><td>reference distance between components (d0). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double distance energy. <pre class="fragment">The Morse potential is given by:
    E = Kd*((1-exp((a/d0)*(d0-d)))^2 - 1)
The width of the energy well is given by a, set here to 6.
The force is zero when d = d0.
The potential is set to zero for d &gt; 3*d0;
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="adbd5167faccf5901241dae5fc4199a01" name="adbd5167faccf5901241dae5fc4199a01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbd5167faccf5901241dae5fc4199a01">&#9670;&nbsp;</a></span>model_neighbor_distance_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_neighbor_distance_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bmodparam.html">Bmodparam</a> &amp;&#160;</td>
          <td class="paramname"><em>md</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the distance-related potentials between components and their neighbors. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">&amp;md</td><td>model parameters with distance interactions specifications. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double distance energy. <pre class="fragment">Distance potential types:
    0   none
    1   harmonic - only for explicit links
    2   soft
    3   Lennard-Jones
    4   Morse
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="aa6dd499aa56d27ea9a2242adc07cc04d" name="aa6dd499aa56d27ea9a2242adc07cc04d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6dd499aa56d27ea9a2242adc07cc04d">&#9670;&nbsp;</a></span>model_neighbor_plane_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_neighbor_plane_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kplane</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the planarity energy and forces with respect to neighbors. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">Kplane</td><td>neighbor planarity constant. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double neighbor planar energy. <pre class="fragment">A plane is fit through the neigbor locations and the normal calculated from:
    n•p = d
where n is the normal vector, p is a point in the plane, and d is the offset.
The deviation of a component location from the neighbor plane is calculated
and converted to a harmonic energy and force.
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="a251ae64cbdf6ff011001886c1e5b1337" name="a251ae64cbdf6ff011001886c1e5b1337"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a251ae64cbdf6ff011001886c1e5b1337">&#9670;&nbsp;</a></span>model_point_force()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_point_force </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>decay</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the forces and energy resulting from a single point force. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">point</td><td>center of point force. </td></tr>
    <tr><td class="paramname">Kpoint</td><td>point force constant. </td></tr>
    <tr><td class="paramname">decay</td><td>energy decay with distance. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double point force energy. <pre class="fragment">The energy is defined as an exponential decay over distance from the 
center of the point force:
    Ep = Kp * exp(-decay*dist)
The force is the derivative of the energy:
    Fp = Kp * decay * dir * exp(-decay*dist)
where Kp is the point force constant, dist is the distance of the component 
from the center of the point force, decay is the energy decay with distance
from the point force center, and dir is the normalized direction vector
pointing from the point force center to the component, indicating the direction
of force.
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="a8c56f12a193aae669cadd550549876a2" name="a8c56f12a193aae669cadd550549876a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c56f12a193aae669cadd550549876a2">&#9670;&nbsp;</a></span>model_polygon_angle_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_polygon_angle_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kpolyangle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the link angular forces and energy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">Kpolyangle</td><td>angle force constant (Ka). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double total link angle energy. <pre class="fragment">The energy is defined as a harmonic function around the reference 
link angle, a0:
    Ea = Ka*(cos(a0)-r1*r2/(|r1|*|r2|))^2
    Ea = Ka*(a0 - a)^2
The force is the derivative of the energy on the first and last atoms:
    Fa1 = 2*Ka*(cos(a0)-r1*r2/(|r1|*|r2|))/(|r1|*|r2|) * ((r1*r2/|r1|)*r1-r2)
    Fa3 = 2*Ka*(cos(a0)-r1*r2/(|r1|*|r2|))/(|r1|*|r2|) * ((r1*r2/|r2|)*r2-r1)
where r1 is the vector from atom 2 to atom 1, r2 is the vector from
atom 2 to atom 3, and Ka is the link angle force constant.
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="a631dc257ac74698ad52f427cc4b8ab46" name="a631dc257ac74698ad52f427cc4b8ab46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a631dc257ac74698ad52f427cc4b8ab46">&#9670;&nbsp;</a></span>model_polygon_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_polygon_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kpoly</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the polygon regularity energy and forces. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">Kpoly</td><td>polygon regularity constant (Kp). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double polygon energy. <pre class="fragment">Given the distances of all the vertices from the polygon center, the
polygon regularity is defined as the deviation of these distances
from the average distance:
    E = Kp*(d - d0)
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="a8da857326b0810c24bbc5daa4fe044be" name="a8da857326b0810c24bbc5daa4fe044be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8da857326b0810c24bbc5daa4fe044be">&#9670;&nbsp;</a></span>model_polygon_plane_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_polygon_plane_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kpolyplane</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the polygon planarity energy and forces. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">Kpolyplane</td><td>polygon planarity constant. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double polygon planar energy. <pre class="fragment">A plane is fit through the polygon vertices and the normal calculated from:
    n•p = d
where n is the normal vector, p is a point in the plane, and d is the offset.
The polygon plane energy is calculated as a harmonic deviation from 
the fitted plane.
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="a2fccf8ef2d25e9332454fe8af95c8cb6" name="a2fccf8ef2d25e9332454fe8af95c8cb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fccf8ef2d25e9332454fe8af95c8cb6">&#9670;&nbsp;</a></span>model_polyhedron_guide_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_polyhedron_guide_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>gmod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kguide</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the potential with respect to a guide polyhedron. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">*gmod</td><td>guide polyhedron model. </td></tr>
    <tr><td class="paramname">Kguide</td><td>guide polyhedron force constant. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double energy. <pre class="fragment">Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="a3570cbe427325125243f2f030acf2b70" name="a3570cbe427325125243f2f030acf2b70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3570cbe427325125243f2f030acf2b70">&#9670;&nbsp;</a></span>model_radial_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_radial_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>d0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kradial</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the potential between a components and a point. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">point</td><td>reference point = radial center. </td></tr>
    <tr><td class="paramname">d0</td><td>reference distance between component and point. </td></tr>
    <tr><td class="paramname">Kradial</td><td>radial force constant. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double energy. <pre class="fragment">The radial potential is given by:
    E = Kd*(d - d0)^2
The force is zero when d = d0.
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="adba977349c6ecee3c9d8ef37b1e38a6b" name="adba977349c6ecee3c9d8ef37b1e38a6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adba977349c6ecee3c9d8ef37b1e38a6b">&#9670;&nbsp;</a></span>model_regularize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int model_regularize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kdistance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Klink</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kpolyangle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kpolygon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kpolyplane</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>decay</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Regularizes a model. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">max_iter</td><td>maximum number of iterations. </td></tr>
    <tr><td class="paramname">distance</td><td>reference distance. </td></tr>
    <tr><td class="paramname">Kdistance</td><td>distance strength constant. </td></tr>
    <tr><td class="paramname">Klink</td><td>link strength constant. </td></tr>
    <tr><td class="paramname">Kpolyangle</td><td>angle strength constant. </td></tr>
    <tr><td class="paramname">Kpolygon</td><td>polygon regularity constant. </td></tr>
    <tr><td class="paramname">Kpolyplane</td><td>polygon planarity constant. </td></tr>
    <tr><td class="paramname">Kpoint</td><td>force away from the center-of-mass. </td></tr>
    <tr><td class="paramname">decay</td><td>point force decay constant. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="ad0e5cb830160de53f08a59e03f408849" name="ad0e5cb830160de53f08a59e03f408849"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0e5cb830160de53f08a59e03f408849">&#9670;&nbsp;</a></span>model_soft_sphere_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_soft_sphere_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>d0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the soft sphere potential between components. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">Kd</td><td>distance force constant. </td></tr>
    <tr><td class="paramname">d0</td><td>reference distance between components. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double distance energy. <pre class="fragment">The soft sphere potential is given by:
    E = Kd*(d0/d)^12
The potential is set to zero for d &gt; 3*d0;
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="a4111f7274a1e0f313b249df84b8e1b8f" name="a4111f7274a1e0f313b249df84b8e1b8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4111f7274a1e0f313b249df84b8e1b8f">&#9670;&nbsp;</a></span>model_verlet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double model_verlet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kfriction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>velocitylimit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Model dynamics using the velocity verlet integrator. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model structure. </td></tr>
    <tr><td class="paramname">timestep</td><td>dynamics time step. </td></tr>
    <tr><td class="paramname">Kfriction</td><td>friction coefficient. </td></tr>
    <tr><td class="paramname">velocitylimit</td><td>limit on velocity per time step. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double kinetic energy. <pre class="fragment">Leapfrog integration for any coordinate x, velocity vx and force Fx:
    x(t+1) = x(t) + vx(t+1) * dt
    vx(t+1) = (Fx(t) * dt/m + vx(t)) * kf
    where
        kf: friction constant (1=no friction)
        dt: time step
        m: atomic mass
The velocity is limited each time step to damp chaotic oscillations.
Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
<a id="a000b5e3639275863d082973124a89b57" name="a000b5e3639275863d082973124a89b57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a000b5e3639275863d082973124a89b57">&#9670;&nbsp;</a></span>model_zero_forces()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int model_zero_forces </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmodel.html">Bmodel</a> *&#160;</td>
          <td class="paramname"><em>model</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Zeroes the component forces. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*model</td><td>model. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int number of components. <pre class="fragment">Only the first model in the linked list is used.
</pre> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="model__mechanics_8h.html">model_mechanics.h</a></li>
    <li class="footer">Generated on Fri Jan 7 2022 02:32:16 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
