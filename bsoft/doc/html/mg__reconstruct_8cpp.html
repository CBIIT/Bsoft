<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/heymannb/b20/bsoft/src/mg/mg_reconstruct.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Bsoft<span id="projectnumber">&#160;2.1.4</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mg__reconstruct_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">mg_reconstruct.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Functions for reconstruction.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="rwimg_8h.html">rwimg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rwmg_8h.html">rwmg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__processing_8h.html">mg_processing.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__select_8h.html">mg_select.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__img__proc_8h.html">mg_img_proc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__particle__select_8h.html">mg_particle_select.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__reconstruct_8h.html">mg_reconstruct.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__ctf_8h.html">mg_ctf.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_complex_8h.html">Complex.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="symmetry_8h.html">symmetry.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h.html">utilities.h</a>&quot;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a81d17eab7781b85c904af0fd99709e73"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__reconstruct_8cpp.html#a81d17eab7781b85c904af0fd99709e73">part_ft_size</a> (int xsize, double scale, int pad_factor)</td></tr>
<tr class="memdesc:a81d17eab7781b85c904af0fd99709e73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the Fourier transform size for 2D particle images for reconstruction.  <a href="mg__reconstruct_8cpp.html#a81d17eab7781b85c904af0fd99709e73">More...</a><br /></td></tr>
<tr class="separator:a81d17eab7781b85c904af0fd99709e73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a001580b07ad193703695641a0c2f2585"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__reconstruct_8cpp.html#a001580b07ad193703695641a0c2f2585">particle_reconstruct</a> (<a class="el" href="class_bparticle.html">Bparticle</a> *partlist, <a class="el" href="struct_bsymmetry.html">Bsymmetry</a> sym, int sym_mode, double hi_res, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; scale, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; sam, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; <a class="el" href="use__ctf_8inc.html#a7a2f2f92a2bbfc2ea0b2e85f0056ca4e">size</a>, int ft_size, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> plan, int interp_type, int ctf_action, double wiener, int flags, int first)</td></tr>
<tr class="memdesc:a001580b07ad193703695641a0c2f2585"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reciprocal space reconstruction from 2D particle images. <br  />
  <a href="mg__reconstruct_8cpp.html#a001580b07ad193703695641a0c2f2585">More...</a><br /></td></tr>
<tr class="separator:a001580b07ad193703695641a0c2f2585"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb0c8e2ac475204ab4f3eb0a2ec3cbef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__reconstruct_8cpp.html#abb0c8e2ac475204ab4f3eb0a2ec3cbef">img_reconstruction_sum_weigh</a> (<a class="el" href="class_bimage.html">Bimage</a> **pacc, int imap, int nmaps, int maps_per_class, double hi_res)</td></tr>
<tr class="memdesc:abb0c8e2ac475204ab4f3eb0a2ec3cbef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Combines and weighs a map from several partial maps and weight sets.  <a href="mg__reconstruct_8cpp.html#abb0c8e2ac475204ab4f3eb0a2ec3cbef">More...</a><br /></td></tr>
<tr class="separator:abb0c8e2ac475204ab4f3eb0a2ec3cbef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1473f6c21ea9b14436952e5fbca48090"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__reconstruct_8cpp.html#a1473f6c21ea9b14436952e5fbca48090">part_single_reconstruction</a> (<a class="el" href="class_bparticle.html">Bparticle</a> *part, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; <a class="el" href="use__ctf_8inc.html#a7a2f2f92a2bbfc2ea0b2e85f0056ca4e">size</a>, <a class="el" href="class_bimage.html">Bimage</a> *pmask, <a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;sym, double hi_res, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; scale, int ft_size, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> img_plan, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> map_plan, double part_weight, int interp_type, <a class="el" href="class_c_t_fparam.html">CTFparam</a> *<a class="el" href="mg__ctf_8cpp.html#a217ecae60a6e430b2e864dde5785d21a">mg_ctf</a>, int ctf_action, double wiener, int flags)</td></tr>
<tr class="separator:a1473f6c21ea9b14436952e5fbca48090"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa2656b1cbf40f2ab7f2490409208ebf"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__reconstruct_8cpp.html#aaa2656b1cbf40f2ab7f2490409208ebf">project_single_particle_reconstruction</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bstring.html">Bstring</a> &amp;maskfile, <a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;sym, int num_select, double hi_res, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; scale, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; <a class="el" href="use__ctf_8inc.html#a7a2f2f92a2bbfc2ea0b2e85f0056ca4e">size</a>, int pad_factor, int interp_type, int ctf_action, double wiener, int flags)</td></tr>
<tr class="memdesc:aaa2656b1cbf40f2ab7f2490409208ebf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reciprocal space reconstruction from the images in a multi-image file. <br  />
  <a href="mg__reconstruct_8cpp.html#aaa2656b1cbf40f2ab7f2490409208ebf">More...</a><br /></td></tr>
<tr class="separator:aaa2656b1cbf40f2ab7f2490409208ebf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af68b4886851b0f53162dc2cd5a61065f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__reconstruct_8cpp.html#af68b4886851b0f53162dc2cd5a61065f">project_set_reconstruction_size</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; &amp;sam, double scale, int twoD_flag)</td></tr>
<tr class="memdesc:af68b4886851b0f53162dc2cd5a61065f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the reconstruction size for reconstruction from 2D particle images.  <a href="mg__reconstruct_8cpp.html#af68b4886851b0f53162dc2cd5a61065f">More...</a><br /></td></tr>
<tr class="separator:af68b4886851b0f53162dc2cd5a61065f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2872555a4044e6545a2a381917021dba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__reconstruct_8cpp.html#a2872555a4044e6545a2a381917021dba">project_configure_for_reconstruction</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bstring.html">Bstring</a> classes, long &amp;nmaps, int &amp;nthreads)</td></tr>
<tr class="memdesc:a2872555a4044e6545a2a381917021dba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the particle selection for reconstruction.  <a href="mg__reconstruct_8cpp.html#a2872555a4044e6545a2a381917021dba">More...</a><br /></td></tr>
<tr class="separator:a2872555a4044e6545a2a381917021dba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18bc54563a593f78691392e34be2b2cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__reconstruct_8cpp.html#a18bc54563a593f78691392e34be2b2cc">project_update_class_averages</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *prec, <a class="el" href="class_bstring.html">Bstring</a> file_name)</td></tr>
<tr class="separator:a18bc54563a593f78691392e34be2b2cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae46730e56cd97358b9251706bb25136c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__reconstruct_8cpp.html#ae46730e56cd97358b9251706bb25136c">project_reconstruct_2D</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bstring.html">Bstring</a> file_name, int transform_output)</td></tr>
<tr class="memdesc:ae46730e56cd97358b9251706bb25136c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a 2D reconstruction from the images in a multi-image file. <br  />
  <a href="mg__reconstruct_8cpp.html#ae46730e56cd97358b9251706bb25136c">More...</a><br /></td></tr>
<tr class="separator:ae46730e56cd97358b9251706bb25136c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5d2ffb32e26de883f9c0e68f71890ec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bparticle.html">Bparticle</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__reconstruct_8cpp.html#aa5d2ffb32e26de883f9c0e68f71890ec">img_reconstruct_2D</a> (long i, <a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *prec, double hires, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</a>, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a9ec8849996c5e210d7b7e8e05b98639d">planb</a>)</td></tr>
<tr class="separator:aa5d2ffb32e26de883f9c0e68f71890ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbf4b3ef489379ce0442371259d4f007"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__reconstruct_8cpp.html#abbf4b3ef489379ce0442371259d4f007">img_reconstruct_2D_fspace</a> (long i, <a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *prec, double hires, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</a>, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a9ec8849996c5e210d7b7e8e05b98639d">planb</a>)</td></tr>
<tr class="separator:abbf4b3ef489379ce0442371259d4f007"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f1c451254ca7bc1aa9b980c8d1351af"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__reconstruct_8cpp.html#a4f1c451254ca7bc1aa9b980c8d1351af">project_reconstruct_2D_fast</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bstring.html">Bstring</a> file_name)</td></tr>
<tr class="separator:a4f1c451254ca7bc1aa9b980c8d1351af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02f63c36cf79f84653041f1f7011397a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__reconstruct_8cpp.html#a02f63c36cf79f84653041f1f7011397a">project_reconstruct_3D</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, long selnum, int calcfom, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; <a class="el" href="use__ctf_8inc.html#a7a2f2f92a2bbfc2ea0b2e85f0056ca4e">size</a>)</td></tr>
<tr class="memdesc:a02f63c36cf79f84653041f1f7011397a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transforms 3D maps and calculates an average.  <a href="mg__reconstruct_8cpp.html#a02f63c36cf79f84653041f1f7011397a">More...</a><br /></td></tr>
<tr class="separator:a02f63c36cf79f84653041f1f7011397a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a163fa705032f58094f60c2c9a94d5ff8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__reconstruct_8cpp.html#a163fa705032f58094f60c2c9a94d5ff8">project_reconstruct_3D</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, long selnum, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; <a class="el" href="use__ctf_8inc.html#a7a2f2f92a2bbfc2ea0b2e85f0056ca4e">size</a>, double resolution)</td></tr>
<tr class="memdesc:a163fa705032f58094f60c2c9a94d5ff8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transforms 3D maps and calculates an average.  <a href="mg__reconstruct_8cpp.html#a163fa705032f58094f60c2c9a94d5ff8">More...</a><br /></td></tr>
<tr class="separator:a163fa705032f58094f60c2c9a94d5ff8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a310d60884e17c978575b8d611e2f05f9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__reconstruct_8cpp.html#a310d60884e17c978575b8d611e2f05f9">project_back_projection</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, long num_select, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; map_size, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; sam, double scale, double resolution, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</a>, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a9ec8849996c5e210d7b7e8e05b98639d">planb</a>)</td></tr>
<tr class="memdesc:a310d60884e17c978575b8d611e2f05f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Back projects a set of 2D images into a 3D volume.  <a href="mg__reconstruct_8cpp.html#a310d60884e17c978575b8d611e2f05f9">More...</a><br /></td></tr>
<tr class="separator:a310d60884e17c978575b8d611e2f05f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0ea5fc1090fb4f67195ef9cefc85718"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__reconstruct_8cpp.html#ae0ea5fc1090fb4f67195ef9cefc85718">img_backprojection_accumulate</a> (<a class="el" href="class_bimage.html">Bimage</a> **pacc, int imap, int nmaps, int nthreads)</td></tr>
<tr class="memdesc:ae0ea5fc1090fb4f67195ef9cefc85718"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accumulates multiple backprojections.  <a href="mg__reconstruct_8cpp.html#ae0ea5fc1090fb4f67195ef9cefc85718">More...</a><br /></td></tr>
<tr class="separator:ae0ea5fc1090fb4f67195ef9cefc85718"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__reconstruct_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Functions for reconstruction. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20010403 </dd>
<dd>
Modified: 20220221 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ae0ea5fc1090fb4f67195ef9cefc85718" name="ae0ea5fc1090fb4f67195ef9cefc85718"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0ea5fc1090fb4f67195ef9cefc85718">&#9670;&nbsp;</a></span>img_backprojection_accumulate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_backprojection_accumulate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> **&#160;</td>
          <td class="paramname"><em>pacc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>imap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nmaps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nthreads</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accumulates multiple backprojections. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">**pacc</td><td>array of partial maps with linked weight maps. </td></tr>
    <tr><td class="paramname">imap</td><td>which output map to weigh. </td></tr>
    <tr><td class="paramname">nmaps</td><td>number of output maps (1,2,3). </td></tr>
    <tr><td class="paramname">nthreads</td><td>number of threads per map (= number of partial maps). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. </dd></dl>

</div>
</div>
<a id="aa5d2ffb32e26de883f9c0e68f71890ec" name="aa5d2ffb32e26de883f9c0e68f71890ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5d2ffb32e26de883f9c0e68f71890ec">&#9670;&nbsp;</a></span>img_reconstruct_2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bparticle.html">Bparticle</a> * img_reconstruct_2D </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>prec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abbf4b3ef489379ce0442371259d4f007" name="abbf4b3ef489379ce0442371259d4f007"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbf4b3ef489379ce0442371259d4f007">&#9670;&nbsp;</a></span>img_reconstruct_2D_fspace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long img_reconstruct_2D_fspace </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>prec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abb0c8e2ac475204ab4f3eb0a2ec3cbef" name="abb0c8e2ac475204ab4f3eb0a2ec3cbef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb0c8e2ac475204ab4f3eb0a2ec3cbef">&#9670;&nbsp;</a></span>img_reconstruction_sum_weigh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_reconstruction_sum_weigh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> **&#160;</td>
          <td class="paramname"><em>pacc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>imap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nmaps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maps_per_class</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Combines and weighs a map from several partial maps and weight sets. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">**pacc</td><td>array of partial maps with linked weight maps. </td></tr>
    <tr><td class="paramname">imap</td><td>which output map to weigh. </td></tr>
    <tr><td class="paramname">nmaps</td><td>number of output maps (1,2,3). </td></tr>
    <tr><td class="paramname">maps_per_class</td><td>number of threads per map (= number of partial maps). </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* weighed reconstruction with FOM block. <pre class="fragment">The input is a set of partially integrated complex maps with associated 
weigths as follows:
    voxel power sums            FOM block of map.
    voxel weight sums           linked image.
    voxel weight squared sums   linked image FOM block.
The partial sums are completed into corresponding blocks in three possible
ways based on the value of imap and nmap:
    nmap    imap    result
    1       0       one map from all input maps
    2       0,1     one map from half of the input maps
    3       0       one map from all input maps
    3       1,2     one map from half of the input maps
The total number of maps in the array is nclasses*nmaps.
</pre> </dd></dl>

</div>
</div>
<a id="a81d17eab7781b85c904af0fd99709e73" name="a81d17eab7781b85c904af0fd99709e73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81d17eab7781b85c904af0fd99709e73">&#9670;&nbsp;</a></span>part_ft_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int part_ft_size </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>xsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pad_factor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the Fourier transform size for 2D particle images for reconstruction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xsize</td><td>size of x dimension. </td></tr>
    <tr><td class="paramname">scale</td><td>scale of reconstruction. </td></tr>
    <tr><td class="paramname">pad_factor</td><td>factor that determines image padding. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int transform size. <pre class="fragment">The reconstruction size must be set.
</pre> </dd></dl>

</div>
</div>
<a id="a1473f6c21ea9b14436952e5fbca48090" name="a1473f6c21ea9b14436952e5fbca48090"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1473f6c21ea9b14436952e5fbca48090">&#9670;&nbsp;</a></span>part_single_reconstruction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double part_single_reconstruction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bparticle.html">Bparticle</a> *&#160;</td>
          <td class="paramname"><em>part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ft_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>img_plan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>map_plan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>part_weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interp_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_c_t_fparam.html">CTFparam</a> *&#160;</td>
          <td class="paramname"><em>mg_ctf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ctf_action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiener</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a001580b07ad193703695641a0c2f2585" name="a001580b07ad193703695641a0c2f2585"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a001580b07ad193703695641a0c2f2585">&#9670;&nbsp;</a></span>particle_reconstruct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * particle_reconstruct </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bparticle.html">Bparticle</a> *&#160;</td>
          <td class="paramname"><em>partlist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bsymmetry.html">Bsymmetry</a>&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sym_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>sam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ft_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>plan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interp_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ctf_action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiener</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>first</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reciprocal space reconstruction from 2D particle images. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*partlist</td><td>a list of 2D particle image parameters. </td></tr>
    <tr><td class="paramname">*sym</td><td>point group symmetry. </td></tr>
    <tr><td class="paramname">sym_mode</td><td>0=apply symmetry, 1=C1, 2=random symmetry view </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">scale</td><td>scale of reconstruction. </td></tr>
    <tr><td class="paramname">sam</td><td>sampling/voxel size of reconstruction. </td></tr>
    <tr><td class="paramname">size</td><td>size of reconstruction. </td></tr>
    <tr><td class="paramname">ft_size</td><td>Fourier transform size. </td></tr>
    <tr><td class="paramname">plan</td><td>Fourier transform plan. </td></tr>
    <tr><td class="paramname">interp_type</td><td>interpolation type. </td></tr>
    <tr><td class="paramname">ctf_action</td><td>flag to apply CTF to projections. </td></tr>
    <tr><td class="paramname">wiener</td><td>Wiener factor. </td></tr>
    <tr><td class="paramname">flags</td><td>1=rescale particles, 2=2D reconstruction, 4=bootstrap, 8=Ewald. </td></tr>
    <tr><td class="paramname">first</td><td>flag to indicate the first thread. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* 3D reconstructed map. <pre class="fragment">The orientation parameters, view vector, angle of rotation and origin,
must all be set. Each image is padded to at least two times its size 
and its Fourier transform packed into 3D reciprocal space.
The figure-of-merit calculated for each reciprocal space voxel is:
           sum(w*re)^2 + sum(w*im)^2
    FOM = ---------------------------
          sum(w)*sum(w*(re^2 + im^2))
where
    re  real part
    im  imaginary part
    w   weight (inverse distance of image pixel to closest grid point)
For voxels with only one data pixel contributing to it, FOM = 0.
A bootstrap reconstruction uses the particle selection to weigh each
selected particle.
</pre> </dd></dl>

</div>
</div>
<a id="a310d60884e17c978575b8d611e2f05f9" name="a310d60884e17c978575b8d611e2f05f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a310d60884e17c978575b8d611e2f05f9">&#9670;&nbsp;</a></span>project_back_projection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * project_back_projection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>num_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>map_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>sam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Back projects a set of 2D images into a 3D volume. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>image processing parameter structure. </td></tr>
    <tr><td class="paramname">num_select</td><td>selection number from the selection column. </td></tr>
    <tr><td class="paramname">map_size</td><td>3-valued vector for the new map size. </td></tr>
    <tr><td class="paramname">sam</td><td>3-value vector for the voxel size in angstrom. </td></tr>
    <tr><td class="paramname">scale</td><td>reconstruction scale. </td></tr>
    <tr><td class="paramname">resolution</td><td>resolution for low-pass filtering. </td></tr>
    <tr><td class="paramname">planf</td><td>2D forward Fourier transform plan. </td></tr>
    <tr><td class="paramname">planb</td><td>2D backward Fourier transform plan. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* the new 3D reconstruction map. <pre class="fragment">All the information needed to do a 3D reconstruction is passed in through
an image processing structure. The new 3D volume is initialized.
Each sub-image in each particle file is read individually and 
back-projected within the new volume. The orientation parameters from
the image processing structure is transferred to the sub-image
structure in the 2D image before calling the function packing one
image into the volume. The default origin is the center of the image.
</pre> </dd></dl>

</div>
</div>
<a id="a2872555a4044e6545a2a381917021dba" name="a2872555a4044e6545a2a381917021dba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2872555a4044e6545a2a381917021dba">&#9670;&nbsp;</a></span>project_configure_for_reconstruction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int project_configure_for_reconstruction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a>&#160;</td>
          <td class="paramname"><em>classes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long &amp;&#160;</td>
          <td class="paramname"><em>nmaps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>nthreads</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up the particle selection for reconstruction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">classes</td><td>string specifying classes to use. </td></tr>
    <tr><td class="paramname">nmaps</td><td>number of maps per class (1,2,3). </td></tr>
    <tr><td class="paramname">nthreads</td><td>number of threads per class (must be even if nmaps &gt; 1). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int number of classes. <pre class="fragment">The classes are specified in a string of comma-separated numbers,
also allowing hyphened ranges (e.g., "2,5-7,9").
The selection numbers for the particles in the project are set to
calculate partial maps so that there are nthread maps per class.
Each such partial map will be calculated in its own thread and
integrated with others from the same class afterwards.
</pre> </dd></dl>

</div>
</div>
<a id="ae46730e56cd97358b9251706bb25136c" name="ae46730e56cd97358b9251706bb25136c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae46730e56cd97358b9251706bb25136c">&#9670;&nbsp;</a></span>project_reconstruct_2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * project_reconstruct_2D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a>&#160;</td>
          <td class="paramname"><em>file_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>transform_output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a 2D reconstruction from the images in a multi-image file. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>image processing parameter structure. </td></tr>
    <tr><td class="paramname">file_name</td><td>2D reconstruction file name. </td></tr>
    <tr><td class="paramname">transform_output</td><td>flag to output transformed images. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* 2D reconstruction image. <pre class="fragment">The angle of rotation and the x,y origins must already have been found 
and placed in the appropriate arrays within the Bproject structure.
Each selected image is transformed, and then added to the reconstruction
image corresponding to the original projection image chosen.
If the transform_output flag is set, then the transformed images are written
into a new image with a "_proj.spi" ending.
</pre> </dd></dl>

</div>
</div>
<a id="a4f1c451254ca7bc1aa9b980c8d1351af" name="a4f1c451254ca7bc1aa9b980c8d1351af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f1c451254ca7bc1aa9b980c8d1351af">&#9670;&nbsp;</a></span>project_reconstruct_2D_fast()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * project_reconstruct_2D_fast </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a>&#160;</td>
          <td class="paramname"><em>file_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a02f63c36cf79f84653041f1f7011397a" name="a02f63c36cf79f84653041f1f7011397a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02f63c36cf79f84653041f1f7011397a">&#9670;&nbsp;</a></span>project_reconstruct_3D() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * project_reconstruct_3D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>selnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>calcfom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transforms 3D maps and calculates an average. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>parameter structure with all parameters. </td></tr>
    <tr><td class="paramname">selnum</td><td>selection number of reconstructions or particles. </td></tr>
    <tr><td class="paramname">calcfom</td><td>flag to calculate FOM block (1=var, 2=std). </td></tr>
    <tr><td class="paramname">size</td><td>size of particles to extract (only when extraction needed). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* average map with FOM block defined. <pre class="fragment">The orientations of the maps in the project must already be specified.
Each map is transformed and added to an average map.
A FOM block is optionally calculated with either the variance or
standard deviation.
</pre> </dd></dl>

</div>
</div>
<a id="a163fa705032f58094f60c2c9a94d5ff8" name="a163fa705032f58094f60c2c9a94d5ff8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a163fa705032f58094f60c2c9a94d5ff8">&#9670;&nbsp;</a></span>project_reconstruct_3D() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * project_reconstruct_3D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>selnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transforms 3D maps and calculates an average. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>parameter structure with all parameters. </td></tr>
    <tr><td class="paramname">selnum</td><td>selection number of reconstructions or particles. </td></tr>
    <tr><td class="paramname">size</td><td>size of particles to extract (only when extraction needed). </td></tr>
    <tr><td class="paramname">resolution</td><td>maximum reconstruction resolution (in angstrom, default Nyquest). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* average map with FOM block defined. <pre class="fragment">The orientations of the maps in the project must already be specified.
Each map is transformed and added to an average map.
A FOM block is optionally calculated with either the variance or
standard deviation.
</pre> </dd></dl>

</div>
</div>
<a id="af68b4886851b0f53162dc2cd5a61065f" name="af68b4886851b0f53162dc2cd5a61065f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af68b4886851b0f53162dc2cd5a61065f">&#9670;&nbsp;</a></span>project_set_reconstruction_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; project_set_reconstruction_size </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>sam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>twoD_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the reconstruction size for reconstruction from 2D particle images. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">&amp;sam</td><td>sampling/voxel size of new map. </td></tr>
    <tr><td class="paramname">scale</td><td>scale of reconstruction. </td></tr>
    <tr><td class="paramname">twoD_flag</td><td>doing a 2D reconstruction rather than 3D. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="class_vector3.html">Vector3&lt;long&gt;</a> reconstruction size. <pre class="fragment">The reconstruction size is set from the first particle image size found.
</pre> </dd></dl>

</div>
</div>
<a id="aaa2656b1cbf40f2ab7f2490409208ebf" name="aaa2656b1cbf40f2ab7f2490409208ebf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa2656b1cbf40f2ab7f2490409208ebf">&#9670;&nbsp;</a></span>project_single_particle_reconstruction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long project_single_particle_reconstruction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>maskfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_bsymmetry.html">Bsymmetry</a> &amp;&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pad_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interp_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ctf_action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiener</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reciprocal space reconstruction from the images in a multi-image file. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>image processing parameter structure. </td></tr>
    <tr><td class="paramname">&amp;maskfile</td><td>mask to determine density statistics. </td></tr>
    <tr><td class="paramname">*sym</td><td>point group symmetry. </td></tr>
    <tr><td class="paramname">num_select</td><td>selection number from the selection column. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">scale</td><td>scale of reconstruction. </td></tr>
    <tr><td class="paramname">size</td><td>size of reconstruction. </td></tr>
    <tr><td class="paramname">pad_factor</td><td>image padding factor. </td></tr>
    <tr><td class="paramname">interp_type</td><td>interpolation type (provisional). </td></tr>
    <tr><td class="paramname">ctf_action</td><td>flag to apply CTF to projections. </td></tr>
    <tr><td class="paramname">wiener</td><td>Wiener factor. </td></tr>
    <tr><td class="paramname">flags</td><td>option flags. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long particles processed. <pre class="fragment">The orientation parameters, view vector, angle of rotation and origin,
must all be set. Each image is padded to at least two times its size 
and its Fourier transform packed into 3D reciprocal space.
The figure-of-merit calculated for each reciprocal space voxel is:
           sum(w*re)^2 + sum(w*im)^2
    FOM = ---------------------------
          sum(w)*sum(w*(re^2 + im^2))
where
    re  real part
    im  imaginary part
    w   weight (inverse distance of image pixel to closest grid point)
For voxels with only one data pixel contributing to it, FOM = 0.
An image is used in the reconstruction if its selection flag has been set.
If the selection number is less than zero, all particles with selection flags
greater than zero are used. If the selection number is zero or above, all
particles with the selection flag set to the same number are used.
A bootstrap reconstruction uses the particle selection to weigh each
selected particle.
</pre> </dd></dl>

</div>
</div>
<a id="a18bc54563a593f78691392e34be2b2cc" name="a18bc54563a593f78691392e34be2b2cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18bc54563a593f78691392e34be2b2cc">&#9670;&nbsp;</a></span>project_update_class_averages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int project_update_class_averages </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>prec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a>&#160;</td>
          <td class="paramname"><em>file_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0b2caeb4b6f130be43e5a2f0267dd453" name="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2caeb4b6f130be43e5a2f0267dd453">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_1d197ef0d9947f4cc1ac44e7f59e2b57.html">mg</a></li><li class="navelem"><a class="el" href="mg__reconstruct_8cpp.html">mg_reconstruct.cpp</a></li>
    <li class="footer">Generated on Tue Jan 31 2023 08:21:29 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
