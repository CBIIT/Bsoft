<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Bsoft: /usr/local/bsoft/include/img_complex.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Bsoft
   &#160;<span id="projectnumber">1.9</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('img__complex_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">img_complex.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions to handle complex data sets.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="rwimg_8h_source.html">rwimg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="kernel_8h_source.html">kernel.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_complex_8h_source.html">Complex.h</a>&quot;</code><br />
</div>
<p><a href="img__complex_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a87d171ceff1c532653016814bfdf06eb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__complex_8h.html#a87d171ceff1c532653016814bfdf06eb">img_complex_product</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *p2)</td></tr>
<tr class="memdesc:a87d171ceff1c532653016814bfdf06eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the complex product of two complex images.  <a href="#a87d171ceff1c532653016814bfdf06eb">More...</a><br /></td></tr>
<tr class="separator:a87d171ceff1c532653016814bfdf06eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5457063137a04a7d00db5d3226b1fef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__complex_8h.html#aa5457063137a04a7d00db5d3226b1fef">img_complex_conjugate_product</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *p2)</td></tr>
<tr class="memdesc:aa5457063137a04a7d00db5d3226b1fef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the product of a complex image with the conjugate of a second.  <a href="#aa5457063137a04a7d00db5d3226b1fef">More...</a><br /></td></tr>
<tr class="separator:aa5457063137a04a7d00db5d3226b1fef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd0b333653e127d638d276d6d0a22672"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__complex_8h.html#afd0b333653e127d638d276d6d0a22672">img_complex_apply_mask</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pmask)</td></tr>
<tr class="memdesc:afd0b333653e127d638d276d6d0a22672"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies a mask to a complex image.  <a href="#afd0b333653e127d638d276d6d0a22672">More...</a><br /></td></tr>
<tr class="separator:afd0b333653e127d638d276d6d0a22672"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad55fffec02b415531bbc41905c0458b4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__complex_8h.html#ad55fffec02b415531bbc41905c0458b4">img_complex_apply_negative_mask</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pmask)</td></tr>
<tr class="memdesc:ad55fffec02b415531bbc41905c0458b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies a mask to a complex image.  <a href="#ad55fffec02b415531bbc41905c0458b4">More...</a><br /></td></tr>
<tr class="separator:ad55fffec02b415531bbc41905c0458b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3388d481d1de82f78d3c94a404a304be"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__complex_8h.html#a3388d481d1de82f78d3c94a404a304be">img_complex_apply_dual_mask</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pmask)</td></tr>
<tr class="memdesc:a3388d481d1de82f78d3c94a404a304be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies a dual mask to a complex image.  <a href="#a3388d481d1de82f78d3c94a404a304be">More...</a><br /></td></tr>
<tr class="separator:a3388d481d1de82f78d3c94a404a304be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a130756fa4563e893782c32684c13faa5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__complex_8h.html#a130756fa4563e893782c32684c13faa5">img_complex_bandpass</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, float hires, float lores)</td></tr>
<tr class="memdesc:a130756fa4563e893782c32684c13faa5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bandpasses a Fourier transform.  <a href="#a130756fa4563e893782c32684c13faa5">More...</a><br /></td></tr>
<tr class="separator:a130756fa4563e893782c32684c13faa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ff2ba759326f96edaa23cca9f477b01"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__complex_8h.html#a0ff2ba759326f96edaa23cca9f477b01">img_pack_two_in_complex</a> (<a class="el" href="class_bimage.html">Bimage</a> *p1, <a class="el" href="class_bimage.html">Bimage</a> *p2)</td></tr>
<tr class="memdesc:a0ff2ba759326f96edaa23cca9f477b01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Packs two real images into one complex image.  <a href="#a0ff2ba759326f96edaa23cca9f477b01">More...</a><br /></td></tr>
<tr class="separator:a0ff2ba759326f96edaa23cca9f477b01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a17c3ea86395dc89fdc5a3ed6a11c5c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__complex_8h.html#a0a17c3ea86395dc89fdc5a3ed6a11c5c">img_unpack_combined_transform</a> (<a class="el" href="class_bimage.html">Bimage</a> *p)</td></tr>
<tr class="memdesc:a0a17c3ea86395dc89fdc5a3ed6a11c5c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unpacks a complex transform obtained from two real images.  <a href="#a0a17c3ea86395dc89fdc5a3ed6a11c5c">More...</a><br /></td></tr>
<tr class="separator:a0a17c3ea86395dc89fdc5a3ed6a11c5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f050870c49d0d17370e0642a0a406b2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__complex_8h.html#a0f050870c49d0d17370e0642a0a406b2">img_combined_complex_product</a> (<a class="el" href="class_bimage.html">Bimage</a> *p)</td></tr>
<tr class="memdesc:a0f050870c49d0d17370e0642a0a406b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images.  <a href="#a0f050870c49d0d17370e0642a0a406b2">More...</a><br /></td></tr>
<tr class="separator:a0f050870c49d0d17370e0642a0a406b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afffb0216e1f2bcca2fc5c9a0469ba164"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__complex_8h.html#afffb0216e1f2bcca2fc5c9a0469ba164">img_combined_masked_complex_product</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pmask)</td></tr>
<tr class="memdesc:afffb0216e1f2bcca2fc5c9a0469ba164"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images.  <a href="#afffb0216e1f2bcca2fc5c9a0469ba164">More...</a><br /></td></tr>
<tr class="separator:afffb0216e1f2bcca2fc5c9a0469ba164"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a7596c44e2b5606f2d27267aae1927b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__complex_8h.html#a5a7596c44e2b5606f2d27267aae1927b">img_combined_bandpass_complex_product</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, float hires, float lores)</td></tr>
<tr class="memdesc:a5a7596c44e2b5606f2d27267aae1927b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images.  <a href="#a5a7596c44e2b5606f2d27267aae1927b">More...</a><br /></td></tr>
<tr class="separator:a5a7596c44e2b5606f2d27267aae1927b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a211870f8212dc5686636c59cccedf612"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__complex_8h.html#a211870f8212dc5686636c59cccedf612">img_combined_bandpass_masked_complex_product</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, float hires, float lores, <a class="el" href="class_bimage.html">Bimage</a> *pmask)</td></tr>
<tr class="memdesc:a211870f8212dc5686636c59cccedf612"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images.  <a href="#a211870f8212dc5686636c59cccedf612">More...</a><br /></td></tr>
<tr class="separator:a211870f8212dc5686636c59cccedf612"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd8f738afcc5a1e742a1c373425a4838"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__complex_8h.html#afd8f738afcc5a1e742a1c373425a4838">img_merge_amplitudes_and_phases</a> (<a class="el" href="class_bimage.html">Bimage</a> *pamp, <a class="el" href="class_bimage.html">Bimage</a> *p)</td></tr>
<tr class="memdesc:afd8f738afcc5a1e742a1c373425a4838"><td class="mdescLeft">&#160;</td><td class="mdescRight">Merges the amplitudes from one map with the phases of another.  <a href="#afd8f738afcc5a1e742a1c373425a4838">More...</a><br /></td></tr>
<tr class="separator:afd8f738afcc5a1e742a1c373425a4838"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc35363fa196d6b1c07b822f15a21d2f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="img__complex_8h.html#acc35363fa196d6b1c07b822f15a21d2f">img_merge_amplitudes_and_phases</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *pref, float res_hi, float res_lo)</td></tr>
<tr class="memdesc:acc35363fa196d6b1c07b822f15a21d2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keeps selected phases and replaces amplitudes and other phases from a reference transform.  <a href="#acc35363fa196d6b1c07b822f15a21d2f">More...</a><br /></td></tr>
<tr class="separator:acc35363fa196d6b1c07b822f15a21d2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions to handle complex data sets. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 19990424 Modified: 20120214 </dd></dl>

<p>Definition in file <a class="el" href="img__complex_8h_source.html">img_complex.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a5a7596c44e2b5606f2d27267aae1927b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_combined_bandpass_complex_product </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>lores</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image (replaced by new image). </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. <pre class="fragment">Requirement: Fourier transform of two images packed into one complex
    data block with the function img_pack_two_in_complex and then
    transformed with the function img_fft.
The Friedel relationships in transforms from real space images are
exploited to transform two images simultaneously and then extract
the individual transforms from the complex data set.
This function extracts the individual transforms and calculates the 
complex conjugate product used in cross-correlation.
The result is scaled by the total power of the two transforms within
the resolution limits, yielding the correlation coefficient when
the product is backtransformed into the cross-correlation map.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__complex_8cpp_source.html#l00589">589</a> of file <a class="el" href="img__complex_8cpp_source.html">img_complex.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a211870f8212dc5686636c59cccedf612"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_combined_bandpass_masked_complex_product </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>lores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image (replaced by new image). </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">*pmask</td><td>binary mask (only 0 and 1), NULL if not desired. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. <pre class="fragment">Requirement: Fourier transform of two images packed into one complex
    data block with the function img_pack_two_in_complex and then
    transformed with the function img_fft.
The Friedel relationships in transforms from real space images are
exploited to transform two images simultaneously and then extract
the individual transforms from the complex data set.
This function extracts the individual transforms and calculates the 
complex conjugate product used in cross-correlation.
The result is scaled by the total power of the two transforms within
the resolution limits, yielding the correlation coefficient when
the product is backtransformed into the cross-correlation map.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__complex_8cpp_source.html#l00712">712</a> of file <a class="el" href="img__complex_8cpp_source.html">img_complex.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0f050870c49d0d17370e0642a0a406b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_combined_complex_product </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image (replaced by new image). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. <pre class="fragment">Requirement: Fourier transform of two images packed into one complex
    data block with the function img_pack_two_in_complex and then
    transformed with the function img_fft.
The Friedel relationships in transforms from real space images are
exploited to transform two images simultaneously and then extract
the individual transforms from the complex data set.
This function extracts the individual transforms and calculates the 
complex conjugate product used in cross-correlation.
The result is scaled by the total power of the two transforms, yielding 
the correlation coefficient when the product is backtransformed into 
the cross-correlation map.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__complex_8cpp_source.html#l00404">404</a> of file <a class="el" href="img__complex_8cpp_source.html">img_complex.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="afffb0216e1f2bcca2fc5c9a0469ba164"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_combined_masked_complex_product </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image (replaced by new image). </td></tr>
    <tr><td class="paramname">*pmask</td><td>binary mask (only 0 and 1), NULL if not desired. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. <pre class="fragment">Requirement: Fourier transform of two images packed into one complex
    data block with the function img_pack_two_in_complex and then
    transformed with the function img_fft.
The Friedel relationships in transforms from real space images are
exploited to transform two images simultaneously and then extract
the individual transforms from the complex data set.
This function extracts the individual transforms and calculates the 
complex conjugate product used in cross-correlation.
The result is scaled by the total power of the two transforms, yielding 
the correlation coefficient when the product is backtransformed into 
the cross-correlation map.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__complex_8cpp_source.html#l00494">494</a> of file <a class="el" href="img__complex_8cpp_source.html">img_complex.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a3388d481d1de82f78d3c94a404a304be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_complex_apply_dual_mask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies a dual mask to a complex image. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>complex image (replaced by new image). </td></tr>
    <tr><td class="paramname">*pmask</td><td>mask (converted to floating point). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. <pre class="fragment">The mask is applied to an image, generating two images, the first 
with values retained where the mask is positive, and the second with
values where the mask is negative.
The input image is replaced and the second is created and linked to
the first.
Requirement: The two input images must be the same size.
No statistics are calculated.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__complex_8cpp_source.html#l00155">155</a> of file <a class="el" href="img__complex_8cpp_source.html">img_complex.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="afd0b333653e127d638d276d6d0a22672"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_complex_apply_mask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies a mask to a complex image. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>complex image (replaced by new image). </td></tr>
    <tr><td class="paramname">*pmask</td><td>mask (converted to floating point). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. <pre class="fragment">Wherever the mask is &lt;= 0, the data is set to zero.
Requirement: The two images must be the same size.
No statistics are calculated.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__complex_8cpp_source.html#l00091">91</a> of file <a class="el" href="img__complex_8cpp_source.html">img_complex.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad55fffec02b415531bbc41905c0458b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_complex_apply_negative_mask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies a mask to a complex image. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>complex image (replaced by new image). </td></tr>
    <tr><td class="paramname">*pmask</td><td>mask (converted to floating point). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. <pre class="fragment">Wherever the mask is &gt;= 0, the data is set to zero.
Requirement: The two images must be the same size.
No statistics are calculated.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__complex_8cpp_source.html#l00121">121</a> of file <a class="el" href="img__complex_8cpp_source.html">img_complex.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a130756fa4563e893782c32684c13faa5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_complex_bandpass </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>hires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>lores</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Bandpasses a Fourier transform. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>image (replaced by new image). </td></tr>
    <tr><td class="paramname">hires</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lores</td><td>low resolution limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. <pre class="fragment">Requirement: a complex Fourier transform.
All data outside the band limits are set to zero.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__complex_8cpp_source.html#l00190">190</a> of file <a class="el" href="img__complex_8cpp_source.html">img_complex.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa5457063137a04a7d00db5d3226b1fef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_complex_conjugate_product </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the product of a complex image with the conjugate of a second. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>first complex image (replaced by new image). </td></tr>
    <tr><td class="paramname">*p2</td><td>second complex image. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. <pre class="fragment">Complex conjugate product:
    (a + ib)*(c - id) = (a*c + b*d) + i(b*c - a*d).
Requirement: The two images must be the same size.
No statistics are calculated.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__complex_8cpp_source.html#l00061">61</a> of file <a class="el" href="img__complex_8cpp_source.html">img_complex.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a87d171ceff1c532653016814bfdf06eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_complex_product </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the complex product of two complex images. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>first complex image (replaced by new image). </td></tr>
    <tr><td class="paramname">*p2</td><td>second complex image. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. <pre class="fragment">Complex product:
    (a + ib)*(c + id) = (a*c - b*d) + i(b*c + a*d).
Requirement: The two images must be the same size.
No statistics are calculated.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__complex_8cpp_source.html#l00030">30</a> of file <a class="el" href="img__complex_8cpp_source.html">img_complex.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="afd8f738afcc5a1e742a1c373425a4838"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_merge_amplitudes_and_phases </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pamp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Merges the amplitudes from one map with the phases of another. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*pamp</td><td>amplitude image (simple or complex). </td></tr>
    <tr><td class="paramname">*p</td><td>image (amplitudes replaced by new image). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double RMSD of amplitudes. <pre class="fragment">The amplitude image can be a floating point image or a complex image.
The phase image must be complex and its amplitudes are replaced by
the values from the amplitude image.
No statistics are calculated.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__complex_8cpp_source.html#l00830">830</a> of file <a class="el" href="img__complex_8cpp_source.html">img_complex.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="acc35363fa196d6b1c07b822f15a21d2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double img_merge_amplitudes_and_phases </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>res_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>res_lo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Keeps selected phases and replaces amplitudes and other phases from a reference transform. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>Fourier transform (replaced by new image). </td></tr>
    <tr><td class="paramname">*pref</td><td>reference Fourier transform. </td></tr>
    <tr><td class="paramname">res_hi</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">res_lo</td><td>low resolution limit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double RMSD of amplitudes. <pre class="fragment">The input transform is considered to be modified in some way (such as solvent flattening).
Only the phases in the specified resolution shell are kept, while all
the other phases and amplitudes within the high resolution limit is
retrieved from the reference transform.
No statistics are calculated.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__complex_8cpp_source.html#l00879">879</a> of file <a class="el" href="img__complex_8cpp_source.html">img_complex.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0ff2ba759326f96edaa23cca9f477b01"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_pack_two_in_complex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Packs two real images into one complex image. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p1</td><td>first image. </td></tr>
    <tr><td class="paramname">*p2</td><td>second image. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* the new complex image, NULL on error. <pre class="fragment">Two real space images are packed into the real and imaginary parts
of a new data block with conversion from the original non-complex type.
The header values of the first image are adopted for the new image.
No statistics are calculated.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__complex_8cpp_source.html#l00255">255</a> of file <a class="el" href="img__complex_8cpp_source.html">img_complex.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0a17c3ea86395dc89fdc5a3ed6a11c5c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* img_unpack_combined_transform </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unpacks a complex transform obtained from two real images. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>combined transform, modified to hold transform of first image. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* transform of second image. <pre class="fragment">The complex image must be a Fourier transform obtained from two real 
space images which were packed into the real and imaginary parts
of the complex image before Fourier transformation.
The input image is used to hold the transform of the first image.
A new image is created to hold the transform of the second image.
Both these images are complex floating point.
Note: Images with even dimensions cannot be unpacked exactly because
    the inverse is not present when x=nx/2 or y=ny/2 or z=nz/2.</pre> </dd></dl>

<p>Definition at line <a class="el" href="img__complex_8cpp_source.html#l00331">331</a> of file <a class="el" href="img__complex_8cpp_source.html">img_complex.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="img__complex_8h.html">img_complex.h</a></li>
    <li class="footer">Generated on Mon Jul 13 2015 18:45:01 for Bsoft by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
