<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/heymannb/b20/bsoft/include/mg_tomo_resol.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Bsoft<span id="projectnumber">&#160;2.1.4</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mg__tomo__resol_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">mg_tomo_resol.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Functions to assess the resoltion of a tomographic tilt series.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="mg__processing_8h.html">mg_processing.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ps__plot_8h.html">ps_plot.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rwimg_8h.html">rwimg.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a12f6b691a687f8570bc8089501f89bd4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__resol_8h.html#a12f6b691a687f8570bc8089501f89bd4">mg_tomo_resolution</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int micrograph_id, double hi_res, double sampling_ratio, double scale, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; <a class="el" href="use__ctf_8inc.html#a7a2f2f92a2bbfc2ea0b2e85f0056ca4e">size</a>, double fast_angle, int action, double wiener, double cutoff, <a class="el" href="class_bstring.html">Bstring</a> &amp;psfile)</td></tr>
<tr class="memdesc:a12f6b691a687f8570bc8089501f89bd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimating the resolution of one micrograph in an aligned tilt series. <br  />
  <a href="mg__tomo__resol_8h.html#a12f6b691a687f8570bc8089501f89bd4">More...</a><br /></td></tr>
<tr class="separator:a12f6b691a687f8570bc8089501f89bd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb7121aa4173e95f1f9ec0b40d7ba702"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="class_bplot.html">Bplot</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__resol_8h.html#aeb7121aa4173e95f1f9ec0b40d7ba702">project_tomo_resolution</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, double hi_res, double sampling_ratio, double scale, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; <a class="el" href="use__ctf_8inc.html#a7a2f2f92a2bbfc2ea0b2e85f0056ca4e">size</a>, double fast_angle, int action, double wiener, double cutoff)</td></tr>
<tr class="memdesc:aeb7121aa4173e95f1f9ec0b40d7ba702"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimating the resolution of the tomogram from an aligned tilt series.  <a href="mg__tomo__resol_8h.html#aeb7121aa4173e95f1f9ec0b40d7ba702">More...</a><br /></td></tr>
<tr class="separator:aeb7121aa4173e95f1f9ec0b40d7ba702"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68a445fc201201a532a023750ff08909"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bplot.html">Bplot</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__resol_8h.html#a68a445fc201201a532a023750ff08909">project_tomo_particle_resolution</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, double hi_res, double sampling_ratio, double fast_angle, double cutoff)</td></tr>
<tr class="memdesc:a68a445fc201201a532a023750ff08909"><td class="mdescLeft">&#160;</td><td class="mdescRight">Estimates the resolution for each particle image in each micrograph.  <a href="mg__tomo__resol_8h.html#a68a445fc201201a532a023750ff08909">More...</a><br /></td></tr>
<tr class="separator:a68a445fc201201a532a023750ff08909"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8789d31ce267667e92cf614797e3a850"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__resol_8h.html#a8789d31ce267667e92cf614797e3a850">img_pack_2D_into_central_section</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bimage.html">Bimage</a> *prec, <a class="el" href="class_bimage.html">Bimage</a> *prec2, long ft_size, double scale, double hi_res, <a class="el" href="class_matrix3.html">Matrix3</a> matr, <a class="el" href="class_matrix3.html">Matrix3</a> mat, int inplane)</td></tr>
<tr class="memdesc:a8789d31ce267667e92cf614797e3a850"><td class="mdescLeft">&#160;</td><td class="mdescRight">Packs a 2D Fourier transform into a 3D reciprocal space volume. <br  />
  <a href="mg__tomo__resol_8h.html#a8789d31ce267667e92cf614797e3a850">More...</a><br /></td></tr>
<tr class="separator:a8789d31ce267667e92cf614797e3a850"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae28e85f54ebe7b1dc4ead60b759eabe0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bplot.html">Bplot</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__tomo__resol_8h.html#ae28e85f54ebe7b1dc4ead60b759eabe0">plot_tilt_resolution</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>)</td></tr>
<tr class="memdesc:ae28e85f54ebe7b1dc4ead60b759eabe0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plots the estimated resolution against the tilt angle.  <a href="mg__tomo__resol_8h.html#ae28e85f54ebe7b1dc4ead60b759eabe0">More...</a><br /></td></tr>
<tr class="separator:ae28e85f54ebe7b1dc4ead60b759eabe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Functions to assess the resoltion of a tomographic tilt series. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20031205 </dd>
<dd>
Modified: 20200723 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a8789d31ce267667e92cf614797e3a850" name="a8789d31ce267667e92cf614797e3a850"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8789d31ce267667e92cf614797e3a850">&#9670;&nbsp;</a></span>img_pack_2D_into_central_section()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long img_pack_2D_into_central_section </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>prec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>prec2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>ft_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_matrix3.html">Matrix3</a>&#160;</td>
          <td class="paramname"><em>matr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_matrix3.html">Matrix3</a>&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>inplane</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Packs a 2D Fourier transform into a 3D reciprocal space volume. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*p</td><td>2D Fourier transform. </td></tr>
    <tr><td class="paramname">*prec</td><td>3D central section. </td></tr>
    <tr><td class="paramname">*prec2</td><td>3D central section with in-plane micrograph omitted. </td></tr>
    <tr><td class="paramname">ft_size</td><td>Fourier transform size. </td></tr>
    <tr><td class="paramname">scale</td><td>reconstruction scale. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">matr</td><td>in plane or reference matrix. </td></tr>
    <tr><td class="paramname">mat</td><td>matrix of image being packed. </td></tr>
    <tr><td class="paramname">inplane</td><td>flag to indicate an in plane image. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long number voxels packed. <pre class="fragment">The rotation matrix is used to determine the plane in reciprocal space
to which the 2D transform data is added. The map is assumed to be cubic
and the 2D transform square. The orientation parameters must be written
into the image structure. The real space 2D image must be supplied.
This is then padded to more than twice its original size, fourier
transformed, and packed into the 3D reciprocal space block.
</pre> </dd></dl>

</div>
</div>
<a id="a12f6b691a687f8570bc8089501f89bd4" name="a12f6b691a687f8570bc8089501f89bd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12f6b691a687f8570bc8089501f89bd4">&#9670;&nbsp;</a></span>mg_tomo_resolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * mg_tomo_resolution </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>micrograph_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sampling_ratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fast_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiener</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>psfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Estimating the resolution of one micrograph in an aligned tilt series. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>image processing parameter structure. </td></tr>
    <tr><td class="paramname">micrograph_id</td><td>micrograph number to use for resolution test. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">sampling_ratio</td><td>ratio for averaging window. </td></tr>
    <tr><td class="paramname">scale</td><td>reconstruction scale. </td></tr>
    <tr><td class="paramname">size</td><td>reconstruction size. </td></tr>
    <tr><td class="paramname">fast_angle</td><td>angle to select micrographs for reconstruction. </td></tr>
    <tr><td class="paramname">action</td><td>flag to apply CTF to projections. </td></tr>
    <tr><td class="paramname">wiener</td><td>Wiener factor. </td></tr>
    <tr><td class="paramname">cutoff</td><td>FRC cutoff. </td></tr>
    <tr><td class="paramname">&amp;psfile</td><td>postscript output file name. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* micrograph reconstruction, NULL on error. <pre class="fragment">The orientation parameters, view vector, angle of rotation and origin,
must all be set. Each image is padded to at least two times its size 
and its Fourier transform packed into 3D reciprocal space.
The figure-of-merit calculated for each reciprocal space voxel is:
           sum(w*re)^2 + sum(w*im)^2
    FOM = ---------------------------
          sum(w)*sum(w*(re^2 + im^2))
where
    re  real part
    im  imaginary part
    w   weight (inverse distance of image pixel to closest grid point)
For voxels with only one data pixel contributing to it, FOM(0).
An image is used in the reconstruction if its selection flag has been set.
If the selection number is less than zero, all particles with selection flags
greater than zero are used. If the selection number is zero or above, all
particles with the selection flag set to the same number are used.
</pre> </dd></dl>

</div>
</div>
<a id="ae28e85f54ebe7b1dc4ead60b759eabe0" name="ae28e85f54ebe7b1dc4ead60b759eabe0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae28e85f54ebe7b1dc4ead60b759eabe0">&#9670;&nbsp;</a></span>plot_tilt_resolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bplot.html">Bplot</a> * plot_tilt_resolution </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Plots the estimated resolution against the tilt angle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>*plot new plot. <pre class="fragment">The resolution estimates must be encoded in the micrograph FOM's.
</pre> </dd></dl>

</div>
</div>
<a id="a68a445fc201201a532a023750ff08909" name="a68a445fc201201a532a023750ff08909"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68a445fc201201a532a023750ff08909">&#9670;&nbsp;</a></span>project_tomo_particle_resolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bplot.html">Bplot</a> * project_tomo_particle_resolution </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sampling_ratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fast_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Estimates the resolution for each particle image in each micrograph. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>micrograph project. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit for resolution estimation. </td></tr>
    <tr><td class="paramname">sampling_ratio</td><td>ratio for averaging window. </td></tr>
    <tr><td class="paramname">fast_angle</td><td>angle to select micrographs for reconstruction. </td></tr>
    <tr><td class="paramname">cutoff</td><td>FRC cutoff to use. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bplot* plot with average particle resolutions. <pre class="fragment">Requires the particles to be defined in all micrographs.
The NLOO algorithm is used for each particle.
</pre> </dd></dl>

</div>
</div>
<a id="aeb7121aa4173e95f1f9ec0b40d7ba702" name="aeb7121aa4173e95f1f9ec0b40d7ba702"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb7121aa4173e95f1f9ec0b40d7ba702">&#9670;&nbsp;</a></span>project_tomo_resolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; <a class="el" href="class_bplot.html">Bplot</a> * &gt; project_tomo_resolution </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sampling_ratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fast_angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiener</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Estimating the resolution of the tomogram from an aligned tilt series. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>image processing parameter structure. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">sampling_ratio</td><td>ratio for averaging window. </td></tr>
    <tr><td class="paramname">scale</td><td>reconstruction scale. </td></tr>
    <tr><td class="paramname">size</td><td>reconstruction size. </td></tr>
    <tr><td class="paramname">fast_angle</td><td>angle to select micrographs for reconstruction. </td></tr>
    <tr><td class="paramname">action</td><td>flag to apply CTF to projections. </td></tr>
    <tr><td class="paramname">wiener</td><td>Wiener factor. </td></tr>
    <tr><td class="paramname">cutoff</td><td>FRC cutoff. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>vector&lt;Bplot*&gt; Two plots: Tilt-resolution and NLOO-3D. <pre class="fragment">The orientation parameters, view vector, angle of rotation and origin,
must all be set. Each image is padded to at least two times its size
and its Fourier transform packed into 3D reciprocal space.
The figure-of-merit calculated for each reciprocal space voxel is:
           sum(w*re)^2 + sum(w*im)^2
    FOM = ---------------------------
          sum(w)*sum(w*(re^2 + im^2))
where
    re  real part
    im  imaginary part
    w   weight (inverse distance of image pixel to closest grid point)
For voxels with only one data pixel contributing to it, FOM(0).
An image is used in the reconstruction if its selection flag has been set.
If the selection number is less than zero, all particles with selection flags
greater than zero are used. If the selection number is zero or above, all
particles with the selection flag set to the same number are used.
</pre> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="mg__tomo__resol_8h.html">mg_tomo_resol.h</a></li>
    <li class="footer">Generated on Tue Jan 31 2023 08:21:29 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
