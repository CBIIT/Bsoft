<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/bernard/b20/bsoft/include/mg_align.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bsoft
   &#160;<span id="projectnumber">2.1.0</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('mg__align_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mg_align.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for functions to align micrographs or coordinates from micrographs and apply the resultant transformation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="mg__processing_8h_source.html">mg_processing.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_bimage_8h_source.html">Bimage.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_vector3_8h_source.html">Vector3.h</a>&quot;</code><br />
</div>
<p><a href="mg__align_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9662f805dd1b4f10fb35674c1d8fa69b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8h.html#a9662f805dd1b4f10fb35674c1d8fa69b">mg_align_coordinates</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int refset)</td></tr>
<tr class="memdesc:a9662f805dd1b4f10fb35674c1d8fa69b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aligns the particle coordinates of a series of micrographs.  <a href="mg__align_8h.html#a9662f805dd1b4f10fb35674c1d8fa69b">More...</a><br /></td></tr>
<tr class="separator:a9662f805dd1b4f10fb35674c1d8fa69b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fe2a50ea1061b8f0363d1fec7330524"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8h.html#a0fe2a50ea1061b8f0363d1fec7330524">mg_align_micrographs</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int refset, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; tile_size, double res_lo, double res_hi, double max_shift, int filter_flag, int refine_flag)</td></tr>
<tr class="memdesc:a0fe2a50ea1061b8f0363d1fec7330524"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aligns a focal series of micrographs.  <a href="mg__align_8h.html#a0fe2a50ea1061b8f0363d1fec7330524">More...</a><br /></td></tr>
<tr class="separator:a0fe2a50ea1061b8f0363d1fec7330524"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d2476a740a9726a32dc3b6015793e4a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8h.html#a5d2476a740a9726a32dc3b6015793e4a">mg_align_feature_extraction</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int max_features, double res_low, double res_high, double thresh, int extract_method)</td></tr>
<tr class="memdesc:a5d2476a740a9726a32dc3b6015793e4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aligns images by feature extraction.  <a href="mg__align_8h.html#a5d2476a740a9726a32dc3b6015793e4a">More...</a><br /></td></tr>
<tr class="separator:a5d2476a740a9726a32dc3b6015793e4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a1dc07a0b30cc4755662a41bb53f4fd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8h.html#a0a1dc07a0b30cc4755662a41bb53f4fd">mg_apply_transform</a> (<a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg_ref, <a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg_apply)</td></tr>
<tr class="memdesc:a0a1dc07a0b30cc4755662a41bb53f4fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies a transformation to particle coordinates in a reference micrograph and writes them into an application micrograph structure.  <a href="mg__align_8h.html#a0a1dc07a0b30cc4755662a41bb53f4fd">More...</a><br /></td></tr>
<tr class="separator:a0a1dc07a0b30cc4755662a41bb53f4fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a464413c7113e0c2f2da01c8164d4f5a1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8h.html#a464413c7113e0c2f2da01c8164d4f5a1">mg_merge_focal_series</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int use_old_origins)</td></tr>
<tr class="memdesc:a464413c7113e0c2f2da01c8164d4f5a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Merges corresponding particle images in each focal series.  <a href="mg__align_8h.html#a464413c7113e0c2f2da01c8164d4f5a1">More...</a><br /></td></tr>
<tr class="separator:a464413c7113e0c2f2da01c8164d4f5a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace439539f332c99632dcc732f9c9968a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8h.html#ace439539f332c99632dcc732f9c9968a">project_write_aligned_averages</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *pgr, <a class="el" href="class_bstring.html">Bstring</a> &amp;imgfile, <a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a> datatype, <a class="el" href="class_bstring.html">Bstring</a> &amp;subset)</td></tr>
<tr class="memdesc:ace439539f332c99632dcc732f9c9968a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates aligned micrograph images and write them to a file.  <a href="mg__align_8h.html#ace439539f332c99632dcc732f9c9968a">More...</a><br /></td></tr>
<tr class="separator:ace439539f332c99632dcc732f9c9968a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7754952d044cebe0d3a2661e8d6af68a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8h.html#a7754952d044cebe0d3a2661e8d6af68a">project_write_aligned_images</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *pgr, <a class="el" href="class_bstring.html">Bstring</a> &amp;imgfile, <a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a> datatype)</td></tr>
<tr class="memdesc:a7754952d044cebe0d3a2661e8d6af68a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates aligned micrograph images and write them to a file.  <a href="mg__align_8h.html#a7754952d044cebe0d3a2661e8d6af68a">More...</a><br /></td></tr>
<tr class="separator:a7754952d044cebe0d3a2661e8d6af68a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8af9c3c5398e68320b9aa88a9bf8a843"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8h.html#a8af9c3c5398e68320b9aa88a9bf8a843">project_write_frame_sums</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *pgr, <a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a> datatype, <a class="el" href="class_bstring.html">Bstring</a> &amp;subset, int flag)</td></tr>
<tr class="memdesc:a8af9c3c5398e68320b9aa88a9bf8a843"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sums aligned micrograph frames and write them to files.  <a href="mg__align_8h.html#a8af9c3c5398e68320b9aa88a9bf8a843">More...</a><br /></td></tr>
<tr class="separator:a8af9c3c5398e68320b9aa88a9bf8a843"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d30ced1e779ece210b97432bc464a86"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8h.html#a2d30ced1e779ece210b97432bc464a86">project_align_frames</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int ref_img, long window, long step, <a class="el" href="class_bimage.html">Bimage</a> *pgr, <a class="el" href="class_bimage.html">Bimage</a> *pmask, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; origin, double hi_res, double lo_res, double shift_limit, double edge_width, double gauss_width, long bin, <a class="el" href="class_bstring.html">Bstring</a> &amp;subset, int flag)</td></tr>
<tr class="memdesc:a2d30ced1e779ece210b97432bc464a86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aligns a series of micrographs by cross-correlation.  <a href="mg__align_8h.html#a2d30ced1e779ece210b97432bc464a86">More...</a><br /></td></tr>
<tr class="separator:a2d30ced1e779ece210b97432bc464a86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac102016c32c7fa2b5d72c778168982fe"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8h.html#ac102016c32c7fa2b5d72c778168982fe">project_align_series</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int ref_img, <a class="el" href="class_bimage.html">Bimage</a> *pgr, <a class="el" href="class_bimage.html">Bimage</a> *pmask, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; origin, double hi_res, double lo_res, double shift_limit, double edge_width, double gauss_width, long bin, <a class="el" href="class_bstring.html">Bstring</a> &amp;subset, int flag)</td></tr>
<tr class="memdesc:ac102016c32c7fa2b5d72c778168982fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aligns a series of micrographs by cross-correlation.  <a href="mg__align_8h.html#ac102016c32c7fa2b5d72c778168982fe">More...</a><br /></td></tr>
<tr class="separator:ac102016c32c7fa2b5d72c778168982fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18bf12d13294a4ea9db00e47cd5e7e23"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8h.html#a18bf12d13294a4ea9db00e47cd5e7e23">mg_tomo_reconstruct2D</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, long dimg, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; size, double scale, double hi_res)</td></tr>
<tr class="memdesc:a18bf12d13294a4ea9db00e47cd5e7e23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reconstructs the zero-tilt image of a tilt-series.  <a href="mg__align_8h.html#a18bf12d13294a4ea9db00e47cd5e7e23">More...</a><br /></td></tr>
<tr class="separator:a18bf12d13294a4ea9db00e47cd5e7e23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a286ff99aa89b275a1b02a048b80e05c3"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8h.html#a286ff99aa89b275a1b02a048b80e05c3">project_tomo_align</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, long thickness, long iter, double dchange, long dimg, double resolution, double shift_limit, double edge_width, double gauss_width)</td></tr>
<tr class="memdesc:a286ff99aa89b275a1b02a048b80e05c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aligns a series of micrographs by cross-correlation sequentially.  <a href="mg__align_8h.html#a286ff99aa89b275a1b02a048b80e05c3">More...</a><br /></td></tr>
<tr class="separator:a286ff99aa89b275a1b02a048b80e05c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a652a4146eb754826c2dac44f7e9fae7d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8h.html#a652a4146eb754826c2dac44f7e9fae7d">project_ssnr</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>)</td></tr>
<tr class="separator:a652a4146eb754826c2dac44f7e9fae7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada9c136fd7095cb136327087a9096656"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8h.html#ada9c136fd7095cb136327087a9096656">project_frames_snr</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, double res_hi, double sampling_ratio, long window, <a class="el" href="class_bstring.html">Bstring</a> &amp;subset, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; tile_size, int flag)</td></tr>
<tr class="memdesc:ada9c136fd7095cb136327087a9096656"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the estimated SNR from aligned movie frames.  <a href="mg__align_8h.html#ada9c136fd7095cb136327087a9096656">More...</a><br /></td></tr>
<tr class="separator:ada9c136fd7095cb136327087a9096656"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for functions to align micrographs or coordinates from micrographs and apply the resultant transformation. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann and Samuel Payne </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20000505 </dd>
<dd>
Modified: 20210805 </dd></dl>

<p class="definition">Definition in file <a class="el" href="mg__align_8h_source.html">mg_align.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a9662f805dd1b4f10fb35674c1d8fa69b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9662f805dd1b4f10fb35674c1d8fa69b">&#9670;&nbsp;</a></span>mg_align_coordinates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mg_align_coordinates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>refset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aligns the particle coordinates of a series of micrographs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">refset</td><td>reference image or set of coordinates (-1 means undefined). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">The sets of micrograph coordinates of a focal series in an image 
processing parameter structure are fitted to each other, giving a 
rotation angle, and shifting and scaling in x and y for each pair 
of micrographs.
There must be the same number of particles in each micrograph
of a focal series.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__align_8cpp_source.html#l00043">43</a> of file <a class="el" href="mg__align_8cpp_source.html">mg_align.cpp</a>.</p>

</div>
</div>
<a id="a5d2476a740a9726a32dc3b6015793e4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d2476a740a9726a32dc3b6015793e4a">&#9670;&nbsp;</a></span>mg_align_feature_extraction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mg_align_feature_extraction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_low</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_high</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>extract_method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aligns images by feature extraction. </p>
<dl class="section author"><dt>Author</dt><dd>Samuel Payne </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>the set of image parameters </td></tr>
    <tr><td class="paramname">max_features</td><td>the maximum number of features to extract </td></tr>
    <tr><td class="paramname">res_low</td><td>the low resolution limit </td></tr>
    <tr><td class="paramname">res_high</td><td>the high resolution limit </td></tr>
    <tr><td class="paramname">thresh</td><td>threshold used for feature extraction </td></tr>
    <tr><td class="paramname">extract_method</td><td>method used for finding the center of particles </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code.</dd></dl>
<p>Calculates the transformation parameters for each set images, by picking features in the images and finding the best fit for the matching of the features.</p>
<p>The features are picked and returned using function <a class="el" href="mg__align_8cpp.html#acb712377db79369631608242a639a93b">img_extract_features()</a>. The set of features is sent to find_transform_params() that finds the transformation parameters that relate the images to each other. The shift in xy directions, the scale in xy directions, and rotation angle is returned. The program works best if the images have at least 40 distinct features. </p>

<p class="definition">Definition at line <a class="el" href="mg__align_8cpp_source.html#l00550">550</a> of file <a class="el" href="mg__align_8cpp_source.html">mg_align.cpp</a>.</p>

</div>
</div>
<a id="a0fe2a50ea1061b8f0363d1fec7330524"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fe2a50ea1061b8f0363d1fec7330524">&#9670;&nbsp;</a></span>mg_align_micrographs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mg_align_micrographs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>refset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>tile_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>filter_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>refine_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aligns a focal series of micrographs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>parameter structure. </td></tr>
    <tr><td class="paramname">refset</td><td>reference image or set of coordinates (&lt; 1 means undefined). </td></tr>
    <tr><td class="paramname">tile_size</td><td>3-valued vector for the size of sub-images. </td></tr>
    <tr><td class="paramname">res_lo</td><td>low resolution limit for cross-correlation. </td></tr>
    <tr><td class="paramname">res_hi</td><td>high resolution limit for cross-correlation. </td></tr>
    <tr><td class="paramname">max_shift</td><td>maximum shift allowed (default 1/4 of tile). </td></tr>
    <tr><td class="paramname">filter_flag</td><td>flag to filter micrograph extremes. </td></tr>
    <tr><td class="paramname">refine_flag</td><td>flag to turn on refinement of shift. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0, &lt;0 on error. <pre class="fragment">A series of micrograph images specified in an image processing 
parameter structure are aligned by segmented cross-correlation. The 
micrograph data blocks are assumed to be arranged with a series in
consequent data blocks. The micrographs are segmented into tiles 
and the tile shifts with respect to each other determined by 
cross-correlation. The shifts are assumed to most accurately 
represent the displacement of the center of one tile with respect 
to the center of the corresponding tile in the other micrograph.
The resultant sets of coordinates are fitted to each
other, giving a 3-value shift vector, a 3-value scale vector,
and a rotation angle for each pair of micrographs.
A reference micrograph is chosen as:
    1.  the first micrograph with particle coordinates
    2.  otherwise, the first micrograph
If coordinates are supplied for particles in the reference micrograph,
the determined transformation parameters are applied and written into
the other micrograph structures.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__align_8cpp_source.html#l00324">324</a> of file <a class="el" href="mg__align_8cpp_source.html">mg_align.cpp</a>.</p>

</div>
</div>
<a id="a0a1dc07a0b30cc4755662a41bb53f4fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a1dc07a0b30cc4755662a41bb53f4fd">&#9670;&nbsp;</a></span>mg_apply_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mg_apply_transform </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg_ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg_apply</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies a transformation to particle coordinates in a reference micrograph and writes them into an application micrograph structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*mg_ref</td><td>micrograph used as reference. </td></tr>
    <tr><td class="paramname">*mg_apply</td><td>micrograph to apply transformation to. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">The transformation parameters specified in the second micrograph
are used.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__align_8cpp_source.html#l00639">639</a> of file <a class="el" href="mg__align_8cpp_source.html">mg_align.cpp</a>.</p>

</div>
</div>
<a id="a464413c7113e0c2f2da01c8164d4f5a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a464413c7113e0c2f2da01c8164d4f5a1">&#9670;&nbsp;</a></span>mg_merge_focal_series()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mg_merge_focal_series </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>use_old_origins</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Merges corresponding particle images in each focal series. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">use_old_origins</td><td>flag to use old origins rather than cross-correlation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__align_8cpp_source.html#l00771">771</a> of file <a class="el" href="mg__align_8cpp_source.html">mg_align.cpp</a>.</p>

</div>
</div>
<a id="a18bf12d13294a4ea9db00e47cd5e7e23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18bf12d13294a4ea9db00e47cd5e7e23">&#9670;&nbsp;</a></span>mg_tomo_reconstruct2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a>* mg_tomo_reconstruct2D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>dimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reconstructs the zero-tilt image of a tilt-series. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">dimg</td><td>number of adjacent images in reconstructions. </td></tr>
    <tr><td class="paramname">size</td><td>reconstruction size. </td></tr>
    <tr><td class="paramname">scale</td><td>reconstruction scale. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit (angstrom). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* new 2D image. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__align_8cpp_source.html#l01705">1705</a> of file <a class="el" href="mg__align_8cpp_source.html">mg_align.cpp</a>.</p>

</div>
</div>
<a id="a2d30ced1e779ece210b97432bc464a86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d30ced1e779ece210b97432bc464a86">&#9670;&nbsp;</a></span>project_align_frames()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double project_align_frames </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ref_img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lo_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>edge_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gauss_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aligns a series of micrographs by cross-correlation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">ref_img</td><td>reference frame number (starts from 0). </td></tr>
    <tr><td class="paramname">window</td><td>moving sum window (default 1, no moving sum). </td></tr>
    <tr><td class="paramname">step</td><td>moving sum interval (default 1). </td></tr>
    <tr><td class="paramname">*pgr</td><td>gain reference. </td></tr>
    <tr><td class="paramname">*pmask</td><td>reciprocal space mask, 0's and 1's. </td></tr>
    <tr><td class="paramname">origin</td><td>tilt origin. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lo_res</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">shift_limit</td><td>maximum shift from nominal origin of image. </td></tr>
    <tr><td class="paramname">edge_width</td><td>edge smoothing width (not done if 0). </td></tr>
    <tr><td class="paramname">gauss_width</td><td>edge decay width. </td></tr>
    <tr><td class="paramname">bin</td><td>integer bin factor. </td></tr>
    <tr><td class="paramname">subset</td><td>a subset to sum. </td></tr>
    <tr><td class="paramname">flag</td><td>options flag. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double root-mean-square of offsets. <pre class="fragment">Each micrograph frame is cross-correlated with the reference
frame and the shift determined.
Options encoded in the flag:
1   rescale image based on histogram.
2   weigh by accumulated dose.
4   write aligned frames with insert "_aln".
8   write aligned frame sum with insert "_sum".
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__align_8cpp_source.html#l01310">1310</a> of file <a class="el" href="mg__align_8cpp_source.html">mg_align.cpp</a>.</p>

</div>
</div>
<a id="ac102016c32c7fa2b5d72c778168982fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac102016c32c7fa2b5d72c778168982fe">&#9670;&nbsp;</a></span>project_align_series()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double project_align_series </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ref_img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lo_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>edge_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gauss_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aligns a series of micrographs by cross-correlation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">ref_img</td><td>reference micrograph number (starts from 0). </td></tr>
    <tr><td class="paramname">*pgr</td><td>gain reference. </td></tr>
    <tr><td class="paramname">*pmask</td><td>reciprocal space mask, 0's and 1's. </td></tr>
    <tr><td class="paramname">origin</td><td>tilt origin. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lo_res</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">shift_limit</td><td>maximum shift from nominal origin of image. </td></tr>
    <tr><td class="paramname">edge_width</td><td>edge smoothing width (not done if 0). </td></tr>
    <tr><td class="paramname">gauss_width</td><td>edge decay width. </td></tr>
    <tr><td class="paramname">bin</td><td>3-value vector of integer bin factors. </td></tr>
    <tr><td class="paramname">&amp;subset</td><td>subset to average (all if empty) </td></tr>
    <tr><td class="paramname">flag</td><td>options flag. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double root-mean-square of offsets. <pre class="fragment">Each micrograph in the series is cross-correlated with the reference
micrograph and the shift determined.
Options encoded in the flag:
1   rescale image based on histogram.
2   weigh by accumulated dose.
4   write aligned frames with insert "_aln".
8   write aligned frame sum with insert "_avg".
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__align_8cpp_source.html#l01533">1533</a> of file <a class="el" href="mg__align_8cpp_source.html">mg_align.cpp</a>.</p>

</div>
</div>
<a id="ada9c136fd7095cb136327087a9096656"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada9c136fd7095cb136327087a9096656">&#9670;&nbsp;</a></span>project_frames_snr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int project_frames_snr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sampling_ratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>tile_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the estimated SNR from aligned movie frames. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">res_hi</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">sampling_ratio</td><td>radial sampling ratio (1 or larger). </td></tr>
    <tr><td class="paramname">window</td><td>number of frames to sum for each curve. </td></tr>
    <tr><td class="paramname">&amp;subset</td><td>subset to average (all if empty). </td></tr>
    <tr><td class="paramname">tile_size</td><td>tile size for tiled SNR. </td></tr>
    <tr><td class="paramname">flag</td><td>flag to convert to counts (1) and calculate a progressive sum (2). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0, &lt;0 on failure. <pre class="fragment">The SNR is calculated as for reconstructions.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__align_8cpp_source.html#l02253">2253</a> of file <a class="el" href="mg__align_8cpp_source.html">mg_align.cpp</a>.</p>

</div>
</div>
<a id="a652a4146eb754826c2dac44f7e9fae7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a652a4146eb754826c2dac44f7e9fae7d">&#9670;&nbsp;</a></span>project_ssnr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double project_ssnr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mg__align_8cpp_source.html#l02037">2037</a> of file <a class="el" href="mg__align_8cpp_source.html">mg_align.cpp</a>.</p>

</div>
</div>
<a id="a286ff99aa89b275a1b02a048b80e05c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a286ff99aa89b275a1b02a048b80e05c3">&#9670;&nbsp;</a></span>project_tomo_align()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long project_tomo_align </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>thickness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dchange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>dimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>edge_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gauss_width</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aligns a series of micrographs by cross-correlation sequentially. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">thickness</td><td>reconstruction thickness. </td></tr>
    <tr><td class="paramname">iter</td><td>number of alignment iterations. </td></tr>
    <tr><td class="paramname">dchange</td><td>threshold change in origin. </td></tr>
    <tr><td class="paramname">dimg</td><td>number of adjacent images in reconstructions. </td></tr>
    <tr><td class="paramname">resolution</td><td>high resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">shift_limit</td><td>limit on shift search (pixels). </td></tr>
    <tr><td class="paramname">edge_width</td><td>smoothing edge width. </td></tr>
    <tr><td class="paramname">gauss_width</td><td>smoothing edge decay. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long 0, &lt;0 on failure. <pre class="fragment">Each pair of adjacent micrographs in the series is cross-correlated
and the relative shift determined. The relative shifts are adjusted
relative to the reference micrograph, defined as the one closest
to a zero degree tilt.
The images are stretched to compensate for tilt difference.
The relationship between an euler representation of the view and
the tilt axis and tilt angle is:
    tilt_axis = phi - 90 = - psi - 90
    tilt_angle = theta
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__align_8cpp_source.html#l01876">1876</a> of file <a class="el" href="mg__align_8cpp_source.html">mg_align.cpp</a>.</p>

</div>
</div>
<a id="ace439539f332c99632dcc732f9c9968a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace439539f332c99632dcc732f9c9968a">&#9670;&nbsp;</a></span>project_write_aligned_averages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double project_write_aligned_averages </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>imgfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a>&#160;</td>
          <td class="paramname"><em>datatype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates aligned micrograph images and write them to a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>micrograph project. </td></tr>
    <tr><td class="paramname">*pgr</td><td>gain reference. </td></tr>
    <tr><td class="paramname">&amp;imgfile</td><td>output image file name. </td></tr>
    <tr><td class="paramname">datatype</td><td>output data type. </td></tr>
    <tr><td class="paramname">&amp;subset</td><td>subset to average (all if empty) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double average SNR. <pre class="fragment">Only the origin is adjusted.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__align_8cpp_source.html#l01029">1029</a> of file <a class="el" href="mg__align_8cpp_source.html">mg_align.cpp</a>.</p>

</div>
</div>
<a id="a7754952d044cebe0d3a2661e8d6af68a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7754952d044cebe0d3a2661e8d6af68a">&#9670;&nbsp;</a></span>project_write_aligned_images()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double project_write_aligned_images </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>imgfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a>&#160;</td>
          <td class="paramname"><em>datatype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates aligned micrograph images and write them to a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>micrograph project. </td></tr>
    <tr><td class="paramname">*pgr</td><td>gain reference. </td></tr>
    <tr><td class="paramname">&amp;imgfile</td><td>output image file name. </td></tr>
    <tr><td class="paramname">datatype</td><td>output data type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double 0. <pre class="fragment">Only the origin is adjusted.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__align_8cpp_source.html#l00957">957</a> of file <a class="el" href="mg__align_8cpp_source.html">mg_align.cpp</a>.</p>

</div>
</div>
<a id="a8af9c3c5398e68320b9aa88a9bf8a843"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8af9c3c5398e68320b9aa88a9bf8a843">&#9670;&nbsp;</a></span>project_write_frame_sums()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double project_write_frame_sums </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a>&#160;</td>
          <td class="paramname"><em>datatype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sums aligned micrograph frames and write them to files. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>micrograph project. </td></tr>
    <tr><td class="paramname">*pgr</td><td>gain reference. </td></tr>
    <tr><td class="paramname">datatype</td><td>output data type. </td></tr>
    <tr><td class="paramname">&amp;subset</td><td>subset to average (all if empty). </td></tr>
    <tr><td class="paramname">flag</td><td>flag to calculate counts from histogram. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double average SNR. <pre class="fragment">Only the origin is adjusted.
</pre> </dd></dl>

<p class="definition">Definition at line <a class="el" href="mg__align_8cpp_source.html#l01172">1172</a> of file <a class="el" href="mg__align_8cpp_source.html">mg_align.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="mg__align_8h.html">mg_align.h</a></li>
    <li class="footer">Generated on Wed Sep 1 2021 09:22:02 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
