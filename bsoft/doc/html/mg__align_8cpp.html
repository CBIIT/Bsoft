<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/heymannb/b20/bsoft/src/mg/mg_align.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">Bsoft<span id="projectnumber">&#160;2.1.4</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('mg__align_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">mg_align.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Functions to align micrographs or coordinates from micrographs and apply the resultant transformation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="_bimage_8h.html">Bimage.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__align_8h.html">mg_align.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rwimg_8h.html">rwimg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__processing_8h.html">mg_processing.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__img__proc_8h.html">mg_img_proc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__ctf__fit_8h.html">mg_ctf_fit.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__select_8h.html">mg_select.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mg__tomography_8h.html">mg_tomography.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="marker_8h.html">marker.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="matrix__linear_8h.html">matrix_linear.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="simplex_8h.html">simplex.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ps__marker_8h.html">ps_marker.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="linked__list_8h.html">linked_list.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h.html">utilities.h</a>&quot;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;fstream&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9662f805dd1b4f10fb35674c1d8fa69b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a9662f805dd1b4f10fb35674c1d8fa69b">mg_align_coordinates</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int refset)</td></tr>
<tr class="memdesc:a9662f805dd1b4f10fb35674c1d8fa69b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aligns the particle coordinates of a series of micrographs.  <a href="mg__align_8cpp.html#a9662f805dd1b4f10fb35674c1d8fa69b">More...</a><br /></td></tr>
<tr class="separator:a9662f805dd1b4f10fb35674c1d8fa69b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19ceb9be403a648693874979f82d7feb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_transform.html">Transform</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a19ceb9be403a648693874979f82d7feb">img_align</a> (<a class="el" href="class_bimage.html">Bimage</a> *p1, <a class="el" href="class_bimage.html">Bimage</a> *p2, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; tile_size, double res_lo, double res_hi, double max_shift, int filter_flag, int refine_flag)</td></tr>
<tr class="separator:a19ceb9be403a648693874979f82d7feb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab297567bb3fb167eed485b655eabba37"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#ab297567bb3fb167eed485b655eabba37">img_sum_subset</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, <a class="el" href="class_bstring.html">Bstring</a> &amp;subset, double dose_per_frame, double time_per_frame)</td></tr>
<tr class="separator:ab297567bb3fb167eed485b655eabba37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fe2a50ea1061b8f0363d1fec7330524"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a0fe2a50ea1061b8f0363d1fec7330524">mg_align_micrographs</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int refset, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; tile_size, double res_lo, double res_hi, double max_shift, int filter_flag, int refine_flag)</td></tr>
<tr class="memdesc:a0fe2a50ea1061b8f0363d1fec7330524"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aligns a focal series of micrographs.  <a href="mg__align_8cpp.html#a0fe2a50ea1061b8f0363d1fec7330524">More...</a><br /></td></tr>
<tr class="separator:a0fe2a50ea1061b8f0363d1fec7330524"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af30fb46fb1b5157378f74ab1a7a61c38"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_bmarker.html">Bmarker</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#af30fb46fb1b5157378f74ab1a7a61c38">img_extract_features</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, int extract_method, int target_num, double threshold)</td></tr>
<tr class="separator:af30fb46fb1b5157378f74ab1a7a61c38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d2476a740a9726a32dc3b6015793e4a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a5d2476a740a9726a32dc3b6015793e4a">mg_align_feature_extraction</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int max_features, double res_low, double res_high, double thresh, int extract_method)</td></tr>
<tr class="memdesc:a5d2476a740a9726a32dc3b6015793e4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aligns images by feature extraction.  <a href="mg__align_8cpp.html#a5d2476a740a9726a32dc3b6015793e4a">More...</a><br /></td></tr>
<tr class="separator:a5d2476a740a9726a32dc3b6015793e4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a1dc07a0b30cc4755662a41bb53f4fd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a0a1dc07a0b30cc4755662a41bb53f4fd">mg_apply_transform</a> (<a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg_ref, <a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg_apply)</td></tr>
<tr class="memdesc:a0a1dc07a0b30cc4755662a41bb53f4fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies a transformation to particle coordinates in a reference micrograph and writes them into an application micrograph structure.  <a href="mg__align_8cpp.html#a0a1dc07a0b30cc4755662a41bb53f4fd">More...</a><br /></td></tr>
<tr class="separator:a0a1dc07a0b30cc4755662a41bb53f4fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a464413c7113e0c2f2da01c8164d4f5a1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a464413c7113e0c2f2da01c8164d4f5a1">mg_merge_focal_series</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int use_old_origins)</td></tr>
<tr class="memdesc:a464413c7113e0c2f2da01c8164d4f5a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Merges corresponding particle images in each focal series.  <a href="mg__align_8cpp.html#a464413c7113e0c2f2da01c8164d4f5a1">More...</a><br /></td></tr>
<tr class="separator:a464413c7113e0c2f2da01c8164d4f5a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af07cc131aab8473b1953f27dabc8ccf8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#af07cc131aab8473b1953f27dabc8ccf8">field_write_aligned_average</a> (<a class="el" href="class_bfield.html">Bfield</a> *field, <a class="el" href="class_bimage.html">Bimage</a> *pgr, <a class="el" href="class_bstring.html">Bstring</a> &amp;imgfile, <a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a> datatype, <a class="el" href="class_bstring.html">Bstring</a> &amp;subset)</td></tr>
<tr class="separator:af07cc131aab8473b1953f27dabc8ccf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7754952d044cebe0d3a2661e8d6af68a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a7754952d044cebe0d3a2661e8d6af68a">project_write_aligned_images</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *pgr, <a class="el" href="class_bstring.html">Bstring</a> &amp;imgfile, <a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a> datatype)</td></tr>
<tr class="memdesc:a7754952d044cebe0d3a2661e8d6af68a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates aligned micrograph images and write them to a file.  <a href="mg__align_8cpp.html#a7754952d044cebe0d3a2661e8d6af68a">More...</a><br /></td></tr>
<tr class="separator:a7754952d044cebe0d3a2661e8d6af68a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace439539f332c99632dcc732f9c9968a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#ace439539f332c99632dcc732f9c9968a">project_write_aligned_averages</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *pgr, <a class="el" href="class_bstring.html">Bstring</a> &amp;imgfile, <a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a> datatype, <a class="el" href="class_bstring.html">Bstring</a> &amp;subset)</td></tr>
<tr class="memdesc:ace439539f332c99632dcc732f9c9968a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates aligned micrograph images and write them to a file.  <a href="mg__align_8cpp.html#ace439539f332c99632dcc732f9c9968a">More...</a><br /></td></tr>
<tr class="separator:ace439539f332c99632dcc732f9c9968a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1438d81b509356e7e9183576213aff3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#aa1438d81b509356e7e9183576213aff3">mg_write_frame_sum</a> (<a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg, <a class="el" href="class_bimage.html">Bimage</a> *pgr, <a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a> datatype, <a class="el" href="class_bstring.html">Bstring</a> &amp;subset, double sampling_ratio, int flag)</td></tr>
<tr class="separator:aa1438d81b509356e7e9183576213aff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb46c7c493d6f0b475fc003961ed957b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#aeb46c7c493d6f0b475fc003961ed957b">project_write_frame_sums</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, <a class="el" href="class_bimage.html">Bimage</a> *pgr, <a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a> datatype, <a class="el" href="class_bstring.html">Bstring</a> &amp;subset, double sampling_ratio, int flag)</td></tr>
<tr class="memdesc:aeb46c7c493d6f0b475fc003961ed957b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sums aligned micrograph frames and write them to files.  <a href="mg__align_8cpp.html#aeb46c7c493d6f0b475fc003961ed957b">More...</a><br /></td></tr>
<tr class="separator:aeb46c7c493d6f0b475fc003961ed957b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f239479ff1f777b4fef75e4d2ff8b57"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a1f239479ff1f777b4fef75e4d2ff8b57">mg_align_frames</a> (<a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg, long ref_num, long window, long step, <a class="el" href="class_bimage.html">Bimage</a> *pgr, <a class="el" href="class_bimage.html">Bimage</a> *pmask, double hi_res, double lo_res, double shift_limit, double edge_width, double gauss_width, long bin, <a class="el" href="class_bstring.html">Bstring</a> &amp;subset, int flag)</td></tr>
<tr class="separator:a1f239479ff1f777b4fef75e4d2ff8b57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d30ced1e779ece210b97432bc464a86"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a2d30ced1e779ece210b97432bc464a86">project_align_frames</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int ref_img, long window, long step, <a class="el" href="class_bimage.html">Bimage</a> *pgr, <a class="el" href="class_bimage.html">Bimage</a> *pmask, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; origin, double hi_res, double lo_res, double shift_limit, double edge_width, double gauss_width, long bin, <a class="el" href="class_bstring.html">Bstring</a> &amp;subset, int flag)</td></tr>
<tr class="memdesc:a2d30ced1e779ece210b97432bc464a86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aligns a series of micrographs by cross-correlation.  <a href="mg__align_8cpp.html#a2d30ced1e779ece210b97432bc464a86">More...</a><br /></td></tr>
<tr class="separator:a2d30ced1e779ece210b97432bc464a86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09234c5f9d92f1a25ec13b326f1ec9c6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a09234c5f9d92f1a25ec13b326f1ec9c6">mg_align_series</a> (<a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg, <a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg_ref, <a class="el" href="class_bimage.html">Bimage</a> *pref, <a class="el" href="class_bimage.html">Bimage</a> *pgr, <a class="el" href="class_bimage.html">Bimage</a> *pmask, double hi_res, double lo_res, double shift_limit, double edge_width, double gauss_width, long bin, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</a>, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a9ec8849996c5e210d7b7e8e05b98639d">planb</a>)</td></tr>
<tr class="separator:a09234c5f9d92f1a25ec13b326f1ec9c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21d47a86732e4d82b7c793aaee747702"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a21d47a86732e4d82b7c793aaee747702">field_align_series</a> (<a class="el" href="class_bfield.html">Bfield</a> *field, int ref_img, <a class="el" href="class_bimage.html">Bimage</a> *pgr, <a class="el" href="class_bimage.html">Bimage</a> *pmask, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; origin, double hi_res, double lo_res, double shift_limit, double edge_width, double gauss_width, long bin, <a class="el" href="class_bstring.html">Bstring</a> &amp;subset, int flag)</td></tr>
<tr class="separator:a21d47a86732e4d82b7c793aaee747702"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac102016c32c7fa2b5d72c778168982fe"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#ac102016c32c7fa2b5d72c778168982fe">project_align_series</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, int ref_img, <a class="el" href="class_bimage.html">Bimage</a> *pgr, <a class="el" href="class_bimage.html">Bimage</a> *pmask, <a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt; origin, double hi_res, double lo_res, double shift_limit, double edge_width, double gauss_width, long bin, <a class="el" href="class_bstring.html">Bstring</a> &amp;subset, int flag)</td></tr>
<tr class="memdesc:ac102016c32c7fa2b5d72c778168982fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aligns a series of micrographs by cross-correlation.  <a href="mg__align_8cpp.html#ac102016c32c7fa2b5d72c778168982fe">More...</a><br /></td></tr>
<tr class="separator:ac102016c32c7fa2b5d72c778168982fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d2655e3ea7dfc2bf3904bd910f0c0a7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a0d2655e3ea7dfc2bf3904bd910f0c0a7">mg_tomo_reconstruct</a> (<a class="el" href="class_bmicrograph.html">Bmicrograph</a> **mgarr, long mg_id, long mg_min, long mg_max, double hi_res, double scale, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; <a class="el" href="use__ctf_8inc.html#a7a2f2f92a2bbfc2ea0b2e85f0056ca4e">size</a>, long ft_size, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</a>, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a9ec8849996c5e210d7b7e8e05b98639d">planb</a>)</td></tr>
<tr class="separator:a0d2655e3ea7dfc2bf3904bd910f0c0a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1cec495e7bed314e164630351f33671"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#ab1cec495e7bed314e164630351f33671">mg_tomo_reconstruct2D</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, long dimg, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; <a class="el" href="use__ctf_8inc.html#a7a2f2f92a2bbfc2ea0b2e85f0056ca4e">size</a>, double scale, double hi_res)</td></tr>
<tr class="memdesc:ab1cec495e7bed314e164630351f33671"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reconstructs the zero-tilt image of a tilt-series.  <a href="mg__align_8cpp.html#ab1cec495e7bed314e164630351f33671">More...</a><br /></td></tr>
<tr class="separator:ab1cec495e7bed314e164630351f33671"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4371b97a29446b84d976d6b9abfe6fda"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a4371b97a29446b84d976d6b9abfe6fda">mg_reconstruct_align</a> (<a class="el" href="class_bmicrograph.html">Bmicrograph</a> **mgarr, long nmg, long mg_id, long dimg, double resolution, double shift_limit, <a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt; <a class="el" href="use__ctf_8inc.html#a7a2f2f92a2bbfc2ea0b2e85f0056ca4e">size</a>, double edge_width, double gauss_width, long ft_size, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</a>, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> <a class="el" href="bico_8cpp.html#a9ec8849996c5e210d7b7e8e05b98639d">planb</a>)</td></tr>
<tr class="separator:a4371b97a29446b84d976d6b9abfe6fda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a286ff99aa89b275a1b02a048b80e05c3"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a286ff99aa89b275a1b02a048b80e05c3">project_tomo_align</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, long thickness, long iter, double dchange, long dimg, double resolution, double shift_limit, double edge_width, double gauss_width)</td></tr>
<tr class="memdesc:a286ff99aa89b275a1b02a048b80e05c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aligns a series of micrographs by cross-correlation sequentially.  <a href="mg__align_8cpp.html#a286ff99aa89b275a1b02a048b80e05c3">More...</a><br /></td></tr>
<tr class="separator:a286ff99aa89b275a1b02a048b80e05c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5b1f1dacbaf2cab60b14750f79a6b4d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#aa5b1f1dacbaf2cab60b14750f79a6b4d">field_ssnr</a> (<a class="el" href="class_bfield.html">Bfield</a> *field, <a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a> plan)</td></tr>
<tr class="separator:aa5b1f1dacbaf2cab60b14750f79a6b4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a652a4146eb754826c2dac44f7e9fae7d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a652a4146eb754826c2dac44f7e9fae7d">project_ssnr</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>)</td></tr>
<tr class="separator:a652a4146eb754826c2dac44f7e9fae7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac450253811e3a33f93d99cc142fac31d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#ac450253811e3a33f93d99cc142fac31d">progressive_snr_R</a> (<a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;simp)</td></tr>
<tr class="separator:ac450253811e3a33f93d99cc142fac31d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a561090306cfb9cc173c50b59a6b1f96e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a561090306cfb9cc173c50b59a6b1f96e">fit_progressive_snr</a> (vector&lt; double &gt; &amp;x, vector&lt; double &gt; &amp;y, double &amp;snr, double &amp;cd)</td></tr>
<tr class="separator:a561090306cfb9cc173c50b59a6b1f96e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4c37fb97bdcd82f64f2d8a3aaa69a86"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#aa4c37fb97bdcd82f64f2d8a3aaa69a86">fit_individual_progressive_snr</a> (<a class="el" href="class_bplot.html">Bplot</a> *plot, vector&lt; double &gt; &amp;minima, long nimg, double dose_per_subset)</td></tr>
<tr class="separator:aa4c37fb97bdcd82f64f2d8a3aaa69a86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76d474a79e8cd6a0010a7ec7d4701863"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a76d474a79e8cd6a0010a7ec7d4701863">progressive_snr_R2</a> (<a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;simp)</td></tr>
<tr class="separator:a76d474a79e8cd6a0010a7ec7d4701863"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a363de496d1b3ece3bcdb6571ac6a02b7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a363de496d1b3ece3bcdb6571ac6a02b7">fit_progressive_snr2</a> (vector&lt; double &gt; &amp;x, vector&lt; double &gt; &amp;y, double &amp;snr, double &amp;c)</td></tr>
<tr class="separator:a363de496d1b3ece3bcdb6571ac6a02b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a210098532a3b9a25b7ed537b69a7125d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a210098532a3b9a25b7ed537b69a7125d">fit_full_progressive_snr</a> (<a class="el" href="class_bplot.html">Bplot</a> *plot, vector&lt; double &gt; &amp;minima, long nimg, double dose_per_subset)</td></tr>
<tr class="separator:a210098532a3b9a25b7ed537b69a7125d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb76e2634ab079c8399943a81a32e657"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#aeb76e2634ab079c8399943a81a32e657">img_filter_spikes</a> (<a class="el" href="class_bimage.html">Bimage</a> *p, double ratio)</td></tr>
<tr class="separator:aeb76e2634ab079c8399943a81a32e657"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fa1b6350ef7cfafa85b22f4d2c4d701"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a7fa1b6350ef7cfafa85b22f4d2c4d701">mg_frames_snr</a> (<a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg, double res_hi, long window, <a class="el" href="class_bstring.html">Bstring</a> &amp;subset, double sampling_ratio, int flag)</td></tr>
<tr class="separator:a7fa1b6350ef7cfafa85b22f4d2c4d701"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc783b73f3d572568ca1f298bc2b14a1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#afc783b73f3d572568ca1f298bc2b14a1">project_frames_snr</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, double res_hi, long window, <a class="el" href="class_bstring.html">Bstring</a> &amp;subset, double sampling_ratio, int flag)</td></tr>
<tr class="memdesc:afc783b73f3d572568ca1f298bc2b14a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the estimated SNR from aligned movie frames.  <a href="mg__align_8cpp.html#afc783b73f3d572568ca1f298bc2b14a1">More...</a><br /></td></tr>
<tr class="separator:afc783b73f3d572568ca1f298bc2b14a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2306f199d8eaa6593f5d6742b7b0b71"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#aa2306f199d8eaa6593f5d6742b7b0b71">mg_frame_shift_analysis</a> (<a class="el" href="class_bmicrograph.html">Bmicrograph</a> *mg, long window, double resolution)</td></tr>
<tr class="separator:aa2306f199d8eaa6593f5d6742b7b0b71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74de542ebf58973a10b561a80ceb8c35"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a74de542ebf58973a10b561a80ceb8c35">project_frame_shift_analysis</a> (<a class="el" href="class_bproject.html">Bproject</a> *<a class="el" href="tcltk__bmodel_8cpp.html#aea438e09dfc03683a0f49a05e9a69cac">project</a>, long window, double resolution)</td></tr>
<tr class="memdesc:a74de542ebf58973a10b561a80ceb8c35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the estimated SNR from aligned movie frames.  <a href="mg__align_8cpp.html#a74de542ebf58973a10b561a80ceb8c35">More...</a><br /></td></tr>
<tr class="separator:a74de542ebf58973a10b561a80ceb8c35"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a263a6854215e5859d1557279858ced33"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bstring.html">Bstring</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a263a6854215e5859d1557279858ced33">progsnr_file</a></td></tr>
<tr class="separator:a263a6854215e5859d1557279858ced33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d4d42e77642b4076742167a184432bd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_bstring.html">Bstring</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mg__align_8cpp.html#a5d4d42e77642b4076742167a184432bd">pssnr_curves</a></td></tr>
<tr class="separator:a5d4d42e77642b4076742167a184432bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Functions to align micrographs or coordinates from micrographs and apply the resultant transformation. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann and Samuel Payne </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20000505 </dd>
<dd>
Modified: 20211004 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a21d47a86732e4d82b7c793aaee747702" name="a21d47a86732e4d82b7c793aaee747702"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21d47a86732e4d82b7c793aaee747702">&#9670;&nbsp;</a></span>field_align_series()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double field_align_series </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bfield.html">Bfield</a> *&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ref_img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lo_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>edge_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gauss_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa5b1f1dacbaf2cab60b14750f79a6b4d" name="aa5b1f1dacbaf2cab60b14750f79a6b4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5b1f1dacbaf2cab60b14750f79a6b4d">&#9670;&nbsp;</a></span>field_ssnr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double field_ssnr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bfield.html">Bfield</a> *&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>plan</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af07cc131aab8473b1953f27dabc8ccf8" name="af07cc131aab8473b1953f27dabc8ccf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af07cc131aab8473b1953f27dabc8ccf8">&#9670;&nbsp;</a></span>field_write_aligned_average()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double field_write_aligned_average </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bfield.html">Bfield</a> *&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>imgfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a>&#160;</td>
          <td class="paramname"><em>datatype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a210098532a3b9a25b7ed537b69a7125d" name="a210098532a3b9a25b7ed537b69a7125d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a210098532a3b9a25b7ed537b69a7125d">&#9670;&nbsp;</a></span>fit_full_progressive_snr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fit_full_progressive_snr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bplot.html">Bplot</a> *&#160;</td>
          <td class="paramname"><em>plot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>minima</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dose_per_subset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa4c37fb97bdcd82f64f2d8a3aaa69a86" name="aa4c37fb97bdcd82f64f2d8a3aaa69a86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4c37fb97bdcd82f64f2d8a3aaa69a86">&#9670;&nbsp;</a></span>fit_individual_progressive_snr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fit_individual_progressive_snr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bplot.html">Bplot</a> *&#160;</td>
          <td class="paramname"><em>plot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>minima</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dose_per_subset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a561090306cfb9cc173c50b59a6b1f96e" name="a561090306cfb9cc173c50b59a6b1f96e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a561090306cfb9cc173c50b59a6b1f96e">&#9670;&nbsp;</a></span>fit_progressive_snr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fit_progressive_snr </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>snr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>cd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a363de496d1b3ece3bcdb6571ac6a02b7" name="a363de496d1b3ece3bcdb6571ac6a02b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a363de496d1b3ece3bcdb6571ac6a02b7">&#9670;&nbsp;</a></span>fit_progressive_snr2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fit_progressive_snr2 </td>
          <td>(</td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>snr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a19ceb9be403a648693874979f82d7feb" name="a19ceb9be403a648693874979f82d7feb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19ceb9be403a648693874979f82d7feb">&#9670;&nbsp;</a></span>img_align()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_transform.html">Transform</a> img_align </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>tile_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>filter_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>refine_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af30fb46fb1b5157378f74ab1a7a61c38" name="af30fb46fb1b5157378f74ab1a7a61c38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af30fb46fb1b5157378f74ab1a7a61c38">&#9670;&nbsp;</a></span>img_extract_features()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_bmarker.html">Bmarker</a> * img_extract_features </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>extract_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>target_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aeb76e2634ab079c8399943a81a32e657" name="aeb76e2634ab079c8399943a81a32e657"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb76e2634ab079c8399943a81a32e657">&#9670;&nbsp;</a></span>img_filter_spikes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int img_filter_spikes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ratio</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab297567bb3fb167eed485b655eabba37" name="ab297567bb3fb167eed485b655eabba37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab297567bb3fb167eed485b655eabba37">&#9670;&nbsp;</a></span>img_sum_subset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * img_sum_subset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dose_per_frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>time_per_frame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9662f805dd1b4f10fb35674c1d8fa69b" name="a9662f805dd1b4f10fb35674c1d8fa69b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9662f805dd1b4f10fb35674c1d8fa69b">&#9670;&nbsp;</a></span>mg_align_coordinates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mg_align_coordinates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>refset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aligns the particle coordinates of a series of micrographs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">refset</td><td>reference image or set of coordinates (-1 means undefined). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">The sets of micrograph coordinates of a focal series in an image 
processing parameter structure are fitted to each other, giving a 
rotation angle, and shifting and scaling in x and y for each pair 
of micrographs.
There must be the same number of particles in each micrograph
of a focal series.
</pre> </dd></dl>

</div>
</div>
<a id="a5d2476a740a9726a32dc3b6015793e4a" name="a5d2476a740a9726a32dc3b6015793e4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d2476a740a9726a32dc3b6015793e4a">&#9670;&nbsp;</a></span>mg_align_feature_extraction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mg_align_feature_extraction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_low</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_high</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>extract_method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aligns images by feature extraction. </p>
<dl class="section author"><dt>Author</dt><dd>Samuel Payne </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>the set of image parameters </td></tr>
    <tr><td class="paramname">max_features</td><td>the maximum number of features to extract </td></tr>
    <tr><td class="paramname">res_low</td><td>the low resolution limit </td></tr>
    <tr><td class="paramname">res_high</td><td>the high resolution limit </td></tr>
    <tr><td class="paramname">thresh</td><td>threshold used for feature extraction </td></tr>
    <tr><td class="paramname">extract_method</td><td>method used for finding the center of particles </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code.</dd></dl>
<p>Calculates the transformation parameters for each set images, by picking features in the images and finding the best fit for the matching of the features.</p>
<p >The features are picked and returned using function <a class="el" href="mg__align_8cpp.html#af30fb46fb1b5157378f74ab1a7a61c38">img_extract_features()</a>. The set of features is sent to find_transform_params() that finds the transformation parameters that relate the images to each other. The shift in xy directions, the scale in xy directions, and rotation angle is returned. The program works best if the images have at least 40 distinct features. </p>

</div>
</div>
<a id="a1f239479ff1f777b4fef75e4d2ff8b57" name="a1f239479ff1f777b4fef75e4d2ff8b57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f239479ff1f777b4fef75e4d2ff8b57">&#9670;&nbsp;</a></span>mg_align_frames()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double mg_align_frames </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>ref_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lo_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>edge_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gauss_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0fe2a50ea1061b8f0363d1fec7330524" name="a0fe2a50ea1061b8f0363d1fec7330524"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fe2a50ea1061b8f0363d1fec7330524">&#9670;&nbsp;</a></span>mg_align_micrographs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mg_align_micrographs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>refset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>tile_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>filter_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>refine_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aligns a focal series of micrographs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>parameter structure. </td></tr>
    <tr><td class="paramname">refset</td><td>reference image or set of coordinates (&lt; 1 means undefined). </td></tr>
    <tr><td class="paramname">tile_size</td><td>3-valued vector for the size of sub-images. </td></tr>
    <tr><td class="paramname">res_lo</td><td>low resolution limit for cross-correlation. </td></tr>
    <tr><td class="paramname">res_hi</td><td>high resolution limit for cross-correlation. </td></tr>
    <tr><td class="paramname">max_shift</td><td>maximum shift allowed (default 1/4 of tile). </td></tr>
    <tr><td class="paramname">filter_flag</td><td>flag to filter micrograph extremes. </td></tr>
    <tr><td class="paramname">refine_flag</td><td>flag to turn on refinement of shift. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0, &lt;0 on error. <pre class="fragment">A series of micrograph images specified in an image processing 
parameter structure are aligned by segmented cross-correlation. The 
micrograph data blocks are assumed to be arranged with a series in
consequent data blocks. The micrographs are segmented into tiles 
and the tile shifts with respect to each other determined by 
cross-correlation. The shifts are assumed to most accurately 
represent the displacement of the center of one tile with respect 
to the center of the corresponding tile in the other micrograph.
The resultant sets of coordinates are fitted to each
other, giving a 3-value shift vector, a 3-value scale vector,
and a rotation angle for each pair of micrographs.
A reference micrograph is chosen as:
    1.  the first micrograph with particle coordinates
    2.  otherwise, the first micrograph
If coordinates are supplied for particles in the reference micrograph,
the determined transformation parameters are applied and written into
the other micrograph structures.
</pre> </dd></dl>

</div>
</div>
<a id="a09234c5f9d92f1a25ec13b326f1ec9c6" name="a09234c5f9d92f1a25ec13b326f1ec9c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09234c5f9d92f1a25ec13b326f1ec9c6">&#9670;&nbsp;</a></span>mg_align_series()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double mg_align_series </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg_ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lo_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>edge_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gauss_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0a1dc07a0b30cc4755662a41bb53f4fd" name="a0a1dc07a0b30cc4755662a41bb53f4fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a1dc07a0b30cc4755662a41bb53f4fd">&#9670;&nbsp;</a></span>mg_apply_transform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mg_apply_transform </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg_ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg_apply</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies a transformation to particle coordinates in a reference micrograph and writes them into an application micrograph structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*mg_ref</td><td>micrograph used as reference. </td></tr>
    <tr><td class="paramname">*mg_apply</td><td>micrograph to apply transformation to. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0. <pre class="fragment">The transformation parameters specified in the second micrograph
are used.
</pre> </dd></dl>

</div>
</div>
<a id="aa2306f199d8eaa6593f5d6742b7b0b71" name="aa2306f199d8eaa6593f5d6742b7b0b71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2306f199d8eaa6593f5d6742b7b0b71">&#9670;&nbsp;</a></span>mg_frame_shift_analysis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mg_frame_shift_analysis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7fa1b6350ef7cfafa85b22f4d2c4d701" name="a7fa1b6350ef7cfafa85b22f4d2c4d701"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fa1b6350ef7cfafa85b22f4d2c4d701">&#9670;&nbsp;</a></span>mg_frames_snr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mg_frames_snr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sampling_ratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a464413c7113e0c2f2da01c8164d4f5a1" name="a464413c7113e0c2f2da01c8164d4f5a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a464413c7113e0c2f2da01c8164d4f5a1">&#9670;&nbsp;</a></span>mg_merge_focal_series()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mg_merge_focal_series </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>use_old_origins</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Merges corresponding particle images in each focal series. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">use_old_origins</td><td>flag to use old origins rather than cross-correlation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int error code. </dd></dl>

</div>
</div>
<a id="a4371b97a29446b84d976d6b9abfe6fda" name="a4371b97a29446b84d976d6b9abfe6fda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4371b97a29446b84d976d6b9abfe6fda">&#9670;&nbsp;</a></span>mg_reconstruct_align()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double mg_reconstruct_align </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> **&#160;</td>
          <td class="paramname"><em>mgarr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nmg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>mg_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>dimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>edge_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gauss_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>ft_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0d2655e3ea7dfc2bf3904bd910f0c0a7" name="a0d2655e3ea7dfc2bf3904bd910f0c0a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d2655e3ea7dfc2bf3904bd910f0c0a7">&#9670;&nbsp;</a></span>mg_tomo_reconstruct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * mg_tomo_reconstruct </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> **&#160;</td>
          <td class="paramname"><em>mgarr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>mg_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>mg_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>mg_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>ft_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fft_8h.html#a61d23c567e69684715ea52482137a5e6">fft_plan</a>&#160;</td>
          <td class="paramname"><em>planb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab1cec495e7bed314e164630351f33671" name="ab1cec495e7bed314e164630351f33671"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1cec495e7bed314e164630351f33671">&#9670;&nbsp;</a></span>mg_tomo_reconstruct2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bimage.html">Bimage</a> * mg_tomo_reconstruct2D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>dimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; long &gt;&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reconstructs the zero-tilt image of a tilt-series. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">dimg</td><td>number of adjacent images in reconstructions. </td></tr>
    <tr><td class="paramname">size</td><td>reconstruction size. </td></tr>
    <tr><td class="paramname">scale</td><td>reconstruction scale. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit (angstrom). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bimage* new 2D image. </dd></dl>

</div>
</div>
<a id="aa1438d81b509356e7e9183576213aff3" name="aa1438d81b509356e7e9183576213aff3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1438d81b509356e7e9183576213aff3">&#9670;&nbsp;</a></span>mg_write_frame_sum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double mg_write_frame_sum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bmicrograph.html">Bmicrograph</a> *&#160;</td>
          <td class="paramname"><em>mg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a>&#160;</td>
          <td class="paramname"><em>datatype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sampling_ratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac450253811e3a33f93d99cc142fac31d" name="ac450253811e3a33f93d99cc142fac31d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac450253811e3a33f93d99cc142fac31d">&#9670;&nbsp;</a></span>progressive_snr_R()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double progressive_snr_R </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;&#160;</td>
          <td class="paramname"><em>simp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a76d474a79e8cd6a0010a7ec7d4701863" name="a76d474a79e8cd6a0010a7ec7d4701863"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76d474a79e8cd6a0010a7ec7d4701863">&#9670;&nbsp;</a></span>progressive_snr_R2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double progressive_snr_R2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bsimplex.html">Bsimplex</a> &amp;&#160;</td>
          <td class="paramname"><em>simp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2d30ced1e779ece210b97432bc464a86" name="a2d30ced1e779ece210b97432bc464a86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d30ced1e779ece210b97432bc464a86">&#9670;&nbsp;</a></span>project_align_frames()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double project_align_frames </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ref_img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lo_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>edge_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gauss_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aligns a series of micrographs by cross-correlation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">ref_img</td><td>reference frame number (starts from 0). </td></tr>
    <tr><td class="paramname">window</td><td>moving sum window (default 1, no moving sum). </td></tr>
    <tr><td class="paramname">step</td><td>moving sum interval (default 1). </td></tr>
    <tr><td class="paramname">*pgr</td><td>gain reference. </td></tr>
    <tr><td class="paramname">*pmask</td><td>reciprocal space mask, 0's and 1's. </td></tr>
    <tr><td class="paramname">origin</td><td>tilt origin. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lo_res</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">shift_limit</td><td>maximum shift from nominal origin of image. </td></tr>
    <tr><td class="paramname">edge_width</td><td>edge smoothing width (not done if 0). </td></tr>
    <tr><td class="paramname">gauss_width</td><td>edge decay width. </td></tr>
    <tr><td class="paramname">bin</td><td>integer bin factor. </td></tr>
    <tr><td class="paramname">subset</td><td>a subset to sum. </td></tr>
    <tr><td class="paramname">flag</td><td>options flag. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double root-mean-square of offsets. <pre class="fragment">Each micrograph frame is cross-correlated with the reference
frame and the shift determined.
Options encoded in the flag:
1   rescale image based on histogram.
2   weigh by accumulated dose.
4   write aligned frames with insert "_aln".
8   write aligned frame sum with insert "_sum".
16  initial alignment: local rather than progressive.
</pre> </dd></dl>

</div>
</div>
<a id="ac102016c32c7fa2b5d72c778168982fe" name="ac102016c32c7fa2b5d72c778168982fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac102016c32c7fa2b5d72c778168982fe">&#9670;&nbsp;</a></span>project_align_series()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double project_align_series </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ref_img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_vector3.html">Vector3</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>origin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hi_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lo_res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>edge_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gauss_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>bin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aligns a series of micrographs by cross-correlation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">ref_img</td><td>reference micrograph number (starts from 0). </td></tr>
    <tr><td class="paramname">*pgr</td><td>gain reference. </td></tr>
    <tr><td class="paramname">*pmask</td><td>reciprocal space mask, 0's and 1's. </td></tr>
    <tr><td class="paramname">origin</td><td>tilt origin. </td></tr>
    <tr><td class="paramname">hi_res</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">lo_res</td><td>low resolution limit. </td></tr>
    <tr><td class="paramname">shift_limit</td><td>maximum shift from nominal origin of image. </td></tr>
    <tr><td class="paramname">edge_width</td><td>edge smoothing width (not done if 0). </td></tr>
    <tr><td class="paramname">gauss_width</td><td>edge decay width. </td></tr>
    <tr><td class="paramname">bin</td><td>3-value vector of integer bin factors. </td></tr>
    <tr><td class="paramname">&amp;subset</td><td>subset to average (all if empty) </td></tr>
    <tr><td class="paramname">flag</td><td>options flag. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double root-mean-square of offsets. <pre class="fragment">Each micrograph in the series is cross-correlated with the reference
micrograph and the shift determined.
Options encoded in the flag:
1   rescale image based on histogram.
2   weigh by accumulated dose.
4   write aligned frames with insert "_aln".
8   write aligned frame sum with insert "_avg".
</pre> </dd></dl>

</div>
</div>
<a id="a74de542ebf58973a10b561a80ceb8c35" name="a74de542ebf58973a10b561a80ceb8c35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74de542ebf58973a10b561a80ceb8c35">&#9670;&nbsp;</a></span>project_frame_shift_analysis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int project_frame_shift_analysis </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the estimated SNR from aligned movie frames. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">window</td><td>number of frames to sum for each curve. </td></tr>
    <tr><td class="paramname">resolution</td><td>resolution for calculating envelope. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0, &lt;0 on failure. <pre class="fragment">The SNR is calculated as for reconstructions.
</pre> </dd></dl>

</div>
</div>
<a id="afc783b73f3d572568ca1f298bc2b14a1" name="afc783b73f3d572568ca1f298bc2b14a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc783b73f3d572568ca1f298bc2b14a1">&#9670;&nbsp;</a></span>project_frames_snr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int project_frames_snr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>res_hi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sampling_ratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the estimated SNR from aligned movie frames. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">res_hi</td><td>high resolution limit. </td></tr>
    <tr><td class="paramname">window</td><td>number of frames to sum for each curve. </td></tr>
    <tr><td class="paramname">&amp;subset</td><td>subset to average (all if empty). </td></tr>
    <tr><td class="paramname">sampling_ratio</td><td>radial sampling ratio (1 or larger). </td></tr>
    <tr><td class="paramname">flag</td><td>flag to convert to counts (1) and calculate a progressive sum (2), filter extremes (4). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int 0, &lt;0 on failure. <pre class="fragment">The SNR is calculated as for reconstructions.
</pre> </dd></dl>

</div>
</div>
<a id="a652a4146eb754826c2dac44f7e9fae7d" name="a652a4146eb754826c2dac44f7e9fae7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a652a4146eb754826c2dac44f7e9fae7d">&#9670;&nbsp;</a></span>project_ssnr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double project_ssnr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a286ff99aa89b275a1b02a048b80e05c3" name="a286ff99aa89b275a1b02a048b80e05c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a286ff99aa89b275a1b02a048b80e05c3">&#9670;&nbsp;</a></span>project_tomo_align()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long project_tomo_align </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>thickness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dchange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>dimg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resolution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>shift_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>edge_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gauss_width</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aligns a series of micrographs by cross-correlation sequentially. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>project parameter structure. </td></tr>
    <tr><td class="paramname">thickness</td><td>reconstruction thickness. </td></tr>
    <tr><td class="paramname">iter</td><td>number of alignment iterations. </td></tr>
    <tr><td class="paramname">dchange</td><td>threshold change in origin. </td></tr>
    <tr><td class="paramname">dimg</td><td>number of adjacent images in reconstructions. </td></tr>
    <tr><td class="paramname">resolution</td><td>high resolution limit (angstrom). </td></tr>
    <tr><td class="paramname">shift_limit</td><td>limit on shift search (pixels). </td></tr>
    <tr><td class="paramname">edge_width</td><td>smoothing edge width. </td></tr>
    <tr><td class="paramname">gauss_width</td><td>smoothing edge decay. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long 0, &lt;0 on failure. <pre class="fragment">Each pair of adjacent micrographs in the series is cross-correlated
and the relative shift determined. The relative shifts are adjusted
relative to the reference micrograph, defined as the one closest
to a zero degree tilt.
The images are stretched to compensate for tilt difference.
The relationship between an euler representation of the view and
the tilt axis and tilt angle is:
    tilt_axis = phi - 90 = - psi - 90
    tilt_angle = theta
</pre> </dd></dl>

</div>
</div>
<a id="ace439539f332c99632dcc732f9c9968a" name="ace439539f332c99632dcc732f9c9968a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace439539f332c99632dcc732f9c9968a">&#9670;&nbsp;</a></span>project_write_aligned_averages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double project_write_aligned_averages </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>imgfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a>&#160;</td>
          <td class="paramname"><em>datatype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates aligned micrograph images and write them to a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>micrograph project. </td></tr>
    <tr><td class="paramname">*pgr</td><td>gain reference. </td></tr>
    <tr><td class="paramname">&amp;imgfile</td><td>output image file name. </td></tr>
    <tr><td class="paramname">datatype</td><td>output data type. </td></tr>
    <tr><td class="paramname">&amp;subset</td><td>subset to average (all if empty) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double average SNR. <pre class="fragment">Only the origin is adjusted.
</pre> </dd></dl>

</div>
</div>
<a id="a7754952d044cebe0d3a2661e8d6af68a" name="a7754952d044cebe0d3a2661e8d6af68a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7754952d044cebe0d3a2661e8d6af68a">&#9670;&nbsp;</a></span>project_write_aligned_images()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double project_write_aligned_images </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>imgfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a>&#160;</td>
          <td class="paramname"><em>datatype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates aligned micrograph images and write them to a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>micrograph project. </td></tr>
    <tr><td class="paramname">*pgr</td><td>gain reference. </td></tr>
    <tr><td class="paramname">&amp;imgfile</td><td>output image file name. </td></tr>
    <tr><td class="paramname">datatype</td><td>output data type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double 0. <pre class="fragment">Only the origin is adjusted.
</pre> </dd></dl>

</div>
</div>
<a id="aeb46c7c493d6f0b475fc003961ed957b" name="aeb46c7c493d6f0b475fc003961ed957b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb46c7c493d6f0b475fc003961ed957b">&#9670;&nbsp;</a></span>project_write_frame_sums()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double project_write_frame_sums </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_bproject.html">Bproject</a> *&#160;</td>
          <td class="paramname"><em>project</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>pgr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utilities_8h.html#ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</a>&#160;</td>
          <td class="paramname"><em>datatype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bstring.html">Bstring</a> &amp;&#160;</td>
          <td class="paramname"><em>subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sampling_ratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sums aligned micrograph frames and write them to files. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*project</td><td>micrograph project. </td></tr>
    <tr><td class="paramname">*pgr</td><td>gain reference. </td></tr>
    <tr><td class="paramname">datatype</td><td>output data type. </td></tr>
    <tr><td class="paramname">&amp;subset</td><td>subset to average (all if empty). </td></tr>
    <tr><td class="paramname">sampling_ratio</td><td>radial sampling ratio (1 or larger). </td></tr>
    <tr><td class="paramname">flag</td><td>flag to calculate counts from histogram. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double average SNR. <pre class="fragment">Only the origin is adjusted.
</pre> </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a263a6854215e5859d1557279858ced33" name="a263a6854215e5859d1557279858ced33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a263a6854215e5859d1557279858ced33">&#9670;&nbsp;</a></span>progsnr_file</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bstring.html">Bstring</a> progsnr_file</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5d4d42e77642b4076742167a184432bd" name="a5d4d42e77642b4076742167a184432bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d4d42e77642b4076742167a184432bd">&#9670;&nbsp;</a></span>pssnr_curves</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_bstring.html">Bstring</a> pssnr_curves</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0b2caeb4b6f130be43e5a2f0267dd453" name="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2caeb4b6f130be43e5a2f0267dd453">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_1d197ef0d9947f4cc1ac44e7f59e2b57.html">mg</a></li><li class="navelem"><a class="el" href="mg__align_8cpp.html">mg_align.cpp</a></li>
    <li class="footer">Generated on Tue Jan 31 2023 08:21:29 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
