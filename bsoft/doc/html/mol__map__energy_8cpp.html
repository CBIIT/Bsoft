<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bsoft: /Users/bernard/b20/bsoft/src/mol/mol_map_energy.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Bsoft_icon128.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bsoft
   &#160;<span id="projectnumber">2.1.0</span>
   </div>
   <div id="projectbrief">Bernard&#39;s software package</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('mol__map__energy_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mol_map_energy.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions to calculate estimates of the fitting of molecules to maps.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="rwmolecule_8h_source.html">rwmolecule.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rwimg_8h_source.html">rwimg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="utilities_8h_source.html">utilities.h</a>&quot;</code><br />
</div>
<p><a href="mol__map__energy_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad300cdac60f9bbab302dc1835dcbdcf8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__map__energy_8cpp.html#ad300cdac60f9bbab302dc1835dcbdcf8">molgroup_map_energy</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_bimage.html">Bimage</a> *map, double Kmap)</td></tr>
<tr class="memdesc:ad300cdac60f9bbab302dc1835dcbdcf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Energy calculation of a molecule fit into a map. <br  />
  <a href="mol__map__energy_8cpp.html#ad300cdac60f9bbab302dc1835dcbdcf8">More...</a><br /></td></tr>
<tr class="separator:ad300cdac60f9bbab302dc1835dcbdcf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad14efe6199856474e3c4f71a34647f76"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__map__energy_8cpp.html#ad14efe6199856474e3c4f71a34647f76">mol_map_energy</a> (<a class="el" href="struct_bmolecule.html">Bmolecule</a> *mol, <a class="el" href="class_bimage.html">Bimage</a> *map, double Kmap)</td></tr>
<tr class="memdesc:ad14efe6199856474e3c4f71a34647f76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Energy calculation of a molecule fit into a map. <br  />
  <a href="mol__map__energy_8cpp.html#ad14efe6199856474e3c4f71a34647f76">More...</a><br /></td></tr>
<tr class="separator:ad14efe6199856474e3c4f71a34647f76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cfafe3fe596d7383ae2847c88c19eed"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__map__energy_8cpp.html#a3cfafe3fe596d7383ae2847c88c19eed">molgroup_map_correlation</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_bimage.html">Bimage</a> *map)</td></tr>
<tr class="memdesc:a3cfafe3fe596d7383ae2847c88c19eed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of the fit of a molecule group into a map as a correlation coefficient. <br  />
  <a href="mol__map__energy_8cpp.html#a3cfafe3fe596d7383ae2847c88c19eed">More...</a><br /></td></tr>
<tr class="separator:a3cfafe3fe596d7383ae2847c88c19eed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3312b0b839dd8781fb5c2d33318a97a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__map__energy_8cpp.html#ab3312b0b839dd8781fb5c2d33318a97a">mol_map_correlation</a> (<a class="el" href="struct_bmolecule.html">Bmolecule</a> *mol, <a class="el" href="class_bimage.html">Bimage</a> *map)</td></tr>
<tr class="memdesc:ab3312b0b839dd8781fb5c2d33318a97a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculation of the fit of a molecule into a map as a correlation coefficient. <br  />
  <a href="mol__map__energy_8cpp.html#ab3312b0b839dd8781fb5c2d33318a97a">More...</a><br /></td></tr>
<tr class="separator:ab3312b0b839dd8781fb5c2d33318a97a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eee27ebf6a7cc1af85c04d7b5702885"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__map__energy_8cpp.html#a2eee27ebf6a7cc1af85c04d7b5702885">molgroup_bond_fit_map_energy</a> (<a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *molgroup, <a class="el" href="class_bimage.html">Bimage</a> *map, double Kmap, int steps)</td></tr>
<tr class="memdesc:a2eee27ebf6a7cc1af85c04d7b5702885"><td class="mdescLeft">&#160;</td><td class="mdescRight">Energy calculation of a molecule fit into a map. <br  />
  <a href="mol__map__energy_8cpp.html#a2eee27ebf6a7cc1af85c04d7b5702885">More...</a><br /></td></tr>
<tr class="separator:a2eee27ebf6a7cc1af85c04d7b5702885"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mol__map__energy_8cpp.html#a0b2caeb4b6f130be43e5a2f0267dd453">verbose</a></td></tr>
<tr class="separator:a0b2caeb4b6f130be43e5a2f0267dd453"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions to calculate estimates of the fitting of molecules to maps. </p>
<dl class="section author"><dt>Author</dt><dd>Bernard Heymann </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Created: 20041230 </dd>
<dd>
Modified: 20111030 </dd></dl>

<p class="definition">Definition in file <a class="el" href="mol__map__energy_8cpp_source.html">mol_map_energy.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab3312b0b839dd8781fb5c2d33318a97a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3312b0b839dd8781fb5c2d33318a97a">&#9670;&nbsp;</a></span>mol_map_correlation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double mol_map_correlation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolecule.html">Bmolecule</a> *&#160;</td>
          <td class="paramname"><em>mol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculation of the fit of a molecule into a map as a correlation coefficient. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*mol</td><td>molecule. </td></tr>
    <tr><td class="paramname">*map</td><td>map. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double correlation coefficient. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mol__map__energy_8cpp_source.html#l00185">185</a> of file <a class="el" href="mol__map__energy_8cpp_source.html">mol_map_energy.cpp</a>.</p>

</div>
</div>
<a id="ad14efe6199856474e3c4f71a34647f76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad14efe6199856474e3c4f71a34647f76">&#9670;&nbsp;</a></span>mol_map_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double mol_map_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolecule.html">Bmolecule</a> *&#160;</td>
          <td class="paramname"><em>mol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kmap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Energy calculation of a molecule fit into a map. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*mol</td><td>molecule. </td></tr>
    <tr><td class="paramname">*map</td><td>map. </td></tr>
    <tr><td class="paramname">Kmap</td><td>map energy constant. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double energy. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mol__map__energy_8cpp_source.html#l00083">83</a> of file <a class="el" href="mol__map__energy_8cpp_source.html">mol_map_energy.cpp</a>.</p>

</div>
</div>
<a id="a2eee27ebf6a7cc1af85c04d7b5702885"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eee27ebf6a7cc1af85c04d7b5702885">&#9670;&nbsp;</a></span>molgroup_bond_fit_map_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double molgroup_bond_fit_map_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>steps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Energy calculation of a molecule fit into a map. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecule group. </td></tr>
    <tr><td class="paramname">*map</td><td>map. </td></tr>
    <tr><td class="paramname">Kmap</td><td>map energy constant. </td></tr>
    <tr><td class="paramname">steps</td><td>number of steps along a bond. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double energy.</dd></dl>
<pre class="fragment">The energy is the negative of the density at each step along a bond, rho, 
plus a fudge factor to make it positive:
    E = Kmap * ((-sum(rho)/n + avg)/std + 10)
where n is the number of voxels sampled, avg is the average of the map,
and std is the standard deviation of the map.
The force associated with this energy is the gradient at each step:
    Fx = Kmap * (rho(x+1) - rho(x-1))/(2*u)
where u is the voxel size. The contribution of a force to an atom at 
a step is weighted by the fractional distance the step is away from
the atom along the bond. 
</pre> 
<p class="definition">Definition at line <a class="el" href="mol__map__energy_8cpp_source.html#l00250">250</a> of file <a class="el" href="mol__map__energy_8cpp_source.html">mol_map_energy.cpp</a>.</p>

</div>
</div>
<a id="a3cfafe3fe596d7383ae2847c88c19eed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cfafe3fe596d7383ae2847c88c19eed">&#9670;&nbsp;</a></span>molgroup_map_correlation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double molgroup_map_correlation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculation of the fit of a molecule group into a map as a correlation coefficient. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecule group. </td></tr>
    <tr><td class="paramname">*map</td><td>map. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double correlation coefficient. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mol__map__energy_8cpp_source.html#l00128">128</a> of file <a class="el" href="mol__map__energy_8cpp_source.html">mol_map_energy.cpp</a>.</p>

</div>
</div>
<a id="ad300cdac60f9bbab302dc1835dcbdcf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad300cdac60f9bbab302dc1835dcbdcf8">&#9670;&nbsp;</a></span>molgroup_map_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double molgroup_map_energy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_bmolgroup.html">Bmolgroup</a> *&#160;</td>
          <td class="paramname"><em>molgroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_bimage.html">Bimage</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kmap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Energy calculation of a molecule fit into a map. <br  />
 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*molgroup</td><td>molecule group. </td></tr>
    <tr><td class="paramname">*map</td><td>map. </td></tr>
    <tr><td class="paramname">Kmap</td><td>map energy constant. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>double energy. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mol__map__energy_8cpp_source.html#l00023">23</a> of file <a class="el" href="mol__map__energy_8cpp_source.html">mol_map_energy.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0b2caeb4b6f130be43e5a2f0267dd453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2caeb4b6f130be43e5a2f0267dd453">&#9670;&nbsp;</a></span>verbose</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int verbose</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_d222c3909b771dd1cf1b375528c5865e.html">mol</a></li><li class="navelem"><a class="el" href="mol__map__energy_8cpp.html">mol_map_energy.cpp</a></li>
    <li class="footer">Generated on Wed Sep 1 2021 09:22:04 for Bsoft by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
