<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_class_bimage" xml:lang="en-US">
<title>Bimage Class Reference</title>
<indexterm><primary>Bimage</primary></indexterm>
<para>

<para>General image parameter class. </para>
 
</para>
<para>
<computeroutput>#include &lt;Bimage.h&gt;</computeroutput>
</para>
<simplesect>
    <title>Public Member Functions    </title>
        <itemizedlist>
            <listitem><para><link linkend="_class_bimage_1a425d720ea28e3566a1cbc1eca8ed9c8d">Bimage</link> ()</para>

<para>Initializes an image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage_1a2019f6168e64ab28ee4aecf26c608bec">Bimage</link> (const <link linkend="_class_bimage">Bimage</link> &amp;p)</para>

<para>The copy constructor. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage_1a43bf591cb81fbd5a134f22a4996f9e2a">Bimage</link> (<link linkend="_class_bstring">Bstring</link> &amp;fn, int readdata, int img_select)</para>

<para>Reads an image from a file. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage_1a05fefb596c7347a4bbc1f484ae90f6bb">Bimage</link> (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> type, <link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ctype, long nx, long ny, long nz, long nn)</para>

<para>Initializes an image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage_1a8fcb3757ada7420ce5a48fff2fb1ce0c">Bimage</link> (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> type, <link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ctype, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_class_bimage_1a8d8f237b0f540eb66bde5e5640097b18">size</link>, long nn)</para>

<para>Initializes an image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage_1abd8f2cf3ae088ca3d5d171e159571e90">Bimage</link> (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> type, <link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ctype, vector&lt; long &gt; <link linkend="_class_bimage_1a8d8f237b0f540eb66bde5e5640097b18">size</link>, long nn)</para>

<para>Initializes an image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage_1af7e9eef81a78901639de38bbdba0a5d1">Bimage</link> (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> type, long nc, long nx, long ny, long nz, long nn)</para>

<para>Initializes a generic multi-channel image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage_1a6dde3db934477ded98998ebec647881a">Bimage</link> (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> type, long nc, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_class_bimage_1a8d8f237b0f540eb66bde5e5640097b18">size</link>, long nn)</para>

<para>Initializes a generic multi-channel image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage_1a9104e8dd80432d70e95570fb4c593fa0">Bimage</link> (<link linkend="_class_matrix">Matrix</link> &amp;mat, long scale)</para>

<para>Initializes an image from a 2D matrix. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage_1ad612df25d03e9be007a57ab619e5e76e">~Bimage</link> ()</para>

<para>Image destructor. </para>
</listitem>
            <listitem><para><link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> <link linkend="_class_bimage_1a9d6a9ea88106962dc7045dc5d21437e2">guess_compoundtype</link> (long nc)</para>
</listitem>
            <listitem><para>bool <link linkend="_class_bimage_1a49f620f446bf442126513d907d05752a">check_compoundtype</link> (long nc, <link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ct)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ab123614e965e5ca895a14ccf30c234a5">check</link> ()</para>

<para>Checks an image for reasonable properties. </para>
</listitem>
            <listitem><para>bool <link linkend="_class_bimage_1a881571949007af044036c47b07b8a3c6">check_if_same_size</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Check if two images are the same size. </para>
</listitem>
            <listitem><para>bool <link linkend="_class_bimage_1a981cab4e4430114b52918a2791586777">check_if_same_image_size</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Check if two images are the same size. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a74e389c2208e3cae5d498ec60fd95a75">check_sampling</link> ()</para>

<para>Checks that the sampling is properly specified. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ad464e07a4843fb9d38eb11345b2325b6">check_resolution</link> (double &amp;resolution)</para>

<para>Checks that the resolution falls within reasonable limits. </para>
</listitem>
            <listitem><para>bool <link linkend="_class_bimage_1a2bb42c15f87e1e551f9d2dbef8491dcd">compatible</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Check if this image has the same number of channels and data type as another. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ab7bdc9cb92f3deebd4cd66188048fea6">identifier</link> (<link linkend="_class_bstring">Bstring</link> s)</para>
</listitem>
            <listitem><para><link linkend="_class_bstring">Bstring</link> &amp; <link linkend="_class_bimage_1ae1ba104935f68613cb8e63066015dc46">identifier</link> ()</para>
</listitem>
            <listitem><para><link linkend="_class_j_svalue">JSvalue</link> &amp; <link linkend="_class_bimage_1afe54a4a2c6cf53d92675a2ddae01da17">meta_data</link> ()</para>
</listitem>
            <listitem><para><link linkend="_class_j_svalue">JSvalue</link> &amp; <link linkend="_class_bimage_1ab93e5357d409d9ac9cb30c7f39fd961a">operator[]</link> (string tag)</para>
</listitem>
            <listitem><para>vector&lt; <link linkend="_class_j_svalue">JSvalue</link> * &gt; <link linkend="_class_bimage_1aa60cb47e314cac85108867d1cf9ceed9">query</link> (string &amp;path)</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1ab48733dde4aaf8c925278d983fb252fb">erase</link> (string tag)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a772035b309aa215414b94b3e1f991920">meta_data_update</link> ()</para>

<para>Update metadata from the sub-image information. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a42dd5c73484665555ed8068a6fc0f63c">update_from_meta_data</link> ()</para>

<para>Update sub-image information from the metadata. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a6882144669b3c67abb55e76d4623a40b">meta_data_retain_one_image</link> (long img_num)</para>

<para>Erases all sub-image records from the meta data except one. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a2be9f3ca7d6cb23f7310f4152bb19362">file_name</link> (string s)</para>
</listitem>
            <listitem><para>string &amp; <link linkend="_class_bimage_1aaa65612821e6125011f91454f7de7581">file_name</link> ()</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a299c87552442660b87cf243919a961fd">find</link> (<link linkend="_class_bstring">Bstring</link> fn)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1aafe7685945a1b8b18efa7e8759fd8b02">label</link> (string s)</para>
</listitem>
            <listitem><para>string &amp; <link linkend="_class_bimage_1ab8e2ac94e18695add819eff58f81d4ab">label</link> ()</para>
</listitem>
            <listitem><para>time_t <link linkend="_class_bimage_1a8bdc58228bbe84e0c029c347d0c61c9f">get_time</link> ()</para>
</listitem>
            <listitem><para>tm * <link linkend="_class_bimage_1af8bea4ff8e105e0aaf25beebd5207fc4">get_localtime</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a9143f5bc96c3fb12dada8d1be1120332">set_time</link> (time_t t)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a906cdf211bd171c7af7088c3ac70423c">set_time</link> (tm *t)</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1adab24545dd418ba976941ee9cc5aaad4">alloc_size</link> () const</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a3d289504ed427397f78837e881dc6ca3">data_size</link> ()</para>
</listitem>
            <listitem><para>unsigned char * <link linkend="_class_bimage_1a6095bea1f7ef723790ce2747a51402be">data_alloc</link> ()</para>
</listitem>
            <listitem><para>unsigned char * <link linkend="_class_bimage_1a50285748c55feaa198bc8becea39fe42">data_alloc_and_clear</link> ()</para>
</listitem>
            <listitem><para>unsigned char * <link linkend="_class_bimage_1a58ea567d0cdd61f54b15ada3663dfce1">data_alloc</link> (long nbytes)</para>

<para>Allocate image data. </para>
</listitem>
            <listitem><para>unsigned char * <link linkend="_class_bimage_1a237661723c35542419e5bb0a81ed0e94">data_alloc_and_clear</link> (long nbytes)</para>
</listitem>
            <listitem><para>unsigned char * <link linkend="_class_bimage_1a6a6de434ebeb11ba2ade23d9d463270a">data_alloc</link> (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> type, <link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ctype, long nx, long ny, long nz, long nn)</para>

<para>Allocate image data with size parameters. </para>
</listitem>
            <listitem><para>unsigned char * <link linkend="_class_bimage_1a2fc8a6b2b0cc4542d5091ee363b9949e">data_alloc_and_clear</link> (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> type, <link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ctype, long nx, long ny, long nz, long nn)</para>
</listitem>
            <listitem><para>unsigned char * <link linkend="_class_bimage_1a997d17b3f9bbd3a5b13450b0379c1aa5">data_assign</link> (unsigned char *nudata)</para>

<para>Assign image data. </para>
</listitem>
            <listitem><para>unsigned char * <link linkend="_class_bimage_1a4c9c4cd199d84788585fa0f7059facef">data_pointer</link> ()</para>
</listitem>
            <listitem><para>unsigned char * <link linkend="_class_bimage_1acc39420e691b12ecafc85dc15ccbe0f6">data_pointer</link> (long offset)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1afb4232f60f0d0582b7208845757a2c1a">data_pointer</link> (unsigned char *ptr)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1afde298560de4552e4abda21507882d29">data_delete</link> ()</para>

<para>Deallocates the image data. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1aab570544ea8a468fc75005223bce4faf">data_offset</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a2d42f4d6f9070c0ec55e68b78eb3c9f0">data_offset</link> (long doff)</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a273fc6371ef29fae7e1150552334b262">image_size</link> ()</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> &amp; <link linkend="_class_bimage_1a04b048e81f60b70ed447b2f320fd2a84">operator=</link> (const <link linkend="_class_bimage">Bimage</link> &amp;p)</para>

<para>Assigns an image. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1ae7e22c15acc26a18a01f9ffe932dc7dd">operator[]</link> (long j) const</para>

<para>Returns the data value at the given index. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1aa3fe0a2bedf7cd2fa732e4af2fbcb8fe">get</link> (long nn, long xx, long yy, long zz, long cc=0)</para>

<para>Returns the data value at the given coordinates. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1aa9cbc0cc1004deca981a0b5b20850c20">get</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; vox, long cc=0)</para>

<para>Returns the data value at the given coordinates. </para>
</listitem>
            <listitem><para>vector&lt; double &gt; <link linkend="_class_bimage_1a6ca731eb52bfb717eb037284aa5f5948">values</link> (long i)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a0c5c2a2c6d2b645b5c076703c2ef35c4">values</link> (long i, vector&lt; double &gt; val)</para>
</listitem>
            <listitem><para>vector&lt; double &gt; <link linkend="_class_bimage_1aab1bb8c97d8f6513ae63dc0f101f4f81">values</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; vox)</para>

<para>Returns an array with all channel data at the given coordinates. </para>
</listitem>
            <listitem><para><link linkend="_class_complex">Complex</link>&lt; double &gt; <link linkend="_class_bimage_1a7feb28efaaf52eddebd38d00066a1a2e">complex</link> (long j)</para>

<para>Returns a complex value at the given index. </para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a47314981f2e8b29a34b0eeba3f25e541">vector3</link> (long j)</para>

<para>Returns a 3-value vector at the given index. </para>
</listitem>
            <listitem><para><link linkend="_class_r_g_b">RGB</link>&lt; double &gt; <link linkend="_class_bimage_1a2d343109d74d589f4fc4ce873b4f9e03">rgb</link> (long j)</para>

<para>Returns a color value at the given index. </para>
</listitem>
            <listitem><para><link linkend="_class_r_g_b_a">RGBA</link>&lt; double &gt; <link linkend="_class_bimage_1a7bffddc51e0a60f24d2768534501f9d7">rgba</link> (long j)</para>

<para>Returns a color value at the given index. </para>
</listitem>
            <listitem><para><link linkend="_class_c_m_y_k">CMYK</link>&lt; double &gt; <link linkend="_class_bimage_1af778ba174284334f20ddef7fc191b249">cmyk</link> (long j)</para>

<para>Returns a color value at the given index. </para>
</listitem>
            <listitem><para><link linkend="_union_type_pointer">TypePointer</link> <link linkend="_class_bimage_1a17ae6d409fb5708f0393e8629699b8ec">fill_value</link> (double v)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a7f091b084f0e714284d7c761dd4c0b15">set</link> (long j, double v)</para>

<para>Sets a single value at the given index. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a44a60b5de3fd18a6c8e0858af9cd65b8">set</link> (long j, <link linkend="_class_complex">Complex</link>&lt; double &gt; cv)</para>

<para>Sets a complex value at the given index. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1abff9753006d934364d77b51c87b34fa4">set</link> (long j, <link linkend="_class_r_g_b">RGB</link>&lt; double &gt; color)</para>

<para>Sets a color value at the given index. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a0e4265c10a266a3f930f0f773f4d1d45">set</link> (long j, <link linkend="_class_r_g_b_a">RGBA</link>&lt; double &gt; color)</para>

<para>Sets a color value at the given index. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a08e615360c7c3c68ed3144acccf40f02">set</link> (long j, <link linkend="_class_c_m_y_k">CMYK</link>&lt; double &gt; color)</para>

<para>Sets a color value at the given index. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a53c53e826eac2717012b6c08e04c0d9a">set</link> (long j, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec)</para>

<para>Sets a 3-value vector at the given index. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a30e0d8a5922143b1c8edba5c07aacb13">set</link> (long j, <link linkend="_class_view">View</link> <link linkend="_class_bimage_1ab474ad5f14737ab4931c0171a5d95579">view</link>)</para>

<para>Sets a 3-value vector at the given index. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1af77f64f607b94b80056a05befc2b686d">add</link> (long j, double v)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a04cec4b61e523881e5cc05f62c0058a8">add</link> (long j, <link linkend="_class_complex">Complex</link>&lt; double &gt; cv)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a5557cef39f005b06b6bd75993a75e54f">add</link> (double xx, double yy, double zz, long nn, double v)</para>

<para>Adds a value at a given location to neigboring data elements. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a059a3df092b74a3b4f56ef2623a1a45d">set_max</link> (double xx, double yy, double zz, long nn, double v)</para>

<para>Sets a value at a given location to neigboring data elements if it is larger. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ad3852c4e4ecd306c5d6abc09f3d78f7f">multiply</link> (long j, <link linkend="_class_complex">Complex</link>&lt; double &gt; cv)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a536c5f24e8492683cc0c65678c524ed2">average2D</link> (long cc, double xf, double yf, double zf, long nn, double iscale)</para>

<para>Averages in the xy plane when scaling is less than 1. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a8b7559f244271ee490d3746da9a02378">average</link> (long cc, double xf, double yf, double zf, long nn, double iscale)</para>

<para>Averages in 3D when scaling is less than 1. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a42ed6903b8c8e716f55c8bd7d884c9b0">interpolate</link> (long cc, double xx, double yy=0, double zz=0, long nn=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0) const</para>

<para>Interpolates using a given location. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a846421e8a35109bb1f20dbe772ccc677">interpolate</link> (double xx, double yy=0, double zz=0, long nn=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0) const</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a3fb5f320d3082349fa4706966eb1af6c">interpolate</link> (long cc, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec, long nn=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0) const</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1aa2f7ba2720f2852ee89d471b885f03cb">interpolate</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec, long nn=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0) const</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a5bdece81eeb52253229885c3911d4316">interpolate</link> (vector&lt; double &gt; vec, long nn=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0) const</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1af23dc8034036c8ac619601259ead7444">interpolate_wrap</link> (long cc, double xx, double yy=0, double zz=0, long nn=0) const</para>

<para>Interpolates using a given location with wrapping. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a08401d5d8da91205f95925898575903b">interpolate_wrap</link> (double xx, double yy=0, double zz=0, long nn=0) const</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1accbcd90dfa5c60b281ab2efb975f2d38">interpolate_wrap</link> (long cc, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec, long nn=0) const</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1aa621195acbabd5c81c769d0ca17e9041">interpolate_wrap</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec, long nn=0) const</para>
</listitem>
            <listitem><para><link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> <link linkend="_class_bimage_1a3f8daaa394b40c3d3fec19e544125e5c">data_type</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a682d0ecb697de9856110a4ad841fb70c">data_type</link> (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> dt)</para>
</listitem>
            <listitem><para><link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> <link linkend="_class_bimage_1a94f685cb874a2593c8520b18962be360">compound_type</link> ()</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1aa2ad0e179f96e2d7fa0bb02d9853c1b6">compound_type</link> (<link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ct)</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1ab5b8a851da4087a959b592c4645c755b">data_type_bits</link> () const</para>

<para>Returns the size of the datatype in bits. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a7d72f814a078c88879693bbf71b54cf5">data_type_size</link> () const</para>

<para>Returns the size of the datatype in bytes. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1aba25aac6daf2be313372df9017583703">compound_type_size</link> ()</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a96111e0fd5ff64a7e037dcba8235b823">data_type_min</link> ()</para>

<para>Get the minimum of a datatype. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1ac7b1bfcf9448a2a6ab4ae52ee7725a81">data_type_max</link> ()</para>

<para>Get the maximum of a datatype. </para>
</listitem>
            <listitem><para><link linkend="_class_bstring">Bstring</link> <link linkend="_class_bimage_1a93ad6a3996ad556af36d215b4eb47904">data_type_string</link> ()</para>

<para>Get the string representation of a datatype. </para>
</listitem>
            <listitem><para><link linkend="_class_bstring">Bstring</link> <link linkend="_class_bimage_1a6d7eaa823a3e59fde34b41efa65bc64f">compound_type_string</link> ()</para>

<para>Get the string representation of a datatype. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ad5c08defb61a7aa665e94d222ea88d08">fix_type</link> ()</para>

<para>Determines the replacement data type. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1aaf2848239c21e111b23b87b4c2a95dd5">change_type</link> (char letter)</para>

<para>Get the data type indicated by a single letter code. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a5edb27a22dcc386452236472c6a1c916">change_type</link> (char *string)</para>

<para>Get the data type from a string. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a05ed25186621c0611497ee8738e9d602">change_type</link> (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> nutype)</para>

<para>Change the data to the new type. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a33659b73113d0d84e2482517310311d5">split_channels</link> ()</para>

<para>Splits the channels into individual images. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ad307b8fb1ce8c72a850c3ceb0fe89002">combine_channels</link> (long nc, <link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ct=<link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36ad83a0f556634bd31d3357be2a64aac4c">TSimple</link>)</para>

<para>Combines images as channels. </para>
</listitem>
            <listitem><para><link linkend="__bimage_8h_1a01e0deba350901d769526633e868806f">FourierType</link> <link linkend="_class_bimage_1a2fd16f09564f26841e4e0468ae3a232f">fourier_type</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a2bc472566e81a653bf7659c2f26fd0e9">fourier_type</link> (<link linkend="__bimage_8h_1a01e0deba350901d769526633e868806f">FourierType</link> tf)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a7c09597809c7610566d5615cf9dbfca1">zero_fourier_origin</link> ()</para>

<para>Zeroes the first voxel in each image. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a6430319a01ff1931cf0d88fb92abca6e">channels</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a867c0564aeba2d80617b4f3b6be737da">channels</link> (long cc)</para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_class_bimage_1a8d8f237b0f540eb66bde5e5640097b18">size</link> () const</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a04248059b87991c9de87d916c3dacfe9">size</link> (long nx, long ny, long nz)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ad92c7423ec3efeebff4da5fc880282bb">size</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; vec)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a15a3862564a94ee0bef5c1d2b0a33180">size</link> (vector&lt; long &gt; vec)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a8a7935b0778f079de4436a87e6007beb">sizeX</link> (long nx)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a24fff6fffe26b2cf9954c7086838deac">sizeY</link> (long ny)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1aa0af0b19b20a1f3a29f6d46cf0a38964">sizeZ</link> (long nz)</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a573098677821d6cb2a3f971a60600585">sizeX</link> () const</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a950470752066c7c8c3a42df1dcbba815">sizeY</link> () const</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a598f1a14a9194965bb93d57c0510536f">sizeZ</link> () const</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a760143d3cb8fd5d6e1245ecd215821a2">index</link> (long nx, long ny) const</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a3ce1e553efbc68da56f446626a005142">index</link> (long nx, long ny, long nz) const</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a6114a3346ee83eed50e799fd887c1302">index</link> (long nx, long ny, long nz, long nn) const</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1aa40279a9386d8c571cf573ec7f2c328f">index</link> (long nc, long nx, long ny, long nz, long nn) const</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a83754238aa74181ac04e7effd55b1e5f">index</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; vox, long nn) const</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1aed40effbf49e57048e306d2df8f24177">index</link> (vector&lt; long &gt; vox, long nn) const</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1abd88814c41f2c26ecdfef9febc8c1b42">index_wrap</link> (long nx, long ny, long nz) const</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a44270f08caaa5aced16a390e07cc34d3">index_wrap</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; coor) const</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a9b5df5f5d1d2702085b6f2cc958fb5e8">index_wrap</link> (vector&lt; long &gt; coor) const</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ad1f822e981215b18e7ee27df213fce0e">coordinates</link> (long i, long &amp;nx, long &amp;ny, long &amp;nz)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a8db6a06e7407d98678c38eb4787cc059">coordinates</link> (long i, long &amp;nx, long &amp;ny, long &amp;nz, long &amp;nn)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a16063cd8e18671cad87e0fa63b5b3858">coordinates</link> (long i, long &amp;nc, long &amp;nx, long &amp;ny, long &amp;nz, long &amp;nn)</para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_class_bimage_1a6cd4fa6eda1e22952da949e76419ee57">coordinates</link> (long i)</para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a02752b6d64220d5d43dfae13fc137e7a">real_coordinates</link> (long i)</para>
</listitem>
            <listitem><para>template&lt;typename T &gt; </para><para>bool <link linkend="_class_bimage_1af5185f2ed4cc550d97a5520280de9b48">within_boundaries</link> (<link linkend="_class_vector3">Vector3</link>&lt; T &gt; loc)</para>
</listitem>
            <listitem><para>bool <link linkend="_class_bimage_1a3e84daec20bb95e8212c96f06e308de5">within_boundaries</link> (long xx, long yy, long zz)</para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_class_bimage_1a72bc35687c981aa55d62dcf9e3570e5c">kernel_low</link> (long i, long k=1)</para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_class_bimage_1a2dd984aa0e02aaa010809ea24d6dcc5e">kernel_high</link> (long i, long k=1)</para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_class_bimage_1ad6a66e3de0c548eee2ae3ca0450aac8c">kernel_low</link> (long i, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; k)</para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_class_bimage_1a6ebd22065c652bcdcb53994029ca6295">kernel_high</link> (long i, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; k)</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a8b90b99ccc3c50f979020d2f8cf5fb97">kernel_min</link> (long idx, long ksize)</para>

<para>Finds the highest value in a kernel. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a8f902f05afe1d97fd1e90a25aecc4532">kernel_max</link> (long idx, long ksize)</para>

<para>Finds the highest value in a kernel. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a32603276232d08670b1f5f119d2b2614">kernel_average</link> (long idx, long ksize, double tmin, double tmax)</para>

<para>Finds the highest value in a kernel. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1acc44e2b417abe30a685105ab38662a77">kernel_max_neigbor</link> (long idx, long ksize)</para>

<para>Finds the highest value in a kernel excluding the central voxel. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1ae2082eb0532625c9807b85c1052921c6">kernel_max_wrap</link> (long idx, long ksize)</para>

<para>Finds the highest value in a kernel with wrapping. </para>
</listitem>
            <listitem><para>multimap&lt; double, long &gt; <link linkend="_class_bimage_1aca34b56eec25e8568c1264ec3c1b2234">kernel_order</link> (long idx, long ksize)</para>

<para>Orders the values in a kernel. </para>
</listitem>
            <listitem><para>multimap&lt; double, long &gt; <link linkend="_class_bimage_1a6517dc1d9d1234580ff7de7cba084325">kernel_order_neighbors</link> (long idx, long ksize)</para>

<para>Orders the neigbor values in a kernel. </para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_class_bimage_1ac787040056b9bf818fbed85b274d5966">page_size</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a6a2a0a9e54ad670ae18e36cf0c2ad397">page_size</link> (long nx, long ny, long nz)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a9f4598b33854f980fbc035ad2745380e">page_size</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; vec)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1acde654e87de96fccb0b430c9ac1c7693">page_size</link> (vector&lt; long &gt; vec)</para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1ae40d87dc98e649c9183f5566de964b32">real_size</link> ()</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1ac5f3b612ae93528dca78ca1641e1f2b6">images</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1aeb76d8399487a3d520985726e25ae3a0">images</link> (long nn)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1af38e5d5dbc312e6ee7f56a7c962e62d5">voxel_size</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1aea6d4d42a222c4916583a05e196e0fd1">sampling</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; u)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1af1e1de0aa7f12bb2db5dba29f400cce7">sampling</link> (long nn, double ux, double uy, double uz)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1aadcb407c60a020cea5a03823a958f26e">sampling</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; u)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a44553b4ff840993fa3911892949b46f7">sampling</link> (double ux, double uy, double uz)</para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a986b9bf2b43b4bc3ba2670794604da07">sampling</link> (long nn)</para>
</listitem>
            <listitem><para>vector&lt; <link linkend="_class_vector3">Vector3</link>&lt; double &gt; &gt; <link linkend="_class_bimage_1a12c7c8891367557aef7043dd2774c9fa">sampling</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a6e9a4660f2ae9526391c3551e77d70d5">sampling</link> (vector&lt; <link linkend="_class_vector3">Vector3</link>&lt; double &gt;&gt; sam)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a33db3f86c385dc4b3d8738d0ad0c59a3">minimum</link> ()</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1ad56cad9380fe0b08593627bbc7f8d795">maximum</link> ()</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a3de98170ee996fa85f1802250e646a87">average</link> ()</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1ad055b167896256474d3cf3cf6bb5c6a4">standard_deviation</link> ()</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a4bf8a5dccfa06f31723598cfb9f08a22">variance</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a9dc7ace6085b582d96077515becacf8f">minimum</link> (double d)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a28e3f6e31813aa176f38b1a18e2d800c">maximum</link> (double d)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a95753acb1cb55e4e013e0b4a486a5c01">average</link> (double d)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a70982cf915d12b0d32511c299dd2a003">standard_deviation</link> (double d)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1adbfb6a4d3284e436475955bc786ac840">background</link> (long nn)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1aa931beeddd098f0759308ef1e11c076c">background</link> (long nn, double bkg)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a69f89659be398fec283e1c267f33c190">background</link> (double bkg)</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a2341b7e858a5c023cd4be98b1ab64773">show_image</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a9391231710bedec11f8bddad05150770">show_image</link> (long nn)</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1af903a9c1e50c06aafeb8464426d88a3b">show_slice</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a29efa892a7c10ec5a88b3f686f97045d">show_slice</link> (long nz)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1af9f10d298cff665dca49330d90e3b2f6">show_scale</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a37bf22fd62b24a81897e5a69bcd85784">show_scale</link> (double scale)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1ac845ec573ac4f2e8d2da9806a27423ed">show_minimum</link> ()</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a15c6ec8dead569920900c0abef394fa3">show_maximum</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1af5616baac679d6a1250d86db6ecba273">show_minimum</link> (double v)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a3db073fe28ad4546b95b2f8993cfc2de">show_maximum</link> (double v)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1abbbc219bc9f6b027e29563617a756bbd">origin</link> (double ox, double oy, double oz)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a0b38a7622f63be6254386f29aee89d57">origin</link> (vector&lt; double &gt; vec)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a1395858573fc8bc13d5d1ab966f09625">origin</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a98e0a30cc0f50a48a0cb5e6301a51ea0">origin</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1af34a10d6c3278ff9f9aeafd0eef4e55c">origin</link> (long nn, vector&lt; double &gt; ori)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a26f0c689d93792813cd398f42b0eeabf">origin</link> (long nn, double ox, double oy, double oz)</para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a29a5efdaa4116dc8d6aa4826384c4076">default_origin</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ab474ad5f14737ab4931c0171a5d95579">view</link> (double vx, double vy, double vz, double va)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ab13be5e642f025a863a9ac1a50d75ab9">view</link> (<link linkend="_class_view">View</link> vw)</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a06916652b8d41c5bad363331a0095862">space_group</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ad458840e2a3e8969140355c131443cad">space_group</link> (unsigned int grp)</para>
</listitem>
            <listitem><para>string &amp; <link linkend="_class_bimage_1a7e1793d4db04c33e603983b47c95b0ba">symmetry</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a356f24e44b64a98a02e7e3100e3349a9">symmetry</link> (string grp)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a3b435df6c3ad057b73957aad67172ea5">unit_cell</link> (<link linkend="_class_unit_cell">UnitCell</link> uc)</para>
</listitem>
            <listitem><para><link linkend="_class_unit_cell">UnitCell</link> <link linkend="_class_bimage_1a58e341bd1fde6068b484a265a546b39a">unit_cell</link> ()</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a8043e568eb8132fa03ada899c4ac25fb">maximum_included_radius</link> ()</para>

<para>Returns the radius of the enclosed sphere or circle. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aacbdfdfe1d47935021b5868821eb4f89">slices_to_images</link> ()</para>

<para>Changes the slices in a 3D image into a set of 2D images. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a678987573053e7625c499abc35a7e817">images_to_slices</link> ()</para>

<para>Changes the 2D images to slices in a 3D image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a30d9c3a12d258a7344378aeb8e56eed6">channels_to_images</link> ()</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1acb066a1d47146efdaf38df32adb0574a">images_to_channels</link> (long nc, <link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ct)</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1aeff910cb0d91aa55d4ec824e2ecf2b58">set_subset_selection</link> (<link linkend="_class_bstring">Bstring</link> list)</para>

<para>Sets the sub-image selections based on a list. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a416e421f9c6a2043c34f223a9df49bef">delete_images</link> (<link linkend="_class_bstring">Bstring</link> list, int retain=0)</para>

<para>Retains or deletes sub-images from a multi-image structure. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1ad890b6b933f3f467cf30b787b0d7bbc4">select_images</link> (<link linkend="_class_bstring">Bstring</link> list)</para>
</listitem>
            <listitem><para>unsigned char * <link linkend="_class_bimage_1aa758e00d61b0cf27d877e46a8054d93c">read_data</link> (ifstream *fimg, int img_select, int <link linkend="_rw_d_m_8cpp_1a7f7475c3cffaf702ef2766959df86817">sb</link>, int vax, long <link linkend="_class_bimage_1a130d1713a0034d563b93034b05680768">pad</link>)</para>

<para>Read image data in a generalized style. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a3acc3a092a8e100f263dbf6625863b72">write</link> (<link linkend="_class_bstring">Bstring</link> &amp;fn)</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a5d169bcc5a3105a3b258b3d62449618f">unpack_transform</link> (unsigned char *data, <link linkend="__bimage_8h_1a01e0deba350901d769526633e868806f">FourierType</link> tf)</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1abac3ddeaa17b3475f3023da92ddbc786">unpack_transform</link> (int img_select, unsigned char *data, <link linkend="__bimage_8h_1a01e0deba350901d769526633e868806f">FourierType</link> tf)</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a3d0d22533e811d43ee246eae948bb5a8">pack_transform</link> (unsigned char *data, <link linkend="__bimage_8h_1a01e0deba350901d769526633e868806f">FourierType</link> tf)</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aac6a00076ac48cd4a17d3aa9504ba5ed">pack_transform</link> (int img_select, unsigned char *data, <link linkend="__bimage_8h_1a01e0deba350901d769526633e868806f">FourierType</link> tf)</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a164807e87f62d5e817344738f69b8c16">statistics</link> ()</para>

<para>Calculates the statistics for an image. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a1d479463c3714a99b670129d62d3fe7a">statistics</link> (long img_num)</para>

<para>Calculates the statistics for a sub-image. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a0e4bd3138163814bd4f96e38d8f9d5fd">statistics</link> (<link linkend="_class_bimage">Bimage</link> *pmask, double &amp;regavg, double &amp;regstd)</para>

<para>Calculates the statistics for a region in an image. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a870a8b94b0a187b9020eb97a01c98962">poisson_statistics_check</link> ()</para>

<para>Checks whether the statistics conform to a Poisson distribution. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1acce5020e4d29e2e0fc0b3ee369b68bc0">stats_within_radii</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; loc, double rad_min, double rad_max, double &amp;vavg, double &amp;vstd)</para>

<para>Calculates the statistics for an image within given radii from a location. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1af67e899354c36a6d1a4abdb37136f079">stats_in_shape</link> (long nn, int type, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; start, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; end, double &amp;vavg, double &amp;vstd)</para>

<para>Calculates the statistics for an image within the given box. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a4524e0f31e3c2c83e3d579cb199aa03f">stats_in_poly</link> (long nn, int nvert, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; *poly, double &amp;vavg, double &amp;vstd)</para>

<para>Calculates the statistics for an image within the given polyhedron. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1ac6e146a61ad251fc4e5562495f6021aa">stats_in_mask</link> (long nn, <link linkend="_class_bimage">Bimage</link> *pmask)</para>

<para>Calculates the statistics for an image for each level in a mask. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a9dff1ffc38196ca423bf5f842fc3c1e6">variance</link> (long kernel_size, int flag=0)</para>

<para>Calculates the local variance within the given kernel. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a3f1e1cdce8cdbf4f060da4c6bb22df70">variance</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; kernel_size, int flag=0)</para>

<para>Calculates the local variance within the given kernel. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1afc9022fbf57ed364f1c2f52b71f7af4d">variance</link> (<link linkend="_class_bimage">Bimage</link> *pweight)</para>

<para>Calculates the local variance weighed with the given image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ad034e4aef862674587ca3e5f83d50a06">information</link> ()</para>

<para>Prints out header information for an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ac63bc84ebfa0da20f4783d5406fb0ada">subimage_information</link> ()</para>

<para>Prints out header information for all sub-images. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a4f3d8867cba26161c0d95971a8714496">moments</link> (long max_order)</para>

<para>Prints out moments for all sub-images. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a0fae7890cf81c93fa08a4234d426e72d">moments</link> (long max_order, long nn)</para>

<para>Prints out moments for one sub-image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a26b30eb05be0db04eb94f479bbd7703b">get</link> (<link linkend="_class_bstring">Bstring</link> tag)</para>

<para>Prints out header information associated with a tag string. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a5d95c9ec5072c183f3a8f46856ad3c21">copy</link> ()</para>

<para>Copies the header information and data of an image into a new image structure. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1ae857443aef660818821614dbf350a334">copy</link> (long nu_nimg)</para>

<para>Copies the header information and data of an image into a new image structure. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a743633e6ef75cd6c5a10964cad2db5c6">copy_header</link> ()</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a6f33c5b1b205f62ce1bd85fd5f9fee3a">copy_header</link> (long nu_nimg)</para>

<para>Copy an image structure into a new one. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1ad694d6b8be2285e48d93cf19933448bc">extract</link> (long nn)</para>

<para>Extracts one sub-image into new image structure. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a2703b464380e42f9a66433f04769da33">extract</link> (long n1, long n2)</para>

<para>Extracts a set of sub-images into new image structure. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a75becde8dfa02b97efe042a439ac4766">extract</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; coords, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_class_bimage_1a8d8f237b0f540eb66bde5e5640097b18">size</link>, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Extracts a region of one sub-image into new image structure. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a80739cb244177d56a44851de64c2ab89">extract</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; loc, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_class_bimage_1a8d8f237b0f540eb66bde5e5640097b18">size</link>, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1abbbc219bc9f6b027e29563617a756bbd">origin</link>)</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a1525f8c9e7b34b3c620f75ec01983bcc">extract</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; loc, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_class_bimage_1a8d8f237b0f540eb66bde5e5640097b18">size</link>, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1abbbc219bc9f6b027e29563617a756bbd">origin</link>, <link linkend="_class_matrix3">Matrix3</link> mat)</para>

<para>Extracts a region of one sub-image into new image structure. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1acd966ad2abdd53d849eff4a21e216281">extract</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; loc, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_class_bimage_1a8d8f237b0f540eb66bde5e5640097b18">size</link>, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1abbbc219bc9f6b027e29563617a756bbd">origin</link>, <link linkend="_class_view">View</link> <link linkend="_class_bimage_1ab474ad5f14737ab4931c0171a5d95579">view</link>)</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a1bf79966f25b70ab6cf0d07445709c47">extract_wrap</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; loc, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_class_bimage_1a8d8f237b0f540eb66bde5e5640097b18">size</link>, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1abbbc219bc9f6b027e29563617a756bbd">origin</link>, <link linkend="_class_matrix3">Matrix3</link> mat)</para>

<para>Extracts a region of one sub-image into new image structure with wrapping. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a14699480a55fbaba89bb70572d74fd71">extract_wrap</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_class_bimage_1a8d8f237b0f540eb66bde5e5640097b18">size</link>, <link linkend="_class_matrix3">Matrix3</link> mat)</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a25a878694c06b1bd8f60792138f69ff1">extract_shell</link> (long nn, double minrad, double maxrad)</para>

<para>Extracts a shell from an image into a new image. </para>
</listitem>
            <listitem><para>vector&lt; <link linkend="_class_vector3">Vector3</link>&lt; long &gt; &gt; <link linkend="_class_bimage_1ad8ef4e4f4bf08e4282763b429c2ff060">tile_coordinates</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; &amp;start, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; &amp;region, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; &amp;tile_size, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; &amp;step_size, int exceed)</para>

<para>Generates a set of tile coordinates for an image. </para>
</listitem>
            <listitem><para>vector&lt; <link linkend="_class_vector3">Vector3</link>&lt; long &gt; &gt; <link linkend="_class_bimage_1a6c8ec73b38f79aca1d59c87ed1a7d27c">tile_coordinates</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; &amp;step_size)</para>

<para>Generates a set of tile coordinates to fit in the image dimensions. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a3555dcbcffc041936d1b79f082782c8e">extract_tiles</link> (long nn, vector&lt; <link linkend="_class_vector3">Vector3</link>&lt; long &gt;&gt; &amp;coords, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size)</para>

<para>Extracts a set of tiles at specified positions from an image into a new image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a3b36947546650566f8889ca3e5eb0e46">extract_tiles</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; start, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; region, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; step_size, int exceed)</para>

<para>Extracts a set of tiles from an image into a new image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1af74c7e919d334bed98157c96e68b5f72">extract_tiles</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size, double fraction=0.2)</para>

<para>Extracts a set of tiles from an image into a new image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a1764bd1bafd971269b576790b810767c">extract_tile_stack</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; coords, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Extracts a stack of tiles at a specified position from an image into a new image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> ** <link linkend="_class_bimage_1ae77dc7a2908d4c822b6040d52c8b6877">extract_tile_stacks</link> (vector&lt; <link linkend="_class_vector3">Vector3</link>&lt; long &gt;&gt; &amp;coords, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size)</para>

<para>Extracts stacks of tiles at a specified positions from an image into an array of new images. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a892f52f8f20dc7804f1ad1b2c9680d36">extract_line</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; end, long width)</para>

<para>Extracts a line from an image into a new image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a83d370c2c5b46f2e3efa77adf4ff50f0">extract_tetrahedron</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; *tet, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Extracts a tetrahedral part of the image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a355e6600b5f741910cb5ddfbd3b561f6">orthogonal_slices</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; voxel, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; ext_size)</para>

<para>Extracts orthogonal views around a voxel. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a80a6e4158e822bc0580169327cd67b0c">extract_show_chunk</link> (<link linkend="_class_bimage">Bimage</link> *pshow, int aflag, long i, long len)</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a6ba5d23997bcbed499347362560988da">extract_show</link> (int aflag)</para>

<para>Converts a slice from an image to a 2D plane for display. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1ab2528c48b7c82f19008a343ccfc42c7d">extract_magnify</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_class_bimage_1a5f9345465a753a4ace75a2b1d7c379ba">center</link>, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; ext_size, double scale)</para>

<para>Extracts a region from an image to magnify. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a89fb7c035e1a7dab3a3b1aa92ee821f8">extract_slice</link> (long nz)</para>

<para>Extracts a given slice or slices from an image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a954793f4d58397221196ccb9c2ef1a67">extract_filament</link> (long img_num, double width, int axis, long nspline, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; *spline)</para>

<para>Extracts a filament defined by a series of coordinates. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a3e690ba847608adfe186083d63e0a8f8">replace</link> (<link linkend="_class_bimage">Bimage</link> *img)</para>

<para>Replaces the data with that from the given image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a42023ed856fd661419b1d2ac9d4f7508">replace</link> (long nn, <link linkend="_class_bimage">Bimage</link> *img, long nr=0)</para>

<para>Replaces one sub-image in an image structure. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a9898fd3b514d2f774ddd72c2673450a0">replace</link> (long nn, <link linkend="_class_bimage">Bimage</link> *img, long nr, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>)</para>

<para>Replaces one sub-image in an image structure. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ab8db25e2cb2d3057af80e8469cd3cb77">clear</link> ()</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link> (double v)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a0df18d85c91d522f3f3c2d8ea56b1850">density</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; coord, double radius, double &amp;sigma)</para>

<para>Calculates the density in a sphere around a coordinate in an image. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1ab423ab772f8f5370378c3ca39d89ffaf">density</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; coord, double radius)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a53c0e1a29c59f66cea84af7fbc18fd14">relative_density</link> (<link linkend="_class_bimage">Bimage</link> *pmask)</para>

<para>Calculates the relative density in a region defined by a mask. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a59438cff519b5ec327b7ef909e761984">invert</link> ()</para>

<para>Inverts the data in the image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a46db3bd25b8e4a6477a4ef686604ceab">reslice</link> (const char *order)</para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ad5ed5dc6affb2312432591d328c6d27b">reslice</link> (<link linkend="_class_bstring">Bstring</link> order)</para>

<para>Switches axes of an image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1aba22e1bb37a9565161d49c7908f2fce7">add</link> (double v)</para>

<para>Adds a constant value to an image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a8f53c71f2d4540295de067659d4d3e26">multiply</link> (double v)</para>

<para>Multiplies an image with a constant value. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1aba8ca57c4383b415ab312f8be4fcf309">multiply</link> (long nn, double v)</para>

<para>Multiplies a sub-image with a constant value. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1afe8d4e28cfbfe3c22d340b7e1d20fb77">power</link> (double v)</para>

<para>Calculates the power of an image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1aca83b7f355394a839d387473c46cb804">sum_images</link> ()</para>

<para>Adds all sub-images. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a7a758b80d8b664281665fd2a22183024">average_images</link> ()</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a34e86e673f3794fc9f2ec5c04540c2a4">average_images</link> (bool sd)</para>

<para>Averages all sub-images and optionally calculates standard deviation image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1abc3633f91294bf9cd72154da5aa885b4">moving_sum</link> (long window, long step=1, int flag=0)</para>

<para>Calculates a moving sum of the sub-images. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a9881cc5ba252117b04982537fcade7ec">progressive_sum</link> ()</para>

<para>Progressive sum of the sub-images. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a3caf0fd81251dd1d57aa3fb336000591">add</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Adds another image to an image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a172ef81a15fd705cd86f2479d4ab307c">add</link> (long nn, <link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Adds another image to a sub-image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a7349e99d1a9375c118ca86b69d387f0f">subtract</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Subtracts another image from an image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a1d255c2a8212c0d798c04135f95d8ab7">add</link> (<link linkend="_class_bimage">Bimage</link> *p, double scale, double <link linkend="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99">shift</link>)</para>

<para>Adds another image to an image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a4f7eff4366c6603d8c6f95960e4883cf">add</link> (long nn, <link linkend="_class_bimage">Bimage</link> *p, double scale, double <link linkend="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99">shift</link>)</para>

<para>Adds another image to an image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a06577441795cc23f8f149d453167f4f4">multiply</link> (<link linkend="_class_bimage">Bimage</link> *p, double scale, double <link linkend="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99">shift</link>=0)</para>

<para>Multiplies an image with another image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a62301788f8dd6bb54f498908100c6144">multiply</link> (long nn, <link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Multiplies a sub-image with another image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a546a12884111b3559dd39393b33344e7">multiply</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Multiplies all sub-images with the first sub-image of the other image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a34fcf4e33e69ef544b67855d7a64b8ea">divide</link> (<link linkend="_class_bimage">Bimage</link> *p, double scale=1, double <link linkend="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99">shift</link>=0)</para>

<para>Divides the first image by the second. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1afcc8a26a38fe1b41c707793d44bb37de">divide_one</link> (<link linkend="_class_bimage">Bimage</link> *p, double scale=1, double <link linkend="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99">shift</link>=0)</para>

<para>Divides the first image by the first sub-image of the second. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a75e17a1198d60941bc2a64a563d99622">inverse</link> (double minval=0)</para>

<para>Calculates the inverse of the image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1aee6dd952940fd6084b5e8a4674e708b2">largest</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Selects the largest of each pixel from two images. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1aa7fd506ba5395c911834305a76c3fe66">smallest</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Selects the smallest of each pixel from two images. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1aad018ca33d662271a36e48fbf559240d">operator+</link> (<link linkend="_class_bimage">Bimage</link> &amp;p)</para>

<para>Adds two images together, adjusting for size difference. </para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1a43916985ee29b7482e3d0bbcd97b68b7">plot</link> ()</para>

<para>Converts a one-dimensional image into a plot. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1aa3c2b8af69df7f99b805f0e0a226e59d">vector_to_simple</link> ()</para>

<para>A vector image is converted to a simple image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a48263b31ee57d8c986bb1256413b71bd">sum</link> (long m, <link linkend="_class_bimage">Bimage</link> **p)</para>

<para>Sums an array of images with their FOM blocks. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ac8555d13111d99d6736cafc5e9d36232">catenate</link> (long m, <link linkend="_class_bimage">Bimage</link> **p)</para>

<para>Catenates an array of images of the same size into a multi-image structure. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a460f2d1622dafdaeb8fc1d61dd0ec462">blend</link> (<link linkend="_class_bimage">Bimage</link> *p, long number)</para>

<para>Blends the two images, creating a new set of sub-images. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1af1d647152e38cede66380147e1bcf1ca">place</link> (long nn, <link linkend="_class_bimage">Bimage</link> *p, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; loc, double radius=0, double scale=1, double <link linkend="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99">shift</link>=0, int operation=0)</para>

<para>Places a small image into a large image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a9011e8d831cdcc0327736162163abd17">place_with_addition</link> (<link linkend="_class_bimage">Bimage</link> *p, long nn)</para>

<para>Packs a tile into a new composite image with addition within overlap. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a421ea2ee53d684fb3a5c54f46a0e8b2a">place_with_overlap</link> (<link linkend="_class_bimage">Bimage</link> *p, long nn)</para>

<para>Packs a tile into a new composite image with weighted overlap. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a1435a37676ede35fc90a5414851a0c41">place_central_part</link> (<link linkend="_class_bimage">Bimage</link> *p, long nn)</para>

<para>Packs a tile into a new composite image, retaining only the central part. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1adb1bceb367182c8e7f159fec64b95982">assemble_tiles</link> (<link linkend="_class_bimage">Bimage</link> *pt, int flag=0)</para>

<para>Assembles overlapping tiles into this image. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a3cd968fadff01e5b7cb98bc61c5bb16c">linear_fit</link> (<link linkend="_class_bimage">Bimage</link> *p, <link linkend="_class_bimage">Bimage</link> *pmask, double max_exclude)</para>

<para>Linear least squares fit of two images. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a6a5b897839510f5387f40489d9465941">histomatch</link> (<link linkend="_class_bimage">Bimage</link> *p, long bins)</para>

<para>Fits two images by matching the histogram of the second to the first. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ae44123b34d0f20e1835482d0a0fe8f86">kernel_gaussian</link> (double sigma, double max)</para>

<para>Generates a gaussian kernel image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a90d4551d4e5fca005dffca66707ac232">kernel_laplacian_of_gaussian</link> (double sigma, double max)</para>

<para>Generates a laplacian-of-gaussian kernel. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aa5538ec2cf75dc526f2598f983b2823b">filter_average</link> (long kernel_size)</para>

<para>Applies an averaging filter to an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ab2921e0ee63f54e4254118a8ba407721">filter_average</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; k)</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a54ca5f2052e28406522cd592d4a311e6">gradient</link> ()</para>

<para>Calculates the central difference gradient image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a68fe6231d0f7ea94af7f610a02827580">gradient3x3</link> ()</para>

<para>Calculates the difference gradient image in a 3x3 kernel. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a9e7a4ada245ecf07688a166af32e1b02">filter_gaussian</link> (long kernel_size, double sigma=0)</para>

<para>Applies a gaussian filter to an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a4227a87d62a6c08de8a41b8040b86a34">filter_sinc</link> ()</para>

<para>Weighs an image with a sinc function. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1adc7a8b3e3bb82e5b64e47780ad3b41a0">convolve_chunk</link> (<link linkend="_class_bimage">Bimage</link> *pkernel, float *nudata, long i, long len)</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a256555f8b2178b4a267fb0be752656ad">convolve</link> (<link linkend="_class_bimage">Bimage</link> *pkernel)</para>

<para>Convolves an image with an arbitrary size convolution filter. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a0961f0dd6376ab4cf6428e408e500cf2">filter_ortho</link> (int type)</para>

<para>Convolves the image with an orthogonal kernel with wrapping. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a7b62e2269f9c7993c77349d583e9f300">filter_dog</link> (double sigma1, double sigma2)</para>

<para>Convolves the image with a difference of gausians kernel. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a5c716602230bd440ec0f6afb129ed6ea">filter_bilateral_chunk</link> (<link linkend="_class_bimage">Bimage</link> *pkernel, double sigma2, int kernel_type, float *nudata, long i, long len, int first)</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a59222f093c517b163aeac959b3696fd3">filter_bilateral</link> (double sigma1, double sigma2, int kernel_type, long kernel_radius)</para>

<para>Denoise an image with combined gaussian distance and density difference kernel. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ac4d4dbb6a5fd01ccb65c5ac871f210f7">filter_rolling_ball</link> (long radius, double scale)</para>

<para>Apply a rolling ball filter. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a54ca7c220c8b8a14d8501694ca2c70ee">filter_rank_chunk</link> (long kernel_size, double rank, float *nudata, long i, long len)</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a207f8d8d30304d422524b843c7175bf3">filter_rank</link> (long kernel_size, double rank)</para>

<para>Applies a median filter to an image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1ab9bc11d57ce0c518f1945af4ee64d9eb">filter_peak</link> (long kernel_size)</para>

<para>Finds the peaks in an image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a3af3c37bff79cfdec5c4ab443d00a3b7">periodic_averaging</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; period)</para>

<para>Calculates an average within a periodic frame. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1adfd7c5588e083504f2bcdb551682dd57">aniso_average</link> (long ksize, double w)</para>

<para>Calculates an anisotropic average within a kernel based on the local gradient. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1acc3dfa467026ffd2b1d6b5229756a028">filter_by_difference</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Calculates an anisotropic average within a kernel based on the local gradient. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a2ec6da2aebaf06f411b5a98f2ecedae9">nad_2D</link> (double ht, double lambda, double C, double alpha)</para>

<para>Denoises a 2D image by non-linear anisotropic diffusion. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1aec5451bc9105d457fb967a025bd0c0cd">nad</link> (double ht, long zw, double lambda, double C, double alpha)</para>

<para>Denoises a 3D density map by non-linear anisotropic diffusion. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a140b990f45d37151903ebc5d7541cddd">simple_to_complex</link> ()</para>

<para>A simple image is converted to a complex image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a7f4694a4f5f907752135c39d67fb02eb">multi_channel_to_complex</link> ()</para>

<para>A multi-channel image is converted to a set of complex images. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ad9d1522e62412070a4694482067f3532">complex_to_real</link> ()</para>

<para>The real part of a complex image is written to a simple image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a3902e92c0036d0d8f812a271f932a0c8">complex_to_imaginary</link> ()</para>

<para>The imaginary part of a complex image is written to a simple image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ab9a5fe205d012073c5bc2a902ca3e95a">complex_to_intensities</link> ()</para>

<para>The intensities from a complex image is written to a simple image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a484243844b17ec9265365545c5087044">complex_to_amplitudes</link> ()</para>

<para>The amplitudes from a complex image is written to a simple image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a7d2e55ed269cd9f3bd954ce2f9d18ed0">complex_to_signed_amplitudes</link> ()</para>

<para>The signed amplitudes from a complex image is written to a simple image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1acfcb9c3eab00573289c72f6ee24ed20c">complex_to_phases</link> ()</para>

<para>The phases from a complex image is written to a simple image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a6c83144b13c3a4c25a7ef4ec9fcf6685">complex_conjugate</link> ()</para>

<para>Calculates the complex conjugate image. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1af0390feeaaed888509327745aad01f27">complex_power</link> ()</para>

<para>Calculates the power in a complex image. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1ad52f5efd5dad2c089de6c1acbb47bb37">complex_normalize</link> ()</para>

<para>Normalizes the power in a complex image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a3d1e6fe27d9a3cabcf908748000ede94">phase_shift</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99">shift</link>)</para>

<para>Phase shifts a complex image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a634b527816eb889e18c2b945cbee91f9">phase_shift</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99">shift</link>)</para>

<para>Phase shifts a complex sub-image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a19989b5365083532862811255c06b538">phase_shift_to_origin</link> ()</para>

<para>Phase shifts a set of reflections to the image origin. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aacdc9509fb8666efb3b60141d95aa36d">phase_shift_to_center</link> ()</para>

<para>Phase shifts a set of reflections to the nominal center of the image origin. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1af9dd2401fc3d59bde6d222d8979d12af">complex_multiply</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Calculates the product of a complex image with a simple image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ac7177b199823a9ccbf78fc65f1042038">complex_product</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Calculates the complex product of two complex images. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a0b693dfd14b455539166ef88fdf852bb">complex_conjugate_product</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Calculates the product of a complex image with the conjugate of a second. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1af23fee98976ac23c37ce16d7feac9ee0">complex_conjugate_product_one2many</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Calculates the product of a complex image with the conjugate of a second. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a900f7f590e1626c8f521e731cb4a9043">complex_apply_mask</link> (<link linkend="_class_bimage">Bimage</link> *pmask)</para>

<para>Applies a mask to a complex image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ab46eac20f607c7922eef77c90a40a832">complex_apply_negative_mask</link> (<link linkend="_class_bimage">Bimage</link> *pmask)</para>

<para>Applies a negative mask to a complex image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a409f4fa58ef28c6cd7f591a8a89d574c">complex_apply_dual_mask</link> (<link linkend="_class_bimage">Bimage</link> *pmask)</para>

<para>Applies a dual mask to a complex image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1adcacc4e756f549b1bb2a60b13ae93a00">complex_bandpass</link> (double hires, double lores)</para>

<para>Bandpasses a Fourier transform. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a4fdf88c178b8f32dafefe99468a543c6">pack_two_in_complex</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Packs two real images into one complex image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1ab581cd7985b8d57b0fce1d70a1651f1a">unpack_combined_transform</link> ()</para>

<para>Unpacks a complex transform obtained from two real images. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a71edead8db40d0773892175a7b5b7a2a">combined_complex_product</link> ()</para>

<para>Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a8f205cb70f7ea0a38369ae7c6f2b5222">combined_complex_product</link> (<link linkend="_class_bimage">Bimage</link> *pmask)</para>

<para>Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a31ff4d6148499e24377c45428ec8c73a">combined_complex_product</link> (double hires, double lores)</para>

<para>Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aa03855b78911b0811e1208885cffc98e">combined_complex_product</link> (double hires, double lores, <link linkend="_class_bimage">Bimage</link> *pmask)</para>

<para>Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a415d393255e21b878bfdc574146a40e8">combined_complex_product_implicit_mask</link> (double hires, double lores)</para>

<para>Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a03a84149ddcfe364e0687f485939274e">merge_amplitudes_and_phases</link> (<link linkend="_class_bimage">Bimage</link> *pamp)</para>

<para>Merges the amplitudes from one map with the phases of another. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a0c0ac2e1677fe947f84234716aba5e50">merge_amplitudes_and_phases</link> (<link linkend="_class_bimage">Bimage</link> *pref, double res_hi, double res_lo)</para>

<para>Keeps selected phases and replaces amplitudes and other phases from a reference transform. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1aa7b16ff07227b448151d6b73c572451a">intensities_phase_colored</link> (double scale)</para>

<para>Generates a power spectrum with phases colored according to a color wheel. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a3f15772a51c0eb1d502fe03d423fba69">phase_colour_wheel</link> ()</para>

<para>Generates a phase color wheel. </para>
</listitem>
            <listitem><para><link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_class_bimage_1a3d7eea09fdb8cca40c6778cd4aa4c49e">fft_setup</link> (<link linkend="_fft_8h_1a61cf819a81d9f5c3c4d82f5907e3fe67">fft_direction</link> dir, int opt=0)</para>

<para>Sets up a plan for fast Fourier transforms. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ac40b2b2d919d6d3a3e3eda301d4e0fba">fft</link> ()</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ad83202ab557c3a6acc6f635d217146a6">fft_back</link> ()</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a242a0713955bce07cc7b0f5904ff394f">fft</link> (<link linkend="_fft_8h_1a61cf819a81d9f5c3c4d82f5907e3fe67">fft_direction</link> dir)</para>

<para>Fast Fourier transforms an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a79448ddf4fd8e74bbfd846d7bb9b19e7">fft_back</link> (<link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> plan, bool norm_flag=1)</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a109041ab7adcf1134630008c736cd0a1">fft</link> (<link linkend="_fft_8h_1a61cf819a81d9f5c3c4d82f5907e3fe67">fft_direction</link> dir, bool norm_flag)</para>

<para>Fast Fourier transforms an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1adcdc6f06bec66f631c393b87ac2a742f">fft</link> (<link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> plan, bool norm_flag=1)</para>

<para>Fast Fourier transforms an image. </para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1ae74e7014bad39ad70cf631c4470d6a3c">change_transform_size</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize)</para>

<para>Resizes a &quot;standard&quot; transform. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a073293aef6831dbcd752ec0b6335e55e">power_spectrum</link> (int flags=0)</para>

<para>Calculates a power spectrum. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a62da7cb39c8509a277d4b60a0ad2eac7">powerspectrum_tiled</link> (long img_num, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size, int flags=0)</para>

<para>Prepares a tiled power spectrum from an image for determining CTF parameters. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a71ae17085d0e29552f960c53090b19fe">powerspectrum_tilt_axis</link> (long img_num, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size, double tilt_axis, double tilt_offset, int flags=0)</para>

<para>Prepares a tiled powerspectrum from a tilted image for determining CTF parameters. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a86e13cf2551e48c8d98c5bad3c3690f9">defocus_scale</link> (long nn, double df, double df2, double iCL2, int fill_type)</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1ae4c0fe6b37b552146256828cb6f17624">powerspectrum_tilted</link> (long img_num, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size, double tilt_axis, double tilt_angle, double defocus, double iCL2, int flags=0)</para>

<para>Prepares a tiled powerspectrum from a tilted image for determining CTF parameters. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1ad0dd5e4008605164e43d404e3d82e02e">powerspectrum_tiled_and_tilted</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size, double tilt_axis, double tilt_angle, double tilt_offset, double defocus, double iCL2, int flags=0)</para>

<para>Prepares a tiled powerspectrum from a tilted image for determining CTF parameters. </para>
</listitem>
            <listitem><para>vector&lt; double &gt; <link linkend="_class_bimage_1a3f3d62db989c0a47443622038e615fb4">powerspectrum_isotropy</link> (long n, double &amp;lores, double &amp;hires)</para>

<para>Calculates a measure of anisotropy in a poer spectrum. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1af2949fc9aeff65845b1c0e64f3cae467">fspace_maximum_radius</link> (double resolution, double sampling_ratio=1)</para>

<para>Calculates the maximum radius in frequency space from a given resolution. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ad4570a384d1683cfcc8e2b1c18c0bda8">fspace_background</link> ()</para>

<para>Calculates the background for a Fourier transform. </para>
</listitem>
            <listitem><para><link linkend="_class_complex">Complex</link>&lt; double &gt; <link linkend="_class_bimage_1a7cc08eed53836fe562577d3a19f24a50">fspace_interpolate</link> (long img_num, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; m, <link linkend="_class_f_s_i___kernel">FSI_Kernel</link> *<link linkend="_structkernel">kernel</link>)</para>

<para>Calculates the complex value at an image location by kernel-based interpolation. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aa75d027b66e4adb4ef2f31ebb14da778">fspace_2D_interpolate</link> (<link linkend="_class_complex">Complex</link>&lt; float &gt; cv, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; m, double part_weight, int interp_type)</para>

<para>Interpolates a 2D image for packing ito a 3D reciprocal space volume. 
<literallayout>&#160;&#xa;</literallayout>
 </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ac1fa0fdcb205c13fd845e64285504be8">fspace_pack_2D</link> (<link linkend="_class_bimage">Bimage</link> *p, <link linkend="_class_matrix3">Matrix3</link> mat, double hi_res, double lo_res, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; scale, double part_weight=1, int interp_type=0)</para>

<para>Packs a 2D Fourier transform into a 3D reciprocal space volume. 
<literallayout>&#160;&#xa;</literallayout>
 </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ab10fa82f152bee515c19971d2e8a1994">fspace_pack_2D</link> (<link linkend="_class_bimage">Bimage</link> *p, <link linkend="_class_view">View</link> asu_view, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp;sym, double hi_res, double lo_res, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; scale, double part_weight=1, int interp_type=0)</para>

<para>Packs a 2D Fourier transform into a 3D reciprocal space volume. 
<literallayout>&#160;&#xa;</literallayout>
 </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a71b940c547ffc63a3295545992833de9">fspace_pack_2D_into_central_section</link> (<link linkend="_class_bimage">Bimage</link> *p, long ft_size, double scale, double hi_res, double lo_res, <link linkend="_class_matrix3">Matrix3</link> matr, <link linkend="_class_matrix3">Matrix3</link> mat)</para>

<para>Packs a 2D Fourier transform into a central section of a 3D reciprocal space volume. 
<literallayout>&#160;&#xa;</literallayout>
 </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ab4adb193f4e57c5a3395cfe5da8a3682">fspace_pack_3D</link> (<link linkend="_class_bimage">Bimage</link> *p, double hi_res=0, double threshold=0)</para>

<para>Packs a 3D Fourier transform into a 3D reciprocal space volume. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1ac80930fd138c661a8728b3a8cb39b72d">fspace_reconstruction_add</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Adds all components to a reconstruction. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a37d5c9685021e104bea5e61dd1b87f60">fspace_reconstruction_weigh</link> ()</para>

<para>Weighs a reconstruction. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a203259c67bbe3d31b46d9b9f3c923153">fspace_reconstruction_stats</link> (double resolution, double sampling_ratio=1)</para>

<para>Calculates Fourier shell statistics. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a4f975f6f05c471150640a20add0acd86">fspace_reconstruction_snr</link> ()</para>

<para>Calculates the SNR map. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a8bbfd40bd975c34e1ed4235e58af8dc1">fspace_translate</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99">shift</link>)</para>

<para>Translates an image in frequency space to avoid interpolation. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1adf4c3dbc2ad222e9ff66a5a0c6e4f562">fspace_translate</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99">shift</link>)</para>

<para>Translates an image in frequency space to avoid interpolation. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a7bfe151a39d17ada82c7ca0ed64fd589">fspace_resize</link> (double scale, double res_hi, double res_lo)</para>

<para>Resizes an image in frequency space to avoid interpolation. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a0f425f44f6e885acd68fd329d07edd63">fspace_resize</link> (<link linkend="_class_bimage">Bimage</link> *pref)</para>

<para>Resizes an image in frequency space to avoid interpolation. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1af4f70203482c3025452fb5e9a097bde6">fspace_amp_one</link> ()</para>

<para>Sets all amplitudes to one. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a2f66579e3b1e53aec78ae09985ce824b">fspace_amp_threshold</link> (double threshold)</para>

<para>Filters the amplitudes of the Fourier transform of an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a7da47417a7d1fea0cd6a02cbab87c702">fspace_sqrt_amp</link> ()</para>

<para>Change the amlitudes to their square roots. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a63076c1fcbd277ad435729c33b5be82f">fspace_square_amp</link> ()</para>

<para>Change the amlitudes to their squares. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a64fc3ee68565a1a039b34145446295a2">fspace_bandpass</link> (double res_hi, double res_lo=0, double width=0)</para>

<para>Applies a bandpass filter to an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a3a004d126c6b9441256e145226416293">fspace_bandpass</link> (double res_hi, double res_lo, double width, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>)</para>

<para>Applies a bandpass filter to an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a39127eceed3818eb3a0e1e59f0d329f3">fspace_frequency_filter</link> (double freq, double sigma)</para>

<para>Applies a frequency filter to an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a6e20382b67e69755e6db457043a0d396">fspace_frequency_filter</link> (double freq, double sigma, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>)</para>

<para>Applies a frequency filter to an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a3cdd3fb2790fb3c739546f4c95462440">fspace_gabor_filter</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; freq, double fsigma, double psigma)</para>

<para>Applies a Gabor filter to an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aece2172a647021b71693e1335a52ad4e">fspace_gabor_filter</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; freq, double fsigma, double psigma, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>)</para>

<para>Applies a Gabor filter to an image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1ae73ec86061ff431511f6c635c1695b87">fspace_radial_power</link> (double resolution, double sampling_ratio=1)</para>

<para>Calculates the radial power spectrum from a Fourier transform. </para>
</listitem>
            <listitem><para>vector&lt; double &gt; <link linkend="_class_bimage_1ac7365e14f761ca13be325fda8991d3ff">fspace_radial</link> (long nn, long maxrad, int flag=0)</para>

<para>Calculates the radial power spectrum from a Fourier transform. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a06f7fe843ce8b5018344741d0023a29e">fspace_weigh</link> (vector&lt; double &gt; &amp;curve, int flag=0)</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a4b5d55edda2562384bd08fbb5935a0d8">fspace_scale</link> (vector&lt; double &gt; &amp;scale, <link linkend="_class_bimage">Bimage</link> *pmask=NULL)</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a2c92e49362a8548a332108661bd83530">fspace_scale</link> (long nn, vector&lt; double &gt; &amp;scale, <link linkend="_class_bimage">Bimage</link> *pmask=NULL)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1af9ea5aed3caede8ae6e6e223adf35093">fspace_fit_B_factor</link> (double res_hi=0)</para>

<para>Determines the overall B-factor of an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aac65275f18cb7d8ffa4e11acdc15e10d">fspace_weigh_ramp</link> (double resolution, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>)</para>

<para>Weighs a transform with a ramp. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a73c972326ebd2d236ec0fcdbc4b0cc5a">fspace_weigh_ramp</link> (double resolution, double axis, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>)</para>

<para>Weighs a transform with a ramp. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a12f04e97a5999c7e83e130768c25d583">fspace_weigh_B_factor</link> (double B, double resolution=0)</para>

<para>Weighs an image&apos;s amplitudes with B-factor (gaussian) curve. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a242ffe8b2a4bcc216ae00afb86daca1d">fspace_weigh_C_curve</link> (double resolution=0)</para>

<para>Weighs an image&apos;s amplitudes with the carbon scattering curve. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1afda57b400f1708167f2c7e64a60eb78b">fspace_weigh_LoG</link> (double resolution, double sigma)</para>

<para>Weighs an image&apos;s amplitudes with a Laplacian-of-Gaussian function. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ac7decddf1751331d158e46c8eaefef00">fspace_weigh_RPS_curve</link> (<link linkend="_class_bplot">Bplot</link> *<link linkend="_class_bimage_1a43916985ee29b7482e3d0bbcd97b68b7">plot</link>, double resolution=0)</para>

<para>Weighs an image&apos;s amplitudes with a given RPS curve. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a3729092a9a3df3b1c98ebe7ef91fdfa3">fspace_weigh_FSC_curve</link> (<link linkend="_class_bplot">Bplot</link> *<link linkend="_class_bimage_1a43916985ee29b7482e3d0bbcd97b68b7">plot</link>, double resolution=0)</para>

<para>Weighs an image&apos;s amplitudes with a given FSC curve. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a2204b62b851a229a9c2cb3489052ae88">fspace_weigh_gaussian</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; sigma, int dir=0)</para>

<para>Weighs an image&apos;s amplitudes with an anisotropic Gaussian function. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a4009dab9defb1ef39feb77371124422f">fspace_gradient</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; sigma)</para>

<para>Generates a image with orthogonal gradients encded in 3-value vectors. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ac56288e974c1a25f146ccd97eb44df38">fspace_weigh</link> (<link linkend="_class_bimage">Bimage</link> *pref, <link linkend="_class_bimage">Bimage</link> *pmask, double resolution=0)</para>

<para>Weighs an image&apos;s amplitudes with the radial power spectrum of another. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aede6de7cbd6febba8dcfde126a052c40">fspace_weigh_dose</link> (long nn, double dose_per_frame, vector&lt; double &gt; critdose)</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a2a5148c88a8ffafddb8fef3f10f29b2d">fspace_weigh_dose</link> (double dose_per_frame, int flag=0)</para>

<para>Weighs an image&apos;s amplitudes with the accumulated dose. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a2bf9851313f15f0e59a4b5c14ed4fc99">fspace_weigh_accumulated_dose</link> (vector&lt; double &gt; dose)</para>

<para>Weighs an image&apos;s amplitudes with the accumulated dose. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a06dc3d6c69b51aea7926b530e8f963ec">fspace_normalize</link> ()</para>

<para>Normalizes an image&apos;s amplitudes. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ad71a5271e9a56028d01378519f152970">fspace_normalize_radial</link> (<link linkend="_class_bimage">Bimage</link> *pmask, double resolution=0, int flag=0)</para>

<para>Normalizes an image&apos;s amplitudes. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a3e641a765529eca00a388d3ccda2c5e9">fspace_positive</link> ()</para>

<para>Sets the image to positive definite. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1ad6e43e43ac9ae08e0a28564decbf278d">friedel_check</link> ()</para>

<para>Checks Friedel symmetry. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a6b6c1ccff23519853d4e246d60e7c5c2">friedel_apply</link> ()</para>

<para>Applies Friedel symmetry. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a4afcc68b536924539893afa7797d9ff0">project</link> (char axis, int flags=1)</para>

<para>Projects a 3D image to a 2D image down one of the three major axes. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1aa6dea162b89d48d12f9f29f757a299e3">rotate_project</link> (<link linkend="_class_matrix3">Matrix3</link> mat, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; translate, double radial_cutoff, int norm_flag=1)</para>

<para>Rotates a 3D map and projects it along the z-axis. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1ab27d43f0379945a6d3fc67f8bfd7d895">project</link> (<link linkend="_class_view">View</link> *<link linkend="_class_bimage_1ab474ad5f14737ab4931c0171a5d95579">view</link>, int norm_flag=1)</para>

<para>Calculates a set of projections from a 3D density map. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a09bd10ebe8a3c6a4ca623a604915f5c9">central_section</link> (<link linkend="_class_matrix3">Matrix3</link> mat, double resolution, <link linkend="_class_f_s_i___kernel">FSI_Kernel</link> *<link linkend="_structkernel">kernel</link>)</para>

<para>Calculates a central section of a 3D fourier transform. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a83a04a916f5dbac1d5bd7b627d18c904">project</link> (<link linkend="_class_view">View</link> *<link linkend="_class_bimage_1ab474ad5f14737ab4931c0171a5d95579">view</link>, double resolution, <link linkend="_class_f_s_i___kernel">FSI_Kernel</link> *<link linkend="_structkernel">kernel</link>)</para>

<para>Calculates a set of projections as central sections from a 3D fourier transform. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aaaa6013e0f403993b7dde45889a0e0ef">back_project</link> (<link linkend="_class_bimage">Bimage</link> *p, double resolution, double axis, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>)</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a2d625d181159abc9d151369048f20733">resolution_prepare</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1aeebfb1d152e36bd7aaf0b7549ba7bc6e">resolution_prepare</link> (<link linkend="_class_bimage">Bimage</link> *p, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> plan)</para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1a53929c5258e3e6d2301375781bf3704b">fsc_dpr</link> (double hi_res, double sampling_ratio=1, int flag=0)</para>

<para>Calculates an FSC and DPR curves from two images. </para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1aa2e604cb03f66a11a174eff259bb6f54">fsc</link> (double hi_res, double sampling_ratio=1)</para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1aae84c0a38fd631080656901ef9468f8d">fsc</link> (<link linkend="_class_bimage">Bimage</link> *p, double hi_res, double sampling_ratio=1)</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a8e64a59b52e430a10cee5540c0024940">fsc_shell</link> (<link linkend="_class_bimage">Bimage</link> *p, double hi_res, double *cutoff, int <link linkend="_class_bimage_1a960a7f0cde5092bb23f788c359c5388a">thickness</link>, int step, int minrad, int maxrad, int <link linkend="_class_bimage_1a130d1713a0034d563b93034b05680768">pad</link>=1, int smooth=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Determine the resolution for each concentric shell in a map. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a5dad3f53957a2ae41c2665080274cbd7">fsc_local</link> (<link linkend="_class_bimage">Bimage</link> *p, <link linkend="_class_bimage">Bimage</link> *pmask, double resolution, double *cutoff, int mask_level, int <link linkend="_class_bimage_1a8d8f237b0f540eb66bde5e5640097b18">size</link>, int <link linkend="_class_bimage_1a130d1713a0034d563b93034b05680768">pad</link>, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; vedge, int step=1, int taper=1, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Determine the local resolution at each masked voxel in a map. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a5a9fe1dc8d2129d9407528f6f65eeb02">local_filter</link> (<link linkend="_class_bimage">Bimage</link> *pmask, int mask_level, <link linkend="_class_bimage">Bimage</link> *resmap, int <link linkend="_class_bimage_1a8d8f237b0f540eb66bde5e5640097b18">size</link>, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; vedge)</para>

<para>Applies a local resolution filter to a map. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1acfe39f90afbe00c91da38a7536dc6fb8">phase_difference</link> (<link linkend="_class_bimage">Bimage</link> *p, int type=0, double res_hi=0, double res_lo=0)</para>

<para>Calculates the cosine of the phase difference between two images. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a0d72986433c77abdb1bbfef125df3cf7">average_phase_difference</link> (<link linkend="_class_bimage">Bimage</link> *p, double res_hi, double res_lo, int weighting=1)</para>

<para>Calculates the average of the absolute phase difference between two images within given resolution shells. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a5afda6e89e9c754d281e416fd0a64a1e">phase_flip</link> (<link linkend="_class_bimage">Bimage</link> *pd)</para>

<para>Flips the phases of an image based on a phase difference map. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1aed4f644bac0ee94020a3143500301f73">correlate</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Calculates correlation coefficient between two images. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a89a24a64c2a46d4e7605f46ae21c6518">correlate</link> (<link linkend="_class_bimage">Bimage</link> *p, double rmin, double rmax, <link linkend="_class_bimage">Bimage</link> *pmask=NULL, int flag=0)</para>

<para>Calculates a correlation coefficient between two images. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1aa0e7e96e701d68bc872693a78aa74c8f">rotate_correlate</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; axis, double <link linkend="__vector3_8h_1a4d0ad562e2f2e87c018fe778805aa3cf">angle</link>)</para>

<para>Rotates a copy of an image and correlates it with the original. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a52206f5ade01f913c6c89ca6827abfec">R_factor</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Calculates an R factor between two images. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a58df899bf2137ec1046c1432d4ea0014">auto_correlate</link> (double hires, double lores)</para>

<para>Calculates an autocorrelation map by Fast Fourier transformation. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1aee3980b2fbc7486c0b2e5d1f0f23a527">cross_correlate</link> (<link linkend="_class_bimage">Bimage</link> *p, double hires, double lores, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>)</para>

<para>Calculates a cross-correlation map by Fast Fourier transformation. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1add424b02a9e5ff78e8bd8003b28da89e">cross_correlate</link> (<link linkend="_class_bimage">Bimage</link> *p, <link linkend="_class_bimage">Bimage</link> *pmask=NULL)</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a733932c8d5fe80fb2d9677e1052f53e7">cross_correlate</link> (<link linkend="_class_bimage">Bimage</link> *p, double hires, double lores, <link linkend="_class_bimage">Bimage</link> *pmask=NULL)</para>

<para>Calculates a cross-correlation map by Fast Fourier transformation. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1ab4398066bdddc4ac4723c27a3e57ce30">correlation_coefficient</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99">shift</link>)</para>

<para>Calculates a coefficient from a Fourier correlation transform given a shift. </para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a6f896443c7d6dcfe0674232c5fa89684">find_shift_in_transform</link> (double shift_limit)</para>

<para>Finds the shift by brute force backtransformation for selected shifts. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a94c6007300a2ac6ee727bce03547aadb">cross_correlate_fspace</link> (<link linkend="_class_bimage">Bimage</link> *p, double hires, double lores, double shift_limit)</para>

<para>Calculates a cross-correlation map by Fast Fourier transformation. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a66dd9d3e57b245ffbb8c6aaf071b48b2">cross_correlate</link> (<link linkend="_class_bimage">Bimage</link> *p, double hires, double lores, <link linkend="_class_bimage">Bimage</link> *pmask, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>)</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a7e0623b75a864ebcc25ee4cb13cd3249">cross_correlate_two_way</link> (<link linkend="_class_bimage">Bimage</link> *p, double hires, double lores, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>)</para>

<para>Calculates a cross-correlation map by Fast Fourier transformation. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a0ae039957d4ef654accb7a9d6533e207">cross_correlate_validate</link> (<link linkend="_class_bimage">Bimage</link> *p, <link linkend="_class_bimage">Bimage</link> *pmask)</para>

<para>Calculates a masked cross-correlation map by Fast Fourier transformation. </para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a7169f09ebd58457a19368b08bf994833">rotate_cross_correlate</link> (<link linkend="_class_bimage">Bimage</link> *pref, <link linkend="_class_view">View</link> <link linkend="_class_bimage_1ab474ad5f14737ab4931c0171a5d95579">view</link>, double hires, double lores, double search_radius, <link linkend="_class_bimage">Bimage</link> *pmask, double &amp;cc, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a7f5f4a66f61f68ea7af007429c246baa">rotate_cross_correlate_two_way</link> (<link linkend="_class_bimage">Bimage</link> *pref, double <link linkend="__vector3_8h_1a4d0ad562e2f2e87c018fe778805aa3cf">angle</link>, double res_hi, double res_lo, double shift_limit, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>)</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a73b98ed9bd3b989b31defd06c1eb027a">find_shift</link> (<link linkend="_class_bimage">Bimage</link> *pref, <link linkend="_class_bimage">Bimage</link> *pmask, double hires, double lores, double radius, double sigma, int refine_flag)</para>

<para>Calculates a cross-correlation map to find the shift for the pair of images. </para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a47921af3160535f94f3060a87524ad6a">find_shift</link> (<link linkend="_class_bimage">Bimage</link> *pref, <link linkend="_class_bimage">Bimage</link> *pmask, double hires, double lores, double radius, double sigma, int refine_flag, double &amp;cc)</para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a574db68f6ca4c87c9854e1e4355c36ce">find_shift</link> (<link linkend="_class_bimage">Bimage</link> *pref, double hires, double lores, double radius, double sigma, int refine_flag, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>)</para>

<para>Calculates a cross-correlation map to find the shift for the pair of images. </para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1ae0c36d9cb08f5525ff89f3c27ef1b763">find_shift</link> (<link linkend="_class_bimage">Bimage</link> *pref, <link linkend="_class_bimage">Bimage</link> *pmask, double hires, double lores, double radius, double sigma, int refine_flag, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>, double &amp;cc)</para>

<para>Calculates a cross-correlation map to find the shift for the pair of images. </para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1af9c9aed8bf9257e2d04101cc548d20ca">find_shift</link> (long nn, <link linkend="_class_bimage">Bimage</link> *pref, <link linkend="_class_bimage">Bimage</link> *pmask, double hi_res, double lo_res, double shift_limit, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>)</para>

<para>Calculates a cross-correlation map to find the shift for the pair of images. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a78cdf739a9bc772b13b7a7ca95753dbd">find_template</link> (<link linkend="_class_bimage">Bimage</link> *ptemp, <link linkend="_class_bimage">Bimage</link> *pmask, double hires, double lores, int bin, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>)</para>

<para>Finds one or more matches to a template. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a7447cd808d862a6f5cedf597ebc4bdbf">find_center</link> (<link linkend="_class_bimage">Bimage</link> *pmask, double hires, double lores, double radius, double sigma, int refine_flag)</para>

<para>Finds the center of mass of an image by cross-correlation with its inverse. </para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1ae5e061b02110ae259864ad686a234038">rotate_find_shift</link> (<link linkend="_class_matrix3">Matrix3</link> mat, double hires, double lores, double radius, double sigma, int refine_flag, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>, double &amp;cc)</para>

<para>Rotates and find shift by cross-correlation. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a2daa0d26e64c9e49ddb2a0cc14e8c2d0">find_peak</link> (double radius=1e30, double sigma=0)</para>

<para>Finds the peak in an image to the nearest voxel. </para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a8be0b064eefaf517f0158b05a0d61bd1">fit_peak</link> ()</para>

<para>Fits an elliptic parabole to locate the position of the peak to sub-voxel resolution. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ae8655ec31cdfa4008f2cd15e5810300b">refine_peak_new</link> ()</para>

<para>Refines the position of a peak to sub-voxel resolution. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a0fab637fb5be036d3821df66f90559ba">refine_peak</link> ()</para>

<para>Refines the position of a peak to sub-voxel resolution. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a29d7ab7027984b63c96e3f9f6ba4ee7a">find_peaks</link> (long kernelsize)</para>

<para>Finds peaks in a map with periodic boundaries. </para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; * <link linkend="_class_bimage_1a4b849fa786ec2cf1d144ca94bf46f7f3">find_peaks</link> (double excl_dist, long &amp;ncoor, double &amp;threshold_min, double &amp;threshold_max, double pix_min=2, double pix_max=10)</para>

<para>Finds the peaks in a cross-correlation map to find template matches. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1abe8c89d040e7a16ababdcb654433ef39">ccmap_confidence</link> (long nn)</para>

<para>Calculates a confidence level to associate with a cross-correlation peak. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a200da2cfe749e4702e39b95e3128355f">peak_sigma</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; coor, long kernel_size)</para>

<para>Calculates a sigma value for a cross-correlation peak. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a1d6eeb216ad95114a41546c5f948661e">search_views</link> (<link linkend="_class_bimage">Bimage</link> *ptemp, <link linkend="_class_view">View</link> *<link linkend="_class_bimage_1ab474ad5f14737ab4931c0171a5d95579">view</link>, double hires, double lores, double search_radius, <link linkend="_class_bimage">Bimage</link> *pmask, <link linkend="_class_view">View</link> &amp;currview, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; &amp;currshift)</para>

<para>Searches a 2D/3D density map for a template. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a5ac6c12ee2b9faa6521107716e981814">search_volume_view</link> (<link linkend="_class_bimage">Bimage</link> *ptemp, <link linkend="_class_view">View</link> <link linkend="_class_bimage_1ab474ad5f14737ab4931c0171a5d95579">view</link>, double hires, double lores, <link linkend="_class_bimage">Bimage</link> *pmask, double threshold, <link linkend="_class_bimage">Bimage</link> *pfit)</para>

<para>Searches a 2D/3D density map for a template using a specific view. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a7ce30d7a0b92b8e8886a19be03e23eff">search_volume</link> (<link linkend="_class_bimage">Bimage</link> *ptemp, <link linkend="_class_view">View</link> *<link linkend="_class_bimage_1ab474ad5f14737ab4931c0171a5d95579">view</link>, double alpha, double alpha_step, double hires, double lores, <link linkend="_class_bimage">Bimage</link> *pmask, double threshold)</para>

<para>Searches a 2D/3D density map for a template. </para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1ad3de86725584217217b4ab919ef3dcdb">find_shift_in_transform</link> (long nn, <link linkend="_class_bimage">Bimage</link> *pref, double shift_limit)</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1aa79aa0e953c56c5ce8e1a1498f386751">align_progressive_fast</link> (long nref, double shift_limit)</para>

<para>Aligns and sums a set of sub-images using a progressive algorithm. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1aa91803c287ab037bc7a3c403291acc2f">align_progressive</link> (long nref, <link linkend="_class_bimage">Bimage</link> *pmask, double hi_res, double lo_res, double shift_limit, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>)</para>

<para>Aligns and sums a set of sub-images using a progressive algorithm. </para>
</listitem>
            <listitem><para>vector&lt; <link linkend="_class_vector3">Vector3</link>&lt; double &gt; &gt; <link linkend="_class_bimage_1a4fc989995479711dd10761d2f7385a3e">align</link> (long ref_num, long window, long step, <link linkend="_class_bimage">Bimage</link> *pmask, double hi_res, double lo_res, double shift_limit, double edge_width, double gauss_width, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; bin)</para>

<para>Aligns and sums a set of sub-images, first progressively and then iteratively. </para>
</listitem>
            <listitem><para><link linkend="_class_j_svalue">JSvalue</link> <link linkend="_class_bimage_1ac91286dc4862354d4dd617144e6fa8e1">align_fast</link> (long ref_num, <link linkend="_class_bimage">Bimage</link> *pmask, double hi_res, double lo_res, double shift_limit, double edge_width, double gauss_width)</para>

<para>Aligns and sums a set of sub-images, first progressively and then iteratively. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1aa7cb4ca59bac82d6f9bc9986d82a889c">fspace_sum</link> (int <link linkend="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99">shift</link>=0)</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a1c83ba28a5aa67dac6558f5cd71b72f5">fspace_shift_sum</link> ()</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a1dbe36e9969106b1a0761da10681f30b">fspace_subset_sums</link> (int subset, int flag=0)</para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1a08afff70db68ac0b93636087899d6992">fspace_ssnr</link> (long nimg, double res_hi, double sampling_ratio)</para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1aa7cd9416f78181f8d911f70be238ba6c">fspace_subset_ssnr</link> (int subset, double res_hi, double sampling_ratio, int flag=0)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a116466a5ea13f35a581948624a4697ce">correlate_annuli</link> (<link linkend="_class_bimage">Bimage</link> *polref, int ann_min, int ann_max, double ang_min, double ang_max, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>, double &amp;cc_max)</para>

<para>Correlate annuli of a polar image. </para>
</listitem>
            <listitem><para>vector&lt; double &gt; <link linkend="_class_bimage_1abed27819fb8388ae6954898e8c5aeea9">pps_angular_correlation</link> (<link linkend="_class_bimage">Bimage</link> *pref, double res_hi, double res_lo, long nang, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1afd7765f966cffac40807eb001959fa28">align2D_pps</link> (<link linkend="_class_bimage">Bimage</link> *pref, double res_hi, double res_lo, double shift_limit, double angle_limit, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>)</para>

<para>Finds the best in-plane alignment for two 2D images using polar power spectra. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a7ceb1c51aa8f8a520fea19befa25b313">align2D</link> (<link linkend="_class_bimage">Bimage</link> *pref, double res_polar, int ann_min, int ann_max, <link linkend="_class_bimage">Bimage</link> *prs_mask, double shift_limit, double angle_limit, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf_1D, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb_1D, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf_2D, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb_2D)</para>

<para>Finds the best in-plane alignment for two 2D images using polar power spectra. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ab4243b9407c5220fabf6f7c23b16d999">align2D</link> (<link linkend="_class_bimage">Bimage</link> *pref, int ann_min, int ann_max, double res_lo, double res_hi, double shift_limit, double angle_limit)</para>

<para>Finds the best in-plane alignment for two 2D images using polar power spectra. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1aafc8731d276675569a09899fe294cb52">simple_to_rgb</link> ()</para>

<para>A simple image is converted to a color image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a288b49e2101c603a259453e74f8fb9ee">simple_to_rgba</link> ()</para>

<para>A simple image is converted to a color image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ab7280ee72a088440e3d190ed9203afe8">color_to_simple</link> ()</para>

<para>A color image is converted to a simple image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a0c7ab28a033eb07c2c62b38044affdfa">rgb_to_rgba</link> ()</para>

<para>An alpha channel is added to a <link linkend="_class_r_g_b">RGB</link> color image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a99a75c617a560025a571c7635b7f015a">rgba_to_rgb</link> ()</para>

<para>The alpha channel is delete from an <link linkend="_class_r_g_b_a">RGBA</link> color image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ae66b4728fbd4a4338eb41ab606915fb4">rgb_to_cmyk</link> ()</para>

<para>Converts an <link linkend="_class_r_g_b">RGB</link> color image to <link linkend="_class_c_m_y_k">CMYK</link>. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a9e0de82e5c0833c271bbda9847f8cbe2">cmyk_to_rgb</link> ()</para>

<para>Converts a <link linkend="_class_c_m_y_k">CMYK</link> color image to <link linkend="_class_r_g_b">RGB</link>. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a80baea1fc2db2bac3aa5837f7396c0d4">one_color</link> (int color, double cmin, double cmax, int flag=0)</para>

<para>Converts a gray-scale image to a single color. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1abfb6e880fab0904b9702007876322ab6">color_red</link> (double cmin, double cmax, int flag=0)</para>

<para>Converts a gray-scale image to red. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a644d535bf1c94569270c32f4d0c0ef40">color_green</link> (double cmin, double cmax, int flag=0)</para>

<para>Converts a gray-scale image to green. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aa2898f1eaaf5f0236e239fe49494849d">color_blue</link> (double cmin, double cmax, int flag=0)</para>

<para>Converts a gray-scale image to blue. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a82c60d383d623215c7803246f91a37c3">pure_color</link> ()</para>

<para>Generates a pure color image without intensity. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ab143e87ca8f289a3ea65566a4c77fbb0">color_combine</link> (<link linkend="_class_bimage">Bimage</link> *p)</para>

<para>Combines two colored images. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1ac8cb2a5aa2fc05dc884221e6cc3e7c28">color_spectrum</link> (double cmin, double cmax)</para>

<para>Colorizes an image to a spectrum. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a5b36e3e577be485764fd630ed6cd4134">red_white_blue</link> (double red_min, double white_min, double white_max, double blue_max)</para>

<para>Colorizes an image with blue positive and red negative. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a9b7833cb5588bdc30b2a46f45eaf3224">rescale</link> (double scale, double <link linkend="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99">shift</link>)</para>

<para>Rescales the image data with a given multiplier and offset. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ac4a76e101fc59bdcabd5f3bb4299955e">rescale</link> (long nn, double scale, double <link linkend="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99">shift</link>)</para>

<para>Rescales the image data with a given multiplier and offset. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a6a5bdce631807ed399818c368aa246f4">rescale_to_min_max</link> (double numin, double numax)</para>

<para>Rescales the image data to a given minimum and maximum. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ae86c101a63bbebc20a1a83b359e4c898">rescale_to_min_max</link> (long nn, double numin, double numax)</para>

<para>Rescales the image data to a given minimum and maximum. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aa480cb0fa61541df90440f2e929142ce">rescale_to_avg_std</link> (double nuavg, double nustd)</para>

<para>Rescales the image data to a given average and standard deviation. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1abda4a7e4de4efa8b83f0a1ef6445da09">rescale_to_avg_std</link> (long nn, double nuavg, double nustd)</para>

<para>Rescales the image data to a given average and standard deviation. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ace3199a5d7bb5c9ea9fcd544e67dff6b">rescale_to_avg_std</link> (double nuavg, double nustd, <link linkend="_class_bimage">Bimage</link> *pmask)</para>

<para>Rescales the image data to a given average and standard deviation. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a55253f5cbc24af2d07edf348d81772cb">truncate</link> (double minim, double maxim, double setmin, double setmax)</para>

<para>Truncates image data to a given minimum and maximum. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a0112a4c9c0d3c8dcd41b17f540584517">truncate_to_min_max</link> (double minim, double maxim)</para>

<para>Truncates image data to a given minimum and maximum. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a972a0567449bfb9aff48b05aafec5c7e">truncate_to_avg</link> (double minim, double maxim)</para>

<para>Sets voxels in image data exceeding a given minimum and maximum to the average. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a76678f39fb8dc645ec3d54d9494db3d9">truncate_to_background</link> (double minim, double maxim)</para>

<para>Sets voxels in image data exceeding a given minimum and maximum to the image background. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a10a2c7e875d850bfd0dbc3e46b9ea998">limit_levels</link> (int nlevels)</para>

<para>Converts a full gray scale image to a limited level image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1add3eb1f754594a556d8a2d43a074b91a">normalize</link> (long imgnum, double <link linkend="_class_bimage_1a8b7559f244271ee490d3746da9a02378">average</link>, double stdev, int norm_type, long bins)</para>

<para>Normalizes a sub-image to a desired average and standard deviation. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a9b6cf645edf16da07022babcacf20692">normalize</link> (double <link linkend="_class_bimage_1a8b7559f244271ee490d3746da9a02378">average</link>, double stdev, int norm_type)</para>

<para>Normalizes a set of images to a desired average and standard deviation. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a0d99849ef19cf0e3af2adeb2182ed0a2">normalize_local</link> (long kernel_size)</para>

<para>Normalizes by subtracting local average and dividing by local standard deviation. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a673b8d495c7e50207c95034787cae2b6">normalize_local</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_structkernel">kernel</link>)</para>

<para>Normalizes by subtracting local average and dividing by local standard deviation. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1abaa0057b767acf23c99af72b999b5368">square</link> ()</para>

<para>Calculates the square of an image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a7411e52811a3b4f86631e89f3a19da2e">square_root</link> ()</para>

<para>Calculates the square root of an image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1a6e71e8fb84408cc791660173295d23d9">logarithm</link> ()</para>

<para>Calculates the logarithm of the image data. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1ae71f57ecd1286f7194495e506bb3b6cc">exponential</link> ()</para>

<para>Calculates the exponential of the image data. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a92a98004da23cb718e3e039f2ae130f9">gradient_correction</link> ()</para>

<para>Calculates and corrects for a linear gradient across an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a0022ff9560c5435a775b17cda6859d21">quadric_correct</link> (vector&lt; double &gt; param)</para>

<para>Corrects for a quadric surface. </para>
</listitem>
            <listitem><para>vector&lt; double &gt; <link linkend="_class_bimage_1a4374a6540837e7e0fb667ade95387125">quadric_fit</link> ()</para>

<para>Fits the whole image to a quadric surface. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a960a7f0cde5092bb23f788c359c5388a">thickness</link> (double reference, double emfp)</para>

<para>Calculates a thickness based on intensities with respect to a reference. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ac1eca04ce6fa6cbd93a59ed0bb0474e0">calculate_background</link> (long nn, int flag)</para>

<para>Calculates the background for one sub-image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a86fbcdfea888cba3b6891cb7c0685077">calculate_background</link> (int flag=0)</para>

<para>Calculates the background for each sub-image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aad111b7044a4c05761f372ce2f5688ae">calculate_background</link> (<link linkend="_class_bimage">Bimage</link> *pmask, long nn, int flag=0)</para>

<para>Calculates the background for one sub-image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a7535de626d0c458869842fe6379a9ba5">calculate_background</link> (<link linkend="_class_bimage">Bimage</link> *pmask, int flag=0)</para>

<para>Calculates the background for each sub-image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ab4c22f850dcdc8bef046cb78707ac808">correct_background</link> (long nn, int flag)</para>

<para>Corrects the background for one sub-image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ae097d0c9a4d324888c4225f6dc64eff5">correct_background</link> (int flag=0)</para>

<para>Corrects the background for each sub-image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aa60f07470d38a7a7c791741e14b81792">correct_background</link> (<link linkend="_class_bimage">Bimage</link> *pmask, int flag=0)</para>

<para>Corrects the background for each sub-image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1abb34c252e6a493a4672317f6790c6bfc">subtract_background</link> ()</para>

<para>Subtracts the background for each sub-image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a45890e60f74185ddfc88080dcbeda69e">shift_background</link> (double bkg)</para>

<para>Sets the background for each sub-image to a given value. </para>
</listitem>
            <listitem><para>vector&lt; long &gt; <link linkend="_class_bimage_1ab85f1d0fdde7701db60b1b62833ffefd">histogram</link> (long bins, double &amp;scale, double &amp;offset)</para>

<para>Calculates the histogram of an image. </para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1a6bde5665ebee734c283db7db9c99b74f">histogram</link> (long bins)</para>

<para>Calculates the histogram of an image. </para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1aa2eff813946f4af3af738ae4bfd4f0b9">histogram_counts</link> (int flags=0)</para>

<para>Finds the peaks in a quantized image from the histogram. </para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1aaf5664a095dcb822b3236ccfcc2b7165">percentiles</link> ()</para>

<para>Calculates the percentiles from the histogram of an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aad7b63e6c18d1efbd0e152a9d88aaa47">histogram_minmax</link> (double &amp;tmin, double &amp;tmax)</para>

<para>Calculates minimum and maximum thresholds for truncation. </para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1a17118ec3a626445c87adb236a8fd69ca">histogram_otsu_variance</link> (long bins)</para>

<para>Calculates the inter-set variance of the bisection of a historgram using the method of Otsu. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a89cdfb0e8c07177ab797bfacd8cf7136">otsu_threshold</link> (long bins)</para>

<para>Calculates the threshold from a histogram according to Otsu. </para>
</listitem>
            <listitem><para>vector&lt; double &gt; <link linkend="_class_bimage_1a8a1320da7a667791d7caf69d8de5f334">otsu_variance</link> (vector&lt; long &gt; h)</para>

<para>Calculates the inter-set variance of the bisection of a historgram using the method of Otsu. </para>
</listitem>
            <listitem><para>vector&lt; double &gt; <link linkend="_class_bimage_1a24ee47d4e71e12e5d0572b3d57dbc048">histogram_multi_thresholds</link> (long bins, long number)</para>

<para>Calculates multiple thresholds from a histogram. </para>
</listitem>
            <listitem><para>vector&lt; double &gt; <link linkend="_class_bimage_1a6d0ea79752667dd909d5becad0eec7ae">histogram_gauss_fit</link> (long bins, long ngauss=1)</para>

<para>Fits a gaussian function to a histogram of an image. </para>
</listitem>
            <listitem><para>vector&lt; double &gt; <link linkend="_class_bimage_1aacf99ed74e096630cc1d98601ae73d6b">histogram_gauss_fit2</link> (long bins, long ngauss=1)</para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1ae3183f34921b1302daac2ef214bd0fbf">histogram_gauss_plot</link> (long bins, long ngauss=1)</para>

<para>Fits a gaussian function to a histogram of an image. </para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1a1ab66dfa88e4a41d2c23d6ce3dc50b1e">histogram_poisson_fit</link> (long bins, int flag=0)</para>

<para>Fits a poisson function to a histogram of an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aa92d1c8b78e7032d0810e50691308d6a">resize</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; translate, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Resizes without interpolation or rescaling. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1aceac93b83e083d4149e77dc87b21d468">resize_copy</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; translate, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Resizes without interpolation or rescaling. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a9e6f5ec793f21d082df60e9365eeb417">resize_wrap</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; translate)</para>

<para>Resizes without interpolation or rescaling. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a34ad16a7706778bce66dc7caf93ceea0">resize_wrap_copy</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; translate)</para>

<para>Resizes with wrapping without interpolation or rescaling. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a130d1713a0034d563b93034b05680768">pad</link> (long sz, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Pads an image to a new size with a given fill value. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a8f7768e1c67e5fcb2a57d36878003b93">pad</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; sz, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Pads an image to a new size with a given fill value. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a211fe34d03f455a6da9ffae457618b29">pad_copy</link> (long sz, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Pads an image to a new size with a given fill value. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a2a7d060153f985a71eb45ce5dd52ed5a">pad_copy</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; sz, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Pads an image to a new size with a given fill value. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1abf488f62aca81f8ec7d4835c97103bc8">shrink_wrap</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; translate)</para>

<para>Shrinks an image to a new size with wrapping of the excluded edges. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ade5bcb6486e3258d8d7f4df3ab61081d">enlarge</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; scale)</para>

<para>Enlarges an image by an inetger scale. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a3de7d9fd87a5c93d12ae9e9366e33b7a">montage</link> (int first, int cols, int rows, int skip=0, int flipy=0)</para>

<para>Rearranges an image into a montage of 2D slices for display. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a38e87c1320e30753ce7e908a4ccd93b6">shape</link> (int type, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; rect, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, double width, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Creates a shape in an image and fills it with a constant value. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a8c5f912dd3240b4763bf53cda85da9e1">shape</link> (long nn, int type, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; rect, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, double width, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Creates a shape in an image and fills it with a constant value. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a9d059625d3892b2a07da71d3e8b400a9">line</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; end, double width, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Creates a line in an image and fills it with a constant value. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a647a5820a81c3ed26344e4c5540446d8">edge_mask</link> (int type, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; rect, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, double width)</para>

<para>Creates a mask with the edge approaching zero. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aab3a7ec44e12c8449b6d6505e6b9938f">edge</link> (int type, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; rect, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, double width, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Smooths the image edge with a soft rectangular function. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a0ca127a5e81dc5a37da132f66c0747bf">edge</link> (long nn, int type, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; rect, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, double width, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Smooths the image edge with a soft rectangular function. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a89fe20c911fb2f64e13e285720a6f37c">hanning_taper</link> (double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Apply Hanning taper window to the image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a540ad8a401b61ff5602ffe643efc2b58">sphere</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a5f9345465a753a4ace75a2b1d7c379ba">center</link>, double radius, double width=0, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Fills a sphere within an image with a uniform value. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1abfe49c9cdf6885b620cf141fb8ef081d">cylinder</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a5f9345465a753a4ace75a2b1d7c379ba">center</link>, double radius, double <link linkend="_class_bimage_1a53f0e717f7eb6d7cbe3282a752872ca3">height</link>, double width, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Fills a cylinder within an image with a uniform value. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a8b232571fb7ecd9f8304a39fc16a5fab">gaussian_sphere</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a5f9345465a753a4ace75a2b1d7c379ba">center</link>, double sigma, double amp)</para>

<para>Fills a gaussian sphere within an image with a uniform value. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aafb93c9e36f480a8b8c7cf40b826a37a">shell</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a5f9345465a753a4ace75a2b1d7c379ba">center</link>, double minrad, double maxrad, double width, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Fills a shell within an image with a uniform value. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aa909a61852ba0685fbebca6c091c667e">shell</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a5f9345465a753a4ace75a2b1d7c379ba">center</link>, double minrad, double maxrad, double width, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Fills a shell within an image with a uniform value. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a50d40a435fef4c6e8c9bff4bf4b4d6f5">shell_wrap</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a5f9345465a753a4ace75a2b1d7c379ba">center</link>, double minrad, double maxrad, double width, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Fills a shell within an image with a uniform value with wrapping. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a5b6e0c4b18f647d68db21c1fbbfaac3b">bar</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; end, double width, double edge_width, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Generates a bar between start and end points. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a637c8c9c3adab0168669c4b0a2bfe29f">bar</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; end, double width, double edge_width, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Generates a bar between start and end points. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a3e05702e10a44ce4cea8cb193d892740">quadric</link> (double *param)</para>

<para>Generates a quadric surface over the whole image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ab64a1edf3326cf703a0b596059704889">chirp</link> (double freq_scale, double freq_shift=0)</para>

<para>Generates a chirp image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a010a69d94b27256f673831bec3ede99b">fill_gaps</link> (long step)</para>

<para>Fill the voxels that are not calculated. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a7885caeffe8b1c90eaf9651fd575d749">interpolate_gaps</link> (long step)</para>

<para>Interpolate the voxels that are not calculated. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1afeb9247a8453a7e7907517b837d31144">transform</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; scale, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1abbbc219bc9f6b027e29563617a756bbd">origin</link>, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; translate, <link linkend="_class_matrix3">Matrix3</link> mat, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Transforms an image by translation, rotation, scaling and skewing, in place. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1af8b24fc84bde3d429023c6a2d19e993b">transform</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; scale, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1abbbc219bc9f6b027e29563617a756bbd">origin</link>, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; translate, <link linkend="_class_matrix3">Matrix3</link> mat, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Transforms an image by translation, rotation, scaling and skewing, returning a new image. </para>
</listitem>
            <listitem><para>void <link linkend="_class_bimage_1aba54e71d897721376cfaab4e6c360cf5">transform_voxel</link> (long i, <link linkend="_class_bimage">Bimage</link> *pt, long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; oldorigin, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; nuorigin, <link linkend="_class_matrix3">Matrix3</link> affmat, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>)</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a3eb5e8ee13e1fdc6ae91cf24a7b1000c">transform</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; scale, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1abbbc219bc9f6b027e29563617a756bbd">origin</link>, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; translate, <link linkend="_class_matrix3">Matrix3</link> mat, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Transforms a sub-image by translation, rotation, scaling and skewing, returning a single new image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a88866b740da67ec07103b1d342cc3a98">rotate</link> ()</para>

<para>Rotates an image using parameters defined in the image in place. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ab27f87167748ab84725b81c74438b932">rotate</link> (double <link linkend="__vector3_8h_1a4d0ad562e2f2e87c018fe778805aa3cf">angle</link>)</para>

<para>Rotates an image around the z-axis by the given angle in place. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1adc92a9f1c9ff02d2c22b9e7a9ffb1be4">rotate</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; axis, double <link linkend="__vector3_8h_1a4d0ad562e2f2e87c018fe778805aa3cf">angle</link>)</para>

<para>Rotates an image using an axis and angle in place. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a7bf45aa1df7f0171cc46ffaf00d4507a">rotate</link> (<link linkend="_class_view">View</link> <link linkend="_class_bimage_1ab474ad5f14737ab4931c0171a5d95579">view</link>)</para>

<para>Rotates an image to a specified view in place. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ad2c655354c84a54ec1b4bd71c8af60be">rotate</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; translate, <link linkend="_class_view">View</link> <link linkend="_class_bimage_1ab474ad5f14737ab4931c0171a5d95579">view</link>)</para>

<para>Rotates an image to a specified view in place. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ad6256d410696b7e3294809706e015efe">rotate</link> (<link linkend="_class_matrix3">Matrix3</link> mat)</para>

<para>Rotates an image using the specified matrix. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aac8847c323035bc8efc85d9f8de52baf">rotate</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; translate, <link linkend="_class_matrix3">Matrix3</link> mat)</para>

<para>Rotates an image using the specified shift and matrix. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a6607d768271a95c3b9f35933e991ad2e">rotate</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize)</para>

<para>Rotates an image using parameters defined in the image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1ab7b52ec12fd191c8f312cfa658fca1ba">rotate</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, double <link linkend="__vector3_8h_1a4d0ad562e2f2e87c018fe778805aa3cf">angle</link>)</para>

<para>Rotates an image around the z-axis by the given angle. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1af9c535401a34f4be682c0cedc8de5237">rotate</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; axis, double <link linkend="__vector3_8h_1a4d0ad562e2f2e87c018fe778805aa3cf">angle</link>)</para>

<para>Rotates an image using an axis and angle. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a3e899df9053f40b4f83f2f2398c79629">rotate</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_view">View</link> <link linkend="_class_bimage_1ab474ad5f14737ab4931c0171a5d95579">view</link>)</para>

<para>Rotates an image to a specified view. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a0e3c27171aa545d21f78bf9053bb5055">rotate</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; translate, <link linkend="_class_view">View</link> <link linkend="_class_bimage_1ab474ad5f14737ab4931c0171a5d95579">view</link>)</para>

<para>Rotates an image to a specified view. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1aa27ac57c3c18d91f290b3881d2f29d95">rotate</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_matrix3">Matrix3</link> mat)</para>

<para>Rotates an image using the specified matrix. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ad873912e785241f662e91058d513cc91">rotate_and_add</link> (<link linkend="_class_bimage">Bimage</link> *p, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1abbbc219bc9f6b027e29563617a756bbd">origin</link>, <link linkend="_class_view">View</link> <link linkend="_class_bimage_1ab474ad5f14737ab4931c0171a5d95579">view</link>)</para>

<para>Rotates an image to a specified view and adds it to another image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a9c6011cf7fd6d019afb2c0025e949d30">orient</link> (<link linkend="_class_view">View</link> *views)</para>

<para>Calculates multiple copies oriented according to views. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1accac475d79e9c3cc1c6ebdc6f0148d69">mirror</link> ()</para>

<para>Inverts/mirrors each image through its origin. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99">shift</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Shifts an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aa35b264e07b883cb7128b9539ceb05af">shift</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Shifts one sub-image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a358a46af05970ae98fe37d43333af8fb">shift_wrap</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec)</para>

<para>Shifts an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a215f5b8d6d4748458c05434ebd7f006b">shift_wrap</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec)</para>

<para>Shifts one sub-image with wrapping. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a5f9345465a753a4ace75a2b1d7c379ba">center</link> (int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Centers an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aea1442cea3c82de6ac0793d38241abaa">center_wrap</link> ()</para>

<para>Centers an image with wrapping. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a32b57fc3c6d4e3ea245b11686bf4c8ae">zero_origin</link> ()</para>

<para>Shifts the origins to zero with wrapping. </para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; long &gt; <link linkend="_class_bimage_1a1264a6b082a28fca56f75e11053d23cb">reciprocal_half</link> ()</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a5003afb6ec7e7d88800197dc47e4abfc">scale_to_same_size</link> (<link linkend="_class_bimage">Bimage</link> *pref)</para>

<para>Scales and image to the given reference. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a8221a6b44bccd9fb4bd31cc31320fcaa">scale_to_reference</link> (<link linkend="_class_bimage">Bimage</link> *pref, <link linkend="_class_bimage">Bimage</link> *pmask, double scalemin, double scalemax, double step)</para>

<para>Scales and image to the given reference, searching for the correct scale. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1afa7a3a7acb990d667c474c2c7d694b30">scale_to_reference</link> (<link linkend="_class_bimage">Bimage</link> *pref, <link linkend="_class_bimage">Bimage</link> *pmask=NULL)</para>

<para>Scales and image to the given reference, searching for the correct scale. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1ac9d5028551a2b8fde28e38228f3e998b">symmetrize</link> (<link linkend="_class_bstring">Bstring</link> &amp;symmetry_string, int flag)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1ac9234ec2ff8a260449cf950cdafa717a">symmetrize</link> (<link linkend="_struct_bsymmetry">Bsymmetry</link> sym, int flag)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1adcb92270632a302bdf4773ee5da2be0a">symmetrize</link> (<link linkend="_class_bstring">Bstring</link> &amp;symmetry_string, <link linkend="_class_view">View</link> ref_view, int flag)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a9780d7cbd494044686c433a6b525b9b6">symmetrize_cyclic</link> (int cyclic, int flag)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1adda5f353fd53c60a772c4457e6585a8b">symmetrize</link> (<link linkend="_struct_bsymmetry">Bsymmetry</link> sym, <link linkend="_class_view">View</link> ref_view, int flag)</para>

<para>Applies point group symmetry to an image. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a4a35640e535bfe59e5e9fbe19a7980d3">check_point_group</link> (<link linkend="_class_bstring">Bstring</link> &amp;check_string)</para>

<para>Checks for the requested symmetries. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a5260d542a8919de15b8398dfd2f90c78">find_cyclic_point_group</link> (<link linkend="_struct_bsymmetry">Bsymmetry</link> &amp;sym, int binfac, double hires, double lores)</para>

<para>Finds the orientation for an image with a cyclic point group symmetry. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a914355785c950b3e733936a999fb155b">find_point_group</link> (<link linkend="_struct_bsymmetry">Bsymmetry</link> &amp;sym, double angle_step, int binfac, double hires, double lores, int flags)</para>

<para>Finds the orientation for an image with a specific point group symmetry. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a1204e425ce7833d410445af713a8792a">rotate_to_axis</link> (<link linkend="_struct_bsymmetry">Bsymmetry</link> &amp;sym, long axis, long axis_flag)</para>

<para>Rotates to a symmetry axis. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a521d7a03503be2b8ec4a4090e81ada1e">change_symmetry</link> (<link linkend="_struct_bsymmetry">Bsymmetry</link> &amp;symold, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp;symnu, double radius, double z_slope)</para>

<para>Changes the symmetry order for cyclic and dihedral maps. </para>
</listitem>
            <listitem><para><link linkend="_class_matrix3">Matrix3</link> <link linkend="_class_bimage_1a9b10d20714d9de3585a5d17a5db6021b">symmetry_equivalent</link> (<link linkend="_class_bimage">Bimage</link> *ptemp, <link linkend="_class_bimage">Bimage</link> *pmask, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp;sym)</para>

<para>Finds the symmetry equivalent orientation of a particle with respect to a template. </para>
</listitem>
            <listitem><para><link linkend="_class_matrix3">Matrix3</link> <link linkend="_class_bimage_1a441cf6a9232c52cd99f32acdb1ba905d">symmetry_equivalent_cyclic</link> (<link linkend="_class_bimage">Bimage</link> *pref, <link linkend="_class_bimage">Bimage</link> *pmask, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp;sym)</para>

<para>Finds the cyclic symmetry equivalent orientation of a particle with respect to a template. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1adc844206e18c734ce3dc13bf775754b0">levelmask_asymmetric_units</link> (<link linkend="_struct_bsymmetry">Bsymmetry</link> &amp;sym, int <link linkend="_class_bimage_1a760143d3cb8fd5d6e1245ecd215821a2">index</link>)</para>

<para>Calculates a multi-level mask to indicate asymmetric units. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a2051e36bed46213a60d8c727a8e4fd6e">replicate_asymmetric_unit</link> (<link linkend="_struct_bsymmetry">Bsymmetry</link> &amp;sym)</para>

<para>Calculates a full map from one asymmetric unit. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a325003555664ad5ab63d7313d15fd26e">find_symmetric_view</link> (<link linkend="_class_bimage">Bimage</link> *ptemp, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp;sym, double phi_step, double theta_step, double alpha_step, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99">shift</link>)</para>

<para>Finds the view that on symmetrizing fits best to a symmetric template. 
<literallayout>&#160;&#xa;</literallayout>
 </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1acf2838d721c0aacfa1d4368509813bb1">helix_interpolate</link> (long i, double helix_rise, double helix_angle, int zmin, int zmax, double radius, int norm_flag=1)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1ab207c264e19d9a213331accd25de29a6">dyad_interpolate</link> (long i, int norm_flag=1)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a200ab278f109331849725f5398930f8e">tube_interpolate</link> (long i, int h, int k, double latconst, int zmin, int zmax, double radius, int norm_flag=1)</para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a006beeeff826f2c0cc1842f9b0a68ff2">helix_symmetrize</link> (double helix_rise, double helix_angle, int dyad_axis, int zmin, int zmax, double radius, int norm_flag=1)</para>

<para>Symmetrizes an image given helical symmetry parameters. </para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1a45b58edcb6fea8c4b1bd1ccd54790ffd">seamed_helix_symmetrize</link> (double helix_rise, double helix_angle, double seam_shift, int dyad_axis, int zmin, int zmax, double radius, int norm_flag)</para>

<para>Symmetrizes an image given helical symmetry parameters and seam shift parameter. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a8e04fb8bc837bf7f030b4fb061e1bdbf">symmetrize_cylinder</link> (int flag)</para>

<para>Calculates a cylindrically symmetrized map. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1abff0d6899e55fcad02d800f179e87e46">symmetrize_cylinder</link> ()</para>

<para>Calculates a cylindrically symmetrized map. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a8f9ffa51405f1702ea3091f35fa66902">tube_symmetrize</link> (int h, int k, double latconst, int zmin, int zmax, double radius, int norm_flag=1)</para>

<para>Symmetrizes an image given tubular lattice parameters. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1aaff64a952f50ef4f0d7752823927a842">convert_to_helix</link> (double helix_rise, double helix_angle, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; offset)</para>

<para>Converts a map to a helix. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a1a729cd6b00a8a5031ca545921e5014b">distort_elliptically</link> (double <link linkend="__vector3_8h_1a4d0ad562e2f2e87c018fe778805aa3cf">angle</link>, double <link linkend="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99">shift</link>)</para>

<para>Transforms a tubular cylinder to an elliptical profile. </para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a8d7f8e0e6c7601e156216fc0552f24d7">test_helix_parameters</link> (double <link linkend="__vector3_8h_1a4d0ad562e2f2e87c018fe778805aa3cf">angle</link>, double hires, double lores, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; mask_size, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; mask_start, long max_iter, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>, double &amp;cc)</para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1acaf92f8a5678c4bf76b6b1530dc228aa">find_helix_parameters</link> (double angle_start, double angle_end, double angle_step, int bin, double hires, double lores, double radius)</para>

<para>Finds the best helix parameters for helical map. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a3d6a7f6c65c1e731404fee3c2fbf7336">test_helix_parameters</link> (double rise, double <link linkend="__vector3_8h_1a4d0ad562e2f2e87c018fe778805aa3cf">angle</link>, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; mask_size, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; mask_start)</para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1ac3c7c1606f1635f114b13ee6a0fa7441">find_helix_parameters</link> (double rise_start, double rise_end, double rise_step, double angle_start, double angle_end, double angle_step, int bin, double radius)</para>

<para>Finds the best helix parameters for helical map. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a2a9eb9c30f80919647fbcd1626f5c611">helix_segment_correlation_one</link> (long i, double angle_start, double angle_end, double angle_step, int bin, double hires, double lores, double radius, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a6ecaa8728bab23c3a7d96fe0cadc75f2">planf</link>, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> <link linkend="_bico_8cpp_1a9ec8849996c5e210d7b7e8e05b98639d">planb</link>, double *cc)</para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1a6080c797d3cb69253b985303271e080e">helix_segment_correlation</link> (int <link linkend="_class_bimage_1a960a7f0cde5092bb23f788c359c5388a">thickness</link>, double angle_start, double angle_end, double angle_step, int bin, double hires, double lores, double radius)</para>

<para>Calculates the correlation over rotation angles between helical segments. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a3b6ce6033d308dc4276493460266243c">transform_lines</link> ()</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a7ce50ec5b49ecf11d7dca124c6a85b90">helical_cross_section</link> (double helix_rise, double helix_angle, double scale, double hires)</para>

<para>Calculates a helical cross section from line transforms of a filament. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1af717a562427570bee1788cf53f3dc408">snvariance</link> (double snradius)</para>

<para>Calculates the ratio of variance inside and outside a given radius. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ad03e8e721a1d85ad7a40d4d03d3c0574">extrude_cross_section</link> (long <link linkend="__vector3_8h_1a7baf5ed670fcf9bcca9a3a400820e292">length</link>, double helix_rise, double helix_angle, int fill_type, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>)</para>

<para>Extrudes a 2D cross section into a 3D continuous helix. </para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1aa5ee26442c0bafb0b25476062545ebfe">filament_width</link> (long width, long lim_lo, long lim_hi)</para>

<para>Estimates the width of a filament. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1ad37eb70146e2c6730f8757cb02eae628">filament_density</link> (double width)</para>

<para>Estimates the density per pixel length of a filament. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a3ba420d47cf61f7095470e8e9c2aeba9">filament_from_projections</link> (double hi_res, int flag=0)</para>

<para>Reconstructs a filament from a set of projections. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a7e58dfcfdf34ccd506bed0d3ef5b4db5">radial</link> (long minrad, long maxrad, double rad_step=1, int wrap=0)</para>

<para>Calculates the radial average of an image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a6ebe92011b255b290b14be60266b8632">radial</link> (long minrad, long maxrad, double rad_step, <link linkend="_class_bimage">Bimage</link> *pmask, int wrap=0)</para>

<para>Calculates the radial average of an image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a9873d1561805e0845a44c24cf2b4d872">radial</link> (long minrad, long maxrad, double rad_step, double ellipticity, double <link linkend="__vector3_8h_1a4d0ad562e2f2e87c018fe778805aa3cf">angle</link>, <link linkend="_class_bimage">Bimage</link> *pmask, int wrap=0)</para>

<para>Calculates the radial average of an image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a8e666b9c155a9929050dcf4b0f339789">radial_symmetry_adjusted</link> (double rad_start, double rad_end, double rad_step, double spherical_fraction, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp;sym)</para>

<para>Calculates the symmetry-adjusted radial average of an image. </para>
</listitem>
            <listitem><para>double * <link linkend="_class_bimage_1adf4764ac2099326f8550a9f85f9e8290">radial_fit</link> (<link linkend="_class_bimage">Bimage</link> *pref)</para>

<para>Fits a radial profile to a reference radial profile. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a47f717fb32a8f0dc296581f6987e5c23">radial_to_full</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1abbbc219bc9f6b027e29563617a756bbd">origin</link>)</para>

<para>Generates a full 2D or 3D image from a radial profile in a 1D image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a09f15732e3911c087fbf9ed1f8762447">cartesian_to_spherical</link> (long nannuli, long nphi, long ntheta)</para>

<para>Calculates an image with spherical coordinates. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1ad80ca2aed25743abb540366ef12cfcff">cartesian_to_cylindrical</link> (long nannuli, long nphi, int flag=0)</para>

<para>Calculates an image with cylindrical coordinates. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a013af83454914211aea16cea113711a5">polar_transform</link> (long nangles, long ann_min, long ann_max, long dann, long zmin, long zmax, long zinc)</para>

<para>Calculates an image with cylindrical coordinates by integration. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a426b883cb5948d3d72776e8dab1370be">polar_power_spectrum</link> (double resolution, long num_angle)</para>

<para>Calculates the polar power spectrum of a 2D transform amplitude or intensity image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a7bdfaa89652d965acbf3a94cb87501b8">line_powerspectra</link> (<link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> plan)</para>

<para>Calculates the 1D power spectrum of each line in an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a886dcdd400fd1e7a920975dad3c43835">radial_shells</link> ()</para>

<para>Calculates an image with slices representing radial shell projections. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a0a2ba8a5f6c80e5ac4e9b52a87e907f8">cylindrical_shells</link> ()</para>

<para>Calculates an image with slices representing cylindrical shell projections. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a5a73644b93a8f9033ada10246f952e0a">radial_sections</link> (double rad_start, double rad_end, double rad_step, double spherical_fraction, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp;sym, int fill_type=<link linkend="_utilities_8h_1ae8a4ca63176786d1254d05591419ba9c">FILL_USER</link>, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Calculates an image with slices giving the radial section projections. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a2a29bbf90a10dd26c13974ba24320196">radial_coverage</link> (double threshold, double rad_step=1)</para>

<para>Calculates the coverage in each radial shell. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a8c930e1334ca602ae39bcf26b3a6f851">topograph_to_surface</link> (<link linkend="_class_bimage">Bimage</link> *psd, long nz, double <link linkend="_class_bimage_1a0df18d85c91d522f3f3c2d8ea56b1850">density</link>, double resolution)</para>

<para>Converts a 2D AFM image to a 3D density map. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a1de22ac24c7afaac9c174a4b4ff27bc9">surface_to_topograph</link> (double threshold, int dir=0)</para>

<para>Converts a 3D image to a 2D height image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a94d462f9cb36da0a45674bcedfa787d1">rotate_height</link> (<link linkend="_class_matrix3">Matrix3</link> mat, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; translate, double threshold=0)</para>

<para>Rotates a 3D map and calculates the height along the z-axis. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a53f0e717f7eb6d7cbe3282a752872ca3">height</link> (<link linkend="_class_view">View</link> *views, double threshold=0)</para>

<para>Calculates a set of height images from a 3D density map. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a42bc0d2d19d1c538cd9680c101d9a780">integer_interpolation</link> (int integer_factor)</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a671612e813fa45a25abde953884831cc">integer_interpolation</link> (int integer_factor, int odd)</para>

<para>Interpolates by an integer scale with a density-preserving overlapping kernel. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a47c5acae2d99305b8eec1997f9db2097">bin</link> (long b)</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1afcbd4d70177757388e094c53aba5ecf3">bin</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; bk)</para>

<para>Bins by an integer size in place. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a6d423733fa3765859c6562127d20e3ed">bin_copy</link> (long b)</para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a720b12635718c76bafb0d844b2264f6b">bin_copy</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; bk)</para>

<para>Bins by an integer size and returns a new image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1aea01ef4b1ce5c9a28c2fbef72c87f45b">bin_around_origin</link> (int bin)</para>

<para>Bins by an integer size making sure the origin falls on a binned voxel, and returns a new image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1add1b04d31f25a73455f662662193c9ac">median_bin</link> (int binning)</para>

<para>Bins by an integer size, selecting the kernel median. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a8789a73a0157946672911c639e820126">noise_uniform</link> (double rmin, double rmax)</para>

<para>Generates an image with a uniform random distribution of densities. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ada19a7de518b9a3ae873b75729c8f74a">noise_gaussian</link> (double ravg=0, double rstd=1)</para>

<para>Generates an image with a gaussian random distribution of densities. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1adc4e6a903ad879bba330eb40f419d8ac">noise_poisson</link> (double ravg)</para>

<para>Generates an image with a poisson random distribution of densities. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a2b440a133368904a12132742c4c8c07d">noise_logistical</link> (double ravg, double rstd)</para>

<para>Generates an image with a gaussian random distribution of densities. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a0be1dd59316cc9ba6cb3af8a2cd7364f">noise_spectral</link> (double alpha)</para>

<para>Generates a noise map with a defined spectral decay. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a7e52a939175e002908692140c372213d">mask</link> (<link linkend="_class_bimage">Bimage</link> *pmask, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>)</para>

<para>Masks an image. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a1513d43b73d238e6b087fe2e4a2dc873">to_mask</link> ()</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a9d8256eb1e4caa7cabb1a72f0287d98d">to_mask</link> (double threshold)</para>

<para>Change the image to a mask. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a3d369e4ff6b9dafa6f4e7c3cc624cc8d">mask_by_threshold</link> (double threshold)</para>

<para>Generates a mask based on an image at a given threshold. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a680ab2f328a430aa2419e8f99a7171ca">mask_by_thresholds</link> (vector&lt; double &gt; threshold)</para>

<para>Generates a mask based on an image at given thresholds. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1abf9e6d8253c07d69800a8eb4a349a81b">mask_by_conditional_thresholds</link> (vector&lt; double &gt; threshold)</para>

<para>Generates a mask based on a conditional hierarchy of thresholds. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1af6366dbd7f4291754ee084a5a47aed4e">mask_stats</link> ()</para>

<para>Calculates statistics for a mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a8a53e32389be9d324c6a5020c0d46478">mask_invert</link> ()</para>

<para>Inverts a mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a93d63999cd5d4250dcd81210958cac78">mask_combine</link> (<link linkend="_class_bimage">Bimage</link> *p, int operation)</para>

<para>Combines two masks with different operations. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a19c294d3382038ecc8c54bccfd4583d3">mask_extract</link> (<link linkend="_class_bimage">Bimage</link> *pmask)</para>

<para>Zeroes everything outside the mask and return the excised feature. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ab8ceb4eeff446c3ed0cc5b937cab227c">max_in_kernel</link> (long ksize)</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a6e4f025da30842a514cb858e8054cc53">mask_dilate_erode</link> (unsigned char dir)</para>

<para>Dilates or erodes a binary mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1af36613b563af19c946ca869f076bf634">mask_dilate</link> (long times=1)</para>

<para>Dilates a binary mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a902d3c93fd01cff5be2cf247ab42c437">mask_erode</link> (long times=1)</para>

<para>Erodes a binary mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1aaa3e82bba9f9618a7bb03ccdd3a2a223">mask_open</link> (int times=1)</para>

<para>Opens a binary mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a2fc50476f618586e13c5d2ba99a3a4d5">mask_close</link> (int times=1)</para>

<para>Closes a binary mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1ac82fd40b41c01945499551804754d76b">mask_fill</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; voxel)</para>

<para>Fills an empty part of a mask indicated by the given voxel. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1ab7a554846aee83da6a7c471ca3ae8636">mask_shell</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1abbbc219bc9f6b027e29563617a756bbd">origin</link>, double rad_min, double rad_max)</para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1acca2b4d4df22975e0790da09f03d6b13">mask_plane</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1abbbc219bc9f6b027e29563617a756bbd">origin</link>, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; normal)</para>

<para>Generates a mask on one side of a plane. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a2b23d253a27fc9adead69d5f94f16ec7">mask_rectangle</link> (double <link linkend="__vector3_8h_1a7baf5ed670fcf9bcca9a3a400820e292">length</link>, double width, double rect_angle, int wrap)</para>

<para>Generates a mask along an axis within a 2D image. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a836137ddada36d9ee07e0c778597470c">mask_symmetrize</link> (<link linkend="_struct_bsymmetry">Bsymmetry</link> &amp;sym)</para>

<para>Symetrizes a mask. </para>
</listitem>
            <listitem><para><link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1a9b263c23f182cd36c93e7de6dc0741e5">mask_fspace_resize</link> (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize)</para>

<para>Resizes a reciprocal space mask. </para>
</listitem>
            <listitem><para>vector&lt; double &gt; <link linkend="_class_bimage_1ad411c82b4d184c05045f3ecb4cbee83d">fspace_default_bands</link> (double res_lo, double res_hi)</para>

<para>Sets up default frequency space bands to generate a mask. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ab103c7cb8674784b51c313026b294cde">mask_fspace_banded</link> (vector&lt; double &gt; &amp;band)</para>

<para>Generate reciprocal space mask based on a specification of bands. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1acb39a8ba9b2b27d51721e89af40582a5">mask_missing_wedge</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1abbbc219bc9f6b027e29563617a756bbd">origin</link>, double tilt_axis, double tilt_neg, double tilt_pos, double resolution)</para>

<para>Generates a mask with a missing wedge. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a90602f4654cd1d2479828eddf096ddb3">mask_missing_pyramid</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1abbbc219bc9f6b027e29563617a756bbd">origin</link>, double tilt_axis1, double tilt_axis2, double tilt_neg1, double tilt_pos1, double tilt_neg2, double tilt_pos2, double resolution)</para>

<para>Generates a mask with a missing pyramid. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a81e19d75253d301436865e742712abe5">mask_missing_cone</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; <link linkend="_class_bimage_1abbbc219bc9f6b027e29563617a756bbd">origin</link>, double mis_ang, double resolution)</para>

<para>Generates a mask with a missing cone. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a1b60c0e93b7ed7fd9141fcf89edd24f6">mask_missing_find</link> (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; ori, double resolution, <link linkend="_class_bstring">Bstring</link> &amp;mis_type)</para>

<para>Generates a missing mask from an example image. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a90d83b3bde0fc65afea592336ea84424">mask_pack_plane</link> (<link linkend="_class_matrix3">Matrix3</link> mat, double hi_res, double scale)</para>

<para>Packs a 2D mask into a 3D reciprocal space volume. 
<literallayout>&#160;&#xa;</literallayout>
 </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1ac78b4ad1046f5e78339620f7ac38309f">variance_threshold</link> (double lowvar)</para>

<para>Calculates a threshold for a local variance image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a3d30db7452d06854cadb693a84e2385a">variance_mask</link> (long kernel_size, double lowvar=1e-6, int bkg_flag=0)</para>

<para>Calculates a mask based on local variance. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1aa0ac74f2bb136585165376ab7feb7b2b">tile_mask</link> (long step)</para>

<para>Converts a mask to a tiled multilevel mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1aa1da94077a3d1099442e779a338873d3">mask_split</link> (long voxels_per_level)</para>

<para>Converts a mask to a multilevel mask with a given number of voxels per level. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a9b050b7abd5bbe9ba1b22ea6f6c55c22">levelmask_collapse</link> ()</para>

<para>Collapse a multi-level mask to a binary mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a7bc85fb79cd16369c7fa58ee7cb9a8c4">levelmask_add</link> (<link linkend="_class_bimage">Bimage</link> *pmask, int add_level=1)</para>

<para>Adds a bilevel mask to a level mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a3b8f8a71d29892880177dba00493a97b">levelmask_dilate</link> (int times)</para>

<para>Dilates a level mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1abfa93c8bce1563c143cbc32bd8c024c3">levelmask_dilate</link> ()</para>

<para>Dilates a level mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a4c503a8bad6d5188959ef2102372c805">levelmask_select</link> (<link linkend="_class_bstring">Bstring</link> &amp;select_list, int flag=0)</para>

<para>Retains the selected levels in a multi-level mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1ad7f3b28f7dcabcf950bed87b5c43fe68">levelmask_combine</link> (<link linkend="_class_bstring">Bstring</link> &amp;select_list)</para>

<para>Combines the selected levels in a multi-level mask and renumber. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a0c655e6d6031423e7028b3d163c0a264">levelmask_select</link> (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; voxel)</para>

<para>Retains the selected levels in a multi-level mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a00376e3fe457712ab10246026c478c89">levelmask_select</link> (<link linkend="_class_bimage">Bimage</link> *pmask)</para>

<para>Selects regions overlapping a mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a152515cc985bb3785ae95e258381c211">levelmask_switch</link> (long index1, long index2)</para>

<para>Switches two segments in a multi-level mask. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ad6e31bfb7410474d13a52648e8d6a3c8">level_masked_stats</link> (<link linkend="_class_bimage">Bimage</link> *pmask)</para>

<para>Caclulates statistics for all the regions defined by a multi-level mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1afd966c254c4470cdf8a9e1d9254e0438">levelmask_symmetrize</link> (<link linkend="_struct_bsymmetry">Bsymmetry</link> &amp;sym)</para>

<para>Symetrizes a multi-level mask. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a8266d26a479d99b845c7125e4efab7f1">level_mask_extract</link> (<link linkend="_class_bimage">Bimage</link> *pmask, int fill_type=0, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>=0)</para>

<para>Extracts all the regions associated with a multi-level mask. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1aa1a2be8e3d04b368f3bfd57256809719">levelmask_average_region_size</link> ()</para>

<para>Calculates the average size of regions in a level mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1af17d6f37ff5cbbdcde7620f05141678e">levelmask_clean</link> ()</para>

<para>Removes empty levels from a multi-level mask. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a86476781a80154c519dd0ddf5962ec43">levelmask_colorize</link> ()</para>

<para>Colorizes a multi-level mask with random color assignments. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a001d55537c8ef53c9a8db4e4db51550b">levelmask_color_by_size</link> ()</para>

<para>Color a multi-level mask based on the volumes of regions. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a8f4b48837a8edb33dd4003ed717d03e1">levelmask_region_size</link> ()</para>

<para>Convert a mask to reflect region sizes. </para>
</listitem>
            <listitem><para><link linkend="_class_bplot">Bplot</link> * <link linkend="_class_bimage_1a42c3d811f32bcb221a5692271fd2e4df">levelmask_size_histogram</link> ()</para>

<para>Color a multi-level mask based on the volumes of regions. </para>
</listitem>
            <listitem><para><link linkend="_class_matrix">Matrix</link> <link linkend="_class_bimage_1a47d213b882cd62b6ddd30592a8b9df45">mask_interface_matrix</link> (int img_num)</para>

<para>Calculates the interfaces between regions. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a94451f98c91c97bf0dee26b0b2a7deab">mask_region_interfaces</link> (int reg_num)</para>

<para>Reports the whole interface matrix or interfaces for one region only. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a032c319d4fb989ec7da3c9088c17a987">mask_merge_delete</link> (long min_size, long min_if)</para>

<para>Calculates the interfaces between regions and deletes/merges small ones. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a26ba83e822caca17e4f2eabfb761f6f3">apply_soft_mask</link> (long nn, <link linkend="_class_bimage">Bimage</link> *pmask, int fill_type, double <link linkend="_class_bimage_1a31c23502ddd87cbb33e533a97282effb">fill</link>)</para>

<para>Applies a soft mask to a sub-image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1ac55bb02394e154f3b19519c3be2c8c98">regions</link> (double threshold, int sign)</para>

<para>Segments an image into contiguous regions. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a7c44ca1140db2f36355ae99a0d0e933a">region_assign</link> (<link linkend="_class_bimage">Bimage</link> *pmask, long idx, long region_number, double threshold, int sign)</para>

<para>Finds all the pixels that are part of the same region. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a5480279ea3c3895fb01a20ffb1839ce7">region_threshold_series</link> (double threshold_first, double threshold_last, double threshold_step)</para>

<para>Segments a map through a series of thresholds and reports results. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1ab0e749d2074b4a2e493324e9b526c4e0">region_flood</link> (<link linkend="_class_bimage">Bimage</link> *pmask, double threshold_hi, double threshold_lo, double threshold_step, int fill_borders)</para>

<para>Creates and expands a region map from a starting to ending threshold value. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1af285f9b976519ffee80fd03a19db17eb">check_neighbors</link> (long idx)</para>

<para>Check neighbors in region map and assign a value if a neighbor is assigned. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a08fd2cd3face95c2fb85f2adfb36532f">track_gradient</link> (double threshold, int flag=0)</para>

<para>Generates a segmented image from peaks above a threshold value. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a97e5ef2e7188a1ba225d6f2c31932686">region_peaks</link> (long kernel_size, double threshold, int flood=0, int wrap=0)</para>

<para>Generates a segmented image from peaks above a threshold value. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1aaea7cb2268b8f1823316f78fa1180bc7">blobs</link> (double threshold, double min_size, double max_size, double setvalue, int sign)</para>

<para>Identifies contiguous regions above a given threshold (blobs) and eliminate those less than a minimum size. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1aa7bdc44f4581bd59d988cd52ea5d10a4">filter_extremes</link> ()</para>

<para>Filters the extremes out of a micrograph image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a68563296b57a2d9c25362546f8bf2e2e">filter_extremes</link> (int mod_flag)</para>

<para>Filters the extremes out of an image. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1abcd3f470d765801f6061d67342a8b42b">filter_extremes</link> (double tmin, double tmax, int <link linkend="_structkernel">kernel</link>=3)</para>

<para>Filters the extremes out of an image by replacing with adjacent averages. </para>
</listitem>
            <listitem><para>long <link linkend="_class_bimage_1a2f42862e052c422dc5868b9b1234cd5d">replace_maxima</link> (double threshold)</para>

<para>Replaces maxima above a threshold using local averages. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1a6b9526b2fed89d032614d58b597db290">mass_threshold</link> (long img_num, double mol_weight, double rho)</para>

<para>Finds the density threshold associated with a particular molecular weight. </para>
</listitem>
            <listitem><para>double <link linkend="_class_bimage_1ad49ed68863064bb22ca6dc210a712f66">mass_at_threshold</link> (long img_num, double threshold, double rho)</para>

<para>Calculates the mass from the density threshold. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a1514d68d5b4b97a826bca033250c4926">internal_volume</link> (double threshold)</para>

<para>Calculates the internal volume of a shell. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a42d2caa457d42a0e1991e63ac4dcf82a">internal_volume</link> (double threshold, int mask_out_freq)</para>

<para>Calculates the internal volume of a shell. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1ae3805a269db97bedf75fea6100a28a09">kmeans_segment</link> (long nregion=2, long max_iter=10, double ratio=1)</para>

<para>Segments an image based on K-means. </para>
</listitem>
            <listitem><para><link linkend="_class_g_sgraph">GSgraph</link> <link linkend="_class_bimage_1a092cc4d52f3a396c699f83dcbd4a2ad4">graph_setup</link> (int connect_type)</para>

<para>Initializing voxels and edges for graph-based segmentation. </para>
</listitem>
            <listitem><para><link linkend="_class_g_sgraph">GSgraph</link> <link linkend="_class_bimage_1a3e7e93591778f6edd9ac10c841202b58">graph_segment</link> (int type=1, int connect_type=0, double complexity=0, long min_size=0)</para>

<para>Graph-based segmentation of an image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a51056d0e235ae01a7ed58427a1c204ef">graph_segments_to_image</link> (<link linkend="_class_g_sgraph">GSgraph</link> &amp;g)</para>

<para>Converting a graph-based segmentation to an image. </para>
</listitem>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1aca8566ad6dc2ec1f6545904b0be3b463">graph_segments_to_mask</link> (<link linkend="_class_g_sgraph">GSgraph</link> &amp;g)</para>

<para>Converting a graph-based segmentation to a multi-level mask. </para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1a0967da4dc8941259b9e4e03fbc169b8e">superpixels_update</link> (<link linkend="_class_bimage">Bimage</link> *pmask, vector&lt; long &gt; vstep, double colorweight, vector&lt; <link linkend="_class_bsuperpixel">Bsuperpixel</link> &gt; &amp;seg)</para>
</listitem>
            <listitem><para>vector&lt; <link linkend="_class_bsuperpixel">Bsuperpixel</link> &gt; <link linkend="_class_bimage_1aed87b5005e95430846c84a77a59a7231">superpixels_from_mask</link> (long cc, long step)</para>

<para>Create superpixels from a multilevel mask. </para>
</listitem>
            <listitem><para>vector&lt; <link linkend="_class_bsuperpixel">Bsuperpixel</link> &gt; <link linkend="_class_bimage_1aa33a023390e57b9360c07a7e29897096">superpixels</link> (long step, double colorweight=0.2, long iterations=10, double stop=1)</para>

<para>Segment the image into superpixels. </para>
</listitem>
            <listitem><para>vector&lt; <link linkend="_class_bsuperpixel">Bsuperpixel</link> &gt; <link linkend="_class_bimage_1af8595e7180726af4e712990b8d8c1e69">superpixels</link> (long step, double colorweight=0.2, long iterations=10, long bin_levels=1, double stop=1)</para>
</listitem>
            <listitem><para>int <link linkend="_class_bimage_1ae3d5f0fe96415e7d334ab657393b7f21">impose_superpixels</link> (<link linkend="_class_bimage">Bimage</link> *pmask, vector&lt; <link linkend="_class_bsuperpixel">Bsuperpixel</link> &gt; &amp;seg, int impose)</para>

<para>Impose superpixel features onto an image. </para>
</listitem>
        </itemizedlist>
</simplesect>
<simplesect>
    <title>Public Attributes    </title>
        <itemizedlist>
            <listitem><para><link linkend="_class_bimage">Bimage</link> * <link linkend="_class_bimage_1a0195ccc461a1a7c1170461211e66f103">next</link></para>
</listitem>
            <listitem><para><link linkend="_class_bsub__image">Bsub_image</link> * <link linkend="_class_bimage_1a4c3d90a7e963c8fb653f825eb139b045">image</link></para>
</listitem>
        </itemizedlist>
</simplesect>
<section>
<title>Detailed Description</title>

<para>General image parameter class. </para>



<para><literallayout><computeroutput>All floating point coordinates are in angstroms and converted 
using the voxel units parameters.
</computeroutput></literallayout> </para>
<para>
Definition at line 161 of file Bimage.h.</para>
</section>
<section>
<title>Constructor &amp; Destructor Documentation</title>
<anchor xml:id="_class_bimage_1a425d720ea28e3566a1cbc1eca8ed9c8d"/>    <section>
    <title>Bimage()<computeroutput>[1/9]</computeroutput></title>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<para><computeroutput>Bimage::Bimage ( )</computeroutput></para><para>

<para>Initializes an image. </para>
</para>

<para><literallayout><computeroutput>The internal initialization function is called.
</computeroutput></literallayout> </para>
<para>
Definition at line 43 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2019f6168e64ab28ee4aecf26c608bec"/>    <section>
    <title>Bimage()<computeroutput>[2/9]</computeroutput></title>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<para><computeroutput>Bimage::Bimage (const <link linkend="_class_bimage">Bimage</link> &amp; p)</computeroutput></para><para>

<para>The copy constructor. </para>
</para>

<para><literallayout><computeroutput>The internal copy function is called.
</computeroutput></literallayout> </para>
<para>
Definition at line 57 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a43bf591cb81fbd5a134f22a4996f9e2a"/>    <section>
    <title>Bimage()<computeroutput>[3/9]</computeroutput></title>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<para><computeroutput>Bimage::Bimage (<link linkend="_class_bstring">Bstring</link> &amp; fn, int readdata, int img_select)</computeroutput></para><para>

<para>Reads an image from a file. </para>
</para>

<para><literallayout><computeroutput>The internal initialization function is called.
</computeroutput></literallayout> </para>
<para>
Definition at line 69 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a05fefb596c7347a4bbc1f484ae90f6bb"/>    <section>
    <title>Bimage()<computeroutput>[4/9]</computeroutput></title>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<para><computeroutput>Bimage::Bimage (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> type, <link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ctype, long nx, long ny, long nz, long nn)</computeroutput></para><para>

<para>Initializes an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>type</entry>
                                <entry>
<para>data type. </para>
</entry>
                            </row>
                            <row>
                                <entry>ctype</entry>
                                <entry>
<para>compound type. </para>
</entry>
                            </row>
                            <row>
                                <entry>nx</entry>
                                <entry>
<para>x dimension. </para>
</entry>
                            </row>
                            <row>
                                <entry>ny</entry>
                                <entry>
<para>y dimension. </para>
</entry>
                            </row>
                            <row>
                                <entry>nz</entry>
                                <entry>
<para>z dimension. </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>number of sub-images. <literallayout><computeroutput>The internal initialization function is called.
The basic properties and size is set up and the data allocated.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 91 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8fcb3757ada7420ce5a48fff2fb1ce0c"/>    <section>
    <title>Bimage()<computeroutput>[5/9]</computeroutput></title>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<para><computeroutput>Bimage::Bimage (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> type, <link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ctype, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; size, long nn)</computeroutput></para><para>

<para>Initializes an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>type</entry>
                                <entry>
<para>data type. </para>
</entry>
                            </row>
                            <row>
                                <entry>ctype</entry>
                                <entry>
<para>compound type. </para>
</entry>
                            </row>
                            <row>
                                <entry>size</entry>
                                <entry>
<para>image size. </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>number of sub-images. <literallayout><computeroutput>The internal initialization function is called.
The basic properties and size is set up and the data allocated.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 112 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1abd8f2cf3ae088ca3d5d171e159571e90"/>    <section>
    <title>Bimage()<computeroutput>[6/9]</computeroutput></title>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<para><computeroutput>Bimage::Bimage (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> type, <link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ctype, vector&lt; long &gt; size, long nn)</computeroutput></para><para>

<para>Initializes an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>type</entry>
                                <entry>
<para>data type. </para>
</entry>
                            </row>
                            <row>
                                <entry>ctype</entry>
                                <entry>
<para>compound type. </para>
</entry>
                            </row>
                            <row>
                                <entry>size</entry>
                                <entry>
<para>image size. </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>number of sub-images.</para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                The internal initialization function is called. The basic properties and size is set up and the data allocated. </para>
<para>
Definition at line 132 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af7e9eef81a78901639de38bbdba0a5d1"/>    <section>
    <title>Bimage()<computeroutput>[7/9]</computeroutput></title>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<para><computeroutput>Bimage::Bimage (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> type, long nc, long nx, long ny, long nz, long nn)</computeroutput></para><para>

<para>Initializes a generic multi-channel image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>type</entry>
                                <entry>
<para>data type. </para>
</entry>
                            </row>
                            <row>
                                <entry>nc</entry>
                                <entry>
<para>number of channels. </para>
</entry>
                            </row>
                            <row>
                                <entry>nx</entry>
                                <entry>
<para>x dimension. </para>
</entry>
                            </row>
                            <row>
                                <entry>ny</entry>
                                <entry>
<para>y dimension. </para>
</entry>
                            </row>
                            <row>
                                <entry>nz</entry>
                                <entry>
<para>z dimension. </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>number of sub-images. <literallayout><computeroutput>The internal initialization function is called.
The basic properties and size is set up and the data allocated.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 154 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6dde3db934477ded98998ebec647881a"/>    <section>
    <title>Bimage()<computeroutput>[8/9]</computeroutput></title>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<para><computeroutput>Bimage::Bimage (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> type, long nc, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; size, long nn)</computeroutput></para><para>

<para>Initializes a generic multi-channel image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>type</entry>
                                <entry>
<para>data type. </para>
</entry>
                            </row>
                            <row>
                                <entry>nc</entry>
                                <entry>
<para>number of channels. </para>
</entry>
                            </row>
                            <row>
                                <entry>size</entry>
                                <entry>
<para>image size. </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>number of sub-images. <literallayout><computeroutput>The internal initialization function is called.
The basic properties and size is set up and the data allocated.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 175 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a9104e8dd80432d70e95570fb4c593fa0"/>    <section>
    <title>Bimage()<computeroutput>[9/9]</computeroutput></title>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>Bimage</secondary></indexterm>
<para><computeroutput>Bimage::Bimage (<link linkend="_class_matrix">Matrix</link> &amp; mat, long scale)</computeroutput></para><para>

<para>Initializes an image from a 2D matrix. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>mat</entry>
                                <entry>
<para>matrix. </para>
</entry>
                            </row>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>integer scale for enlarging the image. <literallayout><computeroutput>The internal initialization function is called.
The basic properties and size is set up and the data allocated.
The matrix contents are transferred with dimension scaling.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 194 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad612df25d03e9be007a57ab619e5e76e"/>    <section>
    <title>~Bimage()</title>
<indexterm><primary>~Bimage</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>~Bimage</secondary></indexterm>
<para><computeroutput>Bimage::~Bimage ( )</computeroutput></para><para>

<para>Image destructor. </para>
</para>

<para><literallayout><computeroutput>All properties and associated data are deallocated.
</computeroutput></literallayout> </para>
<para>
Definition at line 222 of file Bimage.cpp.</para>
</section>
</section>
<section>
<title>Member Function Documentation</title>
<anchor xml:id="_class_bimage_1a3caf0fd81251dd1d57aa3fb336000591"/>    <section>
    <title>add()<computeroutput>[1/8]</computeroutput></title>
<indexterm><primary>add</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>add</secondary></indexterm>
<para><computeroutput>void Bimage::add (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Adds another image to an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image to be added. <literallayout><computeroutput>Requirement: The images must have the same size.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 3653 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a1d255c2a8212c0d798c04135f95d8ab7"/>    <section>
    <title>add()<computeroutput>[2/8]</computeroutput></title>
<indexterm><primary>add</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>add</secondary></indexterm>
<para><computeroutput>void Bimage::add (<link linkend="_class_bimage">Bimage</link> * p, double scale, double shift)</computeroutput></para><para>

<para>Adds another image to an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image to be added. </para>
</entry>
                            </row>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>density scale to other image </para>
</entry>
                            </row>
                            <row>
                                <entry>shift</entry>
                                <entry>
<para>density shift to other image. <literallayout><computeroutput>Requirement: The images must have the same size.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 3728 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aba22e1bb37a9565161d49c7908f2fce7"/>    <section>
    <title>add()<computeroutput>[3/8]</computeroutput></title>
<indexterm><primary>add</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>add</secondary></indexterm>
<para><computeroutput>void Bimage::add (double v)</computeroutput></para><para>

<para>Adds a constant value to an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>v</entry>
                                <entry>
<para>constant to be added. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 3434 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a5557cef39f005b06b6bd75993a75e54f"/>    <section>
    <title>add()<computeroutput>[4/8]</computeroutput></title>
<indexterm><primary>add</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>add</secondary></indexterm>
<para><computeroutput>void Bimage::add (double xx, double yy, double zz, long nn, double v)</computeroutput></para><para>

<para>Adds a value at a given location to neigboring data elements. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>xx</entry>
                                <entry>
<para>x location. </para>
</entry>
                            </row>
                            <row>
                                <entry>yy</entry>
                                <entry>
<para>y location. </para>
</entry>
                            </row>
                            <row>
                                <entry>zz</entry>
                                <entry>
<para>z location. </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number (4 th dimension). </para>
</entry>
                            </row>
                            <row>
                                <entry>v</entry>
                                <entry>
<para>value to add. <literallayout><computeroutput>Inverse of trilinear interpolation.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 1275 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a04cec4b61e523881e5cc05f62c0058a8"/>    <section>
    <title>add()<computeroutput>[5/8]</computeroutput></title>
<indexterm><primary>add</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>add</secondary></indexterm>
<para><computeroutput>void Bimage::add (long j, <link linkend="_class_complex">Complex</link>&lt; double &gt; cv)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 317 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1af77f64f607b94b80056a05befc2b686d"/>    <section>
    <title>add()<computeroutput>[6/8]</computeroutput></title>
<indexterm><primary>add</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>add</secondary></indexterm>
<para><computeroutput>void Bimage::add (long j, double v)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 316 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a172ef81a15fd705cd86f2479d4ab307c"/>    <section>
    <title>add()<computeroutput>[7/8]</computeroutput></title>
<indexterm><primary>add</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>add</secondary></indexterm>
<para><computeroutput>void Bimage::add (long nn, <link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Adds another image to a sub-image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image to be added. <literallayout><computeroutput>Requirement: The images must have the same size.
If the FOM block is defined, it is used to accumulate a sum of:
    the FOM block of the added image if it exists,
    or otherwise the square of the data added.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 3706 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a4f7eff4366c6603d8c6f95960e4883cf"/>    <section>
    <title>add()<computeroutput>[8/8]</computeroutput></title>
<indexterm><primary>add</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>add</secondary></indexterm>
<para><computeroutput>void Bimage::add (long nn, <link linkend="_class_bimage">Bimage</link> * p, double scale, double shift)</computeroutput></para><para>

<para>Adds another image to an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image to be added. </para>
</entry>
                            </row>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>density scale to other image </para>
</entry>
                            </row>
                            <row>
                                <entry>shift</entry>
                                <entry>
<para>density shift to other image. <literallayout><computeroutput>Requirement: The images must have the same size.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 3755 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a4fc989995479711dd10761d2f7385a3e"/>    <section>
    <title>align()</title>
<indexterm><primary>align</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>align</secondary></indexterm>
<para><computeroutput>vector&lt; <link linkend="_class_vector3">Vector3</link>&lt; double &gt; &gt; Bimage::align (long ref_num, long window, long step, <link linkend="_class_bimage">Bimage</link> * pmask, double hi_res, double lo_res, double shift_limit, double edge_width, double gauss_width, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; aln_bin)</computeroutput></para><para>

<para>Aligns and sums a set of sub-images, first progressively and then iteratively. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>ref_num</entry>
                                <entry>
<para>reference sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>window</entry>
                                <entry>
<para>moving sum window. </para>
</entry>
                            </row>
                            <row>
                                <entry>step</entry>
                                <entry>
<para>moving sum interval. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>cross-correlation mask. </para>
</entry>
                            </row>
                            <row>
                                <entry>hi_res</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lo_res</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>shift_limit</entry>
                                <entry>
<para>limit on extent of search for shift. </para>
</entry>
                            </row>
                            <row>
                                <entry>edge_width</entry>
                                <entry>
<para>width of smoothing edge. </para>
</entry>
                            </row>
                            <row>
                                <entry>gauss_width</entry>
                                <entry>
<para>decay coefficient for smoothing edge. </para>
</entry>
                            </row>
                            <row>
                                <entry>aln_bin</entry>
                                <entry>
<para>3-value vector indicating binning level. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>vector&lt;<link linkend="_class_vector3">Vector3&lt;double&gt;</link>&gt; vector of shifts. <literallayout><computeroutput>The images are first aligned using a progressive algorith starting with 
the indicated reference image.
The images are then aligned iteratively using the average image to 
improve the average.
The image is extensively modified and should not be used for further processing.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 253 of file Bimage_align.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7ceb1c51aa8f8a520fea19befa25b313"/>    <section>
    <title>align2D()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>align2D</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>align2D</secondary></indexterm>
<para><computeroutput>double Bimage::align2D (<link linkend="_class_bimage">Bimage</link> * pref, double res_polar, int ann_min, int ann_max, <link linkend="_class_bimage">Bimage</link> * prs_mask, double shift_limit, double angle_limit, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf_1D, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb_1D, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf_2D, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb_2D)</computeroutput></para><para>

<para>Finds the best in-plane alignment for two 2D images using polar power spectra. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pref</entry>
                                <entry>
<para>reference 2D image. </para>
</entry>
                            </row>
                            <row>
                                <entry>res_polar</entry>
                                <entry>
<para>polar resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>ann_min</entry>
                                <entry>
<para>minimum annulus (&gt;=0). </para>
</entry>
                            </row>
                            <row>
                                <entry>ann_max</entry>
                                <entry>
<para>maximum annulus (&lt; image radius). </para>
</entry>
                            </row>
                            <row>
                                <entry>*prs_mask</entry>
                                <entry>
<para>dual mask. </para>
</entry>
                            </row>
                            <row>
                                <entry>shift_limit</entry>
                                <entry>
<para>maximum shift from nominal origin of box. </para>
</entry>
                            </row>
                            <row>
                                <entry>angle_limit</entry>
                                <entry>
<para>maximum rotation from original in-plane rotation angle. </para>
</entry>
                            </row>
                            <row>
                                <entry>planf_1D</entry>
                                <entry>
<para>FFT forward plan for polar images. </para>
</entry>
                            </row>
                            <row>
                                <entry>planb_1D</entry>
                                <entry>
<para>FFT backward plan for polar images. </para>
</entry>
                            </row>
                            <row>
                                <entry>planf_2D</entry>
                                <entry>
<para>FFT forward plan for 2D images. </para>
</entry>
                            </row>
                            <row>
                                <entry>planb_2D</entry>
                                <entry>
<para>FFT backward plan for 2D images. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double correlation coefficient. <literallayout><computeroutput>Both the image and reference is converted to polar images using the 
current origins. The annuli of the polar images are cross-correlated
to find the rotation angle. The reference is rotated and cross-correlated
with the image to determine a new origin for the image. This is iterated
untill the rotation angle and origin of the image does not change any more,
or a maximum number of iterations.
The cross-correlation is done with the provided mask..
The correlation coefficient return is the cross-correlation peak.
The input images must be equal-sized square 2D images.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1478 of file Bimage_align.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab4243b9407c5220fabf6f7c23b16d999"/>    <section>
    <title>align2D()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>align2D</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>align2D</secondary></indexterm>
<para><computeroutput>int Bimage::align2D (<link linkend="_class_bimage">Bimage</link> * pref, int ann_min, int ann_max, double res_lo, double res_hi, double shift_limit, double angle_limit)</computeroutput></para><para>

<para>Finds the best in-plane alignment for two 2D images using polar power spectra. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pref</entry>
                                <entry>
<para>reference 2D image. </para>
</entry>
                            </row>
                            <row>
                                <entry>ann_min</entry>
                                <entry>
<para>minimum annulus (&gt;=0). </para>
</entry>
                            </row>
                            <row>
                                <entry>ann_max</entry>
                                <entry>
<para>maximum annulus (&lt; image radius). </para>
</entry>
                            </row>
                            <row>
                                <entry>res_lo</entry>
                                <entry>
<para>low resolution limit (angstrom). </para>
</entry>
                            </row>
                            <row>
                                <entry>res_hi</entry>
                                <entry>
<para>high resolution limit (angstrom). </para>
</entry>
                            </row>
                            <row>
                                <entry>shift_limit</entry>
                                <entry>
<para>maximum shift from nominal origin of box. </para>
</entry>
                            </row>
                            <row>
                                <entry>angle_limit</entry>
                                <entry>
<para>maximum rotation from original in-plane rotation angle. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double correlation coefficient. <literallayout><computeroutput>This is a simplified interface to the other function Bimage::align2D.
All the fourier transform and rotation functions are handled internally.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1567 of file Bimage_align.cpp.</para>
    </section><anchor xml:id="_class_bimage_1afd7765f966cffac40807eb001959fa28"/>    <section>
    <title>align2D_pps()</title>
<indexterm><primary>align2D_pps</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>align2D_pps</secondary></indexterm>
<para><computeroutput>double Bimage::align2D_pps (<link linkend="_class_bimage">Bimage</link> * pref, double res_hi, double res_lo, double shift_limit, double angle_limit, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb)</computeroutput></para><para>

<para>Finds the best in-plane alignment for two 2D images using polar power spectra. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pref</entry>
                                <entry>
<para>reference 2D image. </para>
</entry>
                            </row>
                            <row>
                                <entry>res_hi</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>res_lo</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>shift_limit</entry>
                                <entry>
<para>maximum shift from nominal origin of box. </para>
</entry>
                            </row>
                            <row>
                                <entry>angle_limit</entry>
                                <entry>
<para>maximum rotation from original in-plane rotation angle. </para>
</entry>
                            </row>
                            <row>
                                <entry>planf</entry>
                                <entry>
<para>FFT forward plan. </para>
</entry>
                            </row>
                            <row>
                                <entry>planb</entry>
                                <entry>
<para>FFT backward plan. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double correlation coefficient. <literallayout><computeroutput>The rotation angle is found by cross-correlating the annuli
of the polar transforms of the power spectra of the image and the
reference image. If the full asu flag is not set, the annular cross-correlation
is done both forwards and backwards to detect mirror images, with the sign 
of the angle indicating which direction is best (&gt;0 =&gt; forwards, &lt;0 =&gt; backwards).
The resolution limit specified in the image is used to low-pass filter 
the cross-correlation. The shift is then determined by cross-correlation 
after rotating the reference image, as well as its 180° rotation to deal with
that ambiguity in the power spectrum.
The correlation coefficient return is the cross-correlation peak.
The input images must be equal-sized square 2D images.
The origin and rotation angle is returned in the image structure.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1389 of file Bimage_align.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac91286dc4862354d4dd617144e6fa8e1"/>    <section>
    <title>align_fast()</title>
<indexterm><primary>align_fast</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>align_fast</secondary></indexterm>
<para><computeroutput><link linkend="_class_j_svalue">JSvalue</link> Bimage::align_fast (long ref_num, <link linkend="_class_bimage">Bimage</link> * pmask, double hi_res, double lo_res, double shift_limit, double edge_width, double gauss_width)</computeroutput></para><para>

<para>Aligns and sums a set of sub-images, first progressively and then iteratively. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>ref_num</entry>
                                <entry>
<para>reference sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>cross-correlation mask. </para>
</entry>
                            </row>
                            <row>
                                <entry>hi_res</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lo_res</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>shift_limit</entry>
                                <entry>
<para>limit on extent of search for shift. </para>
</entry>
                            </row>
                            <row>
                                <entry>edge_width</entry>
                                <entry>
<para>width of smoothing edge. </para>
</entry>
                            </row>
                            <row>
                                <entry>gauss_width</entry>
                                <entry>
<para>decay coefficient for smoothing edge. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double average shift. <literallayout><computeroutput>The images are first aligned using a progressive algorith starting with 
the indicated reference image.
The images are then aligned iteratively using the average image to 
improve the average.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 529 of file Bimage_align.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa91803c287ab037bc7a3c403291acc2f"/>    <section>
    <title>align_progressive()</title>
<indexterm><primary>align_progressive</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>align_progressive</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::align_progressive (long nref, <link linkend="_class_bimage">Bimage</link> * pmask, double hi_res, double lo_res, double shift_limit, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb)</computeroutput></para><para>

<para>Aligns and sums a set of sub-images using a progressive algorithm. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nref</entry>
                                <entry>
<para>reference sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>cross-correlation mask. </para>
</entry>
                            </row>
                            <row>
                                <entry>hi_res</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lo_res</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>shift_limit</entry>
                                <entry>
<para>limit on extent of search for shift. </para>
</entry>
                            </row>
                            <row>
                                <entry>planf</entry>
                                <entry>
<para>plan for forward Fourier transform. </para>
</entry>
                            </row>
                            <row>
                                <entry>planb</entry>
                                <entry>
<para>plan for backward Fourier transform. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* summed reference image. <literallayout><computeroutput>The images are aligned against the reference images with progressive
addition to reference to decrease noise.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 30 of file Bimage_align.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa79aa0e953c56c5ce8e1a1498f386751"/>    <section>
    <title>align_progressive_fast()</title>
<indexterm><primary>align_progressive_fast</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>align_progressive_fast</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::align_progressive_fast (long nref, double shift_limit)</computeroutput></para><para>

<para>Aligns and sums a set of sub-images using a progressive algorithm. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nref</entry>
                                <entry>
<para>reference sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>shift_limit</entry>
                                <entry>
<para>limit on extent of search for shift. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* summed reference image. <literallayout><computeroutput>The images are aligned against the reference images with progressive
addition to reference to decrease noise.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 140 of file Bimage_align.cpp.</para>
    </section><anchor xml:id="_class_bimage_1adab24545dd418ba976941ee9cc5aaad4"/>    <section>
    <title>alloc_size()</title>
<indexterm><primary>alloc_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>alloc_size</secondary></indexterm>
<para><computeroutput>long Bimage::alloc_size ( ) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 262 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1adfd7c5588e083504f2bcdb551682dd57"/>    <section>
    <title>aniso_average()</title>
<indexterm><primary>aniso_average</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>aniso_average</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::aniso_average (long ksize, double w)</computeroutput></para><para>

<para>Calculates an anisotropic average within a kernel based on the local gradient. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>ksize</entry>
                                <entry>
<para>kernel radius. </para>
</entry>
                            </row>
                            <row>
                                <entry>w</entry>
                                <entry>
<para>gradient weight (0 reverts to isotropic). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* new image. </para>
</formalpara>
</para>
<para>
Definition at line 1352 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a26ba83e822caca17e4f2eabfb761f6f3"/>    <section>
    <title>apply_soft_mask()</title>
<indexterm><primary>apply_soft_mask</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>apply_soft_mask</secondary></indexterm>
<para><computeroutput>long Bimage::apply_soft_mask (long nn, <link linkend="_class_bimage">Bimage</link> * pmask, int fill_type, double fill)</computeroutput></para><para>

<para>Applies a soft mask to a sub-image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>pmask</entry>
                                <entry>
<para>soft mask: [0,1]. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value of edge voxels. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The image is multiplied with the mask, filling in the remainder 
with the fill value.
Requirement: The mask must range from 0 to 1.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2557 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1adb1bceb367182c8e7f159fec64b95982"/>    <section>
    <title>assemble_tiles()</title>
<indexterm><primary>assemble_tiles</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>assemble_tiles</secondary></indexterm>
<para><computeroutput>int Bimage::assemble_tiles (<link linkend="_class_bimage">Bimage</link> * pt, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Assembles overlapping tiles into this image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pt</entry>
                                <entry>
<para>multi-image containing tiles. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>flag to set overlap handling. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The origin in each tile specifies the starting location.
Where tiles overlap, the integration is determined by the flag:
0 = simple addition with averaging afterwards.
1 = a gradual transition from one tile to the other.
2 = place just the central part of each tile.
The original data in the image is overwritten.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 433 of file Bimage_combine.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a58df899bf2137ec1046c1432d4ea0014"/>    <section>
    <title>auto_correlate()</title>
<indexterm><primary>auto_correlate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>auto_correlate</secondary></indexterm>
<para><computeroutput>int Bimage::auto_correlate (double hires, double lores)</computeroutput></para><para>

<para>Calculates an autocorrelation map by Fast Fourier transformation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>FFTW library (www.fftw.org).
A multi-image 1D, 2D and 3D data set is transformed forward, the 
transform multiplied by its complex conjugate, followed by backward 
transformation and rescaling by 1/(N*N). Data beyond the resolution 
set in the image structure are zeroed. Therefore the correct setting 
of units and resolution in the image are required. Defaults for the 
units are usually 1 Angstrom/voxel and a zero resolution would
include the whole image (i.e., no resolution limitation).
The resultant image is Float.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 265 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3de98170ee996fa85f1802250e646a87"/>    <section>
    <title>average()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>average</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>average</secondary></indexterm>
<para><computeroutput>double Bimage::average ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 546 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a95753acb1cb55e4e013e0b4a486a5c01"/>    <section>
    <title>average()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>average</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>average</secondary></indexterm>
<para><computeroutput>void Bimage::average (double d)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 551 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a8b7559f244271ee490d3746da9a02378"/>    <section>
    <title>average()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>average</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>average</secondary></indexterm>
<para><computeroutput>double Bimage::average (long cc, double xf, double yf, double zf, long nn, double iscale)</computeroutput></para><para>

<para>Averages in 3D when scaling is less than 1. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>cc</entry>
                                <entry>
<para>channel. </para>
</entry>
                            </row>
                            <row>
                                <entry>xf</entry>
                                <entry>
<para>x location. </para>
</entry>
                            </row>
                            <row>
                                <entry>yf</entry>
                                <entry>
<para>y location. </para>
</entry>
                            </row>
                            <row>
                                <entry>zf</entry>
                                <entry>
<para>z location. </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number. </para>
</entry>
                            </row>
                            <row>
                                <entry>iscale</entry>
                                <entry>
<para>inverse scale. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double average. <literallayout><computeroutput>All neighboring voxels in x, y and z are averaged and result returned.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1380 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a536c5f24e8492683cc0c65678c524ed2"/>    <section>
    <title>average2D()</title>
<indexterm><primary>average2D</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>average2D</secondary></indexterm>
<para><computeroutput>double Bimage::average2D (long cc, double xf, double yf, double zf, long nn, double iscale)</computeroutput></para><para>

<para>Averages in the xy plane when scaling is less than 1. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>cc</entry>
                                <entry>
<para>channel. </para>
</entry>
                            </row>
                            <row>
                                <entry>xf</entry>
                                <entry>
<para>x location. </para>
</entry>
                            </row>
                            <row>
                                <entry>yf</entry>
                                <entry>
<para>y location. </para>
</entry>
                            </row>
                            <row>
                                <entry>zf</entry>
                                <entry>
<para>z location. </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number. </para>
</entry>
                            </row>
                            <row>
                                <entry>iscale</entry>
                                <entry>
<para>inverse scale. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double average. <literallayout><computeroutput>All neighboring voxels in x and y are averaged and result returned.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1343 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7a758b80d8b664281665fd2a22183024"/>    <section>
    <title>average_images()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>average_images</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>average_images</secondary></indexterm>
<para><computeroutput>void Bimage::average_images ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 735 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a34e86e673f3794fc9f2ec5c04540c2a4"/>    <section>
    <title>average_images()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>average_images</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>average_images</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::average_images (bool sd)</computeroutput></para><para>

<para>Averages all sub-images and optionally calculates standard deviation image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>sd</entry>
                                <entry>
<para>flag to calculate linked standard deviation image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* average image. </para>
</formalpara>
</para>
<para>
Definition at line 3533 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0d72986433c77abdb1bbfef125df3cf7"/>    <section>
    <title>average_phase_difference()</title>
<indexterm><primary>average_phase_difference</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>average_phase_difference</secondary></indexterm>
<para><computeroutput>double Bimage::average_phase_difference (<link linkend="_class_bimage">Bimage</link> * p, double res_hi, double res_lo, int weighting = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Calculates the average of the absolute phase difference between two images within given resolution shells. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>real space reference image. </para>
</entry>
                            </row>
                            <row>
                                <entry>res_hi</entry>
                                <entry>
<para>upper resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>res_lo</entry>
                                <entry>
<para>lower resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>weighting</entry>
                                <entry>
<para>weighting type: 0, none; 1, p1-amp; 2, p2-amp; 3, both amps </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double average of the cosine of the phase difference. <literallayout><computeroutput>Both images are Fourier transformed and the absolute phase
difference calculated and averaged.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2201 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aaaa6013e0f403993b7dde45889a0e0ef"/>    <section>
    <title>back_project()</title>
<indexterm><primary>back_project</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>back_project</secondary></indexterm>
<para><computeroutput>int Bimage::back_project (<link linkend="_class_bimage">Bimage</link> * p, double resolution, double axis, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb)</computeroutput></para><para>
Definition at line 437 of file Bimage_project.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a69f89659be398fec283e1c267f33c190"/>    <section>
    <title>background()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>background</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>background</secondary></indexterm>
<para><computeroutput>void Bimage::background (double bkg)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 559 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1adbfb6a4d3284e436475955bc786ac840"/>    <section>
    <title>background()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>background</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>background</secondary></indexterm>
<para><computeroutput>double Bimage::background (long nn)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 553 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1aa931beeddd098f0759308ef1e11c076c"/>    <section>
    <title>background()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>background</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>background</secondary></indexterm>
<para><computeroutput>void Bimage::background (long nn, double bkg)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 556 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a637c8c9c3adab0168669c4b0a2bfe29f"/>    <section>
    <title>bar()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>bar</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>bar</secondary></indexterm>
<para><computeroutput>int Bimage::bar (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; end, double width, double edge_width, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Generates a bar between start and end points. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>start</entry>
                                <entry>
<para>start of bar. </para>
</entry>
                            </row>
                            <row>
                                <entry>end</entry>
                                <entry>
<para>end of bar. </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>width of bar. </para>
</entry>
                            </row>
                            <row>
                                <entry>edge_width</entry>
                                <entry>
<para>bar edge width. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>fill value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>A bar is generated with the given fill value from the start point
to the end point and with a defined width and gaussian edge.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 829 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a5b6e0c4b18f647d68db21c1fbbfaac3b"/>    <section>
    <title>bar()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>bar</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>bar</secondary></indexterm>
<para><computeroutput>int Bimage::bar (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; end, double width, double edge_width, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Generates a bar between start and end points. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>start</entry>
                                <entry>
<para>start of bar. </para>
</entry>
                            </row>
                            <row>
                                <entry>end</entry>
                                <entry>
<para>end of bar. </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>width of bar. </para>
</entry>
                            </row>
                            <row>
                                <entry>edge_width</entry>
                                <entry>
<para>bar edge width. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>fill value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>A bar is generated with the given fill value from the start point
to the end point and with a defined width and gaussian edge.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 803 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a47c5acae2d99305b8eec1997f9db2097"/>    <section>
    <title>bin()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>bin</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>bin</secondary></indexterm>
<para><computeroutput>int Bimage::bin (long b)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 1346 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1afcbd4d70177757388e094c53aba5ecf3"/>    <section>
    <title>bin()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>bin</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>bin</secondary></indexterm>
<para><computeroutput>int Bimage::bin (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; bk)</computeroutput></para><para>

<para>Bins by an integer size in place. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>bk</entry>
                                <entry>
<para>3-value vector of integer bin factors. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>An image is binned by an integer size.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 232 of file Bimage_bin.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aea01ef4b1ce5c9a28c2fbef72c87f45b"/>    <section>
    <title>bin_around_origin()</title>
<indexterm><primary>bin_around_origin</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>bin_around_origin</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::bin_around_origin (int bin)</computeroutput></para><para>

<para>Bins by an integer size making sure the origin falls on a binned voxel, and returns a new image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>bin</entry>
                                <entry>
<para>integer bin factor. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* new image. <literallayout><computeroutput>An image is binned by an integer size, square in 2D and cubic in 3D.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 332 of file Bimage_bin.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6d423733fa3765859c6562127d20e3ed"/>    <section>
    <title>bin_copy()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>bin_copy</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>bin_copy</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link>* Bimage::bin_copy (long b)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 1351 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a720b12635718c76bafb0d844b2264f6b"/>    <section>
    <title>bin_copy()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>bin_copy</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>bin_copy</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::bin_copy (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; bk)</computeroutput></para><para>

<para>Bins by an integer size and returns a new image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>bk</entry>
                                <entry>
<para>3-value vector of integer bin factors. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* new image. <literallayout><computeroutput>An image is binned by an integer size.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 268 of file Bimage_bin.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a460f2d1622dafdaeb8fc1d61dd0ec462"/>    <section>
    <title>blend()</title>
<indexterm><primary>blend</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>blend</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::blend (<link linkend="_class_bimage">Bimage</link> * p, long number)</computeroutput></para><para>

<para>Blends the two images, creating a new set of sub-images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>second image. </para>
</entry>
                            </row>
                            <row>
                                <entry>number</entry>
                                <entry>
<para>number of images in the series. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* new image structure, NULL if error. <literallayout><computeroutput>A number of images are created by blending the two input images in
different ratios. The input images become the first and last sub-images of 
the new image structure, with the intermediate images changing over from
the first to the last:
        new_data = (1-fraction)*data1 + fraction*data2
where fraction = index/(number - 1)
At least 3 new sub-images are packed into the new image. 
All of the header information in the first image is copied into the new image.
Both images are converted to floating point.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 106 of file Bimage_combine.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aaea7cb2268b8f1823316f78fa1180bc7"/>    <section>
    <title>blobs()</title>
<indexterm><primary>blobs</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>blobs</secondary></indexterm>
<para><computeroutput>long Bimage::blobs (double threshold, double min_size, double max_size, double setvalue, int sign)</computeroutput></para><para>

<para>Identifies contiguous regions above a given threshold (blobs) and eliminate those less than a minimum size. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>threshold to define contiguous regions. </para>
</entry>
                            </row>
                            <row>
                                <entry>min_size</entry>
                                <entry>
<para>minimum number of voxels to keep a region. </para>
</entry>
                            </row>
                            <row>
                                <entry>max_size</entry>
                                <entry>
<para>maximum number of voxels to keep a region. </para>
</entry>
                            </row>
                            <row>
                                <entry>setvalue</entry>
                                <entry>
<para>value to assign to deleted regions (typically set to threshold). </para>
</entry>
                            </row>
                            <row>
                                <entry>sign</entry>
                                <entry>
<para>sign controlling direction of thresholding. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of voxels set to threshold. <literallayout><computeroutput>All contiguous regions in an image are indexed and their sizes 
calculated. Whether a region is contiguous is defined by a
threshold. Regions smaller than a minimum number of voxels are
set to the threshold value. The input image is modified and
left as a floating point image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 568 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7535de626d0c458869842fe6379a9ba5"/>    <section>
    <title>calculate_background()<computeroutput>[1/4]</computeroutput></title>
<indexterm><primary>calculate_background</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>calculate_background</secondary></indexterm>
<para><computeroutput>int Bimage::calculate_background (<link linkend="_class_bimage">Bimage</link> * pmask, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates the background for each sub-image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>foreground mask. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>flag to specify where to calculate the background: [0,1] </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 on error. <literallayout><computeroutput>If the mask is specified, it is used to define the part of the 
image to be used for background calculation (where the mask is zero).
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 168 of file Bimage_background.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aad111b7044a4c05761f372ce2f5688ae"/>    <section>
    <title>calculate_background()<computeroutput>[2/4]</computeroutput></title>
<indexterm><primary>calculate_background</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>calculate_background</secondary></indexterm>
<para><computeroutput>int Bimage::calculate_background (<link linkend="_class_bimage">Bimage</link> * pmask, long nn, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates the background for one sub-image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>foreground mask. </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>flag to specify where to calculate the background: [0,1] </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 on error. <literallayout><computeroutput>If the mask is specified, it is used to define the part of the 
image to be used for background calculation (where the mask is zero).
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 124 of file Bimage_background.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a86fbcdfea888cba3b6891cb7c0685077"/>    <section>
    <title>calculate_background()<computeroutput>[3/4]</computeroutput></title>
<indexterm><primary>calculate_background</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>calculate_background</secondary></indexterm>
<para><computeroutput>int Bimage::calculate_background (int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates the background for each sub-image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>flag to specify where to calculate the background: [0,3] </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 on error. <literallayout><computeroutput>The background is taken as the average of the values outside the
circle or sphere enclosed by the image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 91 of file Bimage_background.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac1eca04ce6fa6cbd93a59ed0bb0474e0"/>    <section>
    <title>calculate_background()<computeroutput>[4/4]</computeroutput></title>
<indexterm><primary>calculate_background</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>calculate_background</secondary></indexterm>
<para><computeroutput>int Bimage::calculate_background (long nn, int flag)</computeroutput></para><para>

<para>Calculates the background for one sub-image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>flag to specify where to calculate the background: [0,3] </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 on error. <literallayout><computeroutput>The background is taken as the average of the values for:
flag=0,1    outside the circle or sphere enclosed by the image
flag=2      inside the circle or sphere enclosed by the image
flag=3      inside the half-radius circle in the center of the image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 27 of file Bimage_background.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad80ca2aed25743abb540366ef12cfcff"/>    <section>
    <title>cartesian_to_cylindrical()</title>
<indexterm><primary>cartesian_to_cylindrical</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>cartesian_to_cylindrical</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::cartesian_to_cylindrical (long nannuli, long nphi, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates an image with cylindrical coordinates. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nannuli</entry>
                                <entry>
<para>number of annuli. </para>
</entry>
                            </row>
                            <row>
                                <entry>nphi</entry>
                                <entry>
<para>number of phi angles. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>switch: annulus-angle-z (0), angle-annulus-z (1), z-annulus-angle (2) </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* cylindrical image. <literallayout><computeroutput>The image is converted to cylindrical form with a specified number of 
annuli and angles. 
A point vector p = {x,y,z} with respect to the image origin (typically
the center of the image) is converted to cylindrical coordinates as follows:
    The distance from the z-origin gives the annulus:
        |p| = sqrt(x*x+y*y)
    Phi is the rotation angle around the z-axis, starting at the x-axis:
        phi = atan(y/x)
    The z-coordinate remains unchanged.
The new dimensions are mapped as follows with their maximum ranges:
    |p|   ===&gt; x_dimension (0 - max(x_size,y_size,z_size)
    phi   ===&gt; y_dimension (0 - 2*PI)
    z     ===&gt; z_dimension
The sampling within these ranges are given by the calling function.
The sampling must be isotropic.
The origins within the sub-image structures are used.
The interpolation routine actually calculates the old cartesian 
coordinates for each set of cylindrical coordinates.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 589 of file Bimage_polar.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a09f15732e3911c087fbf9ed1f8762447"/>    <section>
    <title>cartesian_to_spherical()</title>
<indexterm><primary>cartesian_to_spherical</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>cartesian_to_spherical</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::cartesian_to_spherical (long nannuli, long nphi, long ntheta)</computeroutput></para><para>

<para>Calculates an image with spherical coordinates. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nannuli</entry>
                                <entry>
<para>number of annuli. </para>
</entry>
                            </row>
                            <row>
                                <entry>nphi</entry>
                                <entry>
<para>number of phi angles. </para>
</entry>
                            </row>
                            <row>
                                <entry>ntheta</entry>
                                <entry>
<para>number of theta angles. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* spherical image. <literallayout><computeroutput>The image is converted to polar form with a specified number of annuli
and angles in one (a 2D image) or two (a 3D map) directions. The 
angular convention is consistent with the Euler angles used for 3D
image processing. 
A point vector p = {x,y,z} with respect to the image origin (typically
the center of the image) is converted to polar coordinates as follows:
    The size of the vector gives the annulus:
        |p| = sqrt(x*x+y*y+z*z)
    Phi is the rotation angle around the z-axis, starting at the x-axis:
        phi = atan(y/x)
    Theta is the angle between the positive z-axis and the point vector:
        theta = acos(z/|p|)
The new dimensions are mapped as follows with their maximum ranges:
    |p|   ===&gt; x_dimension (0 - max(x_size,y_size,z_size)
    phi   ===&gt; y_dimension (0 - 2*PI)
    theta ===&gt; z_dimension (0 - PI)
The sampling within these ranges are given by the calling function.
The sampling must be isotropic.
The origins within the sub-image structures are used.
The interpolation routine actually calculates the old cartesian 
coordinates for each set of spherical coordinates.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 498 of file Bimage_polar.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac8555d13111d99d6736cafc5e9d36232"/>    <section>
    <title>catenate()</title>
<indexterm><primary>catenate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>catenate</secondary></indexterm>
<para><computeroutput>void Bimage::catenate (long m, <link linkend="_class_bimage">Bimage</link> ** p)</computeroutput></para><para>

<para>Catenates an array of images of the same size into a multi-image structure. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>m</entry>
                                <entry>
<para>number of images in the array. </para>
</entry>
                            </row>
                            <row>
                                <entry>**p</entry>
                                <entry>
<para>array of images. <literallayout><computeroutput>The images must all have the same dimensions.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 52 of file Bimage_combine.cpp.</para>
    </section><anchor xml:id="_class_bimage_1abe8c89d040e7a16ababdcb654433ef39"/>    <section>
    <title>ccmap_confidence()</title>
<indexterm><primary>ccmap_confidence</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>ccmap_confidence</secondary></indexterm>
<para><computeroutput>double Bimage::ccmap_confidence (long nn)</computeroutput></para><para>

<para>Calculates a confidence level to associate with a cross-correlation peak. </para>
</para>

<para><formalpara><title>Author</title>

<para>Bernard Heymann and Xiange Zheng </para>
</formalpara>

                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double P value. <literallayout><computeroutput>The highest two peak maxima are found and used to calculate a
confidence level for the hypothesis that the second highest peak is
different from the first. The two maxima are found by a kernel search
which implicitly assumes that the values associated with a peak
monotonically decays with distance from the peak.
Fisher&apos;s z-transform is used to calculate the confidence level:
    P = erfc((zmax - zmax2)/(2*z_sigma))
where
    zmax, zmax2: z-transforms of the highest two peaks.
    z_sigma: standard deviation of the z-transform of the cc map.
The P value is returned
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1952 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a5f9345465a753a4ace75a2b1d7c379ba"/>    <section>
    <title>center()</title>
<indexterm><primary>center</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>center</secondary></indexterm>
<para><computeroutput>int Bimage::center (int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Centers an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>fill type for filling empty regions. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value to fill in empty regions. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. </para>
</formalpara>
</para>
<para>
Definition at line 694 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aea1442cea3c82de6ac0793d38241abaa"/>    <section>
    <title>center_wrap()</title>
<indexterm><primary>center_wrap</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>center_wrap</secondary></indexterm>
<para><computeroutput>int Bimage::center_wrap ( )</computeroutput></para><para>

<para>Centers an image with wrapping. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int error code. </para>
</formalpara>
</para>
<para>
Definition at line 708 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a09bd10ebe8a3c6a4ca623a604915f5c9"/>    <section>
    <title>central_section()</title>
<indexterm><primary>central_section</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>central_section</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::central_section (<link linkend="_class_matrix3">Matrix3</link> mat, double resolution, <link linkend="_class_f_s_i___kernel">FSI_Kernel</link> * kernel)</computeroutput></para><para>

<para>Calculates a central section of a 3D fourier transform. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>mat</entry>
                                <entry>
<para>3x3 rotation or skewing matrix. </para>
</entry>
                            </row>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>*kernel</entry>
                                <entry>
<para>frequency space interpolation kernel. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* new 2D central section. <literallayout><computeroutput>The orientation of the central section is defined by a rotation matrix
and the interpolation is done with a reciprocal space kernel.
The rotation origin is obtained from the map origin.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 287 of file Bimage_project.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a521d7a03503be2b8ec4a4090e81ada1e"/>    <section>
    <title>change_symmetry()</title>
<indexterm><primary>change_symmetry</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>change_symmetry</secondary></indexterm>
<para><computeroutput>int Bimage::change_symmetry (<link linkend="_struct_bsymmetry">Bsymmetry</link> &amp; symold, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp; symnu, double radius, double z_slope)</computeroutput></para><para>

<para>Changes the symmetry order for cyclic and dihedral maps. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*symold</entry>
                                <entry>
<para>original symmetry. </para>
</entry>
                            </row>
                            <row>
                                <entry>*symnu</entry>
                                <entry>
<para>new symmetry. </para>
</entry>
                            </row>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>radius in voxels of repeating units. </para>
</entry>
                            </row>
                            <row>
                                <entry>z_slope</entry>
                                <entry>
<para>slope along z to adjust radius. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>If the radius is zero, the change in symmetry is done with proportional
shifts that distorts the units in the map.
If the radius is positive, it is used to determine the radial shift for
each unit, giving much less distortion than the proportional shifts.
Variation of the radius of the specimen along z can be handled with
a non-zero z slope parameter.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 585 of file Bimage_symmetry.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae74e7014bad39ad70cf631c4470d6a3c"/>    <section>
    <title>change_transform_size()</title>
<indexterm><primary>change_transform_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>change_transform_size</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt; double &gt; Bimage::change_transform_size (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize)</computeroutput></para><para>

<para>Resizes a &quot;standard&quot; transform. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nusize</entry>
                                <entry>
<para>new image size. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para><link linkend="_class_vector3">Vector3&lt;double&gt;</link> scale. <literallayout><computeroutput>A standard transform is resized by inserting or removing
rows or columns in the middle of the data set.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 248 of file Bimage_fft.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a5edb27a22dcc386452236472c6a1c916"/>    <section>
    <title>change_type()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>change_type</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>change_type</secondary></indexterm>
<para><computeroutput>void Bimage::change_type (char * string)</computeroutput></para><para>

<para>Get the data type from a string. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*string</entry>
                                <entry>
<para>string describing the data type. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 1805 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aaf2848239c21e111b23b87b4c2a95dd5"/>    <section>
    <title>change_type()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>change_type</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>change_type</secondary></indexterm>
<para><computeroutput>void Bimage::change_type (char letter)</computeroutput></para><para>

<para>Get the data type indicated by a single letter code. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>letter</entry>
                                <entry>
<para>letter indicating data type. <literallayout><computeroutput>This function is used in optional command-line arguments to indicate 
a new data type for an image.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 1775 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a05ed25186621c0611497ee8738e9d602"/>    <section>
    <title>change_type()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>change_type</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>change_type</secondary></indexterm>
<para><computeroutput>void Bimage::change_type (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> nutype)</computeroutput></para><para>

<para>Change the data to the new type. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nutype</entry>
                                <entry>
<para>new data type. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 1840 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6430319a01ff1931cf0d88fb92abca6e"/>    <section>
    <title>channels()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>channels</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>channels</secondary></indexterm>
<para><computeroutput>long Bimage::channels ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 379 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a867c0564aeba2d80617b4f3b6be737da"/>    <section>
    <title>channels()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>channels</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>channels</secondary></indexterm>
<para><computeroutput>void Bimage::channels (long cc)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 380 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a30d9c3a12d258a7344378aeb8e56eed6"/>    <section>
    <title>channels_to_images()</title>
<indexterm><primary>channels_to_images</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>channels_to_images</secondary></indexterm>
<para><computeroutput>int Bimage::channels_to_images ( )</computeroutput></para>    </section><anchor xml:id="_class_bimage_1ab123614e965e5ca895a14ccf30c234a5"/>    <section>
    <title>check()</title>
<indexterm><primary>check</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>check</secondary></indexterm>
<para><computeroutput>void Bimage::check ( )</computeroutput></para><para>

<para>Checks an image for reasonable properties. </para>
</para>
<para>
Definition at line 430 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a49f620f446bf442126513d907d05752a"/>    <section>
    <title>check_compoundtype()</title>
<indexterm><primary>check_compoundtype</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>check_compoundtype</secondary></indexterm>
<para><computeroutput>bool Bimage::check_compoundtype (long nc, <link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ct)</computeroutput></para><para>
Definition at line 335 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a981cab4e4430114b52918a2791586777"/>    <section>
    <title>check_if_same_image_size()</title>
<indexterm><primary>check_if_same_image_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>check_if_same_image_size</secondary></indexterm>
<para><computeroutput>bool Bimage::check_if_same_image_size (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Check if two images are the same size. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image to check. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>bool 1 if yes, 0 if no. <literallayout><computeroutput>The function returns the answer and leaves the calling function to 
deal with the result.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 603 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a881571949007af044036c47b07b8a3c6"/>    <section>
    <title>check_if_same_size()</title>
<indexterm><primary>check_if_same_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>check_if_same_size</secondary></indexterm>
<para><computeroutput>bool Bimage::check_if_same_size (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Check if two images are the same size. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image to check. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>bool 1 if yes, 0 if no. <literallayout><computeroutput>The function returns the answer and leaves the calling function to 
deal with the result.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 577 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af285f9b976519ffee80fd03a19db17eb"/>    <section>
    <title>check_neighbors()</title>
<indexterm><primary>check_neighbors</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>check_neighbors</secondary></indexterm>
<para><computeroutput>long Bimage::check_neighbors (long idx)</computeroutput></para><para>

<para>Check neighbors in region map and assign a value if a neighbor is assigned. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>idx</entry>
                                <entry>
<para>index in multi-image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long new value assigned. </para>
</formalpara>
</para>
<para>
Definition at line 387 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a4a35640e535bfe59e5e9fbe19a7980d3"/>    <section>
    <title>check_point_group()</title>
<indexterm><primary>check_point_group</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>check_point_group</secondary></indexterm>
<para><computeroutput>double Bimage::check_point_group (<link linkend="_class_bstring">Bstring</link> &amp; check_string)</computeroutput></para><para>

<para>Checks for the requested symmetries. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>&amp;check_string</entry>
                                <entry>
<para>string with requested point groups. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double symmetry correlation coefficient. <literallayout><computeroutput>Requirement: The input map must be in standard orientation for the symmetry.
For each different symmetry operation, the map is rotated and compared by
real space correlation to the original. 
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 112 of file Bimage_symmetry.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad464e07a4843fb9d38eb11345b2325b6"/>    <section>
    <title>check_resolution()</title>
<indexterm><primary>check_resolution</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>check_resolution</secondary></indexterm>
<para><computeroutput>void Bimage::check_resolution (double &amp; resolution)</computeroutput></para><para>

<para>Checks that the resolution falls within reasonable limits. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>&amp;resolution</entry>
                                <entry>
<para>resolution (modified). <literallayout><computeroutput>The resolution is set to between half the real size and the Nyquist frequency.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 646 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a74e389c2208e3cae5d498ec60fd95a75"/>    <section>
    <title>check_sampling()</title>
<indexterm><primary>check_sampling</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>check_sampling</secondary></indexterm>
<para><computeroutput>void Bimage::check_sampling ( )</computeroutput></para><para>

<para>Checks that the sampling is properly specified. </para>
</para>

<para><literallayout><computeroutput>If the sampling is zero or less it is set to 1.
If a dimension size is one, the sampling is set to 1.
</computeroutput></literallayout> </para>
<para>
Definition at line 627 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab64a1edf3326cf703a0b596059704889"/>    <section>
    <title>chirp()</title>
<indexterm><primary>chirp</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>chirp</secondary></indexterm>
<para><computeroutput>int Bimage::chirp (double freq_scale, double freq_shift = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Generates a chirp image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>freq_scale</entry>
                                <entry>
<para>frequency scale. </para>
</entry>
                            </row>
                            <row>
                                <entry>freq_shift</entry>
                                <entry>
<para>frequency shift (radians). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. </para>
</formalpara>
</para>
<para>
Definition at line 923 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab8db25e2cb2d3057af80e8469cd3cb77"/>    <section>
    <title>clear()</title>
<indexterm><primary>clear</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>clear</secondary></indexterm>
<para><computeroutput>void Bimage::clear ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 716 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1af778ba174284334f20ddef7fc191b249"/>    <section>
    <title>cmyk()</title>
<indexterm><primary>cmyk</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>cmyk</secondary></indexterm>
<para><computeroutput><link linkend="_class_c_m_y_k">CMYK</link>&lt; double &gt; Bimage::cmyk (long j)</computeroutput></para><para>

<para>Returns a color value at the given index. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>j</entry>
                                <entry>
<para>index. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>CMYK&lt;double&gt; the color value. <literallayout><computeroutput>The index refers to compound values.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1092 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a9e0de82e5c0833c271bbda9847f8cbe2"/>    <section>
    <title>cmyk_to_rgb()</title>
<indexterm><primary>cmyk_to_rgb</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>cmyk_to_rgb</secondary></indexterm>
<para><computeroutput>void Bimage::cmyk_to_rgb ( )</computeroutput></para><para>

<para>Converts a <link linkend="_class_c_m_y_k">CMYK</link> color image to <link linkend="_class_r_g_b">RGB</link>. </para>
</para>
<para>
Definition at line 206 of file Bimage_color.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa2898f1eaaf5f0236e239fe49494849d"/>    <section>
    <title>color_blue()</title>
<indexterm><primary>color_blue</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>color_blue</secondary></indexterm>
<para><computeroutput>int Bimage::color_blue (double cmin, double cmax, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Converts a gray-scale image to blue. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>cmin</entry>
                                <entry>
<para>lower grayscale boundary. </para>
</entry>
                            </row>
                            <row>
                                <entry>cmax</entry>
                                <entry>
<para>upper grayscale boundary. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>sets the type of conversion </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>A grayscale image is converted to blue between the given minimum and maximum.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 337 of file Bimage_color.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab143e87ca8f289a3ea65566a4c77fbb0"/>    <section>
    <title>color_combine()</title>
<indexterm><primary>color_combine</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>color_combine</secondary></indexterm>
<para><computeroutput>int Bimage::color_combine (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Combines two colored images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>second image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>Each pair of voxels is summed and the result truncated to 255.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 382 of file Bimage_color.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a644d535bf1c94569270c32f4d0c0ef40"/>    <section>
    <title>color_green()</title>
<indexterm><primary>color_green</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>color_green</secondary></indexterm>
<para><computeroutput>int Bimage::color_green (double cmin, double cmax, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Converts a gray-scale image to green. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>cmin</entry>
                                <entry>
<para>lower grayscale boundary. </para>
</entry>
                            </row>
                            <row>
                                <entry>cmax</entry>
                                <entry>
<para>upper grayscale boundary. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>sets the type of conversion </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>A grayscale image is converted to green between the given minimum and maximum.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 322 of file Bimage_color.cpp.</para>
    </section><anchor xml:id="_class_bimage_1abfb6e880fab0904b9702007876322ab6"/>    <section>
    <title>color_red()</title>
<indexterm><primary>color_red</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>color_red</secondary></indexterm>
<para><computeroutput>int Bimage::color_red (double cmin, double cmax, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Converts a gray-scale image to red. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>cmin</entry>
                                <entry>
<para>lower grayscale boundary. </para>
</entry>
                            </row>
                            <row>
                                <entry>cmax</entry>
                                <entry>
<para>upper grayscale boundary. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>sets the type of conversion </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>A grayscale image is converted to red between the given minimum and maximum.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 307 of file Bimage_color.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac8cb2a5aa2fc05dc884221e6cc3e7c28"/>    <section>
    <title>color_spectrum()</title>
<indexterm><primary>color_spectrum</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>color_spectrum</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::color_spectrum (double cmin, double cmax)</computeroutput></para><para>

<para>Colorizes an image to a spectrum. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>cmin</entry>
                                <entry>
<para>lower grayscale boundary. </para>
</entry>
                            </row>
                            <row>
                                <entry>cmax</entry>
                                <entry>
<para>upper grayscale boundary. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* color scale image. <literallayout><computeroutput>A grayscale image is converted to RGB and colored from blue (low) to 
red (high). Only the values between the given minimum and maximum is used.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 415 of file Bimage_color.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab7280ee72a088440e3d190ed9203afe8"/>    <section>
    <title>color_to_simple()</title>
<indexterm><primary>color_to_simple</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>color_to_simple</secondary></indexterm>
<para><computeroutput>void Bimage::color_to_simple ( )</computeroutput></para><para>

<para>A color image is converted to a simple image. </para>
</para>

<para><literallayout><computeroutput>The new value for each voxel is the average of the RGB color values.
</computeroutput></literallayout> </para>
<para>
Definition at line 94 of file Bimage_color.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad307b8fb1ce8c72a850c3ceb0fe89002"/>    <section>
    <title>combine_channels()</title>
<indexterm><primary>combine_channels</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>combine_channels</secondary></indexterm>
<para><computeroutput>void Bimage::combine_channels (long nc, <link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ct = <computeroutput><link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36ad83a0f556634bd31d3357be2a64aac4c">TSimple</link></computeroutput>
)</computeroutput></para><para>

<para>Combines images as channels. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nc</entry>
                                <entry>
<para>number of channels to create. </para>
</entry>
                            </row>
                            <row>
                                <entry>ct</entry>
                                <entry>
<para>compound type. <literallayout><computeroutput>The input image is replaced with a new image.
If the compound type is single value, the compound type
is inferred from the number of channels.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 2020 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a71edead8db40d0773892175a7b5b7a2a"/>    <section>
    <title>combined_complex_product()<computeroutput>[1/4]</computeroutput></title>
<indexterm><primary>combined_complex_product</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>combined_complex_product</secondary></indexterm>
<para><computeroutput>int Bimage::combined_complex_product ( )</computeroutput></para><para>

<para>Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>Requirement: Fourier transform of two images packed into one complex
    data block with the function Bimage::pack_two_in_complex and then
    transformed with the function Bimage::fft.
The Friedel relationships in transforms from real space images are
exploited to transform two images simultaneously and then extract
the individual transforms from the complex data set.
This function extracts the individual transforms and calculates the 
complex conjugate product used in cross-correlation.
The result is scaled by the total power of the two transforms, yielding 
the correlation coefficient when the product is backtransformed into 
the cross-correlation map.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 878 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8f205cb70f7ea0a38369ae7c6f2b5222"/>    <section>
    <title>combined_complex_product()<computeroutput>[2/4]</computeroutput></title>
<indexterm><primary>combined_complex_product</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>combined_complex_product</secondary></indexterm>
<para><computeroutput>int Bimage::combined_complex_product (<link linkend="_class_bimage">Bimage</link> * pmask)</computeroutput></para><para>

<para>Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>binary mask (only 0 and 1), NULL if not desired. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>Requirement: Fourier transform of two images packed into one complex
    data block with the function Bimage::pack_two_in_complex and then
    transformed with the function Bimage::fft.
The Friedel relationships in transforms from real space images are
exploited to transform two images simultaneously and then extract
the individual transforms from the complex data set.
This function extracts the individual transforms and calculates the 
complex conjugate product used in cross-correlation.
The result is scaled by the total power of the two transforms, yielding 
the correlation coefficient when the product is backtransformed into 
the cross-correlation map.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 966 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a31ff4d6148499e24377c45428ec8c73a"/>    <section>
    <title>combined_complex_product()<computeroutput>[3/4]</computeroutput></title>
<indexterm><primary>combined_complex_product</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>combined_complex_product</secondary></indexterm>
<para><computeroutput>int Bimage::combined_complex_product (double hires, double lores)</computeroutput></para><para>

<para>Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>Requirement: Fourier transform of two images packed into one complex
    data block with the function Bimage::pack_two_in_complex and then
    transformed with the function Bimage::fft.
The Friedel relationships in transforms from real space images are
exploited to transform two images simultaneously and then extract
the individual transforms from the complex data set.
This function extracts the individual transforms and calculates the 
complex conjugate product used in cross-correlation.
The result is scaled by the total power of the two transforms within
the resolution limits, yielding the correlation coefficient when
the product is backtransformed into the cross-correlation map.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 991 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa03855b78911b0811e1208885cffc98e"/>    <section>
    <title>combined_complex_product()<computeroutput>[4/4]</computeroutput></title>
<indexterm><primary>combined_complex_product</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>combined_complex_product</secondary></indexterm>
<para><computeroutput>int Bimage::combined_complex_product (double hires, double lores, <link linkend="_class_bimage">Bimage</link> * pmask)</computeroutput></para><para>

<para>Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>binary mask (only 0 and 1), NULL if not desired. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>Requirement: Fourier transform of two images packed into one complex
    data block with the function Bimage::pack_two_in_complex and then
    transformed with the function Bimage::fft.
The Friedel relationships in transforms from real space images are
exploited to transform two images simultaneously and then extract
the individual transforms from the complex data set.
This function extracts the individual transforms and calculates the 
complex conjugate product used in cross-correlation.
The result is scaled by the total power of the two transforms within
the resolution limits, yielding the correlation coefficient when
the product is backtransformed into the cross-correlation map.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1016 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a415d393255e21b878bfdc574146a40e8"/>    <section>
    <title>combined_complex_product_implicit_mask()</title>
<indexterm><primary>combined_complex_product_implicit_mask</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>combined_complex_product_implicit_mask</secondary></indexterm>
<para><computeroutput>int Bimage::combined_complex_product_implicit_mask (double hires, double lores)</computeroutput></para><para>

<para>Calculates the complex conjugate product of a complex image resulting from combining and Fourier transforming two real space images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>Requirement: Fourier transform of two images packed into one complex
    data block with the function Bimage::pack_two_in_complex and then
    transformed with the function Bimage::fft.
The Friedel relationships in transforms from real space images are
exploited to transform two images simultaneously and then extract
the individual transforms from the complex data set.
This function extracts the individual transforms and calculates the 
complex conjugate product used in cross-correlation.
An implicit mask is assumed: Only non-zero values in both transforms are considered.
The result is scaled by the total power of the two transforms within
the resolution limits, yielding the correlation coefficient when
the product is backtransformed into the cross-correlation map.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1155 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2bb42c15f87e1e551f9d2dbef8491dcd"/>    <section>
    <title>compatible()</title>
<indexterm><primary>compatible</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>compatible</secondary></indexterm>
<para><computeroutput>bool Bimage::compatible (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Check if this image has the same number of channels and data type as another. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>reference image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>bool 1 if yes, 0 if no. <literallayout><computeroutput>The function returns the answer and leaves the calling function to 
deal with the result.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 664 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7feb28efaaf52eddebd38d00066a1a2e"/>    <section>
    <title>complex()</title>
<indexterm><primary>complex</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex</secondary></indexterm>
<para><computeroutput><link linkend="_class_complex">Complex</link>&lt; double &gt; Bimage::complex (long j)</computeroutput></para><para>

<para>Returns a complex value at the given index. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>j</entry>
                                <entry>
<para>index. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Complex&lt;double&gt; the complex floating point value. <literallayout><computeroutput>The index refers to compound values.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1036 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a409f4fa58ef28c6cd7f591a8a89d574c"/>    <section>
    <title>complex_apply_dual_mask()</title>
<indexterm><primary>complex_apply_dual_mask</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex_apply_dual_mask</secondary></indexterm>
<para><computeroutput>int Bimage::complex_apply_dual_mask (<link linkend="_class_bimage">Bimage</link> * pmask)</computeroutput></para><para>

<para>Applies a dual mask to a complex image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>mask (converted to floating point). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>The mask is applied to an image, generating two images, the first 
with values retained where the mask is positive, and the second with
values where the mask is negative.
The input image is replaced and the second is created and linked to
the first.
Requirement: The two input images must be the same size.
No statistics are calculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 646 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a900f7f590e1626c8f521e731cb4a9043"/>    <section>
    <title>complex_apply_mask()</title>
<indexterm><primary>complex_apply_mask</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex_apply_mask</secondary></indexterm>
<para><computeroutput>int Bimage::complex_apply_mask (<link linkend="_class_bimage">Bimage</link> * pmask)</computeroutput></para><para>

<para>Applies a mask to a complex image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>mask (converted to floating point). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>Wherever the mask is &lt;= 0, the data is set to zero.
Requirement: The two images must be the same size.
No statistics are calculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 586 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab46eac20f607c7922eef77c90a40a832"/>    <section>
    <title>complex_apply_negative_mask()</title>
<indexterm><primary>complex_apply_negative_mask</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex_apply_negative_mask</secondary></indexterm>
<para><computeroutput>int Bimage::complex_apply_negative_mask (<link linkend="_class_bimage">Bimage</link> * pmask)</computeroutput></para><para>

<para>Applies a negative mask to a complex image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>mask (converted to floating point). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>Wherever the mask is &gt;= 0, the data is set to zero.
Requirement: The two images must be the same size.
No statistics are calculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 615 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1adcacc4e756f549b1bb2a60b13ae93a00"/>    <section>
    <title>complex_bandpass()</title>
<indexterm><primary>complex_bandpass</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex_bandpass</secondary></indexterm>
<para><computeroutput>int Bimage::complex_bandpass (double hires, double lores)</computeroutput></para><para>

<para>Bandpasses a Fourier transform. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>Requirement: a complex Fourier transform.
All data outside the band limits are set to zero.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 680 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6c83144b13c3a4c25a7ef4ec9fcf6685"/>    <section>
    <title>complex_conjugate()</title>
<indexterm><primary>complex_conjugate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex_conjugate</secondary></indexterm>
<para><computeroutput>void Bimage::complex_conjugate ( )</computeroutput></para><para>

<para>Calculates the complex conjugate image. </para>
</para>
<para>
Definition at line 230 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0b693dfd14b455539166ef88fdf852bb"/>    <section>
    <title>complex_conjugate_product()</title>
<indexterm><primary>complex_conjugate_product</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex_conjugate_product</secondary></indexterm>
<para><computeroutput>int Bimage::complex_conjugate_product (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Calculates the product of a complex image with the conjugate of a second. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>complex image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>Complex conjugate product:
    (a + ib)*(c - id) = (a*c + b*d) + i(b*c - a*d).
Requirement: The two images must be the same size.
No statistics are calculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 507 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af23fee98976ac23c37ce16d7feac9ee0"/>    <section>
    <title>complex_conjugate_product_one2many()</title>
<indexterm><primary>complex_conjugate_product_one2many</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex_conjugate_product_one2many</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::complex_conjugate_product_one2many (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Calculates the product of a complex image with the conjugate of a second. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>complex image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>Complex conjugate product:
    (a + ib)*(c - id) = (a*c + b*d) + i(b*c - a*d).
Requirement: The two images must be the same size.
No statistics are calculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 555 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af9dd2401fc3d59bde6d222d8979d12af"/>    <section>
    <title>complex_multiply()</title>
<indexterm><primary>complex_multiply</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex_multiply</secondary></indexterm>
<para><computeroutput>int Bimage::complex_multiply (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Calculates the product of a complex image with a simple image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>simple image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>Requirement: The two images must be the same size.
No statistics are calculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 447 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad52f5efd5dad2c089de6c1acbb47bb37"/>    <section>
    <title>complex_normalize()</title>
<indexterm><primary>complex_normalize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex_normalize</secondary></indexterm>
<para><computeroutput>double Bimage::complex_normalize ( )</computeroutput></para><para>

<para>Normalizes the power in a complex image. </para>
</para>

<para><formalpara><title>Returns</title>

<para>double power. <literallayout><computeroutput>The first element is set to zero.
The image is scaled by the remaining total power, i.e., the sum of the intensities.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 272 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af0390feeaaed888509327745aad01f27"/>    <section>
    <title>complex_power()</title>
<indexterm><primary>complex_power</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex_power</secondary></indexterm>
<para><computeroutput>double Bimage::complex_power ( )</computeroutput></para><para>

<para>Calculates the power in a complex image. </para>
</para>

<para><formalpara><title>Returns</title>

<para>double power. <literallayout><computeroutput>The first element is set to zero.
The image is scaled by the remaining total power, i.e., the sum of the intensities.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 247 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac7177b199823a9ccbf78fc65f1042038"/>    <section>
    <title>complex_product()</title>
<indexterm><primary>complex_product</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex_product</secondary></indexterm>
<para><computeroutput>int Bimage::complex_product (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Calculates the complex product of two complex images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>complex image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>Complex product:
    (a + ib)*(c + id) = (a*c - b*d) + i(b*c + a*d).
Requirement: The two images must be the same size.
No statistics are calculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 477 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a484243844b17ec9265365545c5087044"/>    <section>
    <title>complex_to_amplitudes()</title>
<indexterm><primary>complex_to_amplitudes</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex_to_amplitudes</secondary></indexterm>
<para><computeroutput>void Bimage::complex_to_amplitudes ( )</computeroutput></para><para>

<para>The amplitudes from a complex image is written to a simple image. </para>
</para>
<para>
Definition at line 161 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3902e92c0036d0d8f812a271f932a0c8"/>    <section>
    <title>complex_to_imaginary()</title>
<indexterm><primary>complex_to_imaginary</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex_to_imaginary</secondary></indexterm>
<para><computeroutput>void Bimage::complex_to_imaginary ( )</computeroutput></para><para>

<para>The imaginary part of a complex image is written to a simple image. </para>
</para>
<para>
Definition at line 118 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab9a5fe205d012073c5bc2a902ca3e95a"/>    <section>
    <title>complex_to_intensities()</title>
<indexterm><primary>complex_to_intensities</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex_to_intensities</secondary></indexterm>
<para><computeroutput>void Bimage::complex_to_intensities ( )</computeroutput></para><para>

<para>The intensities from a complex image is written to a simple image. </para>
</para>
<para>
Definition at line 139 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1acfcb9c3eab00573289c72f6ee24ed20c"/>    <section>
    <title>complex_to_phases()</title>
<indexterm><primary>complex_to_phases</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex_to_phases</secondary></indexterm>
<para><computeroutput>void Bimage::complex_to_phases ( )</computeroutput></para><para>

<para>The phases from a complex image is written to a simple image. </para>
</para>
<para>
Definition at line 208 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad9d1522e62412070a4694482067f3532"/>    <section>
    <title>complex_to_real()</title>
<indexterm><primary>complex_to_real</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex_to_real</secondary></indexterm>
<para><computeroutput>void Bimage::complex_to_real ( )</computeroutput></para><para>

<para>The real part of a complex image is written to a simple image. </para>
</para>
<para>
Definition at line 97 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7d2e55ed269cd9f3bd954ce2f9d18ed0"/>    <section>
    <title>complex_to_signed_amplitudes()</title>
<indexterm><primary>complex_to_signed_amplitudes</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>complex_to_signed_amplitudes</secondary></indexterm>
<para><computeroutput>void Bimage::complex_to_signed_amplitudes ( )</computeroutput></para><para>

<para>The signed amplitudes from a complex image is written to a simple image. </para>
</para>
<para>
Definition at line 183 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a94f685cb874a2593c8520b18962be360"/>    <section>
    <title>compound_type()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>compound_type</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>compound_type</secondary></indexterm>
<para><computeroutput><link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> Bimage::compound_type ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 359 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1aa2ad0e179f96e2d7fa0bb02d9853c1b6"/>    <section>
    <title>compound_type()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>compound_type</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>compound_type</secondary></indexterm>
<para><computeroutput>long Bimage::compound_type (<link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ct)</computeroutput></para><para>
Definition at line 351 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aba25aac6daf2be313372df9017583703"/>    <section>
    <title>compound_type_size()</title>
<indexterm><primary>compound_type_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>compound_type_size</secondary></indexterm>
<para><computeroutput>long Bimage::compound_type_size ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 363 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a6d7eaa823a3e59fde34b41efa65bc64f"/>    <section>
    <title>compound_type_string()</title>
<indexterm><primary>compound_type_string</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>compound_type_string</secondary></indexterm>
<para><computeroutput><link linkend="_class_bstring">Bstring</link> Bimage::compound_type_string ( )</computeroutput></para><para>

<para>Get the string representation of a datatype. </para>
</para>

<para><formalpara><title>Returns</title>

<para><link linkend="_class_bstring">Bstring</link> string representation of a datatype. </para>
</formalpara>
</para>
<para>
Definition at line 1724 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aaff64a952f50ef4f0d7752823927a842"/>    <section>
    <title>convert_to_helix()</title>
<indexterm><primary>convert_to_helix</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>convert_to_helix</secondary></indexterm>
<para><computeroutput>double Bimage::convert_to_helix (double helix_rise, double helix_angle, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; offset)</computeroutput></para><para>

<para>Converts a map to a helix. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>helix_rise</entry>
                                <entry>
<para>rise per asymmetric unit </para>
</entry>
                            </row>
                            <row>
                                <entry>helix_angle</entry>
                                <entry>
<para>rotation angle per asymmetric unit. </para>
</entry>
                            </row>
                            <row>
                                <entry>offset</entry>
                                <entry>
<para>offset in the xy plane. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double 0. <literallayout><computeroutput>The data is offset from the central axis based on helical parameters along the axis.
The data is rotated around the offset vector based on the helix rise 
and helix angle by an angle:
                  distance * (1 - cos(helix_angle))
    angle2 = atan ---------------------------------
                            helix_rise
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 721 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a256555f8b2178b4a267fb0be752656ad"/>    <section>
    <title>convolve()</title>
<indexterm><primary>convolve</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>convolve</secondary></indexterm>
<para><computeroutput>int Bimage::convolve (<link linkend="_class_bimage">Bimage</link> * pkernel)</computeroutput></para><para>

<para>Convolves an image with an arbitrary size convolution filter. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pkernel</entry>
                                <entry>
<para>kernel encoded as an image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 on error. <literallayout><computeroutput>The kernel is multiplied with each area surrounding the current voxel
with wrapping to avoid image edge effects.
The convolution is threaded if compiled with OpenMP.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 592 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1adc7a8b3e3bb82e5b64e47780ad3b41a0"/>    <section>
    <title>convolve_chunk()</title>
<indexterm><primary>convolve_chunk</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>convolve_chunk</secondary></indexterm>
<para><computeroutput>int Bimage::convolve_chunk (<link linkend="_class_bimage">Bimage</link> * pkernel, float * nudata, long i, long len)</computeroutput></para><para>
Definition at line 511 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6cd4fa6eda1e22952da949e76419ee57"/>    <section>
    <title>coordinates()<computeroutput>[1/4]</computeroutput></title>
<indexterm><primary>coordinates</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>coordinates</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt;long&gt; Bimage::coordinates (long i)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 451 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a16063cd8e18671cad87e0fa63b5b3858"/>    <section>
    <title>coordinates()<computeroutput>[2/4]</computeroutput></title>
<indexterm><primary>coordinates</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>coordinates</secondary></indexterm>
<para><computeroutput>void Bimage::coordinates (long i, long &amp; nc, long &amp; nx, long &amp; ny, long &amp; nz, long &amp; nn)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 440 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1ad1f822e981215b18e7ee27df213fce0e"/>    <section>
    <title>coordinates()<computeroutput>[3/4]</computeroutput></title>
<indexterm><primary>coordinates</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>coordinates</secondary></indexterm>
<para><computeroutput>void Bimage::coordinates (long i, long &amp; nx, long &amp; ny, long &amp; nz)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 424 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a8db6a06e7407d98678c38eb4787cc059"/>    <section>
    <title>coordinates()<computeroutput>[4/4]</computeroutput></title>
<indexterm><primary>coordinates</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>coordinates</secondary></indexterm>
<para><computeroutput>void Bimage::coordinates (long i, long &amp; nx, long &amp; ny, long &amp; nz, long &amp; nn)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 431 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a5d95c9ec5072c183f3a8f46856ad3c21"/>    <section>
    <title>copy()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>copy</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>copy</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::copy ( )</computeroutput></para><para>

<para>Copies the header information and data of an image into a new image structure. </para>
</para>

<para><formalpara><title>Returns</title>

<para>Bimage* copied image, NULL if copy failed. </para>
</formalpara>
</para>
<para>
Definition at line 2766 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae857443aef660818821614dbf350a334"/>    <section>
    <title>copy()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>copy</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>copy</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::copy (long nu_nimg)</computeroutput></para><para>

<para>Copies the header information and data of an image into a new image structure. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nu_nimg</entry>
                                <entry>
<para>new number of images (if &lt; 1, keep the old number) </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* copied image, NULL if copy failed. </para>
</formalpara>
</para>
<para>
Definition at line 2792 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a743633e6ef75cd6c5a10964cad2db5c6"/>    <section>
    <title>copy_header()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>copy_header</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>copy_header</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link>* Bimage::copy_header ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 666 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a6f33c5b1b205f62ce1bd85fd5f9fee3a"/>    <section>
    <title>copy_header()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>copy_header</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>copy_header</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::copy_header (long nu_nimg)</computeroutput></para><para>

<para>Copy an image structure into a new one. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nu_nimg</entry>
                                <entry>
<para>new number of images (if &lt; 1, keep the old number) </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* the new image structure, NULL if copy failed. <literallayout><computeroutput>All information from an old image structure is copied into a new one.
This takes care of the internal arrays in the structure.
The data pointer is left to point to the original data.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2826 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa60f07470d38a7a7c791741e14b81792"/>    <section>
    <title>correct_background()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>correct_background</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>correct_background</secondary></indexterm>
<para><computeroutput>int Bimage::correct_background (<link linkend="_class_bimage">Bimage</link> * pmask, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Corrects the background for each sub-image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>foreground mask. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>flag to specify where to calculate the background: [0,3] </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The background is taken as the average of the values outside the
circle or sphere enclosed by the image.
If the mask is specified, it is used to define the foreground of the 
image. The correction then includes the area outside the circle or 
sphere as well as the area where the mask is zero.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 298 of file Bimage_background.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae097d0c9a4d324888c4225f6dc64eff5"/>    <section>
    <title>correct_background()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>correct_background</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>correct_background</secondary></indexterm>
<para><computeroutput>int Bimage::correct_background (int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Corrects the background for each sub-image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>flag to specify where to calculate the background: [0,1] </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 on error. <literallayout><computeroutput>The background is taken as the average of the values outside the
circle or sphere enclosed by the image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 260 of file Bimage_background.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab4c22f850dcdc8bef046cb78707ac808"/>    <section>
    <title>correct_background()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>correct_background</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>correct_background</secondary></indexterm>
<para><computeroutput>int Bimage::correct_background (long nn, int flag)</computeroutput></para><para>

<para>Corrects the background for one sub-image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>flag to specify where to calculate the background: [0,3] </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 on error. <literallayout><computeroutput>The background is taken as the average of the values outside the
circle or sphere enclosed by the image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 202 of file Bimage_background.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aed4f644bac0ee94020a3143500301f73"/>    <section>
    <title>correlate()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>correlate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>correlate</secondary></indexterm>
<para><computeroutput>double Bimage::correlate (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Calculates correlation coefficient between two images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image to correlate with. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double correlation coefficient, -1 if not run. <literallayout><computeroutput>The correlation between two images is calculated and normalized as:
               sum((image1 - avg1)*(image2 - avg2))
    CC = -------------------------------------------------
         sqrt(sum(image1 - avg1)^2 * sum(image2 - avg2)^2)
.
Both images are converted to floating point.
Only the first image is used.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 36 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a89a24a64c2a46d4e7605f46ae21c6518"/>    <section>
    <title>correlate()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>correlate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>correlate</secondary></indexterm>
<para><computeroutput>double Bimage::correlate (<link linkend="_class_bimage">Bimage</link> * p, double rmin, double rmax, <link linkend="_class_bimage">Bimage</link> * pmask = <computeroutput>NULL</computeroutput>
, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates a correlation coefficient between two images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>second image. </para>
</entry>
                            </row>
                            <row>
                                <entry>rmin</entry>
                                <entry>
<para>minimum radius (pixel units). </para>
</entry>
                            </row>
                            <row>
                                <entry>rmax</entry>
                                <entry>
<para>maximum radius (pixel units). </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>mask (can be NULL). </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>flag to modify second image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double correlation coefficient, -1 if error. <literallayout><computeroutput>The correlation between two images is calculated and normalized as:
             sum((image1 - avg1)*(image2 - avg2))
    CC = -------------------------------------------------
         sqrt(sum(image1 - avg1)^2 * sum(image2 - avg2)^2)
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 90 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a116466a5ea13f35a581948624a4697ce"/>    <section>
    <title>correlate_annuli()</title>
<indexterm><primary>correlate_annuli</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>correlate_annuli</secondary></indexterm>
<para><computeroutput>double Bimage::correlate_annuli (<link linkend="_class_bimage">Bimage</link> * polref, int ann_min, int ann_max, double ang_min, double ang_max, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb, double &amp; cc_max)</computeroutput></para><para>

<para>Correlate annuli of a polar image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*polref</entry>
                                <entry>
<para>reference image polar power spectrum transform. </para>
</entry>
                            </row>
                            <row>
                                <entry>ann_min</entry>
                                <entry>
<para>low resolution cutoff (in inverse pixels). </para>
</entry>
                            </row>
                            <row>
                                <entry>ann_max</entry>
                                <entry>
<para>high resolution cutoff (in inverse pixels). </para>
</entry>
                            </row>
                            <row>
                                <entry>ang_min</entry>
                                <entry>
<para>minimum angle to test for (radians). </para>
</entry>
                            </row>
                            <row>
                                <entry>ang_max</entry>
                                <entry>
<para>maximum angle to test for (radians). </para>
</entry>
                            </row>
                            <row>
                                <entry>planf</entry>
                                <entry>
<para>FFT forward plan. </para>
</entry>
                            </row>
                            <row>
                                <entry>planb</entry>
                                <entry>
<para>FFT backward plan. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;cc_max</entry>
                                <entry>
<para>pointer to correlation coefficient for return. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double angle. <literallayout><computeroutput>The input images must be transformed polar images, with each annulus
corresponding to a row in the image.
The polar image annuli between the given limits are cross-correlated
one by one, and a sum of all annuli calculated, weighted by annulus index.
The maximum value in the annulus sum corresponds to the best fit angle.
Both image and mirror image are assessed, yielding a negative angle
when the mirror image gives a larger correlation.
FFTW library (www.fftw.org).
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1187 of file Bimage_align.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab4398066bdddc4ac4723c27a3e57ce30"/>    <section>
    <title>correlation_coefficient()</title>
<indexterm><primary>correlation_coefficient</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>correlation_coefficient</secondary></indexterm>
<para><computeroutput>double Bimage::correlation_coefficient (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; shift)</computeroutput></para><para>

<para>Calculates a coefficient from a Fourier correlation transform given a shift. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>shift</entry>
                                <entry>
<para>real space shift. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double correlation coefficient. <literallayout><computeroutput>The input image is a cross-correlation transform.
A brute force backtransform integration is done for the given shift to 
calculate the corresponding correlation coefficient.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 466 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1add424b02a9e5ff78e8bd8003b28da89e"/>    <section>
    <title>cross_correlate()<computeroutput>[1/4]</computeroutput></title>
<indexterm><primary>cross_correlate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>cross_correlate</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link>* Bimage::cross_correlate (<link linkend="_class_bimage">Bimage</link> * p, <link linkend="_class_bimage">Bimage</link> * pmask = <computeroutput>NULL</computeroutput>
)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 983 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a66dd9d3e57b245ffbb8c6aaf071b48b2"/>    <section>
    <title>cross_correlate()<computeroutput>[2/4]</computeroutput></title>
<indexterm><primary>cross_correlate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>cross_correlate</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::cross_correlate (<link linkend="_class_bimage">Bimage</link> * p, double hires, double lores, <link linkend="_class_bimage">Bimage</link> * pmask, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb)</computeroutput></para>
<para>write_img(&quot;pccp.mrc&quot;, pc, 0);</para>
<para>
Definition at line 599 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a733932c8d5fe80fb2d9677e1052f53e7"/>    <section>
    <title>cross_correlate()<computeroutput>[3/4]</computeroutput></title>
<indexterm><primary>cross_correlate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>cross_correlate</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::cross_correlate (<link linkend="_class_bimage">Bimage</link> * p, double hires, double lores, <link linkend="_class_bimage">Bimage</link> * pmask = <computeroutput>NULL</computeroutput>
)</computeroutput></para><para>

<para>Calculates a cross-correlation map by Fast Fourier transformation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>second image. </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>binary mask (only 0 and 1), NULL if not desired. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* cross-correlation image. <literallayout><computeroutput>FFTW library (www.fftw.org).
Two equally sized multi-image 1D, 2D and 3D real space data sets are 
packed into a complex data set and transformed forward. The transform
is unpacked before the first transform is multiplied with the complex 
conjugate of the second transform. This is then back-transformed to 
obtain the cross-correlation map in real space.
The low resolution limit can be 0, in which case no limits are applied.
The resultant cross-correlation image data type is floating point.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 417 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aee3980b2fbc7486c0b2e5d1f0f23a527"/>    <section>
    <title>cross_correlate()<computeroutput>[4/4]</computeroutput></title>
<indexterm><primary>cross_correlate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>cross_correlate</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::cross_correlate (<link linkend="_class_bimage">Bimage</link> * p, double hires, double lores, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb)</computeroutput></para><para>

<para>Calculates a cross-correlation map by Fast Fourier transformation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>second image. </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>planf</entry>
                                <entry>
<para>forward transform plan. </para>
</entry>
                            </row>
                            <row>
                                <entry>planb</entry>
                                <entry>
<para>backward transform plan. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* cross-correlation image. <literallayout><computeroutput>FFTW library (www.fftw.org).
Two equally sized multi-image 1D, 2D and 3D real space data sets are 
packed into a complex data set and transformed forward. The transform
is unpacked before the first transform is multiplied with the complex 
conjugate of the second transform. This is then back-transformed to 
obtain the cross-correlation map in real space.
Zero-valued data in the transforms are implicitly excluded.
The low resolution limit can be 0, in which case no limits are applied.
The resultant cross-correlation image data type is floating point.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 363 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a94c6007300a2ac6ee727bce03547aadb"/>    <section>
    <title>cross_correlate_fspace()</title>
<indexterm><primary>cross_correlate_fspace</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>cross_correlate_fspace</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::cross_correlate_fspace (<link linkend="_class_bimage">Bimage</link> * p, double hires, double lores, double shift_limit)</computeroutput></para><para>

<para>Calculates a cross-correlation map by Fast Fourier transformation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>second image. </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>shift_limit</entry>
                                <entry>
<para>maximum real space shift. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* cross-correlation image. <literallayout><computeroutput>FFTW library (www.fftw.org).
Two equally sized multi-image 1D, 2D and 3D real space data sets are 
packed into a complex data set and transformed forward. The transform
is unpacked before the first transform is multiplied with the complex 
conjugate of the second transform. This is then back-transformed to 
obtain the cross-correlation map in real space.
The low resolution limit can be 0, in which case no limits are applied.
The resultant cross-correlation image data type is floating point.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 561 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7e0623b75a864ebcc25ee4cb13cd3249"/>    <section>
    <title>cross_correlate_two_way()</title>
<indexterm><primary>cross_correlate_two_way</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>cross_correlate_two_way</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::cross_correlate_two_way (<link linkend="_class_bimage">Bimage</link> * p, double hires, double lores, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb)</computeroutput></para><para>

<para>Calculates a cross-correlation map by Fast Fourier transformation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>second image. </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>planf</entry>
                                <entry>
<para>FFT forward plan. </para>
</entry>
                            </row>
                            <row>
                                <entry>planb</entry>
                                <entry>
<para>FFT backward plan. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* cross-correlation image. <literallayout><computeroutput>FFTW library (www.fftw.org).
Two equally sized multi-image 1D, 2D and 3D real space data sets are 
packed into a complex data set and transformed forward. The transform
is bandpass filtered to the given resolution limits and unpacked.
The two transforms are normalized, and multiplied in two ways:
    prod1 = data1 * data2.conjugate
    prod2 = data1 * data2
The second product represents a cross-correlation with a 180 degree 
rotation of the second image.
Both are back-transformed to obtain the two cross-correlation map in real space.
The one with the highest maximum is selected to return.
The resultant cross-correlation image data type is floating point.
The angle in the cross-correlation image is set to zero if the first
map is selected, otherwise it is set to PI.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 669 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0ae039957d4ef654accb7a9d6533e207"/>    <section>
    <title>cross_correlate_validate()</title>
<indexterm><primary>cross_correlate_validate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>cross_correlate_validate</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::cross_correlate_validate (<link linkend="_class_bimage">Bimage</link> * p, <link linkend="_class_bimage">Bimage</link> * pmask)</computeroutput></para><para>

<para>Calculates a masked cross-correlation map by Fast Fourier transformation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>second image. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>binary mask (only 0 and 1), NULL if not desired. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* cross-correlation image. <literallayout><computeroutput>FFTW library (www.fftw.org).
Two equally sized multi-image 1D, 2D and 3D real space data sets are 
packed into a complex data set and transformed forward. The transform
is unpacked and masked with mask image before the first transform is
multiplied with the complex conjugate of the second transform. This is 
then back-transformed to obtain the cross-correlation map in real space.
The mask must be composed of 0 and 1, and is converted to floating point.
The mask can be omitted (NULL).
The resultant cross-correlation image data type is floating point.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 750 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1abfe49c9cdf6885b620cf141fb8ef081d"/>    <section>
    <title>cylinder()</title>
<indexterm><primary>cylinder</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>cylinder</secondary></indexterm>
<para><computeroutput>int Bimage::cylinder (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; center, double radius, double height, double width, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Fills a cylinder within an image with a uniform value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>center</entry>
                                <entry>
<para>three vector center of cylinder. </para>
</entry>
                            </row>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>cylinder radius. </para>
</entry>
                            </row>
                            <row>
                                <entry>height</entry>
                                <entry>
<para>cylinder heigth. </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>gaussian width of smoothing function. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>fill value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>All voxels within a cylinder at a given location are set to a given fill value.
The height is along the z-direction.
The new data replaces the old data.
The default center is {0,0,0}.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 539 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0a2ba8a5f6c80e5ac4e9b52a87e907f8"/>    <section>
    <title>cylindrical_shells()</title>
<indexterm><primary>cylindrical_shells</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>cylindrical_shells</secondary></indexterm>
<para><computeroutput>int Bimage::cylindrical_shells ( )</computeroutput></para><para>

<para>Calculates an image with slices representing cylindrical shell projections. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The 3D image is converted so that the sections contain 2D projections
of cylindrical shells. The projection in slice i is defined for:
    i &gt;= sqrt(x^2 + y^2)
The first projection is placed at the z origin and radiates out into
both positive and negative directions.
Sampling in x and y is not changed.
The sampling must be isotropic.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 925 of file Bimage_polar.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6095bea1f7ef723790ce2747a51402be"/>    <section>
    <title>data_alloc()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>data_alloc</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_alloc</secondary></indexterm>
<para><computeroutput>unsigned char* Bimage::data_alloc ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 266 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a6a6de434ebeb11ba2ade23d9d463270a"/>    <section>
    <title>data_alloc()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>data_alloc</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_alloc</secondary></indexterm>
<para><computeroutput>unsigned char * Bimage::data_alloc (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> type, <link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ctype, long nx, long ny, long nz, long nn)</computeroutput></para><para>

<para>Allocate image data with size parameters. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>type</entry>
                                <entry>
<para>data type. </para>
</entry>
                            </row>
                            <row>
                                <entry>ctype</entry>
                                <entry>
<para>compound type. </para>
</entry>
                            </row>
                            <row>
                                <entry>nx</entry>
                                <entry>
<para>x dimension. </para>
</entry>
                            </row>
                            <row>
                                <entry>ny</entry>
                                <entry>
<para>y dimension. </para>
</entry>
                            </row>
                            <row>
                                <entry>nz</entry>
                                <entry>
<para>z dimension. </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>number of sub-images. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>unsigned char* pointer to data. <literallayout><computeroutput>The image parameters are set and a new data block allocated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 854 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a58ea567d0cdd61f54b15ada3663dfce1"/>    <section>
    <title>data_alloc()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>data_alloc</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_alloc</secondary></indexterm>
<para><computeroutput>unsigned char * Bimage::data_alloc (long nbytes)</computeroutput></para><para>

<para>Allocate image data. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nbytes</entry>
                                <entry>
<para>number of bytes to allocate. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>unsigned char* pointer to data. <literallayout><computeroutput>Any old data block is deleted.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 808 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a50285748c55feaa198bc8becea39fe42"/>    <section>
    <title>data_alloc_and_clear()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>data_alloc_and_clear</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_alloc_and_clear</secondary></indexterm>
<para><computeroutput>unsigned char* Bimage::data_alloc_and_clear ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 267 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a2fc8a6b2b0cc4542d5091ee363b9949e"/>    <section>
    <title>data_alloc_and_clear()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>data_alloc_and_clear</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_alloc_and_clear</secondary></indexterm>
<para><computeroutput>unsigned char* Bimage::data_alloc_and_clear (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> type, <link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ctype, long nx, long ny, long nz, long nn)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 272 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a237661723c35542419e5bb0a81ed0e94"/>    <section>
    <title>data_alloc_and_clear()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>data_alloc_and_clear</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_alloc_and_clear</secondary></indexterm>
<para><computeroutput>unsigned char* Bimage::data_alloc_and_clear (long nbytes)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 269 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a997d17b3f9bbd3a5b13450b0379c1aa5"/>    <section>
    <title>data_assign()</title>
<indexterm><primary>data_assign</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_assign</secondary></indexterm>
<para><computeroutput>unsigned char * Bimage::data_assign (unsigned char * nudata)</computeroutput></para><para>

<para>Assign image data. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*nudata</entry>
                                <entry>
<para>allocated data pointer. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>unsigned char* pointer to data. <literallayout><computeroutput>Note: The size of the data block must correspond to the image dimensions!
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 884 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1afde298560de4552e4abda21507882d29"/>    <section>
    <title>data_delete()</title>
<indexterm><primary>data_delete</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_delete</secondary></indexterm>
<para><computeroutput>void Bimage::data_delete ( )</computeroutput></para><para>

<para>Deallocates the image data. </para>
</para>
<para>
Definition at line 906 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aab570544ea8a468fc75005223bce4faf"/>    <section>
    <title>data_offset()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>data_offset</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_offset</secondary></indexterm>
<para><computeroutput>long Bimage::data_offset ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 283 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a2d42f4d6f9070c0ec55e68b78eb3c9f0"/>    <section>
    <title>data_offset()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>data_offset</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_offset</secondary></indexterm>
<para><computeroutput>void Bimage::data_offset (long doff)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 284 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a4c9c4cd199d84788585fa0f7059facef"/>    <section>
    <title>data_pointer()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>data_pointer</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_pointer</secondary></indexterm>
<para><computeroutput>unsigned char* Bimage::data_pointer ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 279 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1acc39420e691b12ecafc85dc15ccbe0f6"/>    <section>
    <title>data_pointer()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>data_pointer</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_pointer</secondary></indexterm>
<para><computeroutput>unsigned char* Bimage::data_pointer (long offset)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 280 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1afb4232f60f0d0582b7208845757a2c1a"/>    <section>
    <title>data_pointer()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>data_pointer</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_pointer</secondary></indexterm>
<para><computeroutput>void Bimage::data_pointer (unsigned char * ptr)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 281 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a3d289504ed427397f78837e881dc6ca3"/>    <section>
    <title>data_size()</title>
<indexterm><primary>data_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_size</secondary></indexterm>
<para><computeroutput>long Bimage::data_size ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 265 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a3f8daaa394b40c3d3fec19e544125e5c"/>    <section>
    <title>data_type()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>data_type</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_type</secondary></indexterm>
<para><computeroutput><link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> Bimage::data_type ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 357 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a682d0ecb697de9856110a4ad841fb70c"/>    <section>
    <title>data_type()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>data_type</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_type</secondary></indexterm>
<para><computeroutput>void Bimage::data_type (<link linkend="_utilities_8h_1ad8ed01ff3ff33333d8e19db4d2818bb6">DataType</link> dt)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 358 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1ab5b8a851da4087a959b592c4645c755b"/>    <section>
    <title>data_type_bits()</title>
<indexterm><primary>data_type_bits</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_type_bits</secondary></indexterm>
<para><computeroutput>long Bimage::data_type_bits ( ) const</computeroutput></para><para>

<para>Returns the size of the datatype in bits. </para>
</para>

<para><formalpara><title>Returns</title>

<para>long data type size in bits. <literallayout><computeroutput>The Bit type returns 1.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1591 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac7b1bfcf9448a2a6ab4ae52ee7725a81"/>    <section>
    <title>data_type_max()</title>
<indexterm><primary>data_type_max</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_type_max</secondary></indexterm>
<para><computeroutput>double Bimage::data_type_max ( )</computeroutput></para><para>

<para>Get the maximum of a datatype. </para>
</para>

<para><formalpara><title>Returns</title>

<para>double maximum value. <literallayout><computeroutput>This function is used for returning the maximum value
a data type can hold.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1672 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a96111e0fd5ff64a7e037dcba8235b823"/>    <section>
    <title>data_type_min()</title>
<indexterm><primary>data_type_min</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_type_min</secondary></indexterm>
<para><computeroutput>double Bimage::data_type_min ( )</computeroutput></para><para>

<para>Get the minimum of a datatype. </para>
</para>

<para><formalpara><title>Returns</title>

<para>double minimum value. <literallayout><computeroutput>This function is used for returning the minimum value
a data type can hold.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1642 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7d72f814a078c88879693bbf71b54cf5"/>    <section>
    <title>data_type_size()</title>
<indexterm><primary>data_type_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_type_size</secondary></indexterm>
<para><computeroutput>long Bimage::data_type_size ( ) const</computeroutput></para><para>

<para>Returns the size of the datatype in bytes. </para>
</para>

<para><formalpara><title>Returns</title>

<para>long data type size. <literallayout><computeroutput>The Bit type returns 1.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1616 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a93ad6a3996ad556af36d215b4eb47904"/>    <section>
    <title>data_type_string()</title>
<indexterm><primary>data_type_string</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>data_type_string</secondary></indexterm>
<para><computeroutput><link linkend="_class_bstring">Bstring</link> Bimage::data_type_string ( )</computeroutput></para><para>

<para>Get the string representation of a datatype. </para>
</para>

<para><formalpara><title>Returns</title>

<para><link linkend="_class_bstring">Bstring</link> string representation of a datatype. </para>
</formalpara>
</para>
<para>
Definition at line 1698 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a29a5efdaa4116dc8d6aa4826384c4076"/>    <section>
    <title>default_origin()</title>
<indexterm><primary>default_origin</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>default_origin</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt;double&gt; Bimage::default_origin ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 596 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a86e13cf2551e48c8d98c5bad3c3690f9"/>    <section>
    <title>defocus_scale()</title>
<indexterm><primary>defocus_scale</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>defocus_scale</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::defocus_scale (long nn, double df, double df2, double iCL2, int fill_type)</computeroutput></para><para>
Definition at line 225 of file Bimage_powerspectrum.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a416e421f9c6a2043c34f223a9df49bef"/>    <section>
    <title>delete_images()</title>
<indexterm><primary>delete_images</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>delete_images</secondary></indexterm>
<para><computeroutput>long Bimage::delete_images (<link linkend="_class_bstring">Bstring</link> list, int retain = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Retains or deletes sub-images from a multi-image structure. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>list</entry>
                                <entry>
<para>list of sub-images to retain or delete. </para>
</entry>
                            </row>
                            <row>
                                <entry>retain</entry>
                                <entry>
<para>0=delete list, 1=retain list. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long error code (&lt;0 means failure) or number of sub-images remaining. <literallayout><computeroutput>Sub-images specified in a list are either retained or deleted.
The new data replaces the old data.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2212 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab423ab772f8f5370378c3ca39d89ffaf"/>    <section>
    <title>density()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>density</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>density</secondary></indexterm>
<para><computeroutput>double Bimage::density (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; coord, double radius)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 722 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a0df18d85c91d522f3f3c2d8ea56b1850"/>    <section>
    <title>density()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>density</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>density</secondary></indexterm>
<para><computeroutput>double Bimage::density (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; coord, double radius, double &amp; sigma)</computeroutput></para><para>

<para>Calculates the density in a sphere around a coordinate in an image. </para>
</para>

<para><formalpara><title>Author</title>

<para>Daniel Nemecek and Bernard Heymann </para>
</formalpara>

                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image number. </para>
</entry>
                            </row>
                            <row>
                                <entry>coord</entry>
                                <entry>
<para>position of density in map (voxels). </para>
</entry>
                            </row>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>spherical radius. </para>
</entry>
                            </row>
                            <row>
                                <entry>sigma</entry>
                                <entry>
<para>standard deviation result. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double average density. <literallayout><computeroutput>The density origin is positioned on the component.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 3207 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a1a729cd6b00a8a5031ca545921e5014b"/>    <section>
    <title>distort_elliptically()</title>
<indexterm><primary>distort_elliptically</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>distort_elliptically</secondary></indexterm>
<para><computeroutput>int Bimage::distort_elliptically (double angle, double shift)</computeroutput></para><para>

<para>Transforms a tubular cylinder to an elliptical profile. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>angle</entry>
                                <entry>
<para>angle of elliptical maximum. </para>
</entry>
                            </row>
                            <row>
                                <entry>shift</entry>
                                <entry>
<para>outward shift at elliptical maximum radius. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The density is shifted towards or away from the origin by a specific
amount and in a direction determined by an elliptical profile.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 779 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a34fcf4e33e69ef544b67855d7a64b8ea"/>    <section>
    <title>divide()</title>
<indexterm><primary>divide</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>divide</secondary></indexterm>
<para><computeroutput>void Bimage::divide (<link linkend="_class_bimage">Bimage</link> * p, double scale = <computeroutput>1</computeroutput>
, double shift = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Divides the first image by the second. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>other image. </para>
</entry>
                            </row>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>density scale to apply to other image </para>
</entry>
                            </row>
                            <row>
                                <entry>shift</entry>
                                <entry>
<para>density shift to apply to other image. <literallayout><computeroutput>The image is divided by the other with exceptions:
    image /= other*scale + shift
Both images are converted to floating point.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 3854 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1afcc8a26a38fe1b41c707793d44bb37de"/>    <section>
    <title>divide_one()</title>
<indexterm><primary>divide_one</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>divide_one</secondary></indexterm>
<para><computeroutput>void Bimage::divide_one (<link linkend="_class_bimage">Bimage</link> * p, double scale = <computeroutput>1</computeroutput>
, double shift = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Divides the first image by the first sub-image of the second. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>other image. </para>
</entry>
                            </row>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>density scale to apply to other image </para>
</entry>
                            </row>
                            <row>
                                <entry>shift</entry>
                                <entry>
<para>density shift to apply to other image. <literallayout><computeroutput>The image is divided by the other with exceptions:
    image /= other*scale + shift
Both images are converted to floating point.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 3907 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab207c264e19d9a213331accd25de29a6"/>    <section>
    <title>dyad_interpolate()</title>
<indexterm><primary>dyad_interpolate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>dyad_interpolate</secondary></indexterm>
<para><computeroutput>double Bimage::dyad_interpolate (long i, int norm_flag = <computeroutput>1</computeroutput>
)</computeroutput></para><para>
Definition at line 56 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aab3a7ec44e12c8449b6d6505e6b9938f"/>    <section>
    <title>edge()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>edge</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>edge</secondary></indexterm>
<para><computeroutput>int Bimage::edge (int type, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; rect, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, double width, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Smooths the image edge with a soft rectangular function. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>type</entry>
                                <entry>
<para>type of edge: 0=rectangle, 1=oval, 2=cylinder </para>
</entry>
                            </row>
                            <row>
                                <entry>rect</entry>
                                <entry>
<para>three-value size of the area to be smoothed. </para>
</entry>
                            </row>
                            <row>
                                <entry>start</entry>
                                <entry>
<para>three-value start for smoothing. </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>gaussian width of smoothing function. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value of edge voxels. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The edge of the image is smoothed with a function:
                    v_old(x,y,z) + fill*exp(1.618*dist/width)
    v_new(x,y,z) = ------------------------------------------
                           1 + exp(1.618*dist/width)
where   fill is the desired edge value.
        dist is the distance to the rectangular boundary defined by 
            the input size and start
        width is the gaussian width (softness)
With very small values of the gaussian width, the edge approaches a
step function.
With negative width values, the area filled is outside the shape.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 393 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0ca127a5e81dc5a37da132f66c0747bf"/>    <section>
    <title>edge()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>edge</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>edge</secondary></indexterm>
<para><computeroutput>int Bimage::edge (long nn, int type, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; rect, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, double width, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Smooths the image edge with a soft rectangular function. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>type</entry>
                                <entry>
<para>type of edge: 0=rectangle, 1=oval, 2=cylinder </para>
</entry>
                            </row>
                            <row>
                                <entry>rect</entry>
                                <entry>
<para>three-value size of the area to be smoothed. </para>
</entry>
                            </row>
                            <row>
                                <entry>start</entry>
                                <entry>
<para>three-value start for smoothing. </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>gaussian width of smoothing function. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value of edge voxels. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The edge of the image is smoothed with a function:
                    v_old(x,y,z) + fill*exp(1.618*dist/width)
    v_new(x,y,z) = ------------------------------------------
                           1 + exp(1.618*dist/width)
where   fill is the desired edge value.
        dist is the distance to the rectangular boundary defined by 
            the input size and start
        width is the gaussian width (softness)
With very small values of the gaussian width, the edge approaches a
step function.
With negative width values, the area filled is outside the shape.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 439 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a647a5820a81c3ed26344e4c5540446d8"/>    <section>
    <title>edge_mask()</title>
<indexterm><primary>edge_mask</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>edge_mask</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::edge_mask (int type, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; rect, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, double width)</computeroutput></para><para>

<para>Creates a mask with the edge approaching zero. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>type</entry>
                                <entry>
<para>type of edge: 0=rectangle, 1=oval, 2=cylinder </para>
</entry>
                            </row>
                            <row>
                                <entry>rect</entry>
                                <entry>
<para>three-value size of the area to be masked. </para>
</entry>
                            </row>
                            <row>
                                <entry>start</entry>
                                <entry>
<para>three-value start for mask. </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>gaussian width of smoothing function. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* new soft mask. <literallayout><computeroutput>The edge of the image is smoothed with a function:
                                1
    v_new(x,y,z) =  -------------------------
                    1 + exp(1.618*dist/width)
where   dist is the distance to the boundary defined by 
            the input size and start
        width is the gaussian width (softness)
With very small values of the gaussian width, the edge approaches a
step function.
With negative width values, the area filled is outside the shape.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 305 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ade5bcb6486e3258d8d7f4df3ab61081d"/>    <section>
    <title>enlarge()</title>
<indexterm><primary>enlarge</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>enlarge</secondary></indexterm>
<para><computeroutput>int Bimage::enlarge (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; scale)</computeroutput></para><para>

<para>Enlarges an image by an inetger scale. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>three-value scale. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>An image is enlarged by integer amounts.
The new data replaces the old data.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 499 of file Bimage_resize.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab48733dde4aaf8c925278d983fb252fb"/>    <section>
    <title>erase()</title>
<indexterm><primary>erase</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>erase</secondary></indexterm>
<para><computeroutput>long Bimage::erase (string tag)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 227 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1ae71f57ecd1286f7194495e506bb3b6cc"/>    <section>
    <title>exponential()</title>
<indexterm><primary>exponential</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>exponential</secondary></indexterm>
<para><computeroutput>void Bimage::exponential ( )</computeroutput></para><para>

<para>Calculates the exponential of the image data. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The image is first converted to floating point.
The new data replaces the old data.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 762 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2703b464380e42f9a66433f04769da33"/>    <section>
    <title>extract()<computeroutput>[1/6]</computeroutput></title>
<indexterm><primary>extract</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::extract (long n1, long n2)</computeroutput></para><para>

<para>Extracts a set of sub-images into new image structure. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>n1</entry>
                                <entry>
<para>first sub-image to extract. </para>
</entry>
                            </row>
                            <row>
                                <entry>n2</entry>
                                <entry>
<para>last sub-image to extract. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* the new image structure, NULL if copy failed. </para>
</formalpara>
</para>
<para>
Definition at line 40 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad694d6b8be2285e48d93cf19933448bc"/>    <section>
    <title>extract()<computeroutput>[2/6]</computeroutput></title>
<indexterm><primary>extract</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::extract (long nn)</computeroutput></para><para>

<para>Extracts one sub-image into new image structure. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number to extract. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* the new image structure, NULL if copy failed. </para>
</formalpara>
</para>
<para>
Definition at line 21 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a80739cb244177d56a44851de64c2ab89"/>    <section>
    <title>extract()<computeroutput>[3/6]</computeroutput></title>
<indexterm><primary>extract</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link>* Bimage::extract (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; loc, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; size, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; origin)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 672 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a1525f8c9e7b34b3c620f75ec01983bcc"/>    <section>
    <title>extract()<computeroutput>[4/6]</computeroutput></title>
<indexterm><primary>extract</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::extract (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; loc, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; size, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; ori, <link linkend="_class_matrix3">Matrix3</link> mat)</computeroutput></para><para>

<para>Extracts a region of one sub-image into new image structure. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number to extract. </para>
</entry>
                            </row>
                            <row>
                                <entry>loc</entry>
                                <entry>
<para>extraction location. </para>
</entry>
                            </row>
                            <row>
                                <entry>size</entry>
                                <entry>
<para>extraction size. </para>
</entry>
                            </row>
                            <row>
                                <entry>ori</entry>
                                <entry>
<para>extraction origin. </para>
</entry>
                            </row>
                            <row>
                                <entry>mat</entry>
                                <entry>
<para>orientation matrix. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* the new image structure, NULL if copy failed. </para>
</formalpara>
</para>
<para>
Definition at line 108 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1acd966ad2abdd53d849eff4a21e216281"/>    <section>
    <title>extract()<computeroutput>[5/6]</computeroutput></title>
<indexterm><primary>extract</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link>* Bimage::extract (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; loc, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; size, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; origin, <link linkend="_class_view">View</link> view)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 679 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a75becde8dfa02b97efe042a439ac4766"/>    <section>
    <title>extract()<computeroutput>[6/6]</computeroutput></title>
<indexterm><primary>extract</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::extract (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; coords, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; size, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Extracts a region of one sub-image into new image structure. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number to extract. </para>
</entry>
                            </row>
                            <row>
                                <entry>coords</entry>
                                <entry>
<para>extraction start. </para>
</entry>
                            </row>
                            <row>
                                <entry>size</entry>
                                <entry>
<para>extraction size. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>fill value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* the new image structure, NULL if copy failed. </para>
</formalpara>
</para>
<para>
Definition at line 69 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a954793f4d58397221196ccb9c2ef1a67"/>    <section>
    <title>extract_filament()</title>
<indexterm><primary>extract_filament</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract_filament</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::extract_filament (long img_num, double width, int axis, long nspline, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; * spline)</computeroutput></para><para>

<para>Extracts a filament defined by a series of coordinates. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>img_num</entry>
                                <entry>
<para>image number from which to extract filament. </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>width of filament image to extract. </para>
</entry>
                            </row>
                            <row>
                                <entry>axis</entry>
                                <entry>
<para>helical axis alignment: x=1, y=2, z=3. </para>
</entry>
                            </row>
                            <row>
                                <entry>nspline</entry>
                                <entry>
<para>number of coordinates in spline curve. </para>
</entry>
                            </row>
                            <row>
                                <entry>*spline</entry>
                                <entry>
<para>spline curve. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* one filament image. <literallayout><computeroutput>A single filament is extracted and returned.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1283 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a892f52f8f20dc7804f1ad1b2c9680d36"/>    <section>
    <title>extract_line()</title>
<indexterm><primary>extract_line</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract_line</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::extract_line (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; end, long width)</computeroutput></para><para>

<para>Extracts a line from an image into a new image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number from which to extract. </para>
</entry>
                            </row>
                            <row>
                                <entry>start</entry>
                                <entry>
<para>3-vector start of line. </para>
</entry>
                            </row>
                            <row>
                                <entry>end</entry>
                                <entry>
<para>3-vector end of line. </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>width of integration perpendicular to line. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* extracted line image (1D). <literallayout><computeroutput>The line values extracted are the interpolated values along the vector
defined by start and end coordinates..
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 656 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab2528c48b7c82f19008a343ccfc42c7d"/>    <section>
    <title>extract_magnify()</title>
<indexterm><primary>extract_magnify</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract_magnify</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::extract_magnify (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; center, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; ext_size, double scale)</computeroutput></para><para>

<para>Extracts a region from an image to magnify. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number to extract. </para>
</entry>
                            </row>
                            <row>
                                <entry>center</entry>
                                <entry>
<para>center of region to magnify. </para>
</entry>
                            </row>
                            <row>
                                <entry>ext_size</entry>
                                <entry>
<para>size of region to magnify. </para>
</entry>
                            </row>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>dimensional scaling. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* extracted slice for 2D and 3 slices for 3D. <literallayout><computeroutput>Only the desired region is extracted from the original image and
resized based on the given scale argument.
The dynamic range is rescaled using the image display minimum and 
maximum:
    new_data = data*255/(max-min)
with truncation of the data below 0 and above 255.
Bit data are converted to 0 (black) and 255 (white).
RGB data are rescaled as for gray scale images.
Complex data types are converted to intensities.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1027 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a25a878694c06b1bd8f60792138f69ff1"/>    <section>
    <title>extract_shell()</title>
<indexterm><primary>extract_shell</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract_shell</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::extract_shell (long nn, double minrad, double maxrad)</computeroutput></para><para>

<para>Extracts a shell from an image into a new image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number from which to extract, -1 indicates all images. </para>
</entry>
                            </row>
                            <row>
                                <entry>minrad</entry>
                                <entry>
<para>minimum shell radius. </para>
</entry>
                            </row>
                            <row>
                                <entry>maxrad</entry>
                                <entry>
<para>maximum shell radius. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* extracted image. <literallayout><computeroutput>A single image (only one sub-image) is extracted from a given sub-image
in an image structure, starting at a specified point and with a 
specified size.
The old data is not affected.
Statistics for the extracted image are calculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 193 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6ba5d23997bcbed499347362560988da"/>    <section>
    <title>extract_show()</title>
<indexterm><primary>extract_show</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract_show</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::extract_show (int aflag)</computeroutput></para><para>

<para>Converts a slice from an image to a 2D plane for display. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>aflag</entry>
                                <entry>
<para>averaging flag. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* extracted slice. <literallayout><computeroutput>Only the desired image slice is extracted from the original image and
resized based on the given scale argument.
The image, slice and scale values are encoded in the image structure.
The dynamic range is rescaled using the image display minimum and maximum:
    new_data = data*255/(max-min)
with truncation of the data below 0 and above 255.
Bit data are converted to 0 (black) and 255 (white).
RGB data are rescaled as for gray scale images.
Complex data types are converted to intensities.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 969 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a80a6e4158e822bc0580169327cd67b0c"/>    <section>
    <title>extract_show_chunk()</title>
<indexterm><primary>extract_show_chunk</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract_show_chunk</secondary></indexterm>
<para><computeroutput>int Bimage::extract_show_chunk (<link linkend="_class_bimage">Bimage</link> * pshow, int aflag, long i, long len)</computeroutput></para><para>
Definition at line 851 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a89fb7c035e1a7dab3a3b1aa92ee821f8"/>    <section>
    <title>extract_slice()</title>
<indexterm><primary>extract_slice</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract_slice</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::extract_slice (long nz)</computeroutput></para><para>

<para>Extracts a given slice or slices from an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nz</entry>
                                <entry>
<para>slice number to extract. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* extracted slice(s). <literallayout><computeroutput>Only the desired slices are extracted from the original image.
The dynamic range is rescaled using the image display minimum and 
maximum:
    new_data = data*255/(max-min)
with truncation of the data below 0 and above 255.
Bit data are converted to 0 (black) and 255 (white).
RGB data are rescaled as for gray scale images.
Complex data types are converted to intensities.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1191 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a83d370c2c5b46f2e3efa77adf4ff50f0"/>    <section>
    <title>extract_tetrahedron()</title>
<indexterm><primary>extract_tetrahedron</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract_tetrahedron</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::extract_tetrahedron (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; * tet, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Extracts a tetrahedral part of the image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*tet</entry>
                                <entry>
<para>four 3-value vectors defining the tetrahedron. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>fill value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>All voxels outside a tetrahedron defined by four points or vectors 
are set to a given fill value.
The new data replaces the old data.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 693 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a1764bd1bafd971269b576790b810767c"/>    <section>
    <title>extract_tile_stack()</title>
<indexterm><primary>extract_tile_stack</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract_tile_stack</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::extract_tile_stack (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; coords, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Extracts a stack of tiles at a specified position from an image into a new image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>coords</entry>
                                <entry>
<para>coordinates for the tile origins. </para>
</entry>
                            </row>
                            <row>
                                <entry>tile_size</entry>
                                <entry>
<para>3-vector size of extracted image. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>fill value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* p extracted stack of tiles. <literallayout><computeroutput>A stack of tiles of specified size are extracted from all the sub-images
in an image structure, using given coordinates for the tiles.
The origins of the tiles are inserted into the sub-image origin fields.
The old data is not affected.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 575 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae77dc7a2908d4c822b6040d52c8b6877"/>    <section>
    <title>extract_tile_stacks()</title>
<indexterm><primary>extract_tile_stacks</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract_tile_stacks</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> ** Bimage::extract_tile_stacks (vector&lt; <link linkend="_class_vector3">Vector3</link>&lt; long &gt;&gt; &amp; coords, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size)</computeroutput></para><para>

<para>Extracts stacks of tiles at a specified positions from an image into an array of new images. </para>
</para>

<para>Extracts a set of tiles at specified positions from an image into a new image. 
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>coords</entry>
                                <entry>
<para>coordinates for the tile origins. </para>
</entry>
                            </row>
                            <row>
                                <entry>tile_size</entry>
                                <entry>
<para>3-vector size of extracted image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>vector&lt;Bimage*&gt; extracted stacks of tiles. <literallayout><computeroutput>Stacks of tiles of specified size are extracted from all the sub-images
in an image structure, using given coordinates for the tiles.
The origins of the tiles are inserted into the sub-image origin fields.
The old data is not affected.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 607 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3b36947546650566f8889ca3e5eb0e46"/>    <section>
    <title>extract_tiles()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>extract_tiles</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract_tiles</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::extract_tiles (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; start, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; region, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; step_size, int exceed)</computeroutput></para><para>

<para>Extracts a set of tiles from an image into a new image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number from which to extract. </para>
</entry>
                            </row>
                            <row>
                                <entry>start</entry>
                                <entry>
<para>3-vector start for first tile to be extracted. </para>
</entry>
                            </row>
                            <row>
                                <entry>region</entry>
                                <entry>
<para>3-vector size of part of image to be extracted (0 = whole image). </para>
</entry>
                            </row>
                            <row>
                                <entry>tile_size</entry>
                                <entry>
<para>3-vector size of extracted image. </para>
</entry>
                            </row>
                            <row>
                                <entry>step_size</entry>
                                <entry>
<para>3-vector size of tile intervals. </para>
</entry>
                            </row>
                            <row>
                                <entry>exceed</entry>
                                <entry>
<para>flag to allow tiles to exceed the input image size. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* extracted set of sub-images. <literallayout><computeroutput>A set of tiles of specified size are extracted from a given sub-image
in an image structure, starting from a point and generating
as many tiles as would fit into the image size given. If the image size
given is zero, then the whole image is used. The origins of the tiles
are inserted into the sub-image origin fields.
The old data is not affected.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 465 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af74c7e919d334bed98157c96e68b5f72"/>    <section>
    <title>extract_tiles()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>extract_tiles</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract_tiles</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::extract_tiles (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size, double fraction = <computeroutput>0.2</computeroutput>
)</computeroutput></para><para>

<para>Extracts a set of tiles from an image into a new image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number from which to extract. </para>
</entry>
                            </row>
                            <row>
                                <entry>tile_size</entry>
                                <entry>
<para>3-vector size of extracted image. </para>
</entry>
                            </row>
                            <row>
                                <entry>fraction</entry>
                                <entry>
<para>overlap fraction to aim for. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* extracted set of sub-images. <literallayout><computeroutput>A set of tiles of specified size are extracted from a given sub-image
in an image structure. The tiles are located with overlap (~20% of tile width)
with the aim of covering the whole image but not exceeding it.
The origins of the tiles are inserted into the sub-image origin fields.
The old data is not affected.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 517 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3555dcbcffc041936d1b79f082782c8e"/>    <section>
    <title>extract_tiles()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>extract_tiles</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract_tiles</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::extract_tiles (long nn, vector&lt; <link linkend="_class_vector3">Vector3</link>&lt; long &gt;&gt; &amp; coords, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size)</computeroutput></para><para>

<para>Extracts a set of tiles at specified positions from an image into a new image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number from which to extract, -1 indicates all images. </para>
</entry>
                            </row>
                            <row>
                                <entry>coords</entry>
                                <entry>
<para>coordinates for the tile origins. </para>
</entry>
                            </row>
                            <row>
                                <entry>tile_size</entry>
                                <entry>
<para>3-vector size of extracted image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* p extracted set of sub-images. <literallayout><computeroutput>A set of tiles of specified size are extracted from a given sub-image 
in an image structure, using given coordinates for the tiles, which have
to fit into the image size. The origins of the tiles are inserted into 
the sub-image origin fields.
The old data is not affected.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 400 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a1bf79966f25b70ab6cf0d07445709c47"/>    <section>
    <title>extract_wrap()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>extract_wrap</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract_wrap</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::extract_wrap (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; loc, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; size, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; ori, <link linkend="_class_matrix3">Matrix3</link> mat)</computeroutput></para><para>

<para>Extracts a region of one sub-image into new image structure with wrapping. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number to extract. </para>
</entry>
                            </row>
                            <row>
                                <entry>loc</entry>
                                <entry>
<para>extraction location. </para>
</entry>
                            </row>
                            <row>
                                <entry>size</entry>
                                <entry>
<para>extraction size. </para>
</entry>
                            </row>
                            <row>
                                <entry>ori</entry>
                                <entry>
<para>extraction origin. </para>
</entry>
                            </row>
                            <row>
                                <entry>mat</entry>
                                <entry>
<para>orientation matrix. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* the new image structure, NULL if copy failed. </para>
</formalpara>
</para>
<para>
Definition at line 151 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a14699480a55fbaba89bb70572d74fd71"/>    <section>
    <title>extract_wrap()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>extract_wrap</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extract_wrap</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link>* Bimage::extract_wrap (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; size, <link linkend="_class_matrix3">Matrix3</link> mat)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 685 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1ad03e8e721a1d85ad7a40d4d03d3c0574"/>    <section>
    <title>extrude_cross_section()</title>
<indexterm><primary>extrude_cross_section</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>extrude_cross_section</secondary></indexterm>
<para><computeroutput>int Bimage::extrude_cross_section (long length, double helix_rise, double helix_angle, int fill_type, double fill)</computeroutput></para><para>

<para>Extrudes a 2D cross section into a 3D continuous helix. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>length</entry>
                                <entry>
<para>length in z. </para>
</entry>
                            </row>
                            <row>
                                <entry>helix_rise</entry>
                                <entry>
<para>helical subunit rise in angstrom. </para>
</entry>
                            </row>
                            <row>
                                <entry>helix_angle</entry>
                                <entry>
<para>helical subunit rotation in radians. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value of edge voxels. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The helical axis is at the origin and alongthe a axis.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1596 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac40b2b2d919d6d3a3e3eda301d4e0fba"/>    <section>
    <title>fft()<computeroutput>[1/4]</computeroutput></title>
<indexterm><primary>fft</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fft</secondary></indexterm>
<para><computeroutput>int Bimage::fft ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 855 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a242a0713955bce07cc7b0f5904ff394f"/>    <section>
    <title>fft()<computeroutput>[2/4]</computeroutput></title>
<indexterm><primary>fft</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fft</secondary></indexterm>
<para><computeroutput>int Bimage::fft (<link linkend="_fft_8h_1a61cf819a81d9f5c3c4d82f5907e3fe67">fft_direction</link> dir)</computeroutput></para><para>

<para>Fast Fourier transforms an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>dir</entry>
                                <entry>
<para>direction of transformation (FFTW_FORWARD or FFTW_BACKWARD) </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>FFTW library (www.fftw.org).
A multi-image 1D, 2D and 3D data set is transformed forward or backward 
and rescaled by 1/sqrt(N).  The forward transformation has a negative 
signed exponent in the kernel and the backward transform a positive
sign. The transformation is done in place and the resultant data are 
returned within the original image structure.  For forward transforms, 
the resultant data type is complex float, while for backward transforms, 
it is Float.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 49 of file Bimage_fft.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a109041ab7adcf1134630008c736cd0a1"/>    <section>
    <title>fft()<computeroutput>[3/4]</computeroutput></title>
<indexterm><primary>fft</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fft</secondary></indexterm>
<para><computeroutput>int Bimage::fft (<link linkend="_fft_8h_1a61cf819a81d9f5c3c4d82f5907e3fe67">fft_direction</link> dir, bool norm_flag)</computeroutput></para><para>

<para>Fast Fourier transforms an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>dir</entry>
                                <entry>
<para>direction of transformation (FFTW_FORWARD or FFTW_BACKWARD) </para>
</entry>
                            </row>
                            <row>
                                <entry>norm_flag</entry>
                                <entry>
<para>normalization: 0=none, 1=sqrtN, 2=N. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>FFTW library (www.fftw.org).
A multi-image 1D, 2D and 3D data set is transformed forward or backward 
and optionally rescaled by 1/sqrt(N) or N.  The forward transformation 
has a negative signed exponent in the kernel and the backward transform 
a positive sign. The transformation is done in place and the resultant 
data are returned within the original image structure.
For both directions the resultant image is complex.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 80 of file Bimage_fft.cpp.</para>
    </section><anchor xml:id="_class_bimage_1adcdc6f06bec66f631c393b87ac2a742f"/>    <section>
    <title>fft()<computeroutput>[4/4]</computeroutput></title>
<indexterm><primary>fft</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fft</secondary></indexterm>
<para><computeroutput>int Bimage::fft (<link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> plan, bool norm_flag = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Fast Fourier transforms an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>plan</entry>
                                <entry>
<para>Fourier transform plan. </para>
</entry>
                            </row>
                            <row>
                                <entry>norm_flag</entry>
                                <entry>
<para>normalization: 0=none, 1=sqrtN, 2=N. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>FFTW library (www.fftw.org).
A multi-image 1D, 2D and 3D data set is transformed forward or backward 
and optionally rescaled by 1/sqrt(N) or N.  The forward transformation 
has a negative signed exponent in the kernel and the backward transform 
a positive sign. The transformation is done in place and the resultant 
data are returned within the original image structure.
For both directions the resultant image is complex.
Requirement: The plan must be derived from the same size image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 179 of file Bimage_fft.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad83202ab557c3a6acc6f635d217146a6"/>    <section>
    <title>fft_back()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>fft_back</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fft_back</secondary></indexterm>
<para><computeroutput>int Bimage::fft_back ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 856 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a79448ddf4fd8e74bbfd846d7bb9b19e7"/>    <section>
    <title>fft_back()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>fft_back</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fft_back</secondary></indexterm>
<para><computeroutput>int Bimage::fft_back (<link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> plan, bool norm_flag = <computeroutput>1</computeroutput>
)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 863 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a3d7eea09fdb8cca40c6778cd4aa4c49e"/>    <section>
    <title>fft_setup()</title>
<indexterm><primary>fft_setup</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fft_setup</secondary></indexterm>
<para><computeroutput><link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> Bimage::fft_setup (<link linkend="_fft_8h_1a61cf819a81d9f5c3c4d82f5907e3fe67">fft_direction</link> dir, int opt = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Sets up a plan for fast Fourier transforms. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>dir</entry>
                                <entry>
<para>direction of transformation (FFTW_FORWARD or FFTW_BACKWARD) </para>
</entry>
                            </row>
                            <row>
                                <entry>opt</entry>
                                <entry>
<para>optimization (0=FFTW_ESTIMATE, 1=FFTW_MEASURE, 2=FFTW_PATIENT, 3=FFTW_EXHAUSTIVE). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>fft_plan FFTW plan. <literallayout><computeroutput>FFTW library (www.fftw.org).
The size and direction determines the plan.
Both FFTW versions 2 and 3 are supported.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 29 of file Bimage_fft.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad37eb70146e2c6730f8757cb02eae628"/>    <section>
    <title>filament_density()</title>
<indexterm><primary>filament_density</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filament_density</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::filament_density (double width)</computeroutput></para><para>

<para>Estimates the density per pixel length of a filament. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>filament width (pixels). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* one dimensional image with line integrals. <literallayout><computeroutput>The filament axis must be along the long axis (x or y).
The filament width must be about half of the image width.
The background is calculated for each line from the regions 
outside the width of the filament and subtracted from all
values in the line.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1753 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3ba420d47cf61f7095470e8e9c2aeba9"/>    <section>
    <title>filament_from_projections()</title>
<indexterm><primary>filament_from_projections</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filament_from_projections</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::filament_from_projections (double hi_res, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Reconstructs a filament from a set of projections. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>hi_res</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>0=sequential, 1=random. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* reconstructed filament. <literallayout><computeroutput>The views are set at equally spaced angles around the z-axis.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1813 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa5ee26442c0bafb0b25476062545ebfe"/>    <section>
    <title>filament_width()</title>
<indexterm><primary>filament_width</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filament_width</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::filament_width (long width, long lim_lo, long lim_hi)</computeroutput></para><para>

<para>Estimates the width of a filament. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>window size. </para>
</entry>
                            </row>
                            <row>
                                <entry>lim_lo</entry>
                                <entry>
<para>minimum filament width. </para>
</entry>
                            </row>
                            <row>
                                <entry>lim_hi</entry>
                                <entry>
<para>maximum filament width. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bplot* plot of filament widths. <literallayout><computeroutput>The filament axis must be along the y axis.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1648 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aaa65612821e6125011f91454f7de7581"/>    <section>
    <title>file_name()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>file_name</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>file_name</secondary></indexterm>
<para><computeroutput>string&amp; Bimage::file_name ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 232 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a2be9f3ca7d6cb23f7310f4152bb19362"/>    <section>
    <title>file_name()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>file_name</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>file_name</secondary></indexterm>
<para><computeroutput>void Bimage::file_name (string s)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 231 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a31c23502ddd87cbb33e533a97282effb"/>    <section>
    <title>fill()</title>
<indexterm><primary>fill</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fill</secondary></indexterm>
<para><computeroutput>void Bimage::fill (double v)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 717 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a010a69d94b27256f673831bec3ede99b"/>    <section>
    <title>fill_gaps()</title>
<indexterm><primary>fill_gaps</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fill_gaps</secondary></indexterm>
<para><computeroutput>int Bimage::fill_gaps (long step)</computeroutput></para><para>

<para>Fill the voxels that are not calculated. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>step</entry>
                                <entry>
<para>step increment for voxels with proper values. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 if error. <literallayout><computeroutput>The step size used to calculate sparse voxels is here used to determine
a kernel size for the filling operation. For each sparse voxel, all the
neighbors within the kernel are filled with the center value.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 958 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a17ae6d409fb5708f0393e8629699b8ec"/>    <section>
    <title>fill_value()</title>
<indexterm><primary>fill_value</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fill_value</secondary></indexterm>
<para><computeroutput><link linkend="_union_type_pointer">TypePointer</link> Bimage::fill_value (double v)</computeroutput></para><para>
Definition at line 1098 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa5538ec2cf75dc526f2598f983b2823b"/>    <section>
    <title>filter_average()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>filter_average</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filter_average</secondary></indexterm>
<para><computeroutput>int Bimage::filter_average (long kernel_size)</computeroutput></para><para>

<para>Applies an averaging filter to an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>kernel_size</entry>
                                <entry>
<para>length of kernel edge (typically 3). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 if error. <literallayout><computeroutput>A kernel of a given size is passed over the image and the average
value within the kernel assigned to the central voxel.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 207 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab2921e0ee63f54e4254118a8ba407721"/>    <section>
    <title>filter_average()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>filter_average</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filter_average</secondary></indexterm>
<para><computeroutput>int Bimage::filter_average (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; k)</computeroutput></para><para>
Definition at line 213 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a59222f093c517b163aeac959b3696fd3"/>    <section>
    <title>filter_bilateral()</title>
<indexterm><primary>filter_bilateral</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filter_bilateral</secondary></indexterm>
<para><computeroutput>int Bimage::filter_bilateral (double sigma1, double sigma2, int kernel_type, long kernel_radius)</computeroutput></para><para>

<para>Denoise an image with combined gaussian distance and density difference kernel. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>sigma1</entry>
                                <entry>
<para>sigma for distance weighting function. </para>
</entry>
                            </row>
                            <row>
                                <entry>sigma2</entry>
                                <entry>
<para>sigma for density difference weighting function. </para>
</entry>
                            </row>
                            <row>
                                <entry>kernel_type</entry>
                                <entry>
<para>kernel type for range filter. </para>
</entry>
                            </row>
                            <row>
                                <entry>kernel_radius</entry>
                                <entry>
<para>kernel radius. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The kernel is multiplied with each area surrounding the current voxel.
Kernel types:
    1.  Gaussian
    2.  Lorentzian
    3.  Tukey
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 902 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a5c716602230bd440ec0f6afb129ed6ea"/>    <section>
    <title>filter_bilateral_chunk()</title>
<indexterm><primary>filter_bilateral_chunk</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filter_bilateral_chunk</secondary></indexterm>
<para><computeroutput>int Bimage::filter_bilateral_chunk (<link linkend="_class_bimage">Bimage</link> * pkernel, double sigma2, int kernel_type, float * nudata, long i, long len, int first)</computeroutput></para><para>
Definition at line 789 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1acc3dfa467026ffd2b1d6b5229756a028"/>    <section>
    <title>filter_by_difference()</title>
<indexterm><primary>filter_by_difference</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filter_by_difference</secondary></indexterm>
<para><computeroutput>int Bimage::filter_by_difference (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Calculates an anisotropic average within a kernel based on the local gradient. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image to compare with. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. </para>
</formalpara>
</para>
<para>
Definition at line 1382 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7b62e2269f9c7993c77349d583e9f300"/>    <section>
    <title>filter_dog()</title>
<indexterm><primary>filter_dog</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filter_dog</secondary></indexterm>
<para><computeroutput>int Bimage::filter_dog (double sigma1, double sigma2)</computeroutput></para><para>

<para>Convolves the image with a difference of gausians kernel. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>sigma1</entry>
                                <entry>
<para>sigma for the inner gaussian. </para>
</entry>
                            </row>
                            <row>
                                <entry>sigma2</entry>
                                <entry>
<para>sigma for the outer gaussian. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 on error. </para>
</formalpara>
</para>
<para>
Definition at line 760 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa7bdc44f4581bd59d988cd52ea5d10a4"/>    <section>
    <title>filter_extremes()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>filter_extremes</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filter_extremes</secondary></indexterm>
<para><computeroutput>int Bimage::filter_extremes ( )</computeroutput></para><para>

<para>Filters the extremes out of a micrograph image. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>Segmentation is used to identify large contiguous regions of high
and low values, and these regions are set to the average.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 651 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1abcd3f470d765801f6061d67342a8b42b"/>    <section>
    <title>filter_extremes()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>filter_extremes</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filter_extremes</secondary></indexterm>
<para><computeroutput>int Bimage::filter_extremes (double tmin, double tmax, int kernel = <computeroutput>3</computeroutput>
)</computeroutput></para><para>

<para>Filters the extremes out of an image by replacing with adjacent averages. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>tmin</entry>
                                <entry>
<para>minimum. </para>
</entry>
                            </row>
                            <row>
                                <entry>tmax</entry>
                                <entry>
<para>maximum. </para>
</entry>
                            </row>
                            <row>
                                <entry>kernel</entry>
                                <entry>
<para>kernel edge size. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>Pixels smaller than the minimum or larger than the maximum are set to
the average within a defined kernel.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 705 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a68563296b57a2d9c25362546f8bf2e2e"/>    <section>
    <title>filter_extremes()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>filter_extremes</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filter_extremes</secondary></indexterm>
<para><computeroutput>int Bimage::filter_extremes (int mod_flag)</computeroutput></para><para>

<para>Filters the extremes out of an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>mod_flag</entry>
                                <entry>
<para>modification flag (0=set to avg, 1=set to min_max). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>A histogram of an image is calculated.  The first minimum in the first
quarter of the histogram and the last minimum in the last quarter
are taken to define the small and large outliers.  Pixel outside
these minima are then either set to average or to minimum or maximum
(depending on the mod_flag argument) to remove the outliers.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 680 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a9e7a4ada245ecf07688a166af32e1b02"/>    <section>
    <title>filter_gaussian()</title>
<indexterm><primary>filter_gaussian</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filter_gaussian</secondary></indexterm>
<para><computeroutput>int Bimage::filter_gaussian (long kernel_size, double sigma = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Applies a gaussian filter to an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>kernel_size</entry>
                                <entry>
<para>length of kernel edge. </para>
</entry>
                            </row>
                            <row>
                                <entry>sigma</entry>
                                <entry>
<para>gaussian decay. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 if error. <literallayout><computeroutput>The image is comvolved with a Gaussian kernel.
If the sigma value is zero, it is set to a sixth of the kernel size.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 441 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0961f0dd6376ab4cf6428e408e500cf2"/>    <section>
    <title>filter_ortho()</title>
<indexterm><primary>filter_ortho</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filter_ortho</secondary></indexterm>
<para><computeroutput>int Bimage::filter_ortho (int type)</computeroutput></para><para>

<para>Convolves the image with an orthogonal kernel with wrapping. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>type</entry>
                                <entry>
<para>type of kernel: 0=gradient magnitude, 1=laplacian. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 on error. <literallayout><computeroutput>The gradient kernel is:
    0  0  0    0 -1  0    0  0  0
    0 -1  0   -1  0  1    0  1  0
    0  0  0    0  1  0    0  0  0

The Laplacian filter kernel for a 3D volume is:
    0  0  0    0  1  0    0  0  0
    0  1  0    1 -6  1    0  1  0
    0  0  0    0  1  0    0  0  0
For 1D and 2D the central value is -2 and -4 respectively.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 663 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab9bc11d57ce0c518f1945af4ee64d9eb"/>    <section>
    <title>filter_peak()</title>
<indexterm><primary>filter_peak</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filter_peak</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::filter_peak (long kernel_size)</computeroutput></para><para>

<para>Finds the peaks in an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>kernel_size</entry>
                                <entry>
<para>length of kernel edge (typically 3). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 if error. <literallayout><computeroutput>A kernel of a given size is passed over the image and if the central
voxel is the maximum, it is kept, otherwise it is set to background.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1194 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a207f8d8d30304d422524b843c7175bf3"/>    <section>
    <title>filter_rank()</title>
<indexterm><primary>filter_rank</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filter_rank</secondary></indexterm>
<para><computeroutput>int Bimage::filter_rank (long kernel_size, double rank)</computeroutput></para><para>

<para>Applies a median filter to an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>kernel_size</entry>
                                <entry>
<para>length of kernel edge (typically 3). </para>
</entry>
                            </row>
                            <row>
                                <entry>rank</entry>
                                <entry>
<para>which value in the kernel to retain. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 if error. <literallayout><computeroutput>A kernel of a given size is passed over the image and the median
value within the kernel assigned to the central voxel.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1140 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a54ca7c220c8b8a14d8501694ca2c70ee"/>    <section>
    <title>filter_rank_chunk()</title>
<indexterm><primary>filter_rank_chunk</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filter_rank_chunk</secondary></indexterm>
<para><computeroutput>int Bimage::filter_rank_chunk (long kernel_size, double rank, float * nudata, long i, long len)</computeroutput></para><para>
Definition at line 1059 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac4d4dbb6a5fd01ccb65c5ac871f210f7"/>    <section>
    <title>filter_rolling_ball()</title>
<indexterm><primary>filter_rolling_ball</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filter_rolling_ball</secondary></indexterm>
<para><computeroutput>int Bimage::filter_rolling_ball (long radius, double scale)</computeroutput></para><para>

<para>Apply a rolling ball filter. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>radius of rolling ball. </para>
</entry>
                            </row>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>density scale. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. </para>
</formalpara>
</para>
<para>
Definition at line 954 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a4227a87d62a6c08de8a41b8040b86a34"/>    <section>
    <title>filter_sinc()</title>
<indexterm><primary>filter_sinc</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>filter_sinc</secondary></indexterm>
<para><computeroutput>int Bimage::filter_sinc ( )</computeroutput></para><para>

<para>Weighs an image with a sinc function. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>This filter compensates for trilinear interpolation during reconstruction.
The origin must be properly defined.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 484 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a299c87552442660b87cf243919a961fd"/>    <section>
    <title>find()</title>
<indexterm><primary>find</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link>* Bimage::find (<link linkend="_class_bstring">Bstring</link> fn)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 236 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a7447cd808d862a6f5cedf597ebc4bdbf"/>    <section>
    <title>find_center()</title>
<indexterm><primary>find_center</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find_center</secondary></indexterm>
<para><computeroutput>int Bimage::find_center (<link linkend="_class_bimage">Bimage</link> * pmask, double hires, double lores, double radius, double sigma, int refine_flag)</computeroutput></para><para>

<para>Finds the center of mass of an image by cross-correlation with its inverse. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>binary mask (only 0 and 1). </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>search radius (if &lt; 1, default 1e30). </para>
</entry>
                            </row>
                            <row>
                                <entry>sigma</entry>
                                <entry>
<para>attenuation around radius. </para>
</entry>
                            </row>
                            <row>
                                <entry>refine_flag</entry>
                                <entry>
<para>set to refine shift to subpixel resolution. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>FFTW library (www.fftw.org).
Two equally sized multi-image 1D, 2D and 3D data sets are transformed 
forward, the first transform multiplied by the complex conjugate of
the second transform, followed by backward transformation and 
rescaling by 1/(N*N). Data beyond the resolution set in the first 
image structure are not used. Therefore the correct setting 
of units and resolution in the image are required. Defaults for the 
units are usually 1 Angstrom/voxel and a zero resolution would
include the whole image (i.e., no resolution limitation).
A shift vector for each pair of images is calculated to
determine the cross-correlation peak to sub-pixel resolution.
Note: The first image is the reference and the shift returned is to
    transform the second to fit the first.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1237 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a5260d542a8919de15b8398dfd2f90c78"/>    <section>
    <title>find_cyclic_point_group()</title>
<indexterm><primary>find_cyclic_point_group</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find_cyclic_point_group</secondary></indexterm>
<para><computeroutput>double Bimage::find_cyclic_point_group (<link linkend="_struct_bsymmetry">Bsymmetry</link> &amp; sym, int binfac, double hires, double lores)</computeroutput></para><para>

<para>Finds the orientation for an image with a cyclic point group symmetry. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>sym</entry>
                                <entry>
<para>point group. </para>
</entry>
                            </row>
                            <row>
                                <entry>binfac</entry>
                                <entry>
<para>binning for faster searching (limited to 1,2,3). </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit in angstroms. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit in angstroms. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double symmetry correlation coefficient. <literallayout><computeroutput>The cyclic point group symmetry operation is applied to an image using
the reference symmetry axis, aslo the 2D rotation axis (default {0,0,1}). 
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 234 of file Bimage_symmetry.cpp.</para>
    </section><anchor xml:id="_class_bimage_1acaf92f8a5678c4bf76b6b1530dc228aa"/>    <section>
    <title>find_helix_parameters()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>find_helix_parameters</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find_helix_parameters</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::find_helix_parameters (double angle_start, double angle_end, double angle_step, int bin, double hires, double lores, double radius)</computeroutput></para><para>

<para>Finds the best helix parameters for helical map. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>angle_start</entry>
                                <entry>
<para>start value for angle. </para>
</entry>
                            </row>
                            <row>
                                <entry>angle_end</entry>
                                <entry>
<para>end value for angle. </para>
</entry>
                            </row>
                            <row>
                                <entry>angle_step</entry>
                                <entry>
<para>step size for angle. </para>
</entry>
                            </row>
                            <row>
                                <entry>bin</entry>
                                <entry>
<para>bin image for faster searching (limited to 1,2,3). </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit in angstroms. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit in angstroms. </para>
</entry>
                            </row>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>radius for mask (voxels). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bplot* plot with search results. <literallayout><computeroutput>An incremental search is done for the rotation angle, with the rise
inferred from the cross-correlation shift.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 873 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac3c7c1606f1635f114b13ee6a0fa7441"/>    <section>
    <title>find_helix_parameters()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>find_helix_parameters</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find_helix_parameters</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::find_helix_parameters (double rise_start, double rise_end, double rise_step, double angle_start, double angle_end, double angle_step, int bin, double radius)</computeroutput></para><para>

<para>Finds the best helix parameters for helical map. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>rise_start</entry>
                                <entry>
<para>start value for rise. </para>
</entry>
                            </row>
                            <row>
                                <entry>rise_end</entry>
                                <entry>
<para>end value for rise. </para>
</entry>
                            </row>
                            <row>
                                <entry>rise_step</entry>
                                <entry>
<para>step size for rise. </para>
</entry>
                            </row>
                            <row>
                                <entry>angle_start</entry>
                                <entry>
<para>start value for angle. </para>
</entry>
                            </row>
                            <row>
                                <entry>angle_end</entry>
                                <entry>
<para>end value for angle. </para>
</entry>
                            </row>
                            <row>
                                <entry>angle_step</entry>
                                <entry>
<para>step size for angle. </para>
</entry>
                            </row>
                            <row>
                                <entry>bin</entry>
                                <entry>
<para>bin image for faster searching (limited to 1,2,3). </para>
</entry>
                            </row>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>radius for mask (voxels). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bplot* plot with search results. <literallayout><computeroutput>An incremental search is done for the rise and rotation angle.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1056 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2daa0d26e64c9e49ddb2a0cc14e8c2d0"/>    <section>
    <title>find_peak()</title>
<indexterm><primary>find_peak</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find_peak</secondary></indexterm>
<para><computeroutput>int Bimage::find_peak (double radius = <computeroutput>1e30</computeroutput>
, double sigma = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Finds the peak in an image to the nearest voxel. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>search radius (if &lt; 1, default 1e30). </para>
</entry>
                            </row>
                            <row>
                                <entry>sigma</entry>
                                <entry>
<para>attenuation around radius. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>An image is searched for the global maximum (typically used to find
the shift vector in a cross-correlation map).
The peak vectors returned are in actual pixel coordinates (no wrapping).
The location around which to search is taken from the image origins.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1342 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a4b849fa786ec2cf1d144ca94bf46f7f3"/>    <section>
    <title>find_peaks()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>find_peaks</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find_peaks</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt; double &gt; * Bimage::find_peaks (double excl_dist, long &amp; ncoor, double &amp; threshold_min, double &amp; threshold_max, double pix_min = <computeroutput>2</computeroutput>
, double pix_max = <computeroutput>10</computeroutput>
)</computeroutput></para><para>

<para>Finds the peaks in a cross-correlation map to find template matches. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>excl_dist</entry>
                                <entry>
<para>exclusion distance between peaks. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;ncoor</entry>
                                <entry>
<para>number of coordinates. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;threshold_min</entry>
                                <entry>
<para>minimum threshold to choose peaks. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;threshold_max</entry>
                                <entry>
<para>maximum threshold to choose peaks. </para>
</entry>
                            </row>
                            <row>
                                <entry>pix_min</entry>
                                <entry>
<para>minimum peak width. </para>
</entry>
                            </row>
                            <row>
                                <entry>pix_max</entry>
                                <entry>
<para>maximum peak width. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para><link linkend="_class_vector3">Vector3&lt;double&gt;</link>* list of coordinates. <literallayout><computeroutput>The map is searched in increments of the particle radius to identify
peaks above the threshold and within a box the size of the
particle radius. The identified peaks are further examined to eliminate 
ones that are too close to a higher scoring peak. The acceptable distance
between peaks is set to 1.8 times the particle radius.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1830 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a29d7ab7027984b63c96e3f9f6ba4ee7a"/>    <section>
    <title>find_peaks()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>find_peaks</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find_peaks</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::find_peaks (long kernelsize)</computeroutput></para><para>

<para>Finds peaks in a map with periodic boundaries. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>kernelsize</entry>
                                <entry>
<para>size of kernel side (must be ≥3). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* image with peaks. <literallayout><computeroutput>A peak is defined as the local maximum within a specified kernel, where the
maximum is also larger than a given threshold. This assumes that the region
around a peak decreases monotonically on the scale length of the size of
the kernel. With kernel edge of 3 (+-1 in all directions), the values around
the peak shows a strict monotonicity with distance from the peak maximum.
The peak positions and values are returned in the new image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1741 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a914355785c950b3e733936a999fb155b"/>    <section>
    <title>find_point_group()</title>
<indexterm><primary>find_point_group</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find_point_group</secondary></indexterm>
<para><computeroutput>double Bimage::find_point_group (<link linkend="_struct_bsymmetry">Bsymmetry</link> &amp; sym, double angle_step, int binfac, double hires, double lores, int flags)</computeroutput></para><para>

<para>Finds the orientation for an image with a specific point group symmetry. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>sym</entry>
                                <entry>
<para>point group. </para>
</entry>
                            </row>
                            <row>
                                <entry>angle_step</entry>
                                <entry>
<para>angular step size for search. </para>
</entry>
                            </row>
                            <row>
                                <entry>binfac</entry>
                                <entry>
<para>binning for faster searching (limited to 1,2,3). </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit in angstroms. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit in angstroms. </para>
</entry>
                            </row>
                            <row>
                                <entry>flags</entry>
                                <entry>
<para>flag to search only for minor axes. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double symmetry correlation coefficient. <literallayout><computeroutput>The point group symmetry operations are applied to an image with an
orientation defined by the reference symmetry axis (default {0,0,1}). 
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 299 of file Bimage_symmetry.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a73b98ed9bd3b989b31defd06c1eb027a"/>    <section>
    <title>find_shift()<computeroutput>[1/5]</computeroutput></title>
<indexterm><primary>find_shift</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find_shift</secondary></indexterm>
<para><computeroutput>int Bimage::find_shift (<link linkend="_class_bimage">Bimage</link> * pref, <link linkend="_class_bimage">Bimage</link> * pmask, double hires, double lores, double radius, double sigma, int refine_flag)</computeroutput></para><para>

<para>Calculates a cross-correlation map to find the shift for the pair of images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pref</entry>
                                <entry>
<para>reference image. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>binary mask (only 0 and 1). </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>search radius (if &lt; 1, default 1e30). </para>
</entry>
                            </row>
                            <row>
                                <entry>sigma</entry>
                                <entry>
<para>attenuation around radius. </para>
</entry>
                            </row>
                            <row>
                                <entry>refine_flag</entry>
                                <entry>
<para>set to refine shift to subpixel resolution. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>FFTW library (www.fftw.org).
Two equally sized multi-image 1D, 2D and 3D data sets are transformed 
forward, the first transform multiplied by the complex conjugate of
the second transform, followed by backward transformation and 
rescaling by 1/(N*N). Data beyond the resolution set in the first 
image structure are not used. Therefore the correct setting 
of units and resolution in the image are required. Defaults for the 
units are usually 1 Angstrom/voxel and a zero resolution would
include the whole image (i.e., no resolution limitation).
A shift vector for each pair of images is calculated to
determine the cross-correlation peak to sub-pixel resolution.
Note: The first image is the reference and the shift returned is to
    transform the second to fit the first.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 931 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a47921af3160535f94f3060a87524ad6a"/>    <section>
    <title>find_shift()<computeroutput>[2/5]</computeroutput></title>
<indexterm><primary>find_shift</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find_shift</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt; double &gt; Bimage::find_shift (<link linkend="_class_bimage">Bimage</link> * pref, <link linkend="_class_bimage">Bimage</link> * pmask, double hires, double lores, double radius, double sigma, int refine_flag, double &amp; cc)</computeroutput></para><para>
Definition at line 970 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae0c36d9cb08f5525ff89f3c27ef1b763"/>    <section>
    <title>find_shift()<computeroutput>[3/5]</computeroutput></title>
<indexterm><primary>find_shift</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find_shift</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt; double &gt; Bimage::find_shift (<link linkend="_class_bimage">Bimage</link> * pref, <link linkend="_class_bimage">Bimage</link> * pmask, double hires, double lores, double radius, double sigma, int refine_flag, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb, double &amp; cc)</computeroutput></para><para>

<para>Calculates a cross-correlation map to find the shift for the pair of images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pref</entry>
                                <entry>
<para>reference image. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>binary mask (only 0 and 1). </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>search radius (if &lt; 1, default 1e30). </para>
</entry>
                            </row>
                            <row>
                                <entry>sigma</entry>
                                <entry>
<para>attenuation around radius. </para>
</entry>
                            </row>
                            <row>
                                <entry>refine_flag</entry>
                                <entry>
<para>set to refine shift to subpixel resolution. </para>
</entry>
                            </row>
                            <row>
                                <entry>planf</entry>
                                <entry>
<para>forward Fourier transform plan. </para>
</entry>
                            </row>
                            <row>
                                <entry>planb</entry>
                                <entry>
<para>backward Fourier transform plan. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;cc</entry>
                                <entry>
<para>correlation coefficient </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para><link linkend="_class_vector3">Vector3&lt;double&gt;</link> shift. <literallayout><computeroutput>FFTW library (www.fftw.org).
Two equally sized multi-image 1D, 2D and 3D data sets are transformed 
forward, the first transform multiplied by the complex conjugate of
the second transform, followed by backward transformation and 
rescaling by 1/(N*N). Data beyond the resolution set in the first 
image structure are not used. Therefore the correct setting 
of units and resolution in the image are required. Defaults for the 
units are usually 1 Angstrom/voxel and a zero resolution would
include the whole image (i.e., no resolution limitation).
A shift vector for each pair of images is calculated to
determine the cross-correlation peak to sub-pixel resolution.
Note: The first image is the reference and the shift returned is to
    transform the second to fit the first.

Only the first sub-image shift is calculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1093 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a574db68f6ca4c87c9854e1e4355c36ce"/>    <section>
    <title>find_shift()<computeroutput>[4/5]</computeroutput></title>
<indexterm><primary>find_shift</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find_shift</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt; double &gt; Bimage::find_shift (<link linkend="_class_bimage">Bimage</link> * pref, double hires, double lores, double radius, double sigma, int refine_flag, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb)</computeroutput></para><para>

<para>Calculates a cross-correlation map to find the shift for the pair of images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pref</entry>
                                <entry>
<para>reference image. </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>search radius (if &lt; 1, default 1e30). </para>
</entry>
                            </row>
                            <row>
                                <entry>sigma</entry>
                                <entry>
<para>attenuation around radius. </para>
</entry>
                            </row>
                            <row>
                                <entry>refine_flag</entry>
                                <entry>
<para>set to refine shift to subpixel resolution. </para>
</entry>
                            </row>
                            <row>
                                <entry>planf</entry>
                                <entry>
<para>forward Fourier transform plan. </para>
</entry>
                            </row>
                            <row>
                                <entry>planb</entry>
                                <entry>
<para>backward Fourier transform plan. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para><link linkend="_class_vector3">Vector3&lt;double&gt;</link> shift. <literallayout><computeroutput>FFTW library (www.fftw.org).
Two equally sized multi-image 1D, 2D and 3D data sets are transformed 
forward, the first transform multiplied by the complex conjugate of
the second transform, followed by backward transformation and 
rescaling by 1/(N*N). Data beyond the resolution set in the first 
image structure are not used. Therefore the correct setting 
of units and resolution in the image are required. Defaults for the 
units are usually 1 Angstrom/voxel and a zero resolution would
include the whole image (i.e., no resolution limitation).
A shift vector for each pair of images is calculated to
determine the cross-correlation peak to sub-pixel resolution.
Note: The first image is the reference and the shift returned is to
    transform the second to fit the first.

Only the first sub-image shift is calculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1030 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af9c9aed8bf9257e2d04101cc548d20ca"/>    <section>
    <title>find_shift()<computeroutput>[5/5]</computeroutput></title>
<indexterm><primary>find_shift</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find_shift</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt; double &gt; Bimage::find_shift (long nn, <link linkend="_class_bimage">Bimage</link> * pref, <link linkend="_class_bimage">Bimage</link> * pmask, double hi_res, double lo_res, double shift_limit, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb)</computeroutput></para><para>

<para>Calculates a cross-correlation map to find the shift for the pair of images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image to align. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pref</entry>
                                <entry>
<para>reference image. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>binary mask for cross-correlation (only 0 and 1). </para>
</entry>
                            </row>
                            <row>
                                <entry>hi_res</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lo_res</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>shift_limit</entry>
                                <entry>
<para>search radius (if &lt; 1, default 1e30). </para>
</entry>
                            </row>
                            <row>
                                <entry>planf</entry>
                                <entry>
<para>forward Fourier transform plan. </para>
</entry>
                            </row>
                            <row>
                                <entry>planb</entry>
                                <entry>
<para>backward Fourier transform plan. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double correlation coefficient. <literallayout><computeroutput>The shift is returned as the origin of each sub-image relative to
the reference origin.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1146 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6f896443c7d6dcfe0674232c5fa89684"/>    <section>
    <title>find_shift_in_transform()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>find_shift_in_transform</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find_shift_in_transform</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt; double &gt; Bimage::find_shift_in_transform (double shift_limit)</computeroutput></para><para>

<para>Finds the shift by brute force backtransformation for selected shifts. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>shift_limit</entry>
                                <entry>
<para>maximum real space shift. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para><link linkend="_class_vector3">Vector3&lt;double&gt;</link> best shift. <literallayout><computeroutput>The input image is a cross-correlation transform.
A brute force integration is done for the given shift to calculate
the corresponding correlation coefficient.
The correlation coefficient is return in the FOM field of the sub-image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 501 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad3de86725584217217b4ab919ef3dcdb"/>    <section>
    <title>find_shift_in_transform()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>find_shift_in_transform</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find_shift_in_transform</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt; double &gt; Bimage::find_shift_in_transform (long nn, <link linkend="_class_bimage">Bimage</link> * pref, double shift_limit)</computeroutput></para><para>
Definition at line 83 of file Bimage_align.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a325003555664ad5ab63d7313d15fd26e"/>    <section>
    <title>find_symmetric_view()</title>
<indexterm><primary>find_symmetric_view</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find_symmetric_view</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::find_symmetric_view (<link linkend="_class_bimage">Bimage</link> * ptemp, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp; sym, double phi_step, double theta_step, double alpha_step, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; shift)</computeroutput></para><para>

<para>Finds the view that on symmetrizing fits best to a symmetric template. 
<literallayout>&#160;&#xa;</literallayout>
 </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*ptemp</entry>
                                <entry>
<para>symmetric template. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;sym</entry>
                                <entry>
<para>symmetry. </para>
</entry>
                            </row>
                            <row>
                                <entry>phi_step</entry>
                                <entry>
<para>phi angle step size (radians). </para>
</entry>
                            </row>
                            <row>
                                <entry>theta_step</entry>
                                <entry>
<para>theta angle step size (radians). </para>
</entry>
                            </row>
                            <row>
                                <entry>alpha_step</entry>
                                <entry>
<para>rotation angle step size (radians). </para>
</entry>
                            </row>
                            <row>
                                <entry>shift</entry>
                                <entry>
<para>shift to impose before symmetrization. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* image rotated to the best view. <literallayout><computeroutput>The orientation parameters, view vector, angle of rotation and origin,
of each image is packed into 3D reciprocal space.
An image is used in the reconstruction if its selection flag has been set.
The fill value is taken from image&apos;s background value.  
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1045 of file Bimage_symmetry.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a78cdf739a9bc772b13b7a7ca95753dbd"/>    <section>
    <title>find_template()</title>
<indexterm><primary>find_template</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>find_template</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::find_template (<link linkend="_class_bimage">Bimage</link> * ptemp, <link linkend="_class_bimage">Bimage</link> * pmask, double hires, double lores, int bin, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb)</computeroutput></para><para>

<para>Finds one or more matches to a template. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*ptemp</entry>
                                <entry>
<para>template image. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>reciprocal space mask. </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>bin</entry>
                                <entry>
<para>level of image binning. </para>
</entry>
                            </row>
                            <row>
                                <entry>planf</entry>
                                <entry>
<para>forward Fourier transform plan. </para>
</entry>
                            </row>
                            <row>
                                <entry>planb</entry>
                                <entry>
<para>backward Fourier transform plan. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* cross-correlation map. <literallayout><computeroutput>A template is cross-correlated with the input image including
bandpass filtering to target the size of the template particle.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1179 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8be0b064eefaf517f0158b05a0d61bd1"/>    <section>
    <title>fit_peak()</title>
<indexterm><primary>fit_peak</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fit_peak</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt; double &gt; Bimage::fit_peak ( )</computeroutput></para><para>

<para>Fits an elliptic parabole to locate the position of the peak to sub-voxel resolution. </para>
</para>

<para><formalpara><title>Returns</title>

<para><link linkend="_class_vector3">Vector3&lt;double&gt;</link> shift from input origin. <literallayout><computeroutput>The peak is expected to be near the middle of the image, close to the input origin.
The function fits a 10-parameter parabola to the image.
The shift is retrieved from the parameters by matrix inversion.
The refined peak returned is the offset from the input origin.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1433 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad5c08defb61a7aa665e94d222ea88d08"/>    <section>
    <title>fix_type()</title>
<indexterm><primary>fix_type</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fix_type</secondary></indexterm>
<para><computeroutput>void Bimage::fix_type ( )</computeroutput></para><para>

<para>Determines the replacement data type. </para>
</para>

<para><formalpara><title>Returns</title>

<para>DataType replacement data type. <literallayout><computeroutput>An integer data type is switched between signed and unsigned.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1750 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2fd16f09564f26841e4e0468ae3a232f"/>    <section>
    <title>fourier_type()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>fourier_type</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fourier_type</secondary></indexterm>
<para><computeroutput><link linkend="__bimage_8h_1a01e0deba350901d769526633e868806f">FourierType</link> Bimage::fourier_type ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 375 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a2bc472566e81a653bf7659c2f26fd0e9"/>    <section>
    <title>fourier_type()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>fourier_type</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fourier_type</secondary></indexterm>
<para><computeroutput>void Bimage::fourier_type (<link linkend="__bimage_8h_1a01e0deba350901d769526633e868806f">FourierType</link> tf)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 376 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a6b6c1ccff23519853d4e246d60e7c5c2"/>    <section>
    <title>friedel_apply()</title>
<indexterm><primary>friedel_apply</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>friedel_apply</secondary></indexterm>
<para><computeroutput>int Bimage::friedel_apply ( )</computeroutput></para><para>

<para>Applies Friedel symmetry. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The Friedel-related voxels are converted to polar form and the 
in difference in amplitude and phase calculated (taking into account
the phases should differ by sign). The voxels are then set to the
average and its conjugate.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2021 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad6e43e43ac9ae08e0a28564decbf278d"/>    <section>
    <title>friedel_check()</title>
<indexterm><primary>friedel_check</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>friedel_check</secondary></indexterm>
<para><computeroutput>double Bimage::friedel_check ( )</computeroutput></para><para>

<para>Checks Friedel symmetry. </para>
</para>

<para><formalpara><title>Returns</title>

<para>double overall RMSD or residual. <literallayout><computeroutput>The differences between the complex and polar forms of Friedel-related 
voxels are calculated and accumulated as squared sums weighted by their
average intensities. The residuals are then calculated as 
root-mean-square-deviations.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1959 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aae84c0a38fd631080656901ef9468f8d"/>    <section>
    <title>fsc()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>fsc</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fsc</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::fsc (<link linkend="_class_bimage">Bimage</link> * p, double hi_res, double sampling_ratio = <computeroutput>1</computeroutput>
)</computeroutput></para><para>
Definition at line 325 of file Bimage_resolution.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa2e604cb03f66a11a174eff259bb6f54"/>    <section>
    <title>fsc()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>fsc</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fsc</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::fsc (double hi_res, double sampling_ratio = <computeroutput>1</computeroutput>
)</computeroutput></para><para>
Definition at line 245 of file Bimage_resolution.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a53929c5258e3e6d2301375781bf3704b"/>    <section>
    <title>fsc_dpr()</title>
<indexterm><primary>fsc_dpr</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fsc_dpr</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::fsc_dpr (double hi_res, double sampling_ratio = <computeroutput>1</computeroutput>
, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates an FSC and DPR curves from two images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>hi_res</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>sampling_ratio</entry>
                                <entry>
<para>radial sampling ratio (1 for per voxel sampling). </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>if 1 calculate only the FSC. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bplot* FSC curve. <literallayout><computeroutput>FRC: Fourier ring/shell correlation 
-----------------------------------
Saxton &amp; Baumeister (1982) J. Microscopy 127, 127-138 
de la Fraga et al. (1995) Ultramicroscopy 60, 385-391 
           sum(|F1|*|F2|) 
FRC/FSC = --------------------------------- 
          sqrt( sum(|F1|^2) * sum(|F2|^2) ) 
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 92 of file Bimage_resolution.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a5dad3f53957a2ae41c2665080274cbd7"/>    <section>
    <title>fsc_local()</title>
<indexterm><primary>fsc_local</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fsc_local</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::fsc_local (<link linkend="_class_bimage">Bimage</link> * p, <link linkend="_class_bimage">Bimage</link> * pmask, double hi_res, double * cutoff, int mask_level, int size, int pad, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; vedge, int step = <computeroutput>1</computeroutput>
, int taper = <computeroutput>1</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Determine the local resolution at each masked voxel in a map. </para>
</para>

<para><formalpara><title>Author</title>

<para>Giovanni Cardone and Bernard Heymann </para>
</formalpara>

                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>second image. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>mask. </para>
</entry>
                            </row>
                            <row>
                                <entry>hi_res</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>*cutoff</entry>
                                <entry>
<para>correlation threshold(s). </para>
</entry>
                            </row>
                            <row>
                                <entry>mask_level</entry>
                                <entry>
<para>mask level index. </para>
</entry>
                            </row>
                            <row>
                                <entry>size</entry>
                                <entry>
<para>kernel size. </para>
</entry>
                            </row>
                            <row>
                                <entry>pad</entry>
                                <entry>
<para>padding factor. </para>
</entry>
                            </row>
                            <row>
                                <entry>vedge</entry>
                                <entry>
<para>edge size. </para>
</entry>
                            </row>
                            <row>
                                <entry>step</entry>
                                <entry>
<para>voxel step size. </para>
</entry>
                            </row>
                            <row>
                                <entry>taper</entry>
                                <entry>
<para>kernel tapering function. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>background fill value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* local resolution image. <literallayout><computeroutput>For each voxel specified in the mask, within the edge limits, and at
the step size given, two kernels are extracted from the two input maps.
These kernels are then compared to determine the resolution based FSC.
The resultant resolution value is then written into a new map.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 592 of file Bimage_resolution.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8e64a59b52e430a10cee5540c0024940"/>    <section>
    <title>fsc_shell()</title>
<indexterm><primary>fsc_shell</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fsc_shell</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::fsc_shell (<link linkend="_class_bimage">Bimage</link> * p, double hi_res, double * cutoff, int thickness, int step, int minrad, int maxrad, int pad = <computeroutput>1</computeroutput>
, int smooth = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Determine the resolution for each concentric shell in a map. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>second image. </para>
</entry>
                            </row>
                            <row>
                                <entry>hi_res</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>*cutoff</entry>
                                <entry>
<para>correlation threshold(s). </para>
</entry>
                            </row>
                            <row>
                                <entry>thickness</entry>
                                <entry>
<para>shell thickness. </para>
</entry>
                            </row>
                            <row>
                                <entry>step</entry>
                                <entry>
<para>step size between shells. </para>
</entry>
                            </row>
                            <row>
                                <entry>minrad</entry>
                                <entry>
<para>minimum radius. </para>
</entry>
                            </row>
                            <row>
                                <entry>maxrad</entry>
                                <entry>
<para>maximum radius. </para>
</entry>
                            </row>
                            <row>
                                <entry>pad</entry>
                                <entry>
<para>padding factor. </para>
</entry>
                            </row>
                            <row>
                                <entry>smooth</entry>
                                <entry>
<para>flag for edge smooting. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>background fill value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* a 1D image containing the shell resolutions. </para>
</formalpara>
</para>
<para>
Definition at line 415 of file Bimage_resolution.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa75d027b66e4adb4ef2f31ebb14da778"/>    <section>
    <title>fspace_2D_interpolate()</title>
<indexterm><primary>fspace_2D_interpolate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_2D_interpolate</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_2D_interpolate (<link linkend="_class_complex">Complex</link>&lt; float &gt; cv, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; m, double part_weight, int interp_type)</computeroutput></para><para>

<para>Interpolates a 2D image for packing ito a 3D reciprocal space volume. 
<literallayout>&#160;&#xa;</literallayout>
 </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>cv</entry>
                                <entry>
<para>complex value from 2D transform. </para>
</entry>
                            </row>
                            <row>
                                <entry>m</entry>
                                <entry>
<para>location in 3D relative to origin. </para>
</entry>
                            </row>
                            <row>
                                <entry>part_weight</entry>
                                <entry>
<para>weight to assign to value (usually 1). </para>
</entry>
                            </row>
                            <row>
                                <entry>interp_type</entry>
                                <entry>
<para>interpolation type (0=nearest neighbor, 1=weighted nearest neigbor, 2=trilinear). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 on error. </para>
</formalpara>
</para>
<para>
Definition at line 25 of file Bimage_reconstruct.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af4f70203482c3025452fb5e9a097bde6"/>    <section>
    <title>fspace_amp_one()</title>
<indexterm><primary>fspace_amp_one</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_amp_one</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_amp_one ( )</computeroutput></para><para>

<para>Sets all amplitudes to one. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>If the image is a not a Fourier transform, it is transformed, modified,
and backtransformed. If the image is a Fourier transform, it is just
modified. The resultant image is floating point for real space or
complex for reciprocal space.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 323 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2f66579e3b1e53aec78ae09985ce824b"/>    <section>
    <title>fspace_amp_threshold()</title>
<indexterm><primary>fspace_amp_threshold</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_amp_threshold</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_amp_threshold (double threshold)</computeroutput></para><para>

<para>Filters the amplitudes of the Fourier transform of an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>Miminum amplitude to accept. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>If the image is a not a Fourier transform, it is transformed, filtered,
and backtransformed. If the image is a Fourier transform, it is just
filtered. The filtering sets all amplitudes below the given threshold
to zero. The resultant image is floating point for real space or
complex for reciprocal space.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 368 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad4570a384d1683cfcc8e2b1c18c0bda8"/>    <section>
    <title>fspace_background()</title>
<indexterm><primary>fspace_background</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_background</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_background ( )</computeroutput></para><para>

<para>Calculates the background for a Fourier transform. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. The background is taken to be the area outside Nyquest. </para>
</formalpara>
</para>
<para>
Definition at line 46 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3a004d126c6b9441256e145226416293"/>    <section>
    <title>fspace_bandpass()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>fspace_bandpass</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_bandpass</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_bandpass (double res_hi, double res_lo, double width, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb)</computeroutput></para><para>

<para>Applies a bandpass filter to an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>res_hi</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>res_lo</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>gaussian width of edge. </para>
</entry>
                            </row>
                            <row>
                                <entry>planf</entry>
                                <entry>
<para>forward Fourier transform plan. </para>
</entry>
                            </row>
                            <row>
                                <entry>planb</entry>
                                <entry>
<para>backward Fourier transform plan. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>If the image is a not a Fourier transform, it is transformed, filtered,
and backtransformed. If the image is a Fourier transform, it is just
filtered. The filtering sets all values with frequencies above the
given high resolution limit and below the given low resolution limit
to zero.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 525 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a64fc3ee68565a1a039b34145446295a2"/>    <section>
    <title>fspace_bandpass()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>fspace_bandpass</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_bandpass</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_bandpass (double res_hi, double res_lo = <computeroutput>0</computeroutput>
, double width = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Applies a bandpass filter to an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>res_hi</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>res_lo</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>gaussian width of edge. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>If the image is a not a Fourier transform, it is transformed, filtered,
and backtransformed. If the image is a Fourier transform, it is just
filtered. The filtering sets all values with frequencies above the
given high resolution limit and below the given low resolution limit
to zero.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 496 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad411c82b4d184c05045f3ecb4cbee83d"/>    <section>
    <title>fspace_default_bands()</title>
<indexterm><primary>fspace_default_bands</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_default_bands</secondary></indexterm>
<para><computeroutput>vector&lt; double &gt; Bimage::fspace_default_bands (double res_lo, double res_hi)</computeroutput></para><para>

<para>Sets up default frequency space bands to generate a mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>res_lo</entry>
                                <entry>
<para>low resolution limit (angstrom). </para>
</entry>
                            </row>
                            <row>
                                <entry>res_hi</entry>
                                <entry>
<para>high resolution limit (angstrom). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>vector&lt;double&gt; array of band specifications. <literallayout><computeroutput>The band argument is a list of pairs of values, each pair indicating
a resolution shell (in angstrom) and a flag indicating whether the 
following shells should be:
    0: excluded - also the high resolution limit
    1: included in the FOM
    -1: included in the cross-validation FOM
The high resolution limit for the mask is set in the image structure.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 814 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af9ea5aed3caede8ae6e6e223adf35093"/>    <section>
    <title>fspace_fit_B_factor()</title>
<indexterm><primary>fspace_fit_B_factor</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_fit_B_factor</secondary></indexterm>
<para><computeroutput>double Bimage::fspace_fit_B_factor (double res_hi = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Determines the overall B-factor of an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>res_hi</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double B-factor. <literallayout><computeroutput>The input image must a real space image. A radial power spectrum
is calculated and fitted to the linearized version of the function:
    f^2 = scale * F^2 * exp(-B_factor/2 * s^2)
where:
    f:  scattering profile for carbon
    F:  radial average amplitude
    s:  reciprocal space distance
    scale:  arbitrary scale
The linear form of the function is:
    4*(log(f) - log(F)) = 2*log(scale) - B * s^2
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1128 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a39127eceed3818eb3a0e1e59f0d329f3"/>    <section>
    <title>fspace_frequency_filter()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>fspace_frequency_filter</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_frequency_filter</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_frequency_filter (double freq, double sigma)</computeroutput></para><para>

<para>Applies a frequency filter to an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>freq</entry>
                                <entry>
<para>frequency or inverse frequency. </para>
</entry>
                            </row>
                            <row>
                                <entry>sigma</entry>
                                <entry>
<para>gaussian envelope width around frequency. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>If the image is a not a Fourier transform, it is transformed, filtered,
and backtransformed. If the image is a Fourier transform, it is just
filtered.
The filter imposes a guassian envelope at the given frequency.
If the frequency value is greater than one, it is assumed to be given
as the inverse.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 611 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6e20382b67e69755e6db457043a0d396"/>    <section>
    <title>fspace_frequency_filter()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>fspace_frequency_filter</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_frequency_filter</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_frequency_filter (double freq, double sigma, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb)</computeroutput></para><para>

<para>Applies a frequency filter to an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>freq</entry>
                                <entry>
<para>frequency or inverse frequency. </para>
</entry>
                            </row>
                            <row>
                                <entry>sigma</entry>
                                <entry>
<para>gaussian envelope width around frequency. </para>
</entry>
                            </row>
                            <row>
                                <entry>planf</entry>
                                <entry>
<para>forward Fourier transform plan. </para>
</entry>
                            </row>
                            <row>
                                <entry>planb</entry>
                                <entry>
<para>backward Fourier transform plan. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>If the image is a not a Fourier transform, it is transformed, filtered,
and backtransformed. If the image is a Fourier transform, it is just
filtered.
The filter imposes a guassian envelope at the given frequency.
If the frequency value is greater than one, it is assumed to be given
as the inverse.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 640 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3cdd3fb2790fb3c739546f4c95462440"/>    <section>
    <title>fspace_gabor_filter()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>fspace_gabor_filter</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_gabor_filter</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_gabor_filter (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; freq, double fsigma, double psigma)</computeroutput></para><para>

<para>Applies a Gabor filter to an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>freq</entry>
                                <entry>
<para>frequency or inverse frequency location. </para>
</entry>
                            </row>
                            <row>
                                <entry>fsigma</entry>
                                <entry>
<para>gaussian envelope width in the direction of the frequency vector. </para>
</entry>
                            </row>
                            <row>
                                <entry>psigma</entry>
                                <entry>
<para>gaussian envelope width perpendicular to the frequency vector. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>If the image is a not a Fourier transform, it is transformed, filtered,
and backtransformed. If the image is a Fourier transform, it is just
filtered.
The filter imposes a guassian envelope at the given frequency location.
If the frequency vector size is greater than one, it is assumed to be given
as the inverse.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 716 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aece2172a647021b71693e1335a52ad4e"/>    <section>
    <title>fspace_gabor_filter()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>fspace_gabor_filter</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_gabor_filter</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_gabor_filter (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; freq, double fsigma, double psigma, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb)</computeroutput></para><para>

<para>Applies a Gabor filter to an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>freq</entry>
                                <entry>
<para>frequency or inverse frequency direction location. </para>
</entry>
                            </row>
                            <row>
                                <entry>fsigma</entry>
                                <entry>
<para>gaussian envelope width in the direction of the frequency vector. </para>
</entry>
                            </row>
                            <row>
                                <entry>psigma</entry>
                                <entry>
<para>gaussian envelope width perpendicular to the frequency vector. </para>
</entry>
                            </row>
                            <row>
                                <entry>planf</entry>
                                <entry>
<para>forward Fourier transform plan. </para>
</entry>
                            </row>
                            <row>
                                <entry>planb</entry>
                                <entry>
<para>backward Fourier transform plan. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>If the image is a not a Fourier transform, it is transformed, filtered,
and backtransformed. If the image is a Fourier transform, it is just
filtered.
The filter imposes a guassian envelope at the given frequency location.
If the frequency vector size is greater than one, it is assumed to be given
as the inverse.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 746 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a4009dab9defb1ef39feb77371124422f"/>    <section>
    <title>fspace_gradient()</title>
<indexterm><primary>fspace_gradient</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_gradient</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::fspace_gradient (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; sigma)</computeroutput></para><para>

<para>Generates a image with orthogonal gradients encded in 3-value vectors. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>sigma</entry>
                                <entry>
<para>Gaussian sigma values. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The image is Fourier transformed if needed.
An anisotropic weight function is calculated at each voxel and applied to the transform.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1594 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7cc08eed53836fe562577d3a19f24a50"/>    <section>
    <title>fspace_interpolate()</title>
<indexterm><primary>fspace_interpolate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_interpolate</secondary></indexterm>
<para><computeroutput><link linkend="_class_complex">Complex</link>&lt; double &gt; Bimage::fspace_interpolate (long img_num, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; m, <link linkend="_class_f_s_i___kernel">FSI_Kernel</link> * kernel)</computeroutput></para><para>

<para>Calculates the complex value at an image location by kernel-based interpolation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>img_num</entry>
                                <entry>
<para>sub-image number. </para>
</entry>
                            </row>
                            <row>
                                <entry>m</entry>
                                <entry>
<para>location in image. </para>
</entry>
                            </row>
                            <row>
                                <entry>kernel</entry>
                                <entry>
<para>interpolation kernel. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Complex&lt;double&gt; interpolated value. The kernel lookup table must be precalculated. </para>
</formalpara>
</para>
<para>
Definition at line 85 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af2949fc9aeff65845b1c0e64f3cae467"/>    <section>
    <title>fspace_maximum_radius()</title>
<indexterm><primary>fspace_maximum_radius</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_maximum_radius</secondary></indexterm>
<para><computeroutput>long Bimage::fspace_maximum_radius (double resolution, double sampling_ratio = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Calculates the maximum radius in frequency space from a given resolution. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>sampling_ratio</entry>
                                <entry>
<para>frequency space sampling (default 1 pixel/sample). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long maximum radius. <literallayout><computeroutput>The maximum radius is either the physical image size divided by the resolution,
or Nyquist frequency.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 26 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a06dc3d6c69b51aea7926b530e8f963ec"/>    <section>
    <title>fspace_normalize()</title>
<indexterm><primary>fspace_normalize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_normalize</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_normalize ( )</computeroutput></para><para>

<para>Normalizes an image&apos;s amplitudes. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. </para>
</formalpara>
</para>
<para>
Definition at line 1854 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad71a5271e9a56028d01378519f152970"/>    <section>
    <title>fspace_normalize_radial()</title>
<indexterm><primary>fspace_normalize_radial</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_normalize_radial</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_normalize_radial (<link linkend="_class_bimage">Bimage</link> * pmask, double resolution = <computeroutput>0</computeroutput>
, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Normalizes an image&apos;s amplitudes. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>reciprocal space mask (0 &amp; 1, indicating inclusion of structure factors). </para>
</entry>
                            </row>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>flag to calculate power (0) or amplitude (1). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. </para>
</formalpara>
</para>
<para>
Definition at line 1882 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac1fa0fdcb205c13fd845e64285504be8"/>    <section>
    <title>fspace_pack_2D()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>fspace_pack_2D</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_pack_2D</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_pack_2D (<link linkend="_class_bimage">Bimage</link> * p, <link linkend="_class_matrix3">Matrix3</link> mat, double hi_res, double lo_res, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; scale, double part_weight = <computeroutput>1</computeroutput>
, int interp_type = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Packs a 2D Fourier transform into a 3D reciprocal space volume. 
<literallayout>&#160;&#xa;</literallayout>
 </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>2D particle image transform. </para>
</entry>
                            </row>
                            <row>
                                <entry>mat</entry>
                                <entry>
<para>rotation matrix. </para>
</entry>
                            </row>
                            <row>
                                <entry>hi_res</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lo_res</entry>
                                <entry>
<para>low resolution limit (infinite if 0). </para>
</entry>
                            </row>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>scale of reconstruction and particle magnification. </para>
</entry>
                            </row>
                            <row>
                                <entry>part_weight</entry>
                                <entry>
<para>weight of particle (usually 1). </para>
</entry>
                            </row>
                            <row>
                                <entry>interp_type</entry>
                                <entry>
<para>interpolation type (0=nearest neighbor, 1=weighted nearest neigbor, 2=trilinear). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 on error. <literallayout><computeroutput>The rotation matrix is used to determine the plane in reciprocal space
to which the 2D transform data is added. The map is assumed to be cubic
and the 2D transform square. The orientation parameters must be written
into the image structure. 
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 107 of file Bimage_reconstruct.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab10fa82f152bee515c19971d2e8a1994"/>    <section>
    <title>fspace_pack_2D()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>fspace_pack_2D</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_pack_2D</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_pack_2D (<link linkend="_class_bimage">Bimage</link> * p, <link linkend="_class_view">View</link> asu_view, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp; sym, double hi_res, double lo_res, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; scale, double part_weight = <computeroutput>1</computeroutput>
, int interp_type = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Packs a 2D Fourier transform into a 3D reciprocal space volume. 
<literallayout>&#160;&#xa;</literallayout>
 </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>2D particle image transform. </para>
</entry>
                            </row>
                            <row>
                                <entry>asu_view</entry>
                                <entry>
<para>view of asymmetric unit. </para>
</entry>
                            </row>
                            <row>
                                <entry>*sym</entry>
                                <entry>
<para>point group symmetry. </para>
</entry>
                            </row>
                            <row>
                                <entry>hi_res</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lo_res</entry>
                                <entry>
<para>low resolution limit (infinite if 0). </para>
</entry>
                            </row>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>scale of reconstruction and particle magnification. </para>
</entry>
                            </row>
                            <row>
                                <entry>part_weight</entry>
                                <entry>
<para>weight of particle (usually 1). </para>
</entry>
                            </row>
                            <row>
                                <entry>interp_type</entry>
                                <entry>
<para>interpolation type (0=nearest neighbor, 1=weighted nearest neigbor, 2=trilinear). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 on error. <literallayout><computeroutput>The rotation matrix is used to determine the plane in reciprocal space
to which the 2D transform data is added. The map is assumed to be cubic
and the 2D transform square. The orientation parameters must be written
into the image structure.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 174 of file Bimage_reconstruct.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a71b940c547ffc63a3295545992833de9"/>    <section>
    <title>fspace_pack_2D_into_central_section()</title>
<indexterm><primary>fspace_pack_2D_into_central_section</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_pack_2D_into_central_section</secondary></indexterm>
<para><computeroutput>long Bimage::fspace_pack_2D_into_central_section (<link linkend="_class_bimage">Bimage</link> * p, long ft_size, double scale, double hi_res, double lo_res, <link linkend="_class_matrix3">Matrix3</link> matr, <link linkend="_class_matrix3">Matrix3</link> mat)</computeroutput></para><para>

<para>Packs a 2D Fourier transform into a central section of a 3D reciprocal space volume. 
<literallayout>&#160;&#xa;</literallayout>
 </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>2D particle image transform. </para>
</entry>
                            </row>
                            <row>
                                <entry>ft_size</entry>
                                <entry>
<para>Fourier transform size. </para>
</entry>
                            </row>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>scale of reconstruction and particle magnification. </para>
</entry>
                            </row>
                            <row>
                                <entry>hi_res</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lo_res</entry>
                                <entry>
<para>low resolution limit (infinite if 0). </para>
</entry>
                            </row>
                            <row>
                                <entry>matr</entry>
                                <entry>
<para>central section orientation matrix. </para>
</entry>
                            </row>
                            <row>
                                <entry>mat</entry>
                                <entry>
<para>image orientation matrix. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 on error. <literallayout><computeroutput>The rotation matrix is used to determine the plane in reciprocal space
to which the 2D transform data is added in reference to the rotation
matrix of the central section. The map is assumed to be cubic
and the 2D transform square. The orientation parameters must be written
into the image structure. 
</computeroutput></literallayout> </para>
</formalpara>
</para>

<para><link linkend="_class_vector3">Vector3&lt;double&gt;</link> vn(mat[2][0]/mat[2][2], mat[2][1]/mat[2][2], 0);</para>

<para>matr = matr.transpose();</para>

<para>m = mat * iv; m[2] = m.scalar(vn); m = matr * m;</para>
<para>
Definition at line 212 of file Bimage_reconstruct.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab4adb193f4e57c5a3395cfe5da8a3682"/>    <section>
    <title>fspace_pack_3D()</title>
<indexterm><primary>fspace_pack_3D</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_pack_3D</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_pack_3D (<link linkend="_class_bimage">Bimage</link> * p, double hi_res = <computeroutput>0</computeroutput>
, double threshold = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Packs a 3D Fourier transform into a 3D reciprocal space volume. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>3D particle image transform. </para>
</entry>
                            </row>
                            <row>
                                <entry>hi_res</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>threshold to exclude low intensities. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 on error. <literallayout><computeroutput>The image is added up to the high resolution limit and excluding
low intensities as defined by the threshold.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 314 of file Bimage_reconstruct.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3e641a765529eca00a388d3ccda2c5e9"/>    <section>
    <title>fspace_positive()</title>
<indexterm><primary>fspace_positive</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_positive</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_positive ( )</computeroutput></para><para>

<para>Sets the image to positive definite. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. Scales the amplitudes to give a zero (DC) value of one. </para>
</formalpara>
</para>
<para>
Definition at line 1918 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac7365e14f761ca13be325fda8991d3ff"/>    <section>
    <title>fspace_radial()</title>
<indexterm><primary>fspace_radial</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_radial</secondary></indexterm>
<para><computeroutput>vector&lt; double &gt; Bimage::fspace_radial (long nn, long maxrad, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates the radial power spectrum from a Fourier transform. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image number. </para>
</entry>
                            </row>
                            <row>
                                <entry>maxrad</entry>
                                <entry>
<para>maximum radius (i.e., high resolution limit). </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>flag to calculate power (0) or amplitude (1), and not normalize (2). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double* radial power spectrum in the form of a 1D image.</para>
</formalpara>
A radial average of a 2D or 3D Fourier transform is calculated. An interpolative method is used where the value of a voxel is distributed between the two nearest radial annuli. The final sum in an annulus is normalized by the number of voxels contributing to the annulus sum. </para>
<para>
Definition at line 959 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae73ec86061ff431511f6c635c1695b87"/>    <section>
    <title>fspace_radial_power()</title>
<indexterm><primary>fspace_radial_power</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_radial_power</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::fspace_radial_power (double resolution, double sampling_ratio = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Calculates the radial power spectrum from a Fourier transform. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>sampling_ratio</entry>
                                <entry>
<para>frequency space sampling (default 1 pixel/sample). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* radial power spectrum in the form of a 1D image. <literallayout><computeroutput>A radial average of a 2D or 3D Fourier transform is calculated.  
An interpolative method is used where the value of 
a voxel is distributed between the two nearest radial annuli.
The final sum in an annulus is normalized by the number of voxels 
contributing to the annulus sum.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 833 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac80930fd138c661a8728b3a8cb39b72d"/>    <section>
    <title>fspace_reconstruction_add()</title>
<indexterm><primary>fspace_reconstruction_add</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_reconstruction_add</secondary></indexterm>
<para><computeroutput>long Bimage::fspace_reconstruction_add (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Adds all components to a reconstruction. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>frequency space reconstruction to add. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long 0. <literallayout><computeroutput>The FOM block contains the sum of powers, the next image conatins the
weight sum, and the next image FOM block contains the sum of the
weight squared.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 384 of file Bimage_reconstruct.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a4f975f6f05c471150640a20add0acd86"/>    <section>
    <title>fspace_reconstruction_snr()</title>
<indexterm><primary>fspace_reconstruction_snr</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_reconstruction_snr</secondary></indexterm>
<para><computeroutput>long Bimage::fspace_reconstruction_snr ( )</computeroutput></para><para>

<para>Calculates the SNR map. </para>
</para>

<para><formalpara><title>Returns</title>

<para>long coverage. <literallayout><computeroutput>The FOM block contains the sum of powers, the next image conatins the
weight sum, and the next image FOM block contains the sum of the
weight squared.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 536 of file Bimage_reconstruct.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a203259c67bbe3d31b46d9b9f3c923153"/>    <section>
    <title>fspace_reconstruction_stats()</title>
<indexterm><primary>fspace_reconstruction_stats</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_reconstruction_stats</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_reconstruction_stats (double resolution, double sampling_ratio = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Calculates Fourier shell statistics. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>sampling_ratio</entry>
                                <entry>
<para>frequency space sampling (default 1 pixel/sample). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The average FOM and number of FOM values in each resolution shell is determined.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 452 of file Bimage_reconstruct.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a37d5c9685021e104bea5e61dd1b87f60"/>    <section>
    <title>fspace_reconstruction_weigh()</title>
<indexterm><primary>fspace_reconstruction_weigh</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_reconstruction_weigh</secondary></indexterm>
<para><computeroutput>long Bimage::fspace_reconstruction_weigh ( )</computeroutput></para><para>

<para>Weighs a reconstruction. </para>
</para>

<para><formalpara><title>Returns</title>

<para>long coverage. <literallayout><computeroutput>The FOM block contains the sum of powers, the next image conatins the
weight sum, and the next image FOM block contains the sum of the
weight squared.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 412 of file Bimage_reconstruct.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0f425f44f6e885acd68fd329d07edd63"/>    <section>
    <title>fspace_resize()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>fspace_resize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_resize</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::fspace_resize (<link linkend="_class_bimage">Bimage</link> * pref)</computeroutput></para><para>

<para>Resizes an image in frequency space to avoid interpolation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>pref</entry>
                                <entry>
<para>reference. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* resized image. The image is first resized to approximate the real size of the reference map. </para>
</formalpara>
</para>
<para>
Definition at line 253 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7bfe151a39d17ada82c7ca0ed64fd589"/>    <section>
    <title>fspace_resize()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>fspace_resize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_resize</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_resize (double scale, double res_hi, double res_lo)</computeroutput></para><para>

<para>Resizes an image in frequency space to avoid interpolation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>isotropic scaling. </para>
</entry>
                            </row>
                            <row>
                                <entry>res_hi</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>res_lo</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. </para>
</formalpara>
</para>
<para>
Definition at line 202 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2c92e49362a8548a332108661bd83530"/>    <section>
    <title>fspace_scale()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>fspace_scale</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_scale</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_scale (long nn, vector&lt; double &gt; &amp; scale, <link linkend="_class_bimage">Bimage</link> * pmask = <computeroutput>NULL</computeroutput>
)</computeroutput></para><para>
Definition at line 1061 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a4b5d55edda2562384bd08fbb5935a0d8"/>    <section>
    <title>fspace_scale()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>fspace_scale</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_scale</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_scale (vector&lt; double &gt; &amp; scale, <link linkend="_class_bimage">Bimage</link> * pmask = <computeroutput>NULL</computeroutput>
)</computeroutput></para><para>
Definition at line 1043 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a1c83ba28a5aa67dac6558f5cd71b72f5"/>    <section>
    <title>fspace_shift_sum()</title>
<indexterm><primary>fspace_shift_sum</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_shift_sum</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link>* Bimage::fspace_shift_sum ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 1056 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a7da47417a7d1fea0cd6a02cbab87c702"/>    <section>
    <title>fspace_sqrt_amp()</title>
<indexterm><primary>fspace_sqrt_amp</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_sqrt_amp</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_sqrt_amp ( )</computeroutput></para><para>

<para>Change the amlitudes to their square roots. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. </para>
</formalpara>
</para>
<para>
Definition at line 424 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a63076c1fcbd277ad435729c33b5be82f"/>    <section>
    <title>fspace_square_amp()</title>
<indexterm><primary>fspace_square_amp</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_square_amp</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_square_amp ( )</computeroutput></para><para>

<para>Change the amlitudes to their squares. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. </para>
</formalpara>
</para>
<para>
Definition at line 455 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a08afff70db68ac0b93636087899d6992"/>    <section>
    <title>fspace_ssnr()</title>
<indexterm><primary>fspace_ssnr</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_ssnr</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::fspace_ssnr (long nimg, double res_hi, double sampling_ratio)</computeroutput></para><para>
Definition at line 906 of file Bimage_align.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa7cd9416f78181f8d911f70be238ba6c"/>    <section>
    <title>fspace_subset_ssnr()</title>
<indexterm><primary>fspace_subset_ssnr</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_subset_ssnr</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::fspace_subset_ssnr (int subset, double res_hi, double sampling_ratio, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>
Definition at line 1035 of file Bimage_align.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a1dbe36e9969106b1a0761da10681f30b"/>    <section>
    <title>fspace_subset_sums()</title>
<indexterm><primary>fspace_subset_sums</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_subset_sums</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::fspace_subset_sums (int subset, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>
Definition at line 731 of file Bimage_align.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa7cb4ca59bac82d6f9bc9986d82a889c"/>    <section>
    <title>fspace_sum()</title>
<indexterm><primary>fspace_sum</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_sum</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::fspace_sum (int shift = <computeroutput>0</computeroutput>
)</computeroutput></para><para>
Definition at line 689 of file Bimage_align.cpp.</para>
    </section><anchor xml:id="_class_bimage_1adf4c3dbc2ad222e9ff66a5a0c6e4f562"/>    <section>
    <title>fspace_translate()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>fspace_translate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_translate</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_translate (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; shift)</computeroutput></para><para>

<para>Translates an image in frequency space to avoid interpolation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image to transform. </para>
</entry>
                            </row>
                            <row>
                                <entry>shift</entry>
                                <entry>
<para>3-value real space shift vector. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. </para>
</formalpara>
</para>
<para>
Definition at line 175 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8bbfd40bd975c34e1ed4235e58af8dc1"/>    <section>
    <title>fspace_translate()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>fspace_translate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_translate</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_translate (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; shift)</computeroutput></para><para>

<para>Translates an image in frequency space to avoid interpolation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>shift</entry>
                                <entry>
<para>3-value real space shift vector. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. </para>
</formalpara>
</para>
<para>
Definition at line 147 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac56288e974c1a25f146ccd97eb44df38"/>    <section>
    <title>fspace_weigh()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>fspace_weigh</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_weigh</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_weigh (<link linkend="_class_bimage">Bimage</link> * pref, <link linkend="_class_bimage">Bimage</link> * pmask, double resolution = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Weighs an image&apos;s amplitudes with the radial power spectrum of another. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pref</entry>
                                <entry>
<para>reference image. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>reciprocal space mask (0 &amp; 1, indicating inclusion of structure factors). </para>
</entry>
                            </row>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The two images must be of the same dimensions.
The radial power spectra of the two images are calculated
and used to calculate the ratio of the second to the first in each shell.
This ratio is then used to rescale the amplitudes of the first image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1810 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a06f7fe843ce8b5018344741d0023a29e"/>    <section>
    <title>fspace_weigh()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>fspace_weigh</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_weigh</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_weigh (vector&lt; double &gt; &amp; curve, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>
Definition at line 1020 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2bf9851313f15f0e59a4b5c14ed4fc99"/>    <section>
    <title>fspace_weigh_accumulated_dose()</title>
<indexterm><primary>fspace_weigh_accumulated_dose</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_weigh_accumulated_dose</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_weigh_accumulated_dose (vector&lt; double &gt; dose)</computeroutput></para><para>

<para>Weighs an image&apos;s amplitudes with the accumulated dose. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>dose</entry>
                                <entry>
<para>array containing accumulated dose and parameters. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The amplitudes are weighed using:
1. with 2 parameters: the formula of Grant and Grigorieff (2015).
2. with 3 parameters: exponential decay.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1786 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a12f04e97a5999c7e83e130768c25d583"/>    <section>
    <title>fspace_weigh_B_factor()</title>
<indexterm><primary>fspace_weigh_B_factor</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_weigh_B_factor</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_weigh_B_factor (double B, double resolution = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Weighs an image&apos;s amplitudes with B-factor (gaussian) curve. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>B</entry>
                                <entry>
<para>B factor. </para>
</entry>
                            </row>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The image is Fourier transformed and weighed with a gaussian curve:
    Fnew = F*exp(-B*s2/4)
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1317 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a242ffe8b2a4bcc216ae00afb86daca1d"/>    <section>
    <title>fspace_weigh_C_curve()</title>
<indexterm><primary>fspace_weigh_C_curve</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_weigh_C_curve</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_weigh_C_curve (double resolution = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Weighs an image&apos;s amplitudes with the carbon scattering curve. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The image is Fourier transformed and the radial power spectrum calculated.
The ratio between the C curve and the average amplitudes in each shell
is calculated and used to rescale the amplitudes of the image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1360 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2a5148c88a8ffafddb8fef3f10f29b2d"/>    <section>
    <title>fspace_weigh_dose()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>fspace_weigh_dose</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_weigh_dose</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_weigh_dose (double dose_per_frame, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Weighs an image&apos;s amplitudes with the accumulated dose. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>dose_per_frame</entry>
                                <entry>
<para>electron dose per frame. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>0=Grant, 1=exponential decay. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The image is Fourier transformed and the amplitudes weighed using 
the formula of Grant and Grigorieff (2015) or an exponential decay curve.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1722 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aede6de7cbd6febba8dcfde126a052c40"/>    <section>
    <title>fspace_weigh_dose()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>fspace_weigh_dose</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_weigh_dose</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_weigh_dose (long nn, double dose_per_frame, vector&lt; double &gt; critdose)</computeroutput></para><para>
Definition at line 1685 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3729092a9a3df3b1c98ebe7ef91fdfa3"/>    <section>
    <title>fspace_weigh_FSC_curve()</title>
<indexterm><primary>fspace_weigh_FSC_curve</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_weigh_FSC_curve</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_weigh_FSC_curve (<link linkend="_class_bplot">Bplot</link> * plot, double resolution = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Weighs an image&apos;s amplitudes with a given FSC curve. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*plot</entry>
                                <entry>
<para>FSC plot. </para>
</entry>
                            </row>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The image is Fourier transformed and the radial power spectrum calculated.
The ratio between the square root of the FSC curve and the average 
amplitudes in each shell is calculated and used to rescale the amplitudes 
of the image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1493 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2204b62b851a229a9c2cb3489052ae88"/>    <section>
    <title>fspace_weigh_gaussian()</title>
<indexterm><primary>fspace_weigh_gaussian</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_weigh_gaussian</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_weigh_gaussian (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; sigma, int dir = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Weighs an image&apos;s amplitudes with an anisotropic Gaussian function. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image index. </para>
</entry>
                            </row>
                            <row>
                                <entry>sigma</entry>
                                <entry>
<para>Gaussian sigma values. </para>
</entry>
                            </row>
                            <row>
                                <entry>dir</entry>
                                <entry>
<para>derivative direction: 0=none, 1=x, 2=y, 3=z. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The image must be a complex Fourier transform.
An anisotropic weight function is calculated at each voxel and applied to the transform.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1533 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1afda57b400f1708167f2c7e64a60eb78b"/>    <section>
    <title>fspace_weigh_LoG()</title>
<indexterm><primary>fspace_weigh_LoG</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_weigh_LoG</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_weigh_LoG (double resolution, double sigma)</computeroutput></para><para>

<para>Weighs an image&apos;s amplitudes with a Laplacian-of-Gaussian function. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>sigma</entry>
                                <entry>
<para>gaussian sigma. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The image is Fourier transformed and the radial power spectrum calculated.
The ratio between the C curve and the average amplitudes in each shell
is calculated and used to rescale the amplitudes of the image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1395 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a73c972326ebd2d236ec0fcdbc4b0cc5a"/>    <section>
    <title>fspace_weigh_ramp()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>fspace_weigh_ramp</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_weigh_ramp</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_weigh_ramp (double resolution, double axis, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb)</computeroutput></para><para>

<para>Weighs a transform with a ramp. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>axis</entry>
                                <entry>
<para>tilt axis for single tilt series (radians). </para>
</entry>
                            </row>
                            <row>
                                <entry>planf</entry>
                                <entry>
<para>2D forward Fourier transform plan. </para>
</entry>
                            </row>
                            <row>
                                <entry>planb</entry>
                                <entry>
<para>2D backward Fourier transform plan. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>Requirements:
    The data must be complex float and the FOM block must be allocated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1258 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aac65275f18cb7d8ffa4e11acdc15e10d"/>    <section>
    <title>fspace_weigh_ramp()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>fspace_weigh_ramp</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_weigh_ramp</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_weigh_ramp (double resolution, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb)</computeroutput></para><para>

<para>Weighs a transform with a ramp. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>planf</entry>
                                <entry>
<para>2D forward Fourier transform plan. </para>
</entry>
                            </row>
                            <row>
                                <entry>planb</entry>
                                <entry>
<para>2D backward Fourier transform plan. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>Requirements:
    The data must be complex float and the FOM block must be allocated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1196 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac7decddf1751331d158e46c8eaefef00"/>    <section>
    <title>fspace_weigh_RPS_curve()</title>
<indexterm><primary>fspace_weigh_RPS_curve</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>fspace_weigh_RPS_curve</secondary></indexterm>
<para><computeroutput>int Bimage::fspace_weigh_RPS_curve (<link linkend="_class_bplot">Bplot</link> * plot, double resolution = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Weighs an image&apos;s amplitudes with a given RPS curve. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*plot</entry>
                                <entry>
<para>RPS plot. </para>
</entry>
                            </row>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The image is Fourier transformed and the radial power spectrum calculated.
The ratio between the square root of the RPS curve and the average 
amplitudes in each shell is calculated and used to rescale the amplitudes 
of the image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1436 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8b232571fb7ecd9f8304a39fc16a5fab"/>    <section>
    <title>gaussian_sphere()</title>
<indexterm><primary>gaussian_sphere</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>gaussian_sphere</secondary></indexterm>
<para><computeroutput>int Bimage::gaussian_sphere (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; center, double sigma, double amp)</computeroutput></para><para>

<para>Fills a gaussian sphere within an image with a uniform value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>center</entry>
                                <entry>
<para>center of sphere. </para>
</entry>
                            </row>
                            <row>
                                <entry>sigma</entry>
                                <entry>
<para>Gaussian sigma value. </para>
</entry>
                            </row>
                            <row>
                                <entry>amp</entry>
                                <entry>
<para>amplitude. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>All voxels within a sphere at a given location and with a given radius 
are increased by a given fill value.
The new data replaces the old data.
The default center is {0,0,0}.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 566 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a26b30eb05be0db04eb94f479bbd7703b"/>    <section>
    <title>get()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>get</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>get</secondary></indexterm>
<para><computeroutput>void Bimage::get (<link linkend="_class_bstring">Bstring</link> tag)</computeroutput></para><para>

<para>Prints out header information associated with a tag string. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>tag</entry>
                                <entry>
<para>tag string. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 2741 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa3fe0a2bedf7cd2fa732e4af2fbcb8fe"/>    <section>
    <title>get()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>get</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>get</secondary></indexterm>
<para><computeroutput>double Bimage::get (long nn, long xx, long yy, long zz, long cc = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Returns the data value at the given coordinates. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image index. </para>
</entry>
                            </row>
                            <row>
                                <entry>xx</entry>
                                <entry>
<para>x coordinate. </para>
</entry>
                            </row>
                            <row>
                                <entry>yy</entry>
                                <entry>
<para>y coordinate. </para>
</entry>
                            </row>
                            <row>
                                <entry>zz</entry>
                                <entry>
<para>z coordinate. </para>
</entry>
                            </row>
                            <row>
                                <entry>cc</entry>
                                <entry>
<para>channel index. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double value. <literallayout><computeroutput>The elemental data value is returned in double precision.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 969 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa9cbc0cc1004deca981a0b5b20850c20"/>    <section>
    <title>get()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>get</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>get</secondary></indexterm>
<para><computeroutput>double Bimage::get (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; vox, long cc = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Returns the data value at the given coordinates. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image index. </para>
</entry>
                            </row>
                            <row>
                                <entry>vox</entry>
                                <entry>
<para>voxel coordinates. </para>
</entry>
                            </row>
                            <row>
                                <entry>cc</entry>
                                <entry>
<para>channel index. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double value. <literallayout><computeroutput>The elemental data value is returned in double precision.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 991 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af8bea4ff8e105e0aaf25beebd5207fc4"/>    <section>
    <title>get_localtime()</title>
<indexterm><primary>get_localtime</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>get_localtime</secondary></indexterm>
<para><computeroutput>tm* Bimage::get_localtime ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 255 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a8bdc58228bbe84e0c029c347d0c61c9f"/>    <section>
    <title>get_time()</title>
<indexterm><primary>get_time</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>get_time</secondary></indexterm>
<para><computeroutput>time_t Bimage::get_time ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 251 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a54ca5f2052e28406522cd592d4a311e6"/>    <section>
    <title>gradient()</title>
<indexterm><primary>gradient</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>gradient</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::gradient ( )</computeroutput></para><para>

<para>Calculates the central difference gradient image. </para>
</para>

<para><formalpara><title>Returns</title>

<para>Bimage* an image with 3-value gradient vectors. <literallayout><computeroutput>The central differences are calculated in the three orthogonal
directions and written into 3-value vectors.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 252 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a68fe6231d0f7ea94af7f610a02827580"/>    <section>
    <title>gradient3x3()</title>
<indexterm><primary>gradient3x3</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>gradient3x3</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::gradient3x3 ( )</computeroutput></para><para>

<para>Calculates the difference gradient image in a 3x3 kernel. </para>
</para>

<para><formalpara><title>Returns</title>

<para>Bimage* an image with 3-value gradient vectors. <literallayout><computeroutput>The central differences are calculated in the three orthogonal
directions and written into 3-value vectors.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 336 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a92a98004da23cb718e3e039f2ae130f9"/>    <section>
    <title>gradient_correction()</title>
<indexterm><primary>gradient_correction</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>gradient_correction</secondary></indexterm>
<para><computeroutput>int Bimage::gradient_correction ( )</computeroutput></para><para>

<para>Calculates and corrects for a linear gradient across an image. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The linear gradient across an image is calculated as:
    density(x,y,z) = b0 + b1*x + b2*y + b3*z
The image is converted to floating point and corrected for the gradient.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 783 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3e7e93591778f6edd9ac10c841202b58"/>    <section>
    <title>graph_segment()</title>
<indexterm><primary>graph_segment</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>graph_segment</secondary></indexterm>
<para><computeroutput><link linkend="_class_g_sgraph">GSgraph</link> Bimage::graph_segment (int type = <computeroutput>1</computeroutput>
, int connect_type = <computeroutput>0</computeroutput>
, double complexity = <computeroutput>0</computeroutput>
, long min_size = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Graph-based segmentation of an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>type</entry>
                                <entry>
<para>segmentation type: 1=threshold, 2=statistical region merging. </para>
</entry>
                            </row>
                            <row>
                                <entry>connect_type</entry>
                                <entry>
<para>connection type: 0=direct neighbors, 1=all neighbors. </para>
</entry>
                            </row>
                            <row>
                                <entry>complexity</entry>
                                <entry>
<para>a value determining the number of segments. </para>
</entry>
                            </row>
                            <row>
                                <entry>min_size</entry>
                                <entry>
<para>minimum segment size. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para><link linkend="_class_g_sgraph">GSgraph</link> graph with segment designations. <literallayout><computeroutput>An array of edges between neighboring voxels is set up and sorted in
non-decreasing order. The voxels are then aggregated into regions based
on two selectable criteria:
simple      edge difference with adjustable threshold.
srm         statistical region merging.
Regions below a given cutoff size are merged.
Only the first sub-image is segmented.
</computeroutput></literallayout> </para>
</formalpara>
<formalpara><title>Remarks</title>

<para>R. Nock, F. Nielsen: Statistical Region Merging. IEEE Trans. Pattern Anal. Mach. Intell. 26(11): 1452-1458 (2004) </para>
</formalpara>
</para>
<para>
Definition at line 1380 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a51056d0e235ae01a7ed58427a1c204ef"/>    <section>
    <title>graph_segments_to_image()</title>
<indexterm><primary>graph_segments_to_image</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>graph_segments_to_image</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::graph_segments_to_image (<link linkend="_class_g_sgraph">GSgraph</link> &amp; g)</computeroutput></para><para>

<para>Converting a graph-based segmentation to an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>g</entry>
                                <entry>
<para>graph segmentation. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* segmented image. </para>
</formalpara>
</para>
<para>
Definition at line 1451 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aca8566ad6dc2ec1f6545904b0be3b463"/>    <section>
    <title>graph_segments_to_mask()</title>
<indexterm><primary>graph_segments_to_mask</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>graph_segments_to_mask</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::graph_segments_to_mask (<link linkend="_class_g_sgraph">GSgraph</link> &amp; g)</computeroutput></para><para>

<para>Converting a graph-based segmentation to a multi-level mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>g</entry>
                                <entry>
<para>graph segmentation. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* segmented image. </para>
</formalpara>
</para>
<para>
Definition at line 1478 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a092cc4d52f3a396c699f83dcbd4a2ad4"/>    <section>
    <title>graph_setup()</title>
<indexterm><primary>graph_setup</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>graph_setup</secondary></indexterm>
<para><computeroutput><link linkend="_class_g_sgraph">GSgraph</link> Bimage::graph_setup (int connect_type)</computeroutput></para><para>

<para>Initializing voxels and edges for graph-based segmentation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>connect_type</entry>
                                <entry>
<para>connection type: 0=direct neighbors, 1=all neighbors. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para><link linkend="_class_g_sgraph">GSgraph</link> graph with segment designations. </para>
</formalpara>
<formalpara><title>Remarks</title>

<para>R. Nock, F. Nielsen: Statistical Region Merging. IEEE Trans. Pattern Anal. Mach. Intell. 26(11): 1452-1458 (2004)</para>
</formalpara>
Edges are set up with 6 or 26 neighbors. </para>
<para>
Definition at line 1298 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a9d6a9ea88106962dc7045dc5d21437e2"/>    <section>
    <title>guess_compoundtype()</title>
<indexterm><primary>guess_compoundtype</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>guess_compoundtype</secondary></indexterm>
<para><computeroutput><link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> Bimage::guess_compoundtype (long nc)</computeroutput></para><para>
Definition at line 324 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a89fe20c911fb2f64e13e285720a6f37c"/>    <section>
    <title>hanning_taper()</title>
<indexterm><primary>hanning_taper</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>hanning_taper</secondary></indexterm>
<para><computeroutput>int Bimage::hanning_taper (double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Apply Hanning taper window to the image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value of edge voxels. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>Along each dimension, the image is multiplied with a function:
    v_new(i) = fill + ( v_old(i) - fill )* 0.5 * ( 1 - cos( 2*PI*i/(n-1) )) i=0,...,n-1
where   fill is the desired edge value.
        n is the size of the image
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 460 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a53f0e717f7eb6d7cbe3282a752872ca3"/>    <section>
    <title>height()</title>
<indexterm><primary>height</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>height</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::height (<link linkend="_class_view">View</link> * views, double threshold = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates a set of height images from a 3D density map. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*views</entry>
                                <entry>
<para>linked list of views. </para>
</entry>
                            </row>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>density threshold to consider as object. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* 2D height images as sub-images. <literallayout><computeroutput>A set of height images is calculated according to a list of views.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 230 of file Bimage_topo.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7ce50ec5b49ecf11d7dca124c6a85b90"/>    <section>
    <title>helical_cross_section()</title>
<indexterm><primary>helical_cross_section</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>helical_cross_section</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::helical_cross_section (double helix_rise, double helix_angle, double scale, double hires)</computeroutput></para><para>

<para>Calculates a helical cross section from line transforms of a filament. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>helix_rise</entry>
                                <entry>
<para>helical subunit rise in angstrom. </para>
</entry>
                            </row>
                            <row>
                                <entry>helix_angle</entry>
                                <entry>
<para>helical subunit rotation in radians. </para>
</entry>
                            </row>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>scale of cross section. </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* 2D cross section image. <literallayout><computeroutput>The filament image must be oriented with the helical axis coinciding with 
the y axis. Each row of pixels is transformed and written into a
2D transform based on an orientation calculated from given helical
parameters.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1421 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1acf2838d721c0aacfa1d4368509813bb1"/>    <section>
    <title>helix_interpolate()</title>
<indexterm><primary>helix_interpolate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>helix_interpolate</secondary></indexterm>
<para><computeroutput>double Bimage::helix_interpolate (long i, double helix_rise, double helix_angle, int zmin, int zmax, double radius, int norm_flag = <computeroutput>1</computeroutput>
)</computeroutput></para><para>
Definition at line 18 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6080c797d3cb69253b985303271e080e"/>    <section>
    <title>helix_segment_correlation()</title>
<indexterm><primary>helix_segment_correlation</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>helix_segment_correlation</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::helix_segment_correlation (int thickness, double angle_start, double angle_end, double angle_step, int bin, double hires, double lores, double radius)</computeroutput></para><para>

<para>Calculates the correlation over rotation angles between helical segments. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>thickness</entry>
                                <entry>
<para>segment thickness. </para>
</entry>
                            </row>
                            <row>
                                <entry>angle_start</entry>
                                <entry>
<para>start value for angle. </para>
</entry>
                            </row>
                            <row>
                                <entry>angle_end</entry>
                                <entry>
<para>end value for angle. </para>
</entry>
                            </row>
                            <row>
                                <entry>angle_step</entry>
                                <entry>
<para>step size for angle. </para>
</entry>
                            </row>
                            <row>
                                <entry>bin</entry>
                                <entry>
<para>bin image for faster searching (limited to 1,2,3). </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit in angstroms. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit in angstroms. </para>
</entry>
                            </row>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>radius for mask (voxels). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bplot* plot with coefficients over all rotations results. <literallayout><computeroutput>The image is split up into segments in the z direction. Every adjacent pair
of segments are cross-correlated over an angular range to find the best
rotation. The cross-correlation can be resolution-limited. The image may
also be masked beyond a radius and binned to speed up execution.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1240 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2a9eb9c30f80919647fbcd1626f5c611"/>    <section>
    <title>helix_segment_correlation_one()</title>
<indexterm><primary>helix_segment_correlation_one</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>helix_segment_correlation_one</secondary></indexterm>
<para><computeroutput>int Bimage::helix_segment_correlation_one (long i, double angle_start, double angle_end, double angle_step, int bin, double hires, double lores, double radius, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb, double * cc)</computeroutput></para><para>
Definition at line 1198 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a006beeeff826f2c0cc1842f9b0a68ff2"/>    <section>
    <title>helix_symmetrize()</title>
<indexterm><primary>helix_symmetrize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>helix_symmetrize</secondary></indexterm>
<para><computeroutput>double Bimage::helix_symmetrize (double helix_rise, double helix_angle, int dyad_axis, int zmin, int zmax, double radius, int norm_flag = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Symmetrizes an image given helical symmetry parameters. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>helix_rise</entry>
                                <entry>
<para>rise per asymmetric unit (angstrom). </para>
</entry>
                            </row>
                            <row>
                                <entry>helix_angle</entry>
                                <entry>
<para>rotation angle per asymmetric unit (radians). </para>
</entry>
                            </row>
                            <row>
                                <entry>dyad_axis</entry>
                                <entry>
<para>dyad axis indicator: 2=dyad axis on x-axis, otherwise none. </para>
</entry>
                            </row>
                            <row>
                                <entry>zmin</entry>
                                <entry>
<para>mimimum z slice to include. </para>
</entry>
                            </row>
                            <row>
                                <entry>zmax</entry>
                                <entry>
<para>maximum z slice to include. </para>
</entry>
                            </row>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>radius to do symmetrizing over (pixels). </para>
</entry>
                            </row>
                            <row>
                                <entry>norm_flag</entry>
                                <entry>
<para>if 1, normalize </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double R factor. <literallayout><computeroutput>The data between the z limits are replicated along the helical axis
according to the helical rise and rotation to fill the new volume.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 133 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6bde5665ebee734c283db7db9c99b74f"/>    <section>
    <title>histogram()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>histogram</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>histogram</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::histogram (long bins)</computeroutput></para><para>

<para>Calculates the histogram of an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>bins</entry>
                                <entry>
<para>number of bins in the histogram. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bplot* 0. <literallayout><computeroutput>A histogram of an image is calculated with a given number of bins.
Multiple channels are output as successive one-dimensional arrays.
The image data is not affected.
The statistics for the input image must be correctly calculated.
If the postscript file name is given, a postscript plot is produced.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 82 of file Bimage_histogram.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab85f1d0fdde7701db60b1b62833ffefd"/>    <section>
    <title>histogram()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>histogram</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>histogram</secondary></indexterm>
<para><computeroutput>vector&lt; long &gt; Bimage::histogram (long bins, double &amp; scale, double &amp; offset)</computeroutput></para><para>

<para>Calculates the histogram of an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>bins</entry>
                                <entry>
<para>number of bins in the histogram. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;scale</entry>
                                <entry>
<para>scale. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;offset</entry>
                                <entry>
<para>offset. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>vector&lt;long&gt; histogram. <literallayout><computeroutput>A histogram of an image is calculated with a given number of bins.
Multiple channels are output as successive one-dimensional arrays.
The image data is not affected.
The statistics for the input image must be correctly calculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 33 of file Bimage_histogram.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa2eff813946f4af3af738ae4bfd4f0b9"/>    <section>
    <title>histogram_counts()</title>
<indexterm><primary>histogram_counts</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>histogram_counts</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::histogram_counts (int flags = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Finds the peaks in a quantized image from the histogram. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>flags</entry>
                                <entry>
<para>1=plot, 2=convert image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bplot* plot of fits. <literallayout><computeroutput>A histogram of an image with quantized data is calculated.
The peaks are determined and the image converted.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 206 of file Bimage_histogram.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6d0ea79752667dd909d5becad0eec7ae"/>    <section>
    <title>histogram_gauss_fit()</title>
<indexterm><primary>histogram_gauss_fit</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>histogram_gauss_fit</secondary></indexterm>
<para><computeroutput>vector&lt; double &gt; Bimage::histogram_gauss_fit (long bins, long ngauss = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Fits a gaussian function to a histogram of an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>bins</entry>
                                <entry>
<para>number of bins in the histogram. </para>
</entry>
                            </row>
                            <row>
                                <entry>ngauss</entry>
                                <entry>
<para>number of gaussians. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>vector&lt;double&gt; array with 3 values for each gaussian. <literallayout><computeroutput>A histogram of an image is calculated with a given number of bins.
The return has (in order) the gaussian amplitude, the offset, and the sigma value.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 910 of file Bimage_histogram.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aacf99ed74e096630cc1d98601ae73d6b"/>    <section>
    <title>histogram_gauss_fit2()</title>
<indexterm><primary>histogram_gauss_fit2</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>histogram_gauss_fit2</secondary></indexterm>
<para><computeroutput>vector&lt; double &gt; Bimage::histogram_gauss_fit2 (long bins, long ngauss = <computeroutput>1</computeroutput>
)</computeroutput></para><para>
Definition at line 1016 of file Bimage_histogram.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae3183f34921b1302daac2ef214bd0fbf"/>    <section>
    <title>histogram_gauss_plot()</title>
<indexterm><primary>histogram_gauss_plot</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>histogram_gauss_plot</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::histogram_gauss_plot (long bins, long ngauss = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Fits a gaussian function to a histogram of an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>bins</entry>
                                <entry>
<para>number of bins in the histogram. </para>
</entry>
                            </row>
                            <row>
                                <entry>ngauss</entry>
                                <entry>
<para>number of gaussians. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bplot* plot of the histogram and the gaussian fit. <literallayout><computeroutput>A histogram of an image is calculated with a given number of bins.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1115 of file Bimage_histogram.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aad7b63e6c18d1efbd0e152a9d88aaa47"/>    <section>
    <title>histogram_minmax()</title>
<indexterm><primary>histogram_minmax</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>histogram_minmax</secondary></indexterm>
<para><computeroutput>int Bimage::histogram_minmax (double &amp; tmin, double &amp; tmax)</computeroutput></para><para>

<para>Calculates minimum and maximum thresholds for truncation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>&amp;tmin</entry>
                                <entry>
<para>minumum threshold. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;tmax</entry>
                                <entry>
<para>maxumum threshold. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>A histogram of an image is calculated.  The first minimum in the first
quarter of the histogram and the last minimum in the last quarter
are taken to define the small and large outliers.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 542 of file Bimage_histogram.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a24ee47d4e71e12e5d0572b3d57dbc048"/>    <section>
    <title>histogram_multi_thresholds()</title>
<indexterm><primary>histogram_multi_thresholds</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>histogram_multi_thresholds</secondary></indexterm>
<para><computeroutput>vector&lt; double &gt; Bimage::histogram_multi_thresholds (long bins, long number)</computeroutput></para><para>

<para>Calculates multiple thresholds from a histogram. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>bins</entry>
                                <entry>
<para>number bins in histogram. </para>
</entry>
                            </row>
                            <row>
                                <entry>number</entry>
                                <entry>
<para>number of clusters (one more than thresholds). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>vector&lt;double&gt; thresholds. <literallayout><computeroutput>Reference: PS.Liao, TS.Chen, and PC. Chung,
       Journal of Information Science and Engineering, vol 17, 713-727 (2001)
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 854 of file Bimage_histogram.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a17118ec3a626445c87adb236a8fd69ca"/>    <section>
    <title>histogram_otsu_variance()</title>
<indexterm><primary>histogram_otsu_variance</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>histogram_otsu_variance</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::histogram_otsu_variance (long bins)</computeroutput></para><para>

<para>Calculates the inter-set variance of the bisection of a historgram using the method of Otsu. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>bins</entry>
                                <entry>
<para>number bins in histogram. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double threshold. <literallayout><computeroutput>Reference: NOBUYUKI OTSU, IEEE TRANSACTIONS ON SYSTEMS, MAN, AND CYBERNETICS, VOL. SMC-9, NO. 1, JANUARY 1979
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 644 of file Bimage_histogram.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a1ab66dfa88e4a41d2c23d6ce3dc50b1e"/>    <section>
    <title>histogram_poisson_fit()</title>
<indexterm><primary>histogram_poisson_fit</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>histogram_poisson_fit</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::histogram_poisson_fit (long bins, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Fits a poisson function to a histogram of an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>bins</entry>
                                <entry>
<para>number of bins in the histogram. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>1=plot. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bplot* plot of the histogram and the poisson fit. <literallayout><computeroutput>A histogram of an image is calculated with a given number of bins.
The histogram is fit to the Poisson function:
               lambda * exp(-lambda)
    f(x) = Amp ---------------------
                        x!
by first converting it to a linear form:
    ln(f(x)) = ln(Amp) + x*ln(lambda) - lambda - lgamma(x+1)
and then using the downhill simplex method to find the solution.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1390 of file Bimage_histogram.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6a5b897839510f5387f40489d9465941"/>    <section>
    <title>histomatch()</title>
<indexterm><primary>histomatch</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>histomatch</secondary></indexterm>
<para><computeroutput>int Bimage::histomatch (<link linkend="_class_bimage">Bimage</link> * p, long bins)</computeroutput></para><para>

<para>Fits two images by matching the histogram of the second to the first. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>second image. </para>
</entry>
                            </row>
                            <row>
                                <entry>bins</entry>
                                <entry>
<para>number of bins in the histograms. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 if error. <literallayout><computeroutput>Both images are converted to floating point.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 615 of file Bimage_combine.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae1ba104935f68613cb8e63066015dc46"/>    <section>
    <title>identifier()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>identifier</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>identifier</secondary></indexterm>
<para><computeroutput><link linkend="_class_bstring">Bstring</link>&amp; Bimage::identifier ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 218 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1ab7bdc9cb92f3deebd4cd66188048fea6"/>    <section>
    <title>identifier()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>identifier</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>identifier</secondary></indexterm>
<para><computeroutput>void Bimage::identifier (<link linkend="_class_bstring">Bstring</link> s)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 217 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a273fc6371ef29fae7e1150552334b262"/>    <section>
    <title>image_size()</title>
<indexterm><primary>image_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>image_size</secondary></indexterm>
<para><computeroutput>long Bimage::image_size ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 285 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1ac5f3b612ae93528dca78ca1641e1f2b6"/>    <section>
    <title>images()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>images</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>images</secondary></indexterm>
<para><computeroutput>long Bimage::images ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 507 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1aeb76d8399487a3d520985726e25ae3a0"/>    <section>
    <title>images()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>images</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>images</secondary></indexterm>
<para><computeroutput>void Bimage::images (long nn)</computeroutput></para><para>
Definition at line 369 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1acb066a1d47146efdaf38df32adb0574a"/>    <section>
    <title>images_to_channels()</title>
<indexterm><primary>images_to_channels</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>images_to_channels</secondary></indexterm>
<para><computeroutput>int Bimage::images_to_channels (long nc, <link linkend="_utilities_8h_1a768a6f0a6fd7e9087ff7971abbcc3f36">CompoundType</link> ct)</computeroutput></para>    </section><anchor xml:id="_class_bimage_1a678987573053e7625c499abc35a7e817"/>    <section>
    <title>images_to_slices()</title>
<indexterm><primary>images_to_slices</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>images_to_slices</secondary></indexterm>
<para><computeroutput>int Bimage::images_to_slices ( )</computeroutput></para><para>

<para>Changes the 2D images to slices in a 3D image. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int error code (&lt;0 means failure). </para>
</formalpara>
</para>
<para>
Definition at line 2152 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae3d5f0fe96415e7d334ab657393b7f21"/>    <section>
    <title>impose_superpixels()</title>
<indexterm><primary>impose_superpixels</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>impose_superpixels</secondary></indexterm>
<para><computeroutput>int Bimage::impose_superpixels (<link linkend="_class_bimage">Bimage</link> * pmask, vector&lt; <link linkend="_class_bsuperpixel">Bsuperpixel</link> &gt; &amp; seg, int impose)</computeroutput></para><para>

<para>Impose superpixel features onto an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>mask defining superpixels. </para>
</entry>
                            </row>
                            <row>
                                <entry>seg</entry>
                                <entry>
<para>array of superpixels. </para>
</entry>
                            </row>
                            <row>
                                <entry>impose</entry>
                                <entry>
<para>flag to select feature </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>0 . <literallayout><computeroutput>Features to select:
0   none
1   segment average
2   lowest neighboring segment
3   difference from lowest neighbor
4   higest neigboring segment
5   difference from highest neighbor
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1992 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa40279a9386d8c571cf573ec7f2c328f"/>    <section>
    <title>index()<computeroutput>[1/6]</computeroutput></title>
<indexterm><primary>index</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>index</secondary></indexterm>
<para><computeroutput>long Bimage::index (long nc, long nx, long ny, long nz, long nn) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 400 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a760143d3cb8fd5d6e1245ecd215821a2"/>    <section>
    <title>index()<computeroutput>[2/6]</computeroutput></title>
<indexterm><primary>index</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>index</secondary></indexterm>
<para><computeroutput>long Bimage::index (long nx, long ny) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 391 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a3ce1e553efbc68da56f446626a005142"/>    <section>
    <title>index()<computeroutput>[3/6]</computeroutput></title>
<indexterm><primary>index</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>index</secondary></indexterm>
<para><computeroutput>long Bimage::index (long nx, long ny, long nz) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 394 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a6114a3346ee83eed50e799fd887c1302"/>    <section>
    <title>index()<computeroutput>[4/6]</computeroutput></title>
<indexterm><primary>index</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>index</secondary></indexterm>
<para><computeroutput>long Bimage::index (long nx, long ny, long nz, long nn) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 397 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a83754238aa74181ac04e7effd55b1e5f"/>    <section>
    <title>index()<computeroutput>[5/6]</computeroutput></title>
<indexterm><primary>index</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>index</secondary></indexterm>
<para><computeroutput>long Bimage::index (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; vox, long nn) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 403 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1aed40effbf49e57048e306d2df8f24177"/>    <section>
    <title>index()<computeroutput>[6/6]</computeroutput></title>
<indexterm><primary>index</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>index</secondary></indexterm>
<para><computeroutput>long Bimage::index (vector&lt; long &gt; vox, long nn) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 406 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1abd88814c41f2c26ecdfef9febc8c1b42"/>    <section>
    <title>index_wrap()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>index_wrap</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>index_wrap</secondary></indexterm>
<para><computeroutput>long Bimage::index_wrap (long nx, long ny, long nz) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 409 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a44270f08caaa5aced16a390e07cc34d3"/>    <section>
    <title>index_wrap()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>index_wrap</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>index_wrap</secondary></indexterm>
<para><computeroutput>long Bimage::index_wrap (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; coor) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 418 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a9b5df5f5d1d2702085b6f2cc958fb5e8"/>    <section>
    <title>index_wrap()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>index_wrap</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>index_wrap</secondary></indexterm>
<para><computeroutput>long Bimage::index_wrap (vector&lt; long &gt; coor) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 421 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1ad034e4aef862674587ca3e5f83d50a06"/>    <section>
    <title>information()</title>
<indexterm><primary>information</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>information</secondary></indexterm>
<para><computeroutput>int Bimage::information ( )</computeroutput></para><para>

<para>Prints out header information for an image. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int error code (&lt;0 means failure). </para>
</formalpara>
</para>
<para>
Definition at line 2571 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a42bc0d2d19d1c538cd9680c101d9a780"/>    <section>
    <title>integer_interpolation()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>integer_interpolation</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>integer_interpolation</secondary></indexterm>
<para><computeroutput>int Bimage::integer_interpolation (int integer_factor)</computeroutput></para><para>
Definition at line 16 of file Bimage_bin.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a671612e813fa45a25abde953884831cc"/>    <section>
    <title>integer_interpolation()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>integer_interpolation</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>integer_interpolation</secondary></indexterm>
<para><computeroutput>int Bimage::integer_interpolation (int integer_factor, int odd)</computeroutput></para><para>

<para>Interpolates by an integer scale with a density-preserving overlapping kernel. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>integer_factor</entry>
                                <entry>
<para>integer interpolation factor. </para>
</entry>
                            </row>
                            <row>
                                <entry>odd</entry>
                                <entry>
<para>flag to ensure the dimensions are odd. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>An image is interpolated by integer scaling (i.e., 2, 3, 4-fold or 
more) sometimes referred to as a form of binning.  A kernel is used
such that it overlaps with its neighbouring positions.  Voxels where
neighbouring kernel positions overlap contribute to 2, 4 or 8 new
voxels based on the number of overlapping kernel positions.  Only
the central voxel is unique to a kernel position.  The kernel is 
calculated as:
    w(i,j,k) = (1/s^2n)*(s-|s-1-i|)*(s-|s-1-j|)*(s-|s-1-k|)
where   s is the integer interpolation factor.
        n is the number of dimensions (1D, 2D or 3D).
The flag determines whether the dimensions are forced to be even or odd:
    0       No forcing
    1       x odd
    2       x even
    4       y odd
    8       y even
    16      z odd
    32      z even
    21      all odd
    42      all even
and any other combination.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 50 of file Bimage_bin.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa7b16ff07227b448151d6b73c572451a"/>    <section>
    <title>intensities_phase_colored()</title>
<indexterm><primary>intensities_phase_colored</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>intensities_phase_colored</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::intensities_phase_colored (double scale)</computeroutput></para><para>

<para>Generates a power spectrum with phases colored according to a color wheel. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>amplitude scaling. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* color power spectrum. <literallayout><computeroutput>A polar data type image (such as a Fourier transform) is converted
to indicate the phases as colors. The primary colors are located
0 degrees (red), 120 degrees (green) and -120 degrees (blue). All
three color values are down-weighted based on the amplitude. The
weighting is calculated as:
    weight = amplitude/(average+2*standard_deviation)
The origin specified in the image is used to shift the phases.
The scale is multiplied with the amplitude and cut off at one
to give the user the ability to enhance the image.
Default:
    scale = 1/(average_amplitude + standard_deviation_of_amplitude) 
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1428 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a1514d68d5b4b97a826bca033250c4926"/>    <section>
    <title>internal_volume()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>internal_volume</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>internal_volume</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::internal_volume (double threshold)</computeroutput></para><para>

<para>Calculates the internal volume of a shell. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>threshold to define density. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* internal volume mask. </para>
</formalpara>
</para>
<para>
Definition at line 1009 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a42d2caa457d42a0e1991e63ac4dcf82a"/>    <section>
    <title>internal_volume()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>internal_volume</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>internal_volume</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::internal_volume (double threshold, int mask_out_freq)</computeroutput></para><para>

<para>Calculates the internal volume of a shell. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>threshold to define density. </para>
</entry>
                            </row>
                            <row>
                                <entry>mask_out_freq</entry>
                                <entry>
<para>mask output frequency. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* internal volume mask. </para>
</formalpara>
</para>
<para>
Definition at line 1079 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a846421e8a35109bb1f20dbe772ccc677"/>    <section>
    <title>interpolate()<computeroutput>[1/5]</computeroutput></title>
<indexterm><primary>interpolate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>interpolate</secondary></indexterm>
<para><computeroutput>double Bimage::interpolate (double xx, double yy = <computeroutput>0</computeroutput>
, double zz = <computeroutput>0</computeroutput>
, long nn = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 327 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a42ed6903b8c8e716f55c8bd7d884c9b0"/>    <section>
    <title>interpolate()<computeroutput>[2/5]</computeroutput></title>
<indexterm><primary>interpolate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>interpolate</secondary></indexterm>
<para><computeroutput>double Bimage::interpolate (long cc, double xx, double yy = <computeroutput>0</computeroutput>
, double zz = <computeroutput>0</computeroutput>
, long nn = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
) const</computeroutput></para><para>

<para>Interpolates using a given location. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>cc</entry>
                                <entry>
<para>channel. </para>
</entry>
                            </row>
                            <row>
                                <entry>xx</entry>
                                <entry>
<para>x location. </para>
</entry>
                            </row>
                            <row>
                                <entry>yy</entry>
                                <entry>
<para>y location. </para>
</entry>
                            </row>
                            <row>
                                <entry>zz</entry>
                                <entry>
<para>z location. </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>fill value if outside boundaries. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double interpolated value. <literallayout><computeroutput>Trilinear interpolation.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1423 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3fb5f320d3082349fa4706966eb1af6c"/>    <section>
    <title>interpolate()<computeroutput>[3/5]</computeroutput></title>
<indexterm><primary>interpolate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>interpolate</secondary></indexterm>
<para><computeroutput>double Bimage::interpolate (long cc, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec, long nn = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 331 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1aa2f7ba2720f2852ee89d471b885f03cb"/>    <section>
    <title>interpolate()<computeroutput>[4/5]</computeroutput></title>
<indexterm><primary>interpolate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>interpolate</secondary></indexterm>
<para><computeroutput>double Bimage::interpolate (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec, long nn = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 335 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a5bdece81eeb52253229885c3911d4316"/>    <section>
    <title>interpolate()<computeroutput>[5/5]</computeroutput></title>
<indexterm><primary>interpolate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>interpolate</secondary></indexterm>
<para><computeroutput>double Bimage::interpolate (vector&lt; double &gt; vec, long nn = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 339 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a7885caeffe8b1c90eaf9651fd575d749"/>    <section>
    <title>interpolate_gaps()</title>
<indexterm><primary>interpolate_gaps</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>interpolate_gaps</secondary></indexterm>
<para><computeroutput>int Bimage::interpolate_gaps (long step)</computeroutput></para><para>

<para>Interpolate the voxels that are not calculated. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>step</entry>
                                <entry>
<para>step increment for voxels with proper values. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 if error. <literallayout><computeroutput>Sparse voxels calculated on a regular grid with the given step size are 
used to fill intermediate voxels with linearly interpolated values.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1036 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a08401d5d8da91205f95925898575903b"/>    <section>
    <title>interpolate_wrap()<computeroutput>[1/4]</computeroutput></title>
<indexterm><primary>interpolate_wrap</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>interpolate_wrap</secondary></indexterm>
<para><computeroutput>double Bimage::interpolate_wrap (double xx, double yy = <computeroutput>0</computeroutput>
, double zz = <computeroutput>0</computeroutput>
, long nn = <computeroutput>0</computeroutput>
) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 345 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1af23dc8034036c8ac619601259ead7444"/>    <section>
    <title>interpolate_wrap()<computeroutput>[2/4]</computeroutput></title>
<indexterm><primary>interpolate_wrap</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>interpolate_wrap</secondary></indexterm>
<para><computeroutput>double Bimage::interpolate_wrap (long cc, double xx, double yy = <computeroutput>0</computeroutput>
, double zz = <computeroutput>0</computeroutput>
, long nn = <computeroutput>0</computeroutput>
) const</computeroutput></para><para>

<para>Interpolates using a given location with wrapping. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>cc</entry>
                                <entry>
<para>channel. </para>
</entry>
                            </row>
                            <row>
                                <entry>xx</entry>
                                <entry>
<para>x location. </para>
</entry>
                            </row>
                            <row>
                                <entry>yy</entry>
                                <entry>
<para>y location. </para>
</entry>
                            </row>
                            <row>
                                <entry>zz</entry>
                                <entry>
<para>z location. </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double interpolated value. <literallayout><computeroutput>Trilinear interpolation with wrapping around periodic image boundaries.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1533 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1accbcd90dfa5c60b281ab2efb975f2d38"/>    <section>
    <title>interpolate_wrap()<computeroutput>[3/4]</computeroutput></title>
<indexterm><primary>interpolate_wrap</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>interpolate_wrap</secondary></indexterm>
<para><computeroutput>double Bimage::interpolate_wrap (long cc, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec, long nn = <computeroutput>0</computeroutput>
) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 349 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1aa621195acbabd5c81c769d0ca17e9041"/>    <section>
    <title>interpolate_wrap()<computeroutput>[4/4]</computeroutput></title>
<indexterm><primary>interpolate_wrap</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>interpolate_wrap</secondary></indexterm>
<para><computeroutput>double Bimage::interpolate_wrap (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec, long nn = <computeroutput>0</computeroutput>
) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 353 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a75e17a1198d60941bc2a64a563d99622"/>    <section>
    <title>inverse()</title>
<indexterm><primary>inverse</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>inverse</secondary></indexterm>
<para><computeroutput>void Bimage::inverse (double minval = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates the inverse of the image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>minval</entry>
                                <entry>
<para>the minimum absolute value considered not zero. <literallayout><computeroutput>The inverse of every pixel is calculated.
If the minumum value is given as zero, zero pixels are retained.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 3957 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a59438cff519b5ec327b7ef909e761984"/>    <section>
    <title>invert()</title>
<indexterm><primary>invert</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>invert</secondary></indexterm>
<para><computeroutput>void Bimage::invert ( )</computeroutput></para><para>

<para>Inverts the data in the image. </para>
</para>

<para><literallayout><computeroutput>The Bit data type is negated.
An unsigned data type is subtracted from its type maximum.
A signed data type is negated.
</computeroutput></literallayout> </para>
<para>
Definition at line 3306 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a32603276232d08670b1f5f119d2b2614"/>    <section>
    <title>kernel_average()</title>
<indexterm><primary>kernel_average</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>kernel_average</secondary></indexterm>
<para><computeroutput>double Bimage::kernel_average (long idx, long ksize, double tmin, double tmax)</computeroutput></para><para>

<para>Finds the highest value in a kernel. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>idx</entry>
                                <entry>
<para>index in multi-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>ksize</entry>
                                <entry>
<para>kernel edge half size. </para>
</entry>
                            </row>
                            <row>
                                <entry>tmin</entry>
                                <entry>
<para>miminum to exclude. </para>
</entry>
                            </row>
                            <row>
                                <entry>tmax</entry>
                                <entry>
<para>maximum to exclude </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double average value. </para>
</formalpara>
</para>
<para>
Definition at line 3032 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae44123b34d0f20e1835482d0a0fe8f86"/>    <section>
    <title>kernel_gaussian()</title>
<indexterm><primary>kernel_gaussian</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>kernel_gaussian</secondary></indexterm>
<para><computeroutput>int Bimage::kernel_gaussian (double sigma, double max)</computeroutput></para><para>

<para>Generates a gaussian kernel image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>sigma</entry>
                                <entry>
<para>gaussian width. </para>
</entry>
                            </row>
                            <row>
                                <entry>max</entry>
                                <entry>
<para>kernel maximum. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. </para>
</formalpara>
</para>
<para>
Definition at line 34 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2dd984aa0e02aaa010809ea24d6dcc5e"/>    <section>
    <title>kernel_high()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>kernel_high</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>kernel_high</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt;long&gt; Bimage::kernel_high (long i, long k = <computeroutput>1</computeroutput>
)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 475 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a6ebd22065c652bcdcb53994029ca6295"/>    <section>
    <title>kernel_high()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>kernel_high</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>kernel_high</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt;long&gt; Bimage::kernel_high (long i, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; k)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 485 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a90d4551d4e5fca005dffca66707ac232"/>    <section>
    <title>kernel_laplacian_of_gaussian()</title>
<indexterm><primary>kernel_laplacian_of_gaussian</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>kernel_laplacian_of_gaussian</secondary></indexterm>
<para><computeroutput>int Bimage::kernel_laplacian_of_gaussian (double sigma, double max)</computeroutput></para><para>

<para>Generates a laplacian-of-gaussian kernel. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>sigma</entry>
                                <entry>
<para>gaussian width. </para>
</entry>
                            </row>
                            <row>
                                <entry>max</entry>
                                <entry>
<para>kernel maximum. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* kernel image. </para>
</formalpara>
</para>
<para>
Definition at line 77 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a72bc35687c981aa55d62dcf9e3570e5c"/>    <section>
    <title>kernel_low()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>kernel_low</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>kernel_low</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt;long&gt; Bimage::kernel_low (long i, long k = <computeroutput>1</computeroutput>
)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 469 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1ad6a66e3de0c548eee2ae3ca0450aac8c"/>    <section>
    <title>kernel_low()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>kernel_low</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>kernel_low</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt;long&gt; Bimage::kernel_low (long i, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; k)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 479 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a8f902f05afe1d97fd1e90a25aecc4532"/>    <section>
    <title>kernel_max()</title>
<indexterm><primary>kernel_max</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>kernel_max</secondary></indexterm>
<para><computeroutput>long Bimage::kernel_max (long idx, long ksize)</computeroutput></para><para>

<para>Finds the highest value in a kernel. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>idx</entry>
                                <entry>
<para>index in multi-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>ksize</entry>
                                <entry>
<para>kernel edge half size </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long index of highest value. </para>
</formalpara>
</para>
<para>
Definition at line 2998 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1acc44e2b417abe30a685105ab38662a77"/>    <section>
    <title>kernel_max_neigbor()</title>
<indexterm><primary>kernel_max_neigbor</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>kernel_max_neigbor</secondary></indexterm>
<para><computeroutput>long Bimage::kernel_max_neigbor (long idx, long ksize)</computeroutput></para><para>

<para>Finds the highest value in a kernel excluding the central voxel. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>idx</entry>
                                <entry>
<para>index in multi-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>ksize</entry>
                                <entry>
<para>kernel edge half size </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long index of highest value. </para>
</formalpara>
</para>
<para>
Definition at line 3069 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae2082eb0532625c9807b85c1052921c6"/>    <section>
    <title>kernel_max_wrap()</title>
<indexterm><primary>kernel_max_wrap</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>kernel_max_wrap</secondary></indexterm>
<para><computeroutput>long Bimage::kernel_max_wrap (long idx, long ksize)</computeroutput></para><para>

<para>Finds the highest value in a kernel with wrapping. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>idx</entry>
                                <entry>
<para>index in multi-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>ksize</entry>
                                <entry>
<para>kernel edge half size </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long index of highest value. </para>
</formalpara>
</para>
<para>
Definition at line 3103 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8b90b99ccc3c50f979020d2f8cf5fb97"/>    <section>
    <title>kernel_min()</title>
<indexterm><primary>kernel_min</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>kernel_min</secondary></indexterm>
<para><computeroutput>long Bimage::kernel_min (long idx, long ksize)</computeroutput></para><para>

<para>Finds the highest value in a kernel. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>idx</entry>
                                <entry>
<para>index in multi-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>ksize</entry>
                                <entry>
<para>kernel edge half size </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long index of highest value. </para>
</formalpara>
</para>
<para>
Definition at line 2966 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aca34b56eec25e8568c1264ec3c1b2234"/>    <section>
    <title>kernel_order()</title>
<indexterm><primary>kernel_order</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>kernel_order</secondary></indexterm>
<para><computeroutput>multimap&lt; double, long &gt; Bimage::kernel_order (long idx, long ksize)</computeroutput></para><para>

<para>Orders the values in a kernel. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>idx</entry>
                                <entry>
<para>index in multi-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>ksize</entry>
                                <entry>
<para>kernel edge half size </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>multimap&lt;double,long&gt; index of highest value. </para>
</formalpara>
</para>
<para>
Definition at line 3144 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6517dc1d9d1234580ff7de7cba084325"/>    <section>
    <title>kernel_order_neighbors()</title>
<indexterm><primary>kernel_order_neighbors</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>kernel_order_neighbors</secondary></indexterm>
<para><computeroutput>multimap&lt; double, long &gt; Bimage::kernel_order_neighbors (long idx, long ksize)</computeroutput></para><para>

<para>Orders the neigbor values in a kernel. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>idx</entry>
                                <entry>
<para>index in multi-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>ksize</entry>
                                <entry>
<para>kernel edge half size </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>multimap&lt;double,long&gt; index of highest value. </para>
</formalpara>
</para>
<para>
Definition at line 3172 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae3805a269db97bedf75fea6100a28a09"/>    <section>
    <title>kmeans_segment()</title>
<indexterm><primary>kmeans_segment</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>kmeans_segment</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::kmeans_segment (long nregion = <computeroutput>2</computeroutput>
, long max_iter = <computeroutput>10</computeroutput>
, double ratio = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Segments an image based on K-means. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nregion</entry>
                                <entry>
<para>number of regions. </para>
</entry>
                            </row>
                            <row>
                                <entry>max_iter</entry>
                                <entry>
<para>maximum number of iterations. </para>
</entry>
                            </row>
                            <row>
                                <entry>ratio</entry>
                                <entry>
<para>balance between density and distance. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* segmentation mask. <literallayout><computeroutput>The metric to choose region membership is based on the minimum of:
    d = |&lt;c&gt;-c|/s + r|&lt;v&gt;-v|
for:
    c:      coordinates
    &lt;c&gt;:    region average coordinates.
    s:      image size.
    v:      density.
    &lt;v&gt;:    region average density.
    r:      ratio.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1200 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab8e2ac94e18695add819eff58f81d4ab"/>    <section>
    <title>label()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>label</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>label</secondary></indexterm>
<para><computeroutput>string&amp; Bimage::label ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 246 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1aafe7685945a1b8b18efa7e8759fd8b02"/>    <section>
    <title>label()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>label</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>label</secondary></indexterm>
<para><computeroutput>void Bimage::label (string s)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 245 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1aee6dd952940fd6084b5e8a4674e708b2"/>    <section>
    <title>largest()</title>
<indexterm><primary>largest</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>largest</secondary></indexterm>
<para><computeroutput>void Bimage::largest (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Selects the largest of each pixel from two images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>other image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 3981 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8266d26a479d99b845c7125e4efab7f1"/>    <section>
    <title>level_mask_extract()</title>
<indexterm><primary>level_mask_extract</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>level_mask_extract</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::level_mask_extract (<link linkend="_class_bimage">Bimage</link> * pmask, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Extracts all the regions associated with a multi-level mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>multi-level mask map. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value of edge voxels. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* image with excised regions. <literallayout><computeroutput>The feature index is found in a feature map and the corresponding voxels
in the density maps are extracted.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2035 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad6e31bfb7410474d13a52648e8d6a3c8"/>    <section>
    <title>level_masked_stats()</title>
<indexterm><primary>level_masked_stats</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>level_masked_stats</secondary></indexterm>
<para><computeroutput>int Bimage::level_masked_stats (<link linkend="_class_bimage">Bimage</link> * pmask)</computeroutput></para><para>

<para>Caclulates statistics for all the regions defined by a multi-level mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>multi-level mask map. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The input data is replaced by the average for each region.
A linked image is created to hold the variance for each region.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1889 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7bc85fb79cd16369c7fa58ee7cb9a8c4"/>    <section>
    <title>levelmask_add()</title>
<indexterm><primary>levelmask_add</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>levelmask_add</secondary></indexterm>
<para><computeroutput>long Bimage::levelmask_add (<link linkend="_class_bimage">Bimage</link> * pmask, int add_level = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Adds a bilevel mask to a level mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>pmask</entry>
                                <entry>
<para>bilevel mask to add. </para>
</entry>
                            </row>
                            <row>
                                <entry>add_level</entry>
                                <entry>
<para>the level index to add. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of selected regions. <literallayout><computeroutput>Where the bilevel mask is one, the level mask is set to given level value.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1579 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1adc844206e18c734ce3dc13bf775754b0"/>    <section>
    <title>levelmask_asymmetric_units()</title>
<indexterm><primary>levelmask_asymmetric_units</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>levelmask_asymmetric_units</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::levelmask_asymmetric_units (<link linkend="_struct_bsymmetry">Bsymmetry</link> &amp; sym, int index)</computeroutput></para><para>

<para>Calculates a multi-level mask to indicate asymmetric units. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*sym</entry>
                                <entry>
<para>symmetry structure. </para>
</entry>
                            </row>
                            <row>
                                <entry>index</entry>
                                <entry>
<para>asu index (&lt;1 means all). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* multi-level mask. <literallayout><computeroutput>A reference view for each point group is generated such that it is
located close to the center of the canonical asymmetric unit.
A set of symmetry-related reference views are then generated from 
the original reference.
The distance of each voxel is then calculated to each reference
view, and assigned to asymmetric unit with the closest reference view.
If the given index is larger than one, a mask is generated only for the
asymmetric unit with that index. 
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 899 of file Bimage_symmetry.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa1a2be8e3d04b368f3bfd57256809719"/>    <section>
    <title>levelmask_average_region_size()</title>
<indexterm><primary>levelmask_average_region_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>levelmask_average_region_size</secondary></indexterm>
<para><computeroutput>double Bimage::levelmask_average_region_size ( )</computeroutput></para><para>

<para>Calculates the average size of regions in a level mask. </para>
</para>

<para><formalpara><title>Returns</title>

<para>double average feature size. </para>
</formalpara>
</para>
<para>
Definition at line 2063 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af17d6f37ff5cbbdcde7620f05141678e"/>    <section>
    <title>levelmask_clean()</title>
<indexterm><primary>levelmask_clean</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>levelmask_clean</secondary></indexterm>
<para><computeroutput>long Bimage::levelmask_clean ( )</computeroutput></para><para>

<para>Removes empty levels from a multi-level mask. </para>
</para>

<para><formalpara><title>Returns</title>

<para>long 0. <literallayout><computeroutput>The mask is converted to an integer mask.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2102 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a9b050b7abd5bbe9ba1b22ea6f6c55c22"/>    <section>
    <title>levelmask_collapse()</title>
<indexterm><primary>levelmask_collapse</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>levelmask_collapse</secondary></indexterm>
<para><computeroutput>long Bimage::levelmask_collapse ( )</computeroutput></para><para>

<para>Collapse a multi-level mask to a binary mask. </para>
</para>

<para><formalpara><title>Returns</title>

<para>long number of voxels retained. <literallayout><computeroutput>All non-zero segments are converted to ones.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1541 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a001d55537c8ef53c9a8db4e4db51550b"/>    <section>
    <title>levelmask_color_by_size()</title>
<indexterm><primary>levelmask_color_by_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>levelmask_color_by_size</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::levelmask_color_by_size ( )</computeroutput></para><para>

<para>Color a multi-level mask based on the volumes of regions. </para>
</para>

<para><formalpara><title>Returns</title>

<para>Bimage* new colored image. </para>
</formalpara>
</para>
<para>
Definition at line 2172 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a86476781a80154c519dd0ddf5962ec43"/>    <section>
    <title>levelmask_colorize()</title>
<indexterm><primary>levelmask_colorize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>levelmask_colorize</secondary></indexterm>
<para><computeroutput>long Bimage::levelmask_colorize ( )</computeroutput></para><para>

<para>Colorizes a multi-level mask with random color assignments. </para>
</para>

<para><formalpara><title>Returns</title>

<para>long number of levels. <literallayout><computeroutput>A lookup table (LUT) is calculated for the range of gray-scale values
and random colors assigned to each value.
The image is then converted to RGB using the LUT.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2136 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad7f3b28f7dcabcf950bed87b5c43fe68"/>    <section>
    <title>levelmask_combine()</title>
<indexterm><primary>levelmask_combine</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>levelmask_combine</secondary></indexterm>
<para><computeroutput>long Bimage::levelmask_combine (<link linkend="_class_bstring">Bstring</link> &amp; select_list)</computeroutput></para><para>

<para>Combines the selected levels in a multi-level mask and renumber. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>&amp;select_list</entry>
                                <entry>
<para>comma_separated list of levels to select. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of voxels retained. <literallayout><computeroutput>The new data replaces the old data.
The result is a multi-level mask where the selected levels are combined into one.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1733 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1abfa93c8bce1563c143cbc32bd8c024c3"/>    <section>
    <title>levelmask_dilate()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>levelmask_dilate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>levelmask_dilate</secondary></indexterm>
<para><computeroutput>long Bimage::levelmask_dilate ( )</computeroutput></para><para>

<para>Dilates a level mask. </para>
</para>

<para><formalpara><title>Returns</title>

<para>long 0. <literallayout><computeroutput>Traditional 3^dim kernel dilation.  Any pixel with a value of 1 turns 
all of its neighbors to a value of 1.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1621 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3b8f8a71d29892880177dba00493a97b"/>    <section>
    <title>levelmask_dilate()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>levelmask_dilate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>levelmask_dilate</secondary></indexterm>
<para><computeroutput>long Bimage::levelmask_dilate (int times)</computeroutput></para><para>

<para>Dilates a level mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>times</entry>
                                <entry>
<para>number of dilation operations. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long 0. <literallayout><computeroutput>Traditional 3^dim kernel dilation.  Any pixel with a value of 1 turns 
all of its neighbors to a value of 1.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1603 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8f4b48837a8edb33dd4003ed717d03e1"/>    <section>
    <title>levelmask_region_size()</title>
<indexterm><primary>levelmask_region_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>levelmask_region_size</secondary></indexterm>
<para><computeroutput>int Bimage::levelmask_region_size ( )</computeroutput></para><para>

<para>Convert a mask to reflect region sizes. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. </para>
</formalpara>
</para>
<para>
Definition at line 2225 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a00376e3fe457712ab10246026c478c89"/>    <section>
    <title>levelmask_select()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>levelmask_select</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>levelmask_select</secondary></indexterm>
<para><computeroutput>long Bimage::levelmask_select (<link linkend="_class_bimage">Bimage</link> * pmask)</computeroutput></para><para>

<para>Selects regions overlapping a mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>pmask</entry>
                                <entry>
<para>overlap template mask. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of selected regions. <literallayout><computeroutput>The input mask can be of any form. All non-zero parts of this mask is used.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1816 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a4c503a8bad6d5188959ef2102372c805"/>    <section>
    <title>levelmask_select()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>levelmask_select</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>levelmask_select</secondary></indexterm>
<para><computeroutput>long Bimage::levelmask_select (<link linkend="_class_bstring">Bstring</link> &amp; select_list, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Retains the selected levels in a multi-level mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>&amp;select_list</entry>
                                <entry>
<para>comma_separated list of levels to select. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>0=binary mask, 1=multi-level mask. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of voxels retained. <literallayout><computeroutput>The new data replaces the old data.
The result is either a binary mask (flag=0) or a multi-level mask where
the level indices changed to reflect the new range of selected levels (flag=1).
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1691 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0c655e6d6031423e7028b3d163c0a264"/>    <section>
    <title>levelmask_select()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>levelmask_select</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>levelmask_select</secondary></indexterm>
<para><computeroutput>long Bimage::levelmask_select (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; voxel)</computeroutput></para><para>

<para>Retains the selected levels in a multi-level mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number. </para>
</entry>
                            </row>
                            <row>
                                <entry>voxel</entry>
                                <entry>
<para>voxel with level to select. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of voxels retained. <literallayout><computeroutput>The new data replaces the old data.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1781 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a42c3d811f32bcb221a5692271fd2e4df"/>    <section>
    <title>levelmask_size_histogram()</title>
<indexterm><primary>levelmask_size_histogram</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>levelmask_size_histogram</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::levelmask_size_histogram ( )</computeroutput></para><para>

<para>Color a multi-level mask based on the volumes of regions. </para>
</para>

<para><formalpara><title>Returns</title>

<para>Bplot* region size histogram. </para>
</formalpara>
</para>
<para>
Definition at line 2256 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a152515cc985bb3785ae95e258381c211"/>    <section>
    <title>levelmask_switch()</title>
<indexterm><primary>levelmask_switch</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>levelmask_switch</secondary></indexterm>
<para><computeroutput>long Bimage::levelmask_switch (long index1, long index2)</computeroutput></para><para>

<para>Switches two segments in a multi-level mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>index1</entry>
                                <entry>
<para>first index. </para>
</entry>
                            </row>
                            <row>
                                <entry>index2</entry>
                                <entry>
<para>second index. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of levels. <literallayout><computeroutput>If the two indices are not found, the mask is not modified.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1863 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1afd966c254c4470cdf8a9e1d9254e0438"/>    <section>
    <title>levelmask_symmetrize()</title>
<indexterm><primary>levelmask_symmetrize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>levelmask_symmetrize</secondary></indexterm>
<para><computeroutput>long Bimage::levelmask_symmetrize (<link linkend="_struct_bsymmetry">Bsymmetry</link> &amp; sym)</computeroutput></para><para>

<para>Symetrizes a multi-level mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>sym</entry>
                                <entry>
<para>point group symmetry. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long maximum level index. </para>
</formalpara>
</para>
<para>
Definition at line 1941 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a10a2c7e875d850bfd0dbc3e46b9ea998"/>    <section>
    <title>limit_levels()</title>
<indexterm><primary>limit_levels</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>limit_levels</secondary></indexterm>
<para><computeroutput>int Bimage::limit_levels (int nlevels)</computeroutput></para><para>

<para>Converts a full gray scale image to a limited level image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nlevels</entry>
                                <entry>
<para>number of levels. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The dynamic range of the image is decreased to a given number of gray
scale levels.
The new data replaces the old data.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 426 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a9d059625d3892b2a07da71d3e8b400a9"/>    <section>
    <title>line()</title>
<indexterm><primary>line</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>line</secondary></indexterm>
<para><computeroutput>int Bimage::line (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; end, double width, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Creates a line in an image and fills it with a constant value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>start</entry>
                                <entry>
<para>three-value start of line. </para>
</entry>
                            </row>
                            <row>
                                <entry>end</entry>
                                <entry>
<para>three-value end of line. </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>gaussian width of smoothing function. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>fill value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The edge of the area is smoothed with a function:
                    v_old(x,y,z) + fill*exp(1.618*dist/width)
    v_new(x,y,z) = ------------------------------------------
                           1 + exp(1.618*dist/width)
where   fill is the constant fill value.
        dist is the distance to the rectangular boundary defined by
            the input size and start
        width is the gaussian width (softness)
With very small values of the gaussian width, the edge approaches a
step function.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 234 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7bdfaa89652d965acbf3a94cb87501b8"/>    <section>
    <title>line_powerspectra()</title>
<indexterm><primary>line_powerspectra</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>line_powerspectra</secondary></indexterm>
<para><computeroutput>int Bimage::line_powerspectra (<link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> plan)</computeroutput></para><para>

<para>Calculates the 1D power spectrum of each line in an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>plan</entry>
                                <entry>
<para>fft plan. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>Each line is transformed to a power spectrum in place.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 811 of file Bimage_polar.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3cd968fadff01e5b7cb98bc61c5bb16c"/>    <section>
    <title>linear_fit()</title>
<indexterm><primary>linear_fit</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>linear_fit</secondary></indexterm>
<para><computeroutput>double Bimage::linear_fit (<link linkend="_class_bimage">Bimage</link> * p, <link linkend="_class_bimage">Bimage</link> * pmask, double max_exclude)</computeroutput></para><para>

<para>Linear least squares fit of two images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>second image. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>mask to limit calculation to a certain region. </para>
</entry>
                            </row>
                            <row>
                                <entry>max_exclude</entry>
                                <entry>
<para>maximum percentage of outlying points to exclude. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double first R factor. <literallayout><computeroutput>The data blocks from two images are fit by a simple linear least squares
regression algorithm with exclusion of a percentage of outliers:
    image2 = intercept + slope * image1
The first image is modified to return the difference:
    difference = intercept + slope * image1 - image2
The residual returned is:
    R = sqrt(sum(difference^2) / sum((image2-avg2)^2))
Note: A linear fit is not symmetric with respect to the two input
data sets - the order of the input images determine the output.
The two data blocks must have the same size and are converted to
floating point.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 477 of file Bimage_combine.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a5a9fe1dc8d2129d9407528f6f65eeb02"/>    <section>
    <title>local_filter()</title>
<indexterm><primary>local_filter</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>local_filter</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::local_filter (<link linkend="_class_bimage">Bimage</link> * pmask, int mask_level, <link linkend="_class_bimage">Bimage</link> * resmap, int size, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; vedge)</computeroutput></para><para>

<para>Applies a local resolution filter to a map. </para>
</para>

<para><formalpara><title>Author</title>

<para>Giovanni Cardone and Bernard Heymann </para>
</formalpara>

                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>mask of areas to generate. </para>
</entry>
                            </row>
                            <row>
                                <entry>mask_level</entry>
                                <entry>
<para>mask level. </para>
</entry>
                            </row>
                            <row>
                                <entry>*resmap</entry>
                                <entry>
<para>local resolution map. </para>
</entry>
                            </row>
                            <row>
                                <entry>size</entry>
                                <entry>
<para>kernel size. </para>
</entry>
                            </row>
                            <row>
                                <entry>vedge</entry>
                                <entry>
<para>edge size. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* filtered image, NULL on error. <literallayout><computeroutput>At each voxel, a kernel/small box is extracted and lowpass filtered
to the resolution limit for that voxel in the local resolution map.
A mask may be used to limit the region of application.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 782 of file Bimage_resolution.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6e71e8fb84408cc791660173295d23d9"/>    <section>
    <title>logarithm()</title>
<indexterm><primary>logarithm</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>logarithm</secondary></indexterm>
<para><computeroutput>void Bimage::logarithm ( )</computeroutput></para><para>

<para>Calculates the logarithm of the image data. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The image is first converted to floating point, or intensities
for complex data. The logarithm is calculated to place the minmum at
zero and scale it to the standard deviation:
                data - min
    new_data = log ------------- + 1
                   std
The new data replaces the old data.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 725 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7e52a939175e002908692140c372213d"/>    <section>
    <title>mask()</title>
<indexterm><primary>mask</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask</secondary></indexterm>
<para><computeroutput>long Bimage::mask (<link linkend="_class_bimage">Bimage</link> * pmask, double fill)</computeroutput></para><para>

<para>Masks an image. </para>
</para>

<para><formalpara><title>Author</title>

<para>Samuel Payne </para>
</formalpara>

                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>binary mask. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value to use where mask is zero. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long 0. <literallayout><computeroutput>If the mask value for that pixel is 0, the image pixel is changed
to the fill value.  Otherwise it is left alone.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 26 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1abf9e6d8253c07d69800a8eb4a349a81b"/>    <section>
    <title>mask_by_conditional_thresholds()</title>
<indexterm><primary>mask_by_conditional_thresholds</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_by_conditional_thresholds</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::mask_by_conditional_thresholds (vector&lt; double &gt; threshold)</computeroutput></para><para>

<para>Generates a mask based on a conditional hierarchy of thresholds. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>array of gray scale levels. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* unsigned char mask. <literallayout><computeroutput>A multi-level mask is generated using the given threshold values.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 166 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3d369e4ff6b9dafa6f4e7c3cc624cc8d"/>    <section>
    <title>mask_by_threshold()</title>
<indexterm><primary>mask_by_threshold</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_by_threshold</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::mask_by_threshold (double threshold)</computeroutput></para><para>

<para>Generates a mask based on an image at a given threshold. </para>
</para>

<para><formalpara><title>Author</title>

<para>Samuel Payne &amp; Bernard Heymann </para>
</formalpara>

                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>gray scale level. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* unsigned char mask. <literallayout><computeroutput>A binary mask is generated using the given threshold.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 93 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a680ab2f328a430aa2419e8f99a7171ca"/>    <section>
    <title>mask_by_thresholds()</title>
<indexterm><primary>mask_by_thresholds</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_by_thresholds</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::mask_by_thresholds (vector&lt; double &gt; threshold)</computeroutput></para><para>

<para>Generates a mask based on an image at given thresholds. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>array of gray scale levels. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* unsigned char mask. <literallayout><computeroutput>A multi-level mask is generated using the given threshold values.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 129 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2fc50476f618586e13c5d2ba99a3a4d5"/>    <section>
    <title>mask_close()</title>
<indexterm><primary>mask_close</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_close</secondary></indexterm>
<para><computeroutput>long Bimage::mask_close (int times = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Closes a binary mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>times</entry>
                                <entry>
<para>the number of times to dilate and erode the mask. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long masked voxels. <literallayout><computeroutput>Closing a mask is a dilation followed by an erosion.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 521 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a93d63999cd5d4250dcd81210958cac78"/>    <section>
    <title>mask_combine()</title>
<indexterm><primary>mask_combine</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_combine</secondary></indexterm>
<para><computeroutput>long Bimage::mask_combine (<link linkend="_class_bimage">Bimage</link> * p, int operation)</computeroutput></para><para>

<para>Combines two masks with different operations. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>second mask. </para>
</entry>
                            </row>
                            <row>
                                <entry>operation</entry>
                                <entry>
<para>combining operation. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* unsigned char mask. <literallayout><computeroutput>The input images are assumed to be a masks of 0&apos;s and 1&apos;s and are
modified according to the operation requested:
    0   val1 = val2
    1   val1 = val1 and val2
    2   val1 = val1 or  val2
    3   val1 = val1 xor val2
where val1 and val2 are the data in the two images. 
Image statistics of the first image are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 295 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af36613b563af19c946ca869f076bf634"/>    <section>
    <title>mask_dilate()</title>
<indexterm><primary>mask_dilate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_dilate</secondary></indexterm>
<para><computeroutput>long Bimage::mask_dilate (long times = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Dilates a binary mask. </para>
</para>

<para><formalpara><title>Author</title>

<para>Samuel Payne &amp; Bernard Heymann </para>
</formalpara>

                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>times</entry>
                                <entry>
<para>the number of times to dilate the mask. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long masked voxels. <literallayout><computeroutput>Traditional 3^dim kernel dilation.  Any pixel with a value of 1 turns 
all of its neighbors to a value of 1.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 463 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6e4f025da30842a514cb858e8054cc53"/>    <section>
    <title>mask_dilate_erode()</title>
<indexterm><primary>mask_dilate_erode</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_dilate_erode</secondary></indexterm>
<para><computeroutput>long Bimage::mask_dilate_erode (unsigned char dir)</computeroutput></para><para>

<para>Dilates or erodes a binary mask. </para>
</para>

<para><formalpara><title>Author</title>

<para>Samuel Payne &amp; Bernard Heymann </para>
</formalpara>

                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>dir</entry>
                                <entry>
<para>0=erode, 1=dilate. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long masked voxels. <literallayout><computeroutput>Traditional 3^dim kernel dilation.  Any pixel with a value of 1 turns 
all of its neighbors to a value of 1.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 406 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a902d3c93fd01cff5be2cf247ab42c437"/>    <section>
    <title>mask_erode()</title>
<indexterm><primary>mask_erode</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_erode</secondary></indexterm>
<para><computeroutput>long Bimage::mask_erode (long times = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Erodes a binary mask. </para>
</para>

<para><formalpara><title>Author</title>

<para>Samuel Payne &amp; Bernard Heymann </para>
</formalpara>

                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>times</entry>
                                <entry>
<para>the number of times to erode the mask </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long masked voxels. <literallayout><computeroutput>Traditional 3^dim kernel erosion.  If all the neighboring pixels have
value of 1, then that pixel is left at 1. Otherwise it is changed to 0.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 483 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a19c294d3382038ecc8c54bccfd4583d3"/>    <section>
    <title>mask_extract()</title>
<indexterm><primary>mask_extract</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_extract</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::mask_extract (<link linkend="_class_bimage">Bimage</link> * pmask)</computeroutput></para><para>

<para>Zeroes everything outside the mask and return the excised feature. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>mask. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* excised feature. <literallayout><computeroutput>The mask must be the same size as the image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 333 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac82fd40b41c01945499551804754d76b"/>    <section>
    <title>mask_fill()</title>
<indexterm><primary>mask_fill</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_fill</secondary></indexterm>
<para><computeroutput>long Bimage::mask_fill (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; voxel)</computeroutput></para><para>

<para>Fills an empty part of a mask indicated by the given voxel. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>voxel</entry>
                                <entry>
<para>point from which to fill the mask. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long masked voxels. </para>
</formalpara>
</para>
<para>
Definition at line 539 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab103c7cb8674784b51c313026b294cde"/>    <section>
    <title>mask_fspace_banded()</title>
<indexterm><primary>mask_fspace_banded</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_fspace_banded</secondary></indexterm>
<para><computeroutput>int Bimage::mask_fspace_banded (vector&lt; double &gt; &amp; band)</computeroutput></para><para>

<para>Generate reciprocal space mask based on a specification of bands. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>&amp;band</entry>
                                <entry>
<para>array of number pairs, each a shell and value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The band argument is a list of pairs of values, each pair indicating
a resolution shell (in angstrom) and a flag indicating whether the 
following shells should be:
    0: excluded - also the high resolution limit
    1: included in the FOM
    -1: included in the cross-validation FOM
The high resolution limit for the mask is set in the image structure.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 849 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a9b263c23f182cd36c93e7de6dc0741e5"/>    <section>
    <title>mask_fspace_resize()</title>
<indexterm><primary>mask_fspace_resize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_fspace_resize</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt; double &gt; Bimage::mask_fspace_resize (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize)</computeroutput></para><para>

<para>Resizes a reciprocal space mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nusize</entry>
                                <entry>
<para>new mask size. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para><link linkend="_class_vector3">Vector3&lt;double&gt;</link> scale. <literallayout><computeroutput>The mask is assumed to be centered at (0,0,0).
The image is resized by inserting or removing
rows or columns in the middle of the data set.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 725 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a47d213b882cd62b6ddd30592a8b9df45"/>    <section>
    <title>mask_interface_matrix()</title>
<indexterm><primary>mask_interface_matrix</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_interface_matrix</secondary></indexterm>
<para><computeroutput><link linkend="_class_matrix">Matrix</link> Bimage::mask_interface_matrix (int img_num)</computeroutput></para><para>

<para>Calculates the interfaces between regions. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>img_num</entry>
                                <entry>
<para>sub-image number. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para><link linkend="_class_matrix">Matrix</link> interface matrix. <literallayout><computeroutput>The mask must be an integer image.
An interface matrix is calculated to count the number of connected
voxels between every pair of regions.
Each value i in a row j gives the number of voxels of the region j that
are adjacent to one or more voxels in region i.
Row 0 and column 0 are excluded from the calculation.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2339 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8a53e32389be9d324c6a5020c0d46478"/>    <section>
    <title>mask_invert()</title>
<indexterm><primary>mask_invert</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_invert</secondary></indexterm>
<para><computeroutput>long Bimage::mask_invert ( )</computeroutput></para><para>

<para>Inverts a mask. </para>
</para>

<para><formalpara><title>Returns</title>

<para>long number of mask voxels. <literallayout><computeroutput>The mask is assumed to be in range [0,1].
    new_mask = 1 - old_mask.
Image statistics of the mask are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 260 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a032c319d4fb989ec7da3c9088c17a987"/>    <section>
    <title>mask_merge_delete()</title>
<indexterm><primary>mask_merge_delete</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_merge_delete</secondary></indexterm>
<para><computeroutput>long Bimage::mask_merge_delete (long min_size, long min_if)</computeroutput></para><para>

<para>Calculates the interfaces between regions and deletes/merges small ones. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>min_size</entry>
                                <entry>
<para>minimum size to accept regions, small ones are deleted/merged. </para>
</entry>
                            </row>
                            <row>
                                <entry>min_if</entry>
                                <entry>
<para>minimum interface size to consider a small region connected. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long 0. <literallayout><computeroutput>The mask is converted to an integer mask.
An interface matrix is calculated to count the number of connected
voxels between every pair of regions.
Regions that are smaller than the minimum size are either deleted or
merged with other regions.
If the maximum interface size for a small region is less than the minimum
specified, the region is deleted, otherwise, it is added to that
neighboring region with which it shares the biggest interface.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2457 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a81e19d75253d301436865e742712abe5"/>    <section>
    <title>mask_missing_cone()</title>
<indexterm><primary>mask_missing_cone</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_missing_cone</secondary></indexterm>
<para><computeroutput>long Bimage::mask_missing_cone (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; ori, double mis_ang, double resolution)</computeroutput></para><para>

<para>Generates a mask with a missing cone. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>ori</entry>
                                <entry>
<para>image origin. </para>
</entry>
                            </row>
                            <row>
                                <entry>mis_ang</entry>
                                <entry>
<para>cone angle from xy plane. </para>
</entry>
                            </row>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of mask voxels. <literallayout><computeroutput>The given image is used to generate a binary mask of the same size.
If the input origin is {0,0,0}, the origin in the image is used as 
the center for the missing part.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1105 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a1b60c0e93b7ed7fd9141fcf89edd24f6"/>    <section>
    <title>mask_missing_find()</title>
<indexterm><primary>mask_missing_find</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_missing_find</secondary></indexterm>
<para><computeroutput>long Bimage::mask_missing_find (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; ori, double resolution, <link linkend="_class_bstring">Bstring</link> &amp; mis_type)</computeroutput></para><para>

<para>Generates a missing mask from an example image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>ori</entry>
                                <entry>
<para>image origin. </para>
</entry>
                            </row>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>mis_type</entry>
                                <entry>
<para>missing region type: wedge. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of mask voxels. <literallayout><computeroutput>The given image is used to generate a binary mask of the same size.
If the input origin is {0,0,0}, the origin in the image is used as 
the center for the missing part.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1178 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a90602f4654cd1d2479828eddf096ddb3"/>    <section>
    <title>mask_missing_pyramid()</title>
<indexterm><primary>mask_missing_pyramid</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_missing_pyramid</secondary></indexterm>
<para><computeroutput>long Bimage::mask_missing_pyramid (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; ori, double tilt_axis1, double tilt_axis2, double tilt_neg1, double tilt_pos1, double tilt_neg2, double tilt_pos2, double resolution)</computeroutput></para><para>

<para>Generates a mask with a missing pyramid. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>ori</entry>
                                <entry>
<para>image origin. </para>
</entry>
                            </row>
                            <row>
                                <entry>tilt_axis1</entry>
                                <entry>
<para>tilt axis angle 1. </para>
</entry>
                            </row>
                            <row>
                                <entry>tilt_axis2</entry>
                                <entry>
<para>tilt axis angle 2. </para>
</entry>
                            </row>
                            <row>
                                <entry>tilt_neg1</entry>
                                <entry>
<para>negative tilt angle for axis 1. </para>
</entry>
                            </row>
                            <row>
                                <entry>tilt_pos1</entry>
                                <entry>
<para>positive tilt angle for axis 1. </para>
</entry>
                            </row>
                            <row>
                                <entry>tilt_neg2</entry>
                                <entry>
<para>negative tilt angle for axis 2. </para>
</entry>
                            </row>
                            <row>
                                <entry>tilt_pos2</entry>
                                <entry>
<para>positive tilt angle for axis 2. </para>
</entry>
                            </row>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of mask voxels. <literallayout><computeroutput>The given image is used to generate a binary mask of the same size.
If the input origin is {0,0,0}, the origin in the image is used as 
the center for the missing part.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1017 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1acb39a8ba9b2b27d51721e89af40582a5"/>    <section>
    <title>mask_missing_wedge()</title>
<indexterm><primary>mask_missing_wedge</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_missing_wedge</secondary></indexterm>
<para><computeroutput>long Bimage::mask_missing_wedge (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; ori, double tilt_axis, double tilt_neg, double tilt_pos, double resolution)</computeroutput></para><para>

<para>Generates a mask with a missing wedge. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>ori</entry>
                                <entry>
<para>image origin. </para>
</entry>
                            </row>
                            <row>
                                <entry>tilt_axis</entry>
                                <entry>
<para>tilt axis angle. </para>
</entry>
                            </row>
                            <row>
                                <entry>tilt_neg</entry>
                                <entry>
<para>negative tilt angle. </para>
</entry>
                            </row>
                            <row>
                                <entry>tilt_pos</entry>
                                <entry>
<para>positive tilt angle. </para>
</entry>
                            </row>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of mask voxels. <literallayout><computeroutput>The given image is used to generate a binary mask of the same size.
If the input origin is {0,0,0}, the origin in the image is used as 
the center for the missing part.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 934 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aaa3e82bba9f9618a7bb03ccdd3a2a223"/>    <section>
    <title>mask_open()</title>
<indexterm><primary>mask_open</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_open</secondary></indexterm>
<para><computeroutput>long Bimage::mask_open (int times = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Opens a binary mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>times</entry>
                                <entry>
<para>the number of times to erode and dilate the mask. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long masked voxels. <literallayout><computeroutput>Opening a mask is an erosion followed by a dilation.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 501 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a90d83b3bde0fc65afea592336ea84424"/>    <section>
    <title>mask_pack_plane()</title>
<indexterm><primary>mask_pack_plane</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_pack_plane</secondary></indexterm>
<para><computeroutput>long Bimage::mask_pack_plane (<link linkend="_class_matrix3">Matrix3</link> mat, double hi_res, double scale)</computeroutput></para><para>

<para>Packs a 2D mask into a 3D reciprocal space volume. 
<literallayout>&#160;&#xa;</literallayout>
 </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>mat</entry>
                                <entry>
<para>affine orientation matrix. </para>
</entry>
                            </row>
                            <row>
                                <entry>hi_res</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>scale. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long 0. <literallayout><computeroutput>The rotation matrix is used to determine the plane in reciprocal space
to set as one.
Both the high resolution limit and the scale must correspond to the 
associated reconstruction.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1285 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1acca2b4d4df22975e0790da09f03d6b13"/>    <section>
    <title>mask_plane()</title>
<indexterm><primary>mask_plane</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_plane</secondary></indexterm>
<para><computeroutput>long Bimage::mask_plane (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; origin, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; normal)</computeroutput></para><para>

<para>Generates a mask on one side of a plane. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>origin</entry>
                                <entry>
<para>any point on plane. </para>
</entry>
                            </row>
                            <row>
                                <entry>normal</entry>
                                <entry>
<para>plane normal. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long 0. <literallayout><computeroutput>The given image is used to generate a binary mask of the same size.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 553 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2b23d253a27fc9adead69d5f94f16ec7"/>    <section>
    <title>mask_rectangle()</title>
<indexterm><primary>mask_rectangle</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_rectangle</secondary></indexterm>
<para><computeroutput>long Bimage::mask_rectangle (double length, double width, double rect_angle, int wrap)</computeroutput></para><para>

<para>Generates a mask along an axis within a 2D image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>length</entry>
                                <entry>
<para>length along axis (pixels). </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>width perpendicular to axis (pixels). </para>
</entry>
                            </row>
                            <row>
                                <entry>rect_angle</entry>
                                <entry>
<para>angle from x-axis (radians). </para>
</entry>
                            </row>
                            <row>
                                <entry>wrap</entry>
                                <entry>
<para>flag to wrap around boundaries. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long 0. <literallayout><computeroutput>The input image is assumed to be a mask of 0&apos;s and 1&apos;s and is modified
according to the operation requested.
Only an axis in the xy plane is used, generating a rectangular mask
of given length and width around the axis, with its center at the
origins given in the image structure.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 608 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a94451f98c91c97bf0dee26b0b2a7deab"/>    <section>
    <title>mask_region_interfaces()</title>
<indexterm><primary>mask_region_interfaces</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_region_interfaces</secondary></indexterm>
<para><computeroutput>long Bimage::mask_region_interfaces (int reg_num)</computeroutput></para><para>

<para>Reports the whole interface matrix or interfaces for one region only. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>reg_num</entry>
                                <entry>
<para>region to report for (&lt;0 whole interface matrix). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long 0. <literallayout><computeroutput>The mask is converted to an integer mask.
An interface matrix is calculated to count the number of connected
voxels between every pair of regions.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2406 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab7a554846aee83da6a7c471ca3ae8636"/>    <section>
    <title>mask_shell()</title>
<indexterm><primary>mask_shell</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_shell</secondary></indexterm>
<para><computeroutput>long Bimage::mask_shell (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; origin, double rad_min, double rad_max)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 1382 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1aa1da94077a3d1099442e779a338873d3"/>    <section>
    <title>mask_split()</title>
<indexterm><primary>mask_split</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_split</secondary></indexterm>
<para><computeroutput>long Bimage::mask_split (long voxels_per_level)</computeroutput></para><para>

<para>Converts a mask to a multilevel mask with a given number of voxels per level. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>voxels_per_level</entry>
                                <entry>
<para>number of voxels per level. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of voxels retained. <literallayout><computeroutput>The new data replaces the old data.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1491 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af6366dbd7f4291754ee084a5a47aed4e"/>    <section>
    <title>mask_stats()</title>
<indexterm><primary>mask_stats</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_stats</secondary></indexterm>
<para><computeroutput>long Bimage::mask_stats ( )</computeroutput></para><para>

<para>Calculates statistics for a mask. </para>
</para>

<para><formalpara><title>Returns</title>

<para>long voxels in positive levels. <literallayout><computeroutput>The mask can be any type, but the regions in the mask are rounded to
the nearest integer for counting statistics.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 205 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a836137ddada36d9ee07e0c778597470c"/>    <section>
    <title>mask_symmetrize()</title>
<indexterm><primary>mask_symmetrize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mask_symmetrize</secondary></indexterm>
<para><computeroutput>long Bimage::mask_symmetrize (<link linkend="_struct_bsymmetry">Bsymmetry</link> &amp; sym)</computeroutput></para><para>

<para>Symetrizes a mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>sym</entry>
                                <entry>
<para>point group symmetry. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long maximum level index. </para>
</formalpara>
</para>
<para>
Definition at line 660 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad49ed68863064bb22ca6dc210a712f66"/>    <section>
    <title>mass_at_threshold()</title>
<indexterm><primary>mass_at_threshold</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mass_at_threshold</secondary></indexterm>
<para><computeroutput>double Bimage::mass_at_threshold (long img_num, double threshold, double rho)</computeroutput></para><para>

<para>Calculates the mass from the density threshold. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>img_num</entry>
                                <entry>
<para>sub-image number (first = 0). </para>
</entry>
                            </row>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>density threshold. </para>
</entry>
                            </row>
                            <row>
                                <entry>rho</entry>
                                <entry>
<para>protein density in Da/A3. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double threshold. <literallayout><computeroutput>An image is assumed to have density represented by higher (white) values.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 979 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6b9526b2fed89d032614d58b597db290"/>    <section>
    <title>mass_threshold()</title>
<indexterm><primary>mass_threshold</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mass_threshold</secondary></indexterm>
<para><computeroutput>double Bimage::mass_threshold (long img_num, double mol_weight, double rho)</computeroutput></para><para>

<para>Finds the density threshold associated with a particular molecular weight. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>img_num</entry>
                                <entry>
<para>sub-image number (first = 0,). </para>
</entry>
                            </row>
                            <row>
                                <entry>mol_weight</entry>
                                <entry>
<para>molecular weight. </para>
</entry>
                            </row>
                            <row>
                                <entry>rho</entry>
                                <entry>
<para>protein density in Da/A3. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>float threshold. <literallayout><computeroutput>A threshold value is determined which contour a density such that
it corresponds to 100% of the given molecular weight.
An image is assumed to have density represented by higher (white) values.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 890 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab8ceb4eeff446c3ed0cc5b937cab227c"/>    <section>
    <title>max_in_kernel()</title>
<indexterm><primary>max_in_kernel</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>max_in_kernel</secondary></indexterm>
<para><computeroutput>int Bimage::max_in_kernel (long ksize)</computeroutput></para><para>
Definition at line 348 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad56cad9380fe0b08593627bbc7f8d795"/>    <section>
    <title>maximum()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>maximum</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>maximum</secondary></indexterm>
<para><computeroutput>double Bimage::maximum ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 545 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a28e3f6e31813aa176f38b1a18e2d800c"/>    <section>
    <title>maximum()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>maximum</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>maximum</secondary></indexterm>
<para><computeroutput>void Bimage::maximum (double d)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 550 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a8043e568eb8132fa03ada899c4ac25fb"/>    <section>
    <title>maximum_included_radius()</title>
<indexterm><primary>maximum_included_radius</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>maximum_included_radius</secondary></indexterm>
<para><computeroutput>double Bimage::maximum_included_radius ( )</computeroutput></para><para>

<para>Returns the radius of the enclosed sphere or circle. </para>
</para>

<para><formalpara><title>Returns</title>

<para>double radius of largest sphere that will fit in an image. <literallayout><computeroutput>Returns the radius of the largest sphere or circle that will fit
inside a three- or two-dimensional image, respectively, or the 
midpoint of a one-dimensional image.
Assumes that the x, y, and z dimensions are the number of data points
in those respective directions, and that the length (in pixels)
of the respective dimensions is x, y, or z minus one.  The minimum 
length is two times the radius of the largest sphere that will fit 
inside the image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2095 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1add1b04d31f25a73455f662662193c9ac"/>    <section>
    <title>median_bin()</title>
<indexterm><primary>median_bin</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>median_bin</secondary></indexterm>
<para><computeroutput>int Bimage::median_bin (int binning)</computeroutput></para><para>

<para>Bins by an integer size, selecting the kernel median. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>binning</entry>
                                <entry>
<para>integer bin factor. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>An image is binned by an integer size, square in 2D and cubic in 3D.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 393 of file Bimage_bin.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a03a84149ddcfe364e0687f485939274e"/>    <section>
    <title>merge_amplitudes_and_phases()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>merge_amplitudes_and_phases</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>merge_amplitudes_and_phases</secondary></indexterm>
<para><computeroutput>double Bimage::merge_amplitudes_and_phases (<link linkend="_class_bimage">Bimage</link> * pamp)</computeroutput></para><para>

<para>Merges the amplitudes from one map with the phases of another. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pamp</entry>
                                <entry>
<para>amplitude image (simple or complex). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double RMSD of amplitudes. <literallayout><computeroutput>The amplitude image can be a floating point image or a complex image.
The phase image must be complex and its amplitudes are replaced by
the values from the amplitude image.
No statistics are calculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1288 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0c0ac2e1677fe947f84234716aba5e50"/>    <section>
    <title>merge_amplitudes_and_phases()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>merge_amplitudes_and_phases</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>merge_amplitudes_and_phases</secondary></indexterm>
<para><computeroutput>double Bimage::merge_amplitudes_and_phases (<link linkend="_class_bimage">Bimage</link> * pref, double res_hi, double res_lo)</computeroutput></para><para>

<para>Keeps selected phases and replaces amplitudes and other phases from a reference transform. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pref</entry>
                                <entry>
<para>reference Fourier transform. </para>
</entry>
                            </row>
                            <row>
                                <entry>res_hi</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>res_lo</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double RMSD of amplitudes. <literallayout><computeroutput>The input transform is considered to be modified in some way (such as solvent flattening).
Only the phases in the specified resolution shell are kept, while all
the other phases and amplitudes within the high resolution limit is
retrieved from the reference transform.
No statistics are calculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1336 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1afe54a4a2c6cf53d92675a2ddae01da17"/>    <section>
    <title>meta_data()</title>
<indexterm><primary>meta_data</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>meta_data</secondary></indexterm>
<para><computeroutput><link linkend="_class_j_svalue">JSvalue</link>&amp; Bimage::meta_data ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 220 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a6882144669b3c67abb55e76d4623a40b"/>    <section>
    <title>meta_data_retain_one_image()</title>
<indexterm><primary>meta_data_retain_one_image</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>meta_data_retain_one_image</secondary></indexterm>
<para><computeroutput>void Bimage::meta_data_retain_one_image (long img_num)</computeroutput></para><para>

<para>Erases all sub-image records from the meta data except one. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>img_num</entry>
                                <entry>
<para>sub-image number. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 780 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a772035b309aa215414b94b3e1f991920"/>    <section>
    <title>meta_data_update()</title>
<indexterm><primary>meta_data_update</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>meta_data_update</secondary></indexterm>
<para><computeroutput>void Bimage::meta_data_update ( )</computeroutput></para><para>

<para>Update metadata from the sub-image information. </para>
</para>

<para><literallayout><computeroutput>The sub-image information is encoded in the metadata in JSON format.
</computeroutput></literallayout> </para>
<para>
Definition at line 687 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a33db3f86c385dc4b3d8738d0ad0c59a3"/>    <section>
    <title>minimum()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>minimum</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>minimum</secondary></indexterm>
<para><computeroutput>double Bimage::minimum ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 544 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a9dc7ace6085b582d96077515becacf8f"/>    <section>
    <title>minimum()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>minimum</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>minimum</secondary></indexterm>
<para><computeroutput>void Bimage::minimum (double d)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 549 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1accac475d79e9c3cc1c6ebdc6f0148d69"/>    <section>
    <title>mirror()</title>
<indexterm><primary>mirror</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>mirror</secondary></indexterm>
<para><computeroutput>int Bimage::mirror ( )</computeroutput></para><para>

<para>Inverts/mirrors each image through its origin. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int number of images. <literallayout><computeroutput>Each image in a Bimage structure is inverted.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 563 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a4f3d8867cba26161c0d95971a8714496"/>    <section>
    <title>moments()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>moments</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>moments</secondary></indexterm>
<para><computeroutput>int Bimage::moments (long max_order)</computeroutput></para><para>

<para>Prints out moments for all sub-images. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int error code (&lt;0 means failure). </para>
</formalpara>
</para>
<para>
Definition at line 2670 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0fae7890cf81c93fa08a4234d426e72d"/>    <section>
    <title>moments()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>moments</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>moments</secondary></indexterm>
<para><computeroutput>int Bimage::moments (long max_order, long nn)</computeroutput></para><para>

<para>Prints out moments for one sub-image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>max_order</entry>
                                <entry>
<para>maximum order. </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code (&lt;0 means failure). </para>
</formalpara>
</para>
<para>
Definition at line 2687 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3de7d9fd87a5c93d12ae9e9366e33b7a"/>    <section>
    <title>montage()</title>
<indexterm><primary>montage</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>montage</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::montage (int first, int cols, int rows, int skip = <computeroutput>0</computeroutput>
, int flip = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Rearranges an image into a montage of 2D slices for display. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>cols</entry>
                                <entry>
<para>columns in montage. </para>
</entry>
                            </row>
                            <row>
                                <entry>rows</entry>
                                <entry>
<para>rows in montage. </para>
</entry>
                            </row>
                            <row>
                                <entry>first</entry>
                                <entry>
<para>first slice in montage. </para>
</entry>
                            </row>
                            <row>
                                <entry>skip</entry>
                                <entry>
<para>number of slices to skip. </para>
</entry>
                            </row>
                            <row>
                                <entry>flip</entry>
                                <entry>
<para>flip the order of panels on: 1=x axis, 2=y axis. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* montaged image. <literallayout><computeroutput>The slices of a 3D image are packed into a 2D montage.
The background value for the image is used for empty regions.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 49 of file Bimage_montage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1abc3633f91294bf9cd72154da5aa885b4"/>    <section>
    <title>moving_sum()</title>
<indexterm><primary>moving_sum</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>moving_sum</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::moving_sum (long window, long step = <computeroutput>1</computeroutput>
, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates a moving sum of the sub-images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>window</entry>
                                <entry>
<para>number of successive images to sum. </para>
</entry>
                            </row>
                            <row>
                                <entry>step</entry>
                                <entry>
<para>intervals between windows. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>if set, calculate average. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* moving sum/average image. <literallayout><computeroutput>Each successive subset of sub-images of size set by the window parameter are summed.
Where the window extends beyond the limits for the number of images,
the summation is just over the existing images.
The number of images depends on the step size.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 3583 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7f4694a4f5f907752135c39d67fb02eb"/>    <section>
    <title>multi_channel_to_complex()</title>
<indexterm><primary>multi_channel_to_complex</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>multi_channel_to_complex</secondary></indexterm>
<para><computeroutput>void Bimage::multi_channel_to_complex ( )</computeroutput></para><para>

<para>A multi-channel image is converted to a set of complex images. </para>
</para>

<para><literallayout><computeroutput>The input image channels are written into the real part of the complex image.
</computeroutput></literallayout> </para>
<para>
Definition at line 53 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a546a12884111b3559dd39393b33344e7"/>    <section>
    <title>multiply()<computeroutput>[1/6]</computeroutput></title>
<indexterm><primary>multiply</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>multiply</secondary></indexterm>
<para><computeroutput>void Bimage::multiply (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Multiplies all sub-images with the first sub-image of the other image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image multiplier. <literallayout><computeroutput>The other image is multiplied with the first.
Both images are converted to floating point.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 3822 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a06577441795cc23f8f149d453167f4f4"/>    <section>
    <title>multiply()<computeroutput>[2/6]</computeroutput></title>
<indexterm><primary>multiply</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>multiply</secondary></indexterm>
<para><computeroutput>void Bimage::multiply (<link linkend="_class_bimage">Bimage</link> * p, double scale, double shift = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Multiplies an image with another image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image multiplier. </para>
</entry>
                            </row>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>density scale to other image </para>
</entry>
                            </row>
                            <row>
                                <entry>shift</entry>
                                <entry>
<para>density shift to other image. <literallayout><computeroutput>Requirement: The images must have the same size.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 3777 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8f53c71f2d4540295de067659d4d3e26"/>    <section>
    <title>multiply()<computeroutput>[3/6]</computeroutput></title>
<indexterm><primary>multiply</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>multiply</secondary></indexterm>
<para><computeroutput>void Bimage::multiply (double v)</computeroutput></para><para>

<para>Multiplies an image with a constant value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>v</entry>
                                <entry>
<para>constant multiplier. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 3450 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad3852c4e4ecd306c5d6abc09f3d78f7f"/>    <section>
    <title>multiply()<computeroutput>[4/6]</computeroutput></title>
<indexterm><primary>multiply</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>multiply</secondary></indexterm>
<para><computeroutput>void Bimage::multiply (long j, <link linkend="_class_complex">Complex</link>&lt; double &gt; cv)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 320 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a62301788f8dd6bb54f498908100c6144"/>    <section>
    <title>multiply()<computeroutput>[5/6]</computeroutput></title>
<indexterm><primary>multiply</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>multiply</secondary></indexterm>
<para><computeroutput>void Bimage::multiply (long nn, <link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Multiplies a sub-image with another image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image to multiply. </para>
</entry>
                            </row>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image multiplier. <literallayout><computeroutput>Requirement: The images must have the same size.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 3802 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aba8ca57c4383b415ab312f8be4fcf309"/>    <section>
    <title>multiply()<computeroutput>[6/6]</computeroutput></title>
<indexterm><primary>multiply</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>multiply</secondary></indexterm>
<para><computeroutput>void Bimage::multiply (long nn, double v)</computeroutput></para><para>

<para>Multiplies a sub-image with a constant value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>v</entry>
                                <entry>
<para>constant multiplier. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 3471 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aec5451bc9105d457fb967a025bd0c0cd"/>    <section>
    <title>nad()</title>
<indexterm><primary>nad</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>nad</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::nad (double ht, long zw, double lambda, double C, double alpha)</computeroutput></para><para>

<para>Denoises a 3D density map by non-linear anisotropic diffusion. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>ht</entry>
                                <entry>
<para>time step size, 0 &lt; ht &lt;= 0.25. </para>
</entry>
                            </row>
                            <row>
                                <entry>zw</entry>
                                <entry>
<para>slab size for piece-wise denoising. </para>
</entry>
                            </row>
                            <row>
                                <entry>lambda</entry>
                                <entry>
<para>lamda parameter for EED. </para>
</entry>
                            </row>
                            <row>
                                <entry>C</entry>
                                <entry>
<para>coherence parameter for CED. </para>
</entry>
                            </row>
                            <row>
                                <entry>alpha</entry>
                                <entry>
<para>. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* new image. <literallayout><computeroutput>The diffusion tensor is calculated with the aim of enhancing edges (EED)
or planes (CED).
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 580 of file Bimage_nad.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2ec6da2aebaf06f411b5a98f2ecedae9"/>    <section>
    <title>nad_2D()</title>
<indexterm><primary>nad_2D</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>nad_2D</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::nad_2D (double ht, double lambda, double C, double alpha)</computeroutput></para><para>

<para>Denoises a 2D image by non-linear anisotropic diffusion. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>ht</entry>
                                <entry>
<para>time step size, 0 &lt; ht &lt;= 0.25. </para>
</entry>
                            </row>
                            <row>
                                <entry>lambda</entry>
                                <entry>
<para>lamda parameter for EED. </para>
</entry>
                            </row>
                            <row>
                                <entry>C</entry>
                                <entry>
<para>coherence parameter for CED. </para>
</entry>
                            </row>
                            <row>
                                <entry>alpha</entry>
                                <entry>
<para>. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* new image. <literallayout><computeroutput>The diffusion tensor is calculated with the aim of enhancing edges (EED)
or planes (CED).
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 554 of file Bimage_nad.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ada19a7de518b9a3ae873b75729c8f74a"/>    <section>
    <title>noise_gaussian()</title>
<indexterm><primary>noise_gaussian</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>noise_gaussian</secondary></indexterm>
<para><computeroutput>int Bimage::noise_gaussian (double ravg = <computeroutput>0</computeroutput>
, double rstd = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Generates an image with a gaussian random distribution of densities. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>ravg</entry>
                                <entry>
<para>average. </para>
</entry>
                            </row>
                            <row>
                                <entry>rstd</entry>
                                <entry>
<para>standard deviation. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>An image with a given datatype, number of subimages, and size is
generated with densities with a gaussian distribution with a given
average and standard deviation:
    density = average + std_dev*sqrt(-2*log(random_value))*
                    cos(2*PI*random_value);
where random_value is between 0 and 1.
The output image is floating point.
Statistics are calculated before returning.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 72 of file Bimage_noise.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2b440a133368904a12132742c4c8c07d"/>    <section>
    <title>noise_logistical()</title>
<indexterm><primary>noise_logistical</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>noise_logistical</secondary></indexterm>
<para><computeroutput>int Bimage::noise_logistical (double ravg, double rstd)</computeroutput></para><para>

<para>Generates an image with a gaussian random distribution of densities. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>ravg</entry>
                                <entry>
<para>average. </para>
</entry>
                            </row>
                            <row>
                                <entry>rstd</entry>
                                <entry>
<para>standard deviation. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>An image with a given datatype, number of subimages, and size is
generated with densities with a logistical differential distribution 
with a given average and standard deviation:
    density = average + (std_dev/golden)*ln(1/random_value - 1)
where random_value is between 0 and 1 and:
    golden  = (sqrt(5) + 1)/2
The output image is floating point.
Statistics are calculated before returning.
</computeroutput></literallayout> Reference: Press W.H. et al (1992) Numerical Recipes in C. </para>
</formalpara>
</para>
<para>
Definition at line 156 of file Bimage_noise.cpp.</para>
    </section><anchor xml:id="_class_bimage_1adc4e6a903ad879bba330eb40f419d8ac"/>    <section>
    <title>noise_poisson()</title>
<indexterm><primary>noise_poisson</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>noise_poisson</secondary></indexterm>
<para><computeroutput>int Bimage::noise_poisson (double ravg)</computeroutput></para><para>

<para>Generates an image with a poisson random distribution of densities. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>ravg</entry>
                                <entry>
<para>average. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>Algorithm taken from Numerical Recipes in C.
The poisson distribution is given for j = 0,1,... by:
            avg^j * exp(-avg)
    P(j) = -----------------
                   j!
Note that only positive integer values are defined for j and sum(P(j)) = 1.
An array of floating point numbers is generated with a poisson 
distribution with a given average. The standard deviation is:
    std = sqrt(avg)
If the average &lt;= 0, the function exits.
Statistics are calculated before returning.
</computeroutput></literallayout> Reference: Press W.H. et al (1992) Numerical Recipes in C. </para>
</formalpara>
</para>
<para>
Definition at line 115 of file Bimage_noise.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0be1dd59316cc9ba6cb3af8a2cd7364f"/>    <section>
    <title>noise_spectral()</title>
<indexterm><primary>noise_spectral</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>noise_spectral</secondary></indexterm>
<para><computeroutput>int Bimage::noise_spectral (double alpha)</computeroutput></para><para>

<para>Generates a noise map with a defined spectral decay. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>alpha</entry>
                                <entry>
<para>spectral decay. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>Uniform random phases are generated and the amplitudes are set to:
    amp = s^(-alpha/2).
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 184 of file Bimage_noise.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8789a73a0157946672911c639e820126"/>    <section>
    <title>noise_uniform()</title>
<indexterm><primary>noise_uniform</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>noise_uniform</secondary></indexterm>
<para><computeroutput>int Bimage::noise_uniform (double rmin, double rmax)</computeroutput></para><para>

<para>Generates an image with a uniform random distribution of densities. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>rmin</entry>
                                <entry>
<para>minimum density value. </para>
</entry>
                            </row>
                            <row>
                                <entry>rmax</entry>
                                <entry>
<para>maximum density value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>An image with a given datatype, number of subimages, and size is
generated with densities distributed uniformly in the range of the
given minimum and maximum:
    density = random_value*(max - min) + min
where random_value is between 0 and 1.
The average and standard deviation are:
    average = (max + min)/2
    standard deviation = 0.5*sqrt(1/3)*(max - min).
The output image is floating point.
Statistics are calculated before returning.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 34 of file Bimage_noise.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a9b6cf645edf16da07022babcacf20692"/>    <section>
    <title>normalize()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>normalize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>normalize</secondary></indexterm>
<para><computeroutput>int Bimage::normalize (double average, double stdev, int norm_type)</computeroutput></para><para>

<para>Normalizes a set of images to a desired average and standard deviation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>average</entry>
                                <entry>
<para>desired average. </para>
</entry>
                            </row>
                            <row>
                                <entry>stdev</entry>
                                <entry>
<para>desired standard deviation (if 0, use defaults). </para>
</entry>
                            </row>
                            <row>
                                <entry>norm_type</entry>
                                <entry>
<para>type of determining the effective average and standard deviation: 0=simple, 1=Gaussian, 2=Poisson. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The effective average and standard deviation for each image is obtained
in one of three ways:
    0.      The simple avergae and standard devaition for the image.
    1.      Gaussian fit of the histogram.
    2.      Poisson fit of the histogram.
A histogram of an image is calculated with a given number of bins.
The histogram is fit to a Gaussian or Poisson function with exclusion of a
small number of bins in the histogram (defined as outliers).
The effective average and standard deviation are used to 
rescale the data for each image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 536 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1add3eb1f754594a556d8a2d43a074b91a"/>    <section>
    <title>normalize()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>normalize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>normalize</secondary></indexterm>
<para><computeroutput>int Bimage::normalize (long imgnum, double average, double stdev, int norm_type, long bins)</computeroutput></para><para>

<para>Normalizes a sub-image to a desired average and standard deviation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>imgnum</entry>
                                <entry>
<para>sub-image number. </para>
</entry>
                            </row>
                            <row>
                                <entry>average</entry>
                                <entry>
<para>desired average. </para>
</entry>
                            </row>
                            <row>
                                <entry>stdev</entry>
                                <entry>
<para>desired standard deviation (if 0, use defaults). </para>
</entry>
                            </row>
                            <row>
                                <entry>norm_type</entry>
                                <entry>
<para>type of determining the effective average and standard deviation: 0=simple, 1=Gaussian, 2=Poisson. </para>
</entry>
                            </row>
                            <row>
                                <entry>bins</entry>
                                <entry>
<para>number of histogram bins required to fit distributions. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The effective average and standard deviation for each image is obtained
in one of three ways:
    0.      The simple avergae and standard devaition for the image.
    1.      Gaussian fit of the histogram.
    2.      Poisson fit of the histogram.
A histogram of an image is calculated with a given number of bins.
The histogram is fit to a Gaussian or Poisson function with exclusion of a
small number of bins in the histogram (defined as outliers).
The effective average and standard deviation are used to 
rescale the data for each image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 481 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0d99849ef19cf0e3af2adeb2182ed0a2"/>    <section>
    <title>normalize_local()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>normalize_local</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>normalize_local</secondary></indexterm>
<para><computeroutput>int Bimage::normalize_local (long kernel_size)</computeroutput></para><para>

<para>Normalizes by subtracting local average and dividing by local standard deviation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>kernel_size</entry>
                                <entry>
<para>size of kernel edge. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The local average and standard deviation within a kernel is calculated 
and used to normalize the image.
The convolution is threaded if compiled with GCD or OpenMP.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 608 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a673b8d495c7e50207c95034787cae2b6"/>    <section>
    <title>normalize_local()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>normalize_local</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>normalize_local</secondary></indexterm>
<para><computeroutput>int Bimage::normalize_local (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; kernel)</computeroutput></para><para>

<para>Normalizes by subtracting local average and dividing by local standard deviation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>kernel</entry>
                                <entry>
<para>size of kernel edge. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The local average and standard deviation within a kernel is calculated 
and used to normalize the image.
The convolution is threaded if compiled with GCD or OpenMP.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 625 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a80baea1fc2db2bac3aa5837f7396c0d4"/>    <section>
    <title>one_color()</title>
<indexterm><primary>one_color</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>one_color</secondary></indexterm>
<para><computeroutput>int Bimage::one_color (int color, double cmin, double cmax, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Converts a gray-scale image to a single color. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>color</entry>
                                <entry>
<para>color selection (0=red, 1=green, 2=blue). </para>
</entry>
                            </row>
                            <row>
                                <entry>cmin</entry>
                                <entry>
<para>lower grayscale boundary. </para>
</entry>
                            </row>
                            <row>
                                <entry>cmax</entry>
                                <entry>
<para>upper grayscale boundary. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>sets the type of conversion. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>A grayscale image is converted to a selected color between the given minimum and maximum.
The flag parameter bit:
    bit 1       calculate a subtractive color range.
    bit 2       keep the ranges beyond the minimum and maximum as gray
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 247 of file Bimage_color.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aad018ca33d662271a36e48fbf559240d"/>    <section>
    <title>operator+()</title>
<indexterm><primary>operator+</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>operator+</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::operator+ (<link linkend="_class_bimage">Bimage</link> &amp; p)</computeroutput></para><para>

<para>Adds two images together, adjusting for size difference. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>&amp;p</entry>
                                <entry>
<para>image to add. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* summed image, NULL on error. <literallayout><computeroutput>The second image is added to the first:
    image1 = image1 + image2*scale + shift
The resultant image size is the bigger of the two.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 4034 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a04b048e81f60b70ed447b2f320fd2a84"/>    <section>
    <title>operator=()</title>
<indexterm><primary>operator=</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>operator=</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> &amp; Bimage::operator= (const <link linkend="_class_bimage">Bimage</link> &amp; p)</computeroutput></para><para>

<para>Assigns an image. </para>
</para>

<para><literallayout><computeroutput>The internal copy function is called.
</computeroutput></literallayout> </para>
<para>
Definition at line 920 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae7e22c15acc26a18a01f9ffe932dc7dd"/>    <section>
    <title>operator[]()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>operator[]</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>operator[]</secondary></indexterm>
<para><computeroutput>double Bimage::operator[] (long j) const</computeroutput></para><para>

<para>Returns the data value at the given index. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>j</entry>
                                <entry>
<para>index. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double value. <literallayout><computeroutput>The elemental data value is returned in double precision.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 937 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab93e5357d409d9ac9cb30c7f39fd961a"/>    <section>
    <title>operator[]()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>operator[]</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>operator[]</secondary></indexterm>
<para><computeroutput><link linkend="_class_j_svalue">JSvalue</link>&amp; Bimage::operator[] (string tag)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 221 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a9c6011cf7fd6d019afb2c0025e949d30"/>    <section>
    <title>orient()</title>
<indexterm><primary>orient</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>orient</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::orient (<link linkend="_class_view">View</link> * views)</computeroutput></para><para>

<para>Calculates multiple copies oriented according to views. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>views</entry>
                                <entry>
<para>orientations for new images. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* new set of images. <literallayout><computeroutput>Each image in a Bimage structure is rotated to the corresponding view.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 529 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1abbbc219bc9f6b027e29563617a756bbd"/>    <section>
    <title>origin()<computeroutput>[1/6]</computeroutput></title>
<indexterm><primary>origin</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>origin</secondary></indexterm>
<para><computeroutput>void Bimage::origin (double ox, double oy, double oz)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 574 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a26f0c689d93792813cd398f42b0eeabf"/>    <section>
    <title>origin()<computeroutput>[2/6]</computeroutput></title>
<indexterm><primary>origin</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>origin</secondary></indexterm>
<para><computeroutput>void Bimage::origin (long nn, double ox, double oy, double oz)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 593 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a98e0a30cc0f50a48a0cb5e6301a51ea0"/>    <section>
    <title>origin()<computeroutput>[3/6]</computeroutput></title>
<indexterm><primary>origin</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>origin</secondary></indexterm>
<para><computeroutput>void Bimage::origin (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 586 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1af34a10d6c3278ff9f9aeafd0eef4e55c"/>    <section>
    <title>origin()<computeroutput>[4/6]</computeroutput></title>
<indexterm><primary>origin</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>origin</secondary></indexterm>
<para><computeroutput>void Bimage::origin (long nn, vector&lt; double &gt; ori)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 589 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a1395858573fc8bc13d5d1ab966f09625"/>    <section>
    <title>origin()<computeroutput>[5/6]</computeroutput></title>
<indexterm><primary>origin</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>origin</secondary></indexterm>
<para><computeroutput>void Bimage::origin (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 582 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a0b38a7622f63be6254386f29aee89d57"/>    <section>
    <title>origin()<computeroutput>[6/6]</computeroutput></title>
<indexterm><primary>origin</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>origin</secondary></indexterm>
<para><computeroutput>void Bimage::origin (vector&lt; double &gt; vec)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 578 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a355e6600b5f741910cb5ddfbd3b561f6"/>    <section>
    <title>orthogonal_slices()</title>
<indexterm><primary>orthogonal_slices</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>orthogonal_slices</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::orthogonal_slices (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; voxel, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; ext_size)</computeroutput></para><para>

<para>Extracts orthogonal views around a voxel. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number to extract. </para>
</entry>
                            </row>
                            <row>
                                <entry>voxel</entry>
                                <entry>
<para>voxel of intersection. </para>
</entry>
                            </row>
                            <row>
                                <entry>ext_size</entry>
                                <entry>
<para>size of slices to extract. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* extracted slice for 2D and 3 slices for 3D. <literallayout><computeroutput>Only the desired region is extracted from the original image.
The fill value is taken from the image background.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 767 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a89cdfb0e8c07177ab797bfacd8cf7136"/>    <section>
    <title>otsu_threshold()</title>
<indexterm><primary>otsu_threshold</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>otsu_threshold</secondary></indexterm>
<para><computeroutput>double Bimage::otsu_threshold (long bins)</computeroutput></para><para>

<para>Calculates the threshold from a histogram according to Otsu. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>bins</entry>
                                <entry>
<para>number bins in histogram. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double threshold. <literallayout><computeroutput>Reference: NOBUYUKI OTSU, IEEE TRANSACTIONS ON SYSTEMS, MAN, AND CYBERNETICS, VOL. SMC-9, NO. 1, JANUARY 1979
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 694 of file Bimage_histogram.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8a1320da7a667791d7caf69d8de5f334"/>    <section>
    <title>otsu_variance()</title>
<indexterm><primary>otsu_variance</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>otsu_variance</secondary></indexterm>
<para><computeroutput>vector&lt; double &gt; Bimage::otsu_variance (vector&lt; long &gt; h)</computeroutput></para><para>

<para>Calculates the inter-set variance of the bisection of a historgram using the method of Otsu. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>h</entry>
                                <entry>
<para>histogram. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>vector&lt;double&gt; variance. <literallayout><computeroutput>Reference: NOBUYUKI OTSU, IEEE TRANSACTIONS ON SYSTEMS, MAN, AND CYBERNETICS, VOL. SMC-9, NO. 1, JANUARY 1979
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 735 of file Bimage_histogram.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aac6a00076ac48cd4a17d3aa9504ba5ed"/>    <section>
    <title>pack_transform()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>pack_transform</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>pack_transform</secondary></indexterm>
<para><computeroutput>int Bimage::pack_transform (int img_select, unsigned char * data, <link linkend="__bimage_8h_1a01e0deba350901d769526633e868806f">FourierType</link> tf)</computeroutput></para><para>
Definition at line 2509 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3d0d22533e811d43ee246eae948bb5a8"/>    <section>
    <title>pack_transform()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>pack_transform</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>pack_transform</secondary></indexterm>
<para><computeroutput>int Bimage::pack_transform (unsigned char * data, <link linkend="__bimage_8h_1a01e0deba350901d769526633e868806f">FourierType</link> tf)</computeroutput></para><para>
Definition at line 2504 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a4fdf88c178b8f32dafefe99468a543c6"/>    <section>
    <title>pack_two_in_complex()</title>
<indexterm><primary>pack_two_in_complex</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>pack_two_in_complex</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::pack_two_in_complex (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Packs two real images into one complex image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>second image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* the new complex image, NULL on error. <literallayout><computeroutput>Two real space images are packed into the real and imaginary parts
of a new data block with conversion from the original non-complex type.
The header values of the first image are adopted for the new image.
No statistics are calculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 744 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a130d1713a0034d563b93034b05680768"/>    <section>
    <title>pad()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>pad</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>pad</secondary></indexterm>
<para><computeroutput>int Bimage::pad (long sz, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Pads an image to a new size with a given fill value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>sz</entry>
                                <entry>
<para>new size. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value to use when padding the image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The image is enlarged with padding only on one side in each
dimension with an input size greater than one.
The data type is preserved.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 347 of file Bimage_resize.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8f7768e1c67e5fcb2a57d36878003b93"/>    <section>
    <title>pad()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>pad</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>pad</secondary></indexterm>
<para><computeroutput>int Bimage::pad (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; sz, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Pads an image to a new size with a given fill value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>sz</entry>
                                <entry>
<para>new size. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value to use when padding the image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0.</para>
</formalpara>
The image is enlarged with padding only on one side in each dimension with an input size greater than one. The data type is preserved. </para>
<para>
Definition at line 370 of file Bimage_resize.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a211fe34d03f455a6da9ffae457618b29"/>    <section>
    <title>pad_copy()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>pad_copy</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>pad_copy</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::pad_copy (long sz, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Pads an image to a new size with a given fill value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>sz</entry>
                                <entry>
<para>new size. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value to use when padding the image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* resized image. <literallayout><computeroutput>The image is enlarged with padding only on one side in each
dimension with an input size greater than one.
The data type is preserved.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 388 of file Bimage_resize.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2a7d060153f985a71eb45ce5dd52ed5a"/>    <section>
    <title>pad_copy()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>pad_copy</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>pad_copy</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::pad_copy (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; sz, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Pads an image to a new size with a given fill value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>sz</entry>
                                <entry>
<para>new size. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value to use when padding the image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* resized image.</para>
</formalpara>
The image is enlarged with padding only on one side in each dimension with an input size greater than one. The data type is preserved. </para>
<para>
Definition at line 411 of file Bimage_resize.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac787040056b9bf818fbed85b274d5966"/>    <section>
    <title>page_size()<computeroutput>[1/4]</computeroutput></title>
<indexterm><primary>page_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>page_size</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt;long&gt; Bimage::page_size ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 496 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a6a2a0a9e54ad670ae18e36cf0c2ad397"/>    <section>
    <title>page_size()<computeroutput>[2/4]</computeroutput></title>
<indexterm><primary>page_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>page_size</secondary></indexterm>
<para><computeroutput>void Bimage::page_size (long nx, long ny, long nz)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 497 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a9f4598b33854f980fbc035ad2745380e"/>    <section>
    <title>page_size()<computeroutput>[3/4]</computeroutput></title>
<indexterm><primary>page_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>page_size</secondary></indexterm>
<para><computeroutput>void Bimage::page_size (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; vec)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 501 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1acde654e87de96fccb0b430c9ac1c7693"/>    <section>
    <title>page_size()<computeroutput>[4/4]</computeroutput></title>
<indexterm><primary>page_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>page_size</secondary></indexterm>
<para><computeroutput>void Bimage::page_size (vector&lt; long &gt; vec)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 502 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a200da2cfe749e4702e39b95e3128355f"/>    <section>
    <title>peak_sigma()</title>
<indexterm><primary>peak_sigma</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>peak_sigma</secondary></indexterm>
<para><computeroutput>double Bimage::peak_sigma (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; coor, long kernel_size)</computeroutput></para><para>

<para>Calculates a sigma value for a cross-correlation peak. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>coor</entry>
                                <entry>
<para>coordinates in the image. </para>
</entry>
                            </row>
                            <row>
                                <entry>kernel_size</entry>
                                <entry>
<para>kernel size to fit the gaussian. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double sigma value. <literallayout><computeroutput>The peak is assumed to be close to a gaussian.
The sigma is calculated for each kernel location and averaged:
    sigma = sqrt(rad^2/2(ln(vmax)-ln(v)))
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2008 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aaf5664a095dcb822b3236ccfcc2b7165"/>    <section>
    <title>percentiles()</title>
<indexterm><primary>percentiles</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>percentiles</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::percentiles ( )</computeroutput></para><para>

<para>Calculates the percentiles from the histogram of an image. </para>
</para>

<para><formalpara><title>Returns</title>

<para>Bplot* plot of the percentiles. <literallayout><computeroutput>A histogram of an image is calculated with 10000 bins.
The percentiles are calculated from the running sum of the histogram
and returned in a plot.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 468 of file Bimage_histogram.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3af3c37bff79cfdec5c4ab443d00a3b7"/>    <section>
    <title>periodic_averaging()</title>
<indexterm><primary>periodic_averaging</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>periodic_averaging</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::periodic_averaging (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; period)</computeroutput></para><para>

<para>Calculates an average within a periodic frame. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>period</entry>
                                <entry>
<para>size of periodic frame. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* new image. </para>
</formalpara>
</para>
<para>
Definition at line 1263 of file Bimage_filter.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3f15772a51c0eb1d502fe03d423fba69"/>    <section>
    <title>phase_colour_wheel()</title>
<indexterm><primary>phase_colour_wheel</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>phase_colour_wheel</secondary></indexterm>
<para><computeroutput>int Bimage::phase_colour_wheel ( )</computeroutput></para><para>

<para>Generates a phase color wheel. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The image is filled with a color wheel where the location (x,y) 
is converted to polar form:
    a = arctan(y/x)
    r = sqrt(x^2+y^2)
The color is a function of the angle a and saturation is a function
of the distance from the origin.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 574 of file Bimage_color.cpp.</para>
    </section><anchor xml:id="_class_bimage_1acfe39f90afbe00c91da38a7536dc6fb8"/>    <section>
    <title>phase_difference()</title>
<indexterm><primary>phase_difference</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>phase_difference</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::phase_difference (<link linkend="_class_bimage">Bimage</link> * p, int type = <computeroutput>0</computeroutput>
, double res_hi = <computeroutput>0</computeroutput>
, double res_lo = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates the cosine of the phase difference between two images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>real space reference image. </para>
</entry>
                            </row>
                            <row>
                                <entry>type</entry>
                                <entry>
<para>0=phase angle, 1=cos(phase angle), 2=scale by amplitude product </para>
</entry>
                            </row>
                            <row>
                                <entry>res_hi</entry>
                                <entry>
<para>upper resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>res_lo</entry>
                                <entry>
<para>lower resolution limit. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* phase difference image. <literallayout><computeroutput>Both images are Fourier transformed and the cosine of the phase
difference calculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2103 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a5afda6e89e9c754d281e416fd0a64a1e"/>    <section>
    <title>phase_flip()</title>
<indexterm><primary>phase_flip</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>phase_flip</secondary></indexterm>
<para><computeroutput>int Bimage::phase_flip (<link linkend="_class_bimage">Bimage</link> * pd)</computeroutput></para><para>

<para>Flips the phases of an image based on a phase difference map. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pd</entry>
                                <entry>
<para>reciprocal space phase difference map. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. </para>
</formalpara>
</para>
<para>
Definition at line 2289 of file Bimage_fspace.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a634b527816eb889e18c2b945cbee91f9"/>    <section>
    <title>phase_shift()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>phase_shift</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>phase_shift</secondary></indexterm>
<para><computeroutput>int Bimage::phase_shift (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; shift)</computeroutput></para><para>

<para>Phase shifts a complex sub-image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image to transform. </para>
</entry>
                            </row>
                            <row>
                                <entry>shift</entry>
                                <entry>
<para>three-value real space shift vector. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>A real space translation with wrapping is equivalent to phase shifting
in reciprocal space.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 327 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3d1e6fe27d9a3cabcf908748000ede94"/>    <section>
    <title>phase_shift()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>phase_shift</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>phase_shift</secondary></indexterm>
<para><computeroutput>int Bimage::phase_shift (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; shift)</computeroutput></para><para>

<para>Phase shifts a complex image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>shift</entry>
                                <entry>
<para>three-value real space shift vector. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>A real space translation with wrapping is equivalent to phase shifting
in reciprocal space.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 303 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aacdc9509fb8666efb3b60141d95aa36d"/>    <section>
    <title>phase_shift_to_center()</title>
<indexterm><primary>phase_shift_to_center</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>phase_shift_to_center</secondary></indexterm>
<para><computeroutput>int Bimage::phase_shift_to_center ( )</computeroutput></para><para>

<para>Phase shifts a set of reflections to the nominal center of the image origin. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>A real space translation with wrapping is equivalent to phase shifting
in reciprocal space. The phases are shifted based on the embedded
sub-image origins.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 429 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a19989b5365083532862811255c06b538"/>    <section>
    <title>phase_shift_to_origin()</title>
<indexterm><primary>phase_shift_to_origin</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>phase_shift_to_origin</secondary></indexterm>
<para><computeroutput>int Bimage::phase_shift_to_origin ( )</computeroutput></para><para>

<para>Phase shifts a set of reflections to the image origin. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>A real space translation with wrapping is equivalent to phase shifting
in reciprocal space. The phases are shifted based on the embedded
sub-image origins.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 374 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af1d647152e38cede66380147e1bcf1ca"/>    <section>
    <title>place()</title>
<indexterm><primary>place</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>place</secondary></indexterm>
<para><computeroutput>int Bimage::place (long nn, <link linkend="_class_bimage">Bimage</link> * p, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; loc, double radius = <computeroutput>0</computeroutput>
, double scale = <computeroutput>1</computeroutput>
, double shift = <computeroutput>0</computeroutput>
, int operation = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Places a small image into a large image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image to place. </para>
</entry>
                            </row>
                            <row>
                                <entry>loc</entry>
                                <entry>
<para>location in large image of small image origin. </para>
</entry>
                            </row>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>radial mask to transfer small image. </para>
</entry>
                            </row>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>density scale to apply to second image. </para>
</entry>
                            </row>
                            <row>
                                <entry>shift</entry>
                                <entry>
<para>density shift to apply to second image. </para>
</entry>
                            </row>
                            <row>
                                <entry>operation</entry>
                                <entry>
<para>operation to apply. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 if error. <literallayout><computeroutput>The small image is placed with its origin at given origin in the large image.
The second image is scaled and shifted before placing into the first:
    image1 = image1 + image2*scale + shift
Both images are converted to floating point.
The operation can be selected:
    0   simple addition.
    1   replace if smaller.
    2   replace if larger.
Requirement: Both images must have the same pixel size.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 176 of file Bimage_combine.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a1435a37676ede35fc90a5414851a0c41"/>    <section>
    <title>place_central_part()</title>
<indexterm><primary>place_central_part</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>place_central_part</secondary></indexterm>
<para><computeroutput>int Bimage::place_central_part (<link linkend="_class_bimage">Bimage</link> * p, long nn)</computeroutput></para><para>

<para>Packs a tile into a new composite image, retaining only the central part. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image = tiles. </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>tile image (can be a sub-image). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The overlaps between tiles are divided between the neighboring tiles.
The tile placement is in the sub-image origins.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 356 of file Bimage_combine.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a9011e8d831cdcc0327736162163abd17"/>    <section>
    <title>place_with_addition()</title>
<indexterm><primary>place_with_addition</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>place_with_addition</secondary></indexterm>
<para><computeroutput>int Bimage::place_with_addition (<link linkend="_class_bimage">Bimage</link> * p, long nn)</computeroutput></para><para>

<para>Packs a tile into a new composite image with addition within overlap. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image = tiles. </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>tile image (can be a sub-image). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The tiles are added to the image.
The contributions at each voxel are counted in a linked image.
The tile placement is in the sub-image origins.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 240 of file Bimage_combine.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a421ea2ee53d684fb3a5c54f46a0e8b2a"/>    <section>
    <title>place_with_overlap()</title>
<indexterm><primary>place_with_overlap</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>place_with_overlap</secondary></indexterm>
<para><computeroutput>int Bimage::place_with_overlap (<link linkend="_class_bimage">Bimage</link> * p, long nn)</computeroutput></para><para>

<para>Packs a tile into a new composite image with weighted overlap. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image = tiles. </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>tile image (can be a sub-image). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The overlaps between tiles are filled in with a weighted average based
on a linear transition from one to the other.
The tile placement is in the sub-image origins.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 282 of file Bimage_combine.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a43916985ee29b7482e3d0bbcd97b68b7"/>    <section>
    <title>plot()</title>
<indexterm><primary>plot</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>plot</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::plot ( )</computeroutput></para><para>

<para>Converts a one-dimensional image into a plot. </para>
</para>

<para><formalpara><title>Returns</title>

<para>Bplot* plot structure.</para>
</formalpara>
Each image generates one plot with each channel converted to a curve. </para>
<para>
Definition at line 4111 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a870a8b94b0a187b9020eb97a01c98962"/>    <section>
    <title>poisson_statistics_check()</title>
<indexterm><primary>poisson_statistics_check</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>poisson_statistics_check</secondary></indexterm>
<para><computeroutput>double Bimage::poisson_statistics_check ( )</computeroutput></para><para>

<para>Checks whether the statistics conform to a Poisson distribution. </para>
</para>

<para><formalpara><title>Returns</title>

<para>double variance-to-average scale. <literallayout><computeroutput>A warning is issued when the variance/average differs more than 5% from one.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 197 of file Bimage_stats.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a426b883cb5948d3d72776e8dab1370be"/>    <section>
    <title>polar_power_spectrum()</title>
<indexterm><primary>polar_power_spectrum</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>polar_power_spectrum</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::polar_power_spectrum (double resolution, long num_angle)</computeroutput></para><para>

<para>Calculates the polar power spectrum of a 2D transform amplitude or intensity image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>num_angle</entry>
                                <entry>
<para>number of angles to use for interpolation. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* polar power spectrum. <literallayout><computeroutput>The length of each annulus is number of angles times the radial offset.
The samples on each annulus are calculated by bilinear interpolation.
The maximum annulus calculated depends on the resolution limit specified
in the input image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 771 of file Bimage_polar.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a013af83454914211aea16cea113711a5"/>    <section>
    <title>polar_transform()</title>
<indexterm><primary>polar_transform</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>polar_transform</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::polar_transform (long nangles, long ann_min, long ann_max, long dann, long zmin, long zmax, long zinc)</computeroutput></para><para>

<para>Calculates an image with cylindrical coordinates by integration. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nangles</entry>
                                <entry>
<para>number of angles in each annulus. </para>
</entry>
                            </row>
                            <row>
                                <entry>ann_min</entry>
                                <entry>
<para>minimum annulus (pixels). </para>
</entry>
                            </row>
                            <row>
                                <entry>ann_max</entry>
                                <entry>
<para>maximum annulus (pixels). </para>
</entry>
                            </row>
                            <row>
                                <entry>dann</entry>
                                <entry>
<para>width of annulus (pixels). </para>
</entry>
                            </row>
                            <row>
                                <entry>zmin</entry>
                                <entry>
<para>minimum z (pixels). </para>
</entry>
                            </row>
                            <row>
                                <entry>zmax</entry>
                                <entry>
<para>maximum z (pixels). </para>
</entry>
                            </row>
                            <row>
                                <entry>zinc</entry>
                                <entry>
<para>increment in z (pixels). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* cylindrical image. <literallayout><computeroutput>The image is converted to cylindrical form by integrating blocks 
    with a defined annular width and thickness in z at each angle. 
The resultant image contains lines corresponding to integrated blocks
    covering 360° of angle.
The sampling must be isotropic.
The origins within the sub-image structures are used.
The interpolation routine actually calculates the old cartesian 
coordinates for each set of cylindrical coordinates.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 696 of file Bimage_polar.cpp.</para>
    </section><anchor xml:id="_class_bimage_1afe8d4e28cfbfe3c22d340b7e1d20fb77"/>    <section>
    <title>power()</title>
<indexterm><primary>power</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>power</secondary></indexterm>
<para><computeroutput>void Bimage::power (double v)</computeroutput></para><para>

<para>Calculates the power of an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>v</entry>
                                <entry>
<para>power value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 3488 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a073293aef6831dbcd752ec0b6335e55e"/>    <section>
    <title>power_spectrum()</title>
<indexterm><primary>power_spectrum</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>power_spectrum</secondary></indexterm>
<para><computeroutput>int Bimage::power_spectrum (int flags = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates a power spectrum. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>flags</entry>
                                <entry>
<para>1=norm, 2=avg, 4=shift, 8=log. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>All the sub-images are Fourier transformed.
The flags variable controls options base don which bits are set:
    1   normalize image before transformation
    2   average all power spectra
    4   shift the origin to the center
    8   calculate the logarithm of the power spectrum
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 49 of file Bimage_powerspectrum.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3f3d62db989c0a47443622038e615fb4"/>    <section>
    <title>powerspectrum_isotropy()</title>
<indexterm><primary>powerspectrum_isotropy</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>powerspectrum_isotropy</secondary></indexterm>
<para><computeroutput>vector&lt; double &gt; Bimage::powerspectrum_isotropy (long n, double &amp; lores, double &amp; hires)</computeroutput></para><para>

<para>Calculates a measure of anisotropy in a poer spectrum. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>n</entry>
                                <entry>
<para>sub-image number. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;hires</entry>
                                <entry>
<para>high resolution limit </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>vector&lt;double&gt; 3-vlaue vector: power average and deviation and maximum power angle. The power between the indicated resolution shells are averaged for each angle and fitted to an equation for anisotropy: P = Pavg + Pdev*cos(2(a-phi)) where phi is the direction of maximum power. </para>
</formalpara>
</para>
<para>
Definition at line 432 of file Bimage_powerspectrum.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a62da7cb39c8509a277d4b60a0ad2eac7"/>    <section>
    <title>powerspectrum_tiled()</title>
<indexterm><primary>powerspectrum_tiled</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>powerspectrum_tiled</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::powerspectrum_tiled (long img_num, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size, int flags = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Prepares a tiled power spectrum from an image for determining CTF parameters. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>img_num</entry>
                                <entry>
<para>sub-image to transform. </para>
</entry>
                            </row>
                            <row>
                                <entry>tile_size</entry>
                                <entry>
<para>tile size (if (0,0,0) don&apos;t tile). </para>
</entry>
                            </row>
                            <row>
                                <entry>flags</entry>
                                <entry>
<para>1=norm, 2=avg, 4=shift, 8=log. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* power spectrum. <literallayout><computeroutput>A large single image (a micrograph) is converted to a number of tiles
packed into a multi-image structure.
All the sub-images are Fourier transformed and the power spectra calculated.
The flag indicates if the images are normalized, averaged, shifted and
the logarithm calculated
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 106 of file Bimage_powerspectrum.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad0dd5e4008605164e43d404e3d82e02e"/>    <section>
    <title>powerspectrum_tiled_and_tilted()</title>
<indexterm><primary>powerspectrum_tiled_and_tilted</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>powerspectrum_tiled_and_tilted</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::powerspectrum_tiled_and_tilted (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size, double tilt_axis, double tilt_angle, double tilt_offset, double defocus, double iCL2, int flags = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Prepares a tiled powerspectrum from a tilted image for determining CTF parameters. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>tile_size</entry>
                                <entry>
<para>tile size (if (0,0,0) don&apos;t tile). </para>
</entry>
                            </row>
                            <row>
                                <entry>tilt_axis</entry>
                                <entry>
<para>tilt axis angle (in radians). </para>
</entry>
                            </row>
                            <row>
                                <entry>tilt_angle</entry>
                                <entry>
<para>tilt angle (in radians). </para>
</entry>
                            </row>
                            <row>
                                <entry>tilt_offset</entry>
                                <entry>
<para>offset perpendicular to tilt axis (in pixels). </para>
</entry>
                            </row>
                            <row>
                                <entry>defocus</entry>
                                <entry>
<para>average defocus to adjust for change in focus. </para>
</entry>
                            </row>
                            <row>
                                <entry>iCL2</entry>
                                <entry>
<para>inverse of product of spherical aberration and wavelenght squared. </para>
</entry>
                            </row>
                            <row>
                                <entry>flags</entry>
                                <entry>
<para>1=norm, 2=avg, 4=shift, 8=log, 16=add. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* power spectrum. <literallayout><computeroutput>A large single image (a micrograph) is converted to a number of tiles
packed into a multi-image structure.
All the sub-images are Fourier transformed and the power spectra calculated.
The power spectra are scaled based on the tilt and average defocus of the image.
The flag indicates if the images are normalized, averaged, shifted and
the logarithm calculated
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 365 of file Bimage_powerspectrum.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a71ae17085d0e29552f960c53090b19fe"/>    <section>
    <title>powerspectrum_tilt_axis()</title>
<indexterm><primary>powerspectrum_tilt_axis</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>powerspectrum_tilt_axis</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::powerspectrum_tilt_axis (long img_num, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size, double tilt_axis, double tilt_offset, int flags = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Prepares a tiled powerspectrum from a tilted image for determining CTF parameters. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>img_num</entry>
                                <entry>
<para>sub-image to transform. </para>
</entry>
                            </row>
                            <row>
                                <entry>tile_size</entry>
                                <entry>
<para>tile size (if (0,0,0) don&apos;t tile). </para>
</entry>
                            </row>
                            <row>
                                <entry>tilt_axis</entry>
                                <entry>
<para>tilt axis angle (in radians). </para>
</entry>
                            </row>
                            <row>
                                <entry>tilt_offset</entry>
                                <entry>
<para>offset perpendicular to tilt axis (in pixels). </para>
</entry>
                            </row>
                            <row>
                                <entry>flags</entry>
                                <entry>
<para>1=norm, 2=avg, 4=shift, 8=log. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* power spectrum. <literallayout><computeroutput>A large single image (a micrograph) is converted to a number of tiles
along the tilt axis packed into a multi-image structure.
All the sub-images are Fourier transformed and the power spectra calculated.
The flag indicates if the images are normalized, averaged, shifted and
the logarithm calculated
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 163 of file Bimage_powerspectrum.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae4c0fe6b37b552146256828cb6f17624"/>    <section>
    <title>powerspectrum_tilted()</title>
<indexterm><primary>powerspectrum_tilted</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>powerspectrum_tilted</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::powerspectrum_tilted (long img_num, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size, double tilt_axis, double tilt_angle, double defocus, double iCL2, int flags = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Prepares a tiled powerspectrum from a tilted image for determining CTF parameters. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>img_num</entry>
                                <entry>
<para>sub-image to transform. </para>
</entry>
                            </row>
                            <row>
                                <entry>tile_size</entry>
                                <entry>
<para>tile size (if (0,0,0) don&apos;t tile). </para>
</entry>
                            </row>
                            <row>
                                <entry>tilt_axis</entry>
                                <entry>
<para>tilt axis angle (in radians). </para>
</entry>
                            </row>
                            <row>
                                <entry>tilt_angle</entry>
                                <entry>
<para>tilt angle (in radians). </para>
</entry>
                            </row>
                            <row>
                                <entry>defocus</entry>
                                <entry>
<para>average defocus to adjust for change in focus. </para>
</entry>
                            </row>
                            <row>
                                <entry>iCL2</entry>
                                <entry>
<para>inverse of product of spherical aberration and wavelenght squared. </para>
</entry>
                            </row>
                            <row>
                                <entry>flags</entry>
                                <entry>
<para>1=norm, 2=avg, 4=shift, 8=log. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* power spectrum. <literallayout><computeroutput>A large single image (a micrograph) is converted to a number of tiles
packed into a multi-image structure.
All the sub-images are Fourier transformed and the power spectra calculated.
The power spectra are scaled based on the tilt and average defocus of the image.
The flag indicates if the images are normalized, averaged, shifted and
the logarithm calculated
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 281 of file Bimage_powerspectrum.cpp.</para>
    </section><anchor xml:id="_class_bimage_1abed27819fb8388ae6954898e8c5aeea9"/>    <section>
    <title>pps_angular_correlation()</title>
<indexterm><primary>pps_angular_correlation</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>pps_angular_correlation</secondary></indexterm>
<para><computeroutput>vector&lt; double &gt; Bimage::pps_angular_correlation (<link linkend="_class_bimage">Bimage</link> * pref, double res_hi, double res_lo, long nang, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf)</computeroutput></para><para>
Definition at line 1315 of file Bimage_align.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a9881cc5ba252117b04982537fcade7ec"/>    <section>
    <title>progressive_sum()</title>
<indexterm><primary>progressive_sum</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>progressive_sum</secondary></indexterm>
<para><computeroutput>void Bimage::progressive_sum ( )</computeroutput></para><para>

<para>Progressive sum of the sub-images. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>Each sub-image is summed with all previous sub-images.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 3633 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a4afcc68b536924539893afa7797d9ff0"/>    <section>
    <title>project()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>project</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>project</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::project (char axis, int flags = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Projects a 3D image to a 2D image down one of the three major axes. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>axis</entry>
                                <entry>
<para>axis of projection. </para>
</entry>
                            </row>
                            <row>
                                <entry>flags</entry>
                                <entry>
<para>1=scale projection, 2=minimum, 4=maximum. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* projection image (floating point). <literallayout><computeroutput>The sums of the z-planes are accumulated into a new floating point data 
block.  This block is then rescaled and converted back to the original 
data type.
The new data replaces the old data.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 31 of file Bimage_project.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a83a04a916f5dbac1d5bd7b627d18c904"/>    <section>
    <title>project()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>project</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>project</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::project (<link linkend="_class_view">View</link> * view, double resolution, <link linkend="_class_f_s_i___kernel">FSI_Kernel</link> * kernel)</computeroutput></para><para>

<para>Calculates a set of projections as central sections from a 3D fourier transform. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*view</entry>
                                <entry>
<para>linked list of views. </para>
</entry>
                            </row>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>*kernel</entry>
                                <entry>
<para>frequency space interpolation kernel. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* projections as sub-images. <literallayout><computeroutput>The map is Fourier transformed and shifted to its phase origin.
For each view, a central section is calculated using reciprocal space interpolation.
All the projections are phase shifted to a central origin and back-transformed.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 343 of file Bimage_project.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab27d43f0379945a6d3fc67f8bfd7d895"/>    <section>
    <title>project()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>project</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>project</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::project (<link linkend="_class_view">View</link> * view, int norm_flag = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Calculates a set of projections from a 3D density map. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*view</entry>
                                <entry>
<para>linked list of views. </para>
</entry>
                            </row>
                            <row>
                                <entry>norm_flag</entry>
                                <entry>
<para>flag to normalize projection. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* projections as sub-images. <literallayout><computeroutput>A set of projections is calculated according to a list of views.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 207 of file Bimage_project.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a82c60d383d623215c7803246f91a37c3"/>    <section>
    <title>pure_color()</title>
<indexterm><primary>pure_color</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>pure_color</secondary></indexterm>
<para><computeroutput>int Bimage::pure_color ( )</computeroutput></para><para>

<para>Generates a pure color image without intensity. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>Pure color is defined as:
            col
    col = --------
          sum(col)
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 352 of file Bimage_color.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3e05702e10a44ce4cea8cb193d892740"/>    <section>
    <title>quadric()</title>
<indexterm><primary>quadric</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>quadric</secondary></indexterm>
<para><computeroutput>int Bimage::quadric (double * param)</computeroutput></para><para>

<para>Generates a quadric surface over the whole image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>param</entry>
                                <entry>
<para>7-value array of parameters. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. </para>
</formalpara>
</para>
<para>
Definition at line 893 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0022ff9560c5435a775b17cda6859d21"/>    <section>
    <title>quadric_correct()</title>
<indexterm><primary>quadric_correct</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>quadric_correct</secondary></indexterm>
<para><computeroutput>int Bimage::quadric_correct (vector&lt; double &gt; param)</computeroutput></para><para>

<para>Corrects for a quadric surface. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>param</entry>
                                <entry>
<para>7-value array of parameters. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. </para>
</formalpara>
</para>
<para>
Definition at line 857 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a4374a6540837e7e0fb667ade95387125"/>    <section>
    <title>quadric_fit()</title>
<indexterm><primary>quadric_fit</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>quadric_fit</secondary></indexterm>
<para><computeroutput>vector&lt; double &gt; Bimage::quadric_fit ( )</computeroutput></para><para>

<para>Fits the whole image to a quadric surface. </para>
</para>

<para><formalpara><title>Returns</title>

<para>vector&lt;double&gt; 7-value array of parameters. <literallayout><computeroutput>A quadric surface is defined as:
v = a0 + a1*dx + a2*dy + a3*dz + a4*dx^2 + a5*dy^2 + a6*dz^2
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 893 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa60cb47e314cac85108867d1cf9ceed9"/>    <section>
    <title>query()</title>
<indexterm><primary>query</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>query</secondary></indexterm>
<para><computeroutput>vector&lt;<link linkend="_class_j_svalue">JSvalue</link>*&gt; Bimage::query (string &amp; path)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 224 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a52206f5ade01f913c6c89ca6827abfec"/>    <section>
    <title>R_factor()</title>
<indexterm><primary>R_factor</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>R_factor</secondary></indexterm>
<para><computeroutput>double Bimage::R_factor (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Calculates an R factor between two images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>second image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double R factor, -1 if not run. <literallayout><computeroutput>The difference between two images is calculated and normalized as:
                          sum(image1 - image2)^2
    R = sqrt(-------------------------------------------------)
             sqrt(sum(image1 - avg1)^2 * sum(image2 - avg2)^2)
Both images are converted to floating point.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 218 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6ebe92011b255b290b14be60266b8632"/>    <section>
    <title>radial()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>radial</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>radial</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::radial (long minrad, long maxrad, double rad_step, <link linkend="_class_bimage">Bimage</link> * pmask, int wrap = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates the radial average of an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>minrad</entry>
                                <entry>
<para>minimum radius in voxels. </para>
</entry>
                            </row>
                            <row>
                                <entry>maxrad</entry>
                                <entry>
<para>maximum radius in voxels. </para>
</entry>
                            </row>
                            <row>
                                <entry>rad_step</entry>
                                <entry>
<para>step size in voxels. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>mask to limit calculation. </para>
</entry>
                            </row>
                            <row>
                                <entry>wrap</entry>
                                <entry>
<para>flag to wrap the data. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* radial average in the form of a 1D image. <literallayout><computeroutput>A radial average of a 2D or 3D image is calculated between a minimum
and maximum radius.  An interpolative method is used where the value of 
a voxel is distributed between the two nearest radial annuli.
The final sum in an annulus is normalized by the number of voxels 
contributing to the annulus sum.
The origins within the sub-image structures are used.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 55 of file Bimage_polar.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a9873d1561805e0845a44c24cf2b4d872"/>    <section>
    <title>radial()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>radial</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>radial</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::radial (long minrad, long maxrad, double rad_step, double ellipticity, double angle, <link linkend="_class_bimage">Bimage</link> * pmask, int wrap = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates the radial average of an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>minrad</entry>
                                <entry>
<para>minimum radius in voxels. </para>
</entry>
                            </row>
                            <row>
                                <entry>maxrad</entry>
                                <entry>
<para>maximum radius in voxels. </para>
</entry>
                            </row>
                            <row>
                                <entry>rad_step</entry>
                                <entry>
<para>step size in voxels. </para>
</entry>
                            </row>
                            <row>
                                <entry>ellipticity</entry>
                                <entry>
<para>ratio of major and minor axes. </para>
</entry>
                            </row>
                            <row>
                                <entry>angle</entry>
                                <entry>
<para>angle of major axis. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>mask to limit calculation. </para>
</entry>
                            </row>
                            <row>
                                <entry>wrap</entry>
                                <entry>
<para>flag to wrap the data. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* radial average in the form of a 1D image. <literallayout><computeroutput>A radial average of a 2D or 3D image is calculated between a minimum
and maximum radius.  An interpolative method is used where the value of 
a voxel is distributed between the two nearest radial annuli.
The final sum in an annulus is normalized by the number of voxels 
contributing to the annulus sum.
The origins within the sub-image structures are used.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 79 of file Bimage_polar.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7e58dfcfdf34ccd506bed0d3ef5b4db5"/>    <section>
    <title>radial()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>radial</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>radial</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::radial (long minrad, long maxrad, double rad_step = <computeroutput>1</computeroutput>
, int wrap = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates the radial average of an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>minrad</entry>
                                <entry>
<para>minimum radius in voxels. </para>
</entry>
                            </row>
                            <row>
                                <entry>maxrad</entry>
                                <entry>
<para>maximum radius in voxels. </para>
</entry>
                            </row>
                            <row>
                                <entry>rad_step</entry>
                                <entry>
<para>step size in voxels. </para>
</entry>
                            </row>
                            <row>
                                <entry>wrap</entry>
                                <entry>
<para>flag to wrap the data. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* radial average in the form of a 1D image. <literallayout><computeroutput>A radial average of a 2D or 3D image is calculated between a minimum
and maximum radius.  An interpolative method is used where the value of 
a voxel is distributed between the two nearest radial annuli.
The final sum in an annulus is normalized by the number of voxels 
contributing to the annulus sum.
The origins within the sub-image structures are used.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 33 of file Bimage_polar.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2a29bbf90a10dd26c13974ba24320196"/>    <section>
    <title>radial_coverage()</title>
<indexterm><primary>radial_coverage</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>radial_coverage</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::radial_coverage (double threshold, double rad_step = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Calculates the coverage in each radial shell. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>density threshold to distinguish for- and background. </para>
</entry>
                            </row>
                            <row>
                                <entry>rad_step</entry>
                                <entry>
<para>radial step size (voxels). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. </para>
</formalpara>
</para>
<para>
Definition at line 1190 of file Bimage_polar.cpp.</para>
    </section><anchor xml:id="_class_bimage_1adf4764ac2099326f8550a9f85f9e8290"/>    <section>
    <title>radial_fit()</title>
<indexterm><primary>radial_fit</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>radial_fit</secondary></indexterm>
<para><computeroutput>double * Bimage::radial_fit (<link linkend="_class_bimage">Bimage</link> * pref)</computeroutput></para><para>

<para>Fits a radial profile to a reference radial profile. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pref</entry>
                                <entry>
<para>reference radial profile as a 1D image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double* 3-value result vector: dimension scale, amplitude scale and amplitude shift. <literallayout><computeroutput>A radial profile is fitted to a reference profile using an iterative
simplex down-hill method.  The equations solved are:
    x(new) = x(old)*m
    y(new) = y(old)*a + b
where   m is the dimension scaling (or magnification).
        a is the amplitude scaling.
        b is the amplitude shift.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 325 of file Bimage_polar.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a5a73644b93a8f9033ada10246f952e0a"/>    <section>
    <title>radial_sections()</title>
<indexterm><primary>radial_sections</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>radial_sections</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::radial_sections (double rad_start, double rad_end, double rad_step, double spherical_fraction, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp; sym, int fill_type = <computeroutput><link linkend="_utilities_8h_1ae8a4ca63176786d1254d05591419ba9c">FILL_USER</link></computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates an image with slices giving the radial section projections. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>rad_start</entry>
                                <entry>
<para>starting radius (voxels). </para>
</entry>
                            </row>
                            <row>
                                <entry>rad_end</entry>
                                <entry>
<para>ending radius (voxels). </para>
</entry>
                            </row>
                            <row>
                                <entry>rad_step</entry>
                                <entry>
<para>radial step size (voxels). </para>
</entry>
                            </row>
                            <row>
                                <entry>spherical_fraction</entry>
                                <entry>
<para>fraction of spherical section (requires symmetry). </para>
</entry>
                            </row>
                            <row>
                                <entry>*sym</entry>
                                <entry>
<para>symmetry for non-spherical sections. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value to fill in excluded regions. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* image with radial sections. <literallayout><computeroutput>The 3D image is converted so that the sections contain 2D projections
of radial shells. The projection in slice i is defined for:
    i &gt;= sqrt(x^2 + y^2)
Non-spherical sections can be generated by specifying the symmetry and
the fraction of spherical nature (1=spherical, 0=based on symmetry).
Sampling in x and y is not changed.
The sampling in the input map must be isotropic.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1131 of file Bimage_polar.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a886dcdd400fd1e7a920975dad3c43835"/>    <section>
    <title>radial_shells()</title>
<indexterm><primary>radial_shells</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>radial_shells</secondary></indexterm>
<para><computeroutput>int Bimage::radial_shells ( )</computeroutput></para><para>

<para>Calculates an image with slices representing radial shell projections. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The 3D image is converted so that the sections contain 2D projections
of radial shells. The projection in slice z is defined for:
    z &gt;= sqrt((x-xo)^2 + (y-yo)^2) + zo
The first projection is placed at the z origin and radiates out into
both positive and negative directions.
Sampling in x and y is not changed.
The sampling must be isotropic.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 853 of file Bimage_polar.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8e666b9c155a9929050dcf4b0f339789"/>    <section>
    <title>radial_symmetry_adjusted()</title>
<indexterm><primary>radial_symmetry_adjusted</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>radial_symmetry_adjusted</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::radial_symmetry_adjusted (double rad_start, double rad_end, double rad_step, double spherical_fraction, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp; sym)</computeroutput></para><para>

<para>Calculates the symmetry-adjusted radial average of an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>rad_start</entry>
                                <entry>
<para>minimum radius in voxels. </para>
</entry>
                            </row>
                            <row>
                                <entry>rad_end</entry>
                                <entry>
<para>maximum radius in voxels. </para>
</entry>
                            </row>
                            <row>
                                <entry>rad_step</entry>
                                <entry>
<para>step size in voxels. </para>
</entry>
                            </row>
                            <row>
                                <entry>spherical_fraction</entry>
                                <entry>
<para>ratio of major and minor axes. </para>
</entry>
                            </row>
                            <row>
                                <entry>*sym</entry>
                                <entry>
<para>point group symmetry. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* radial average in the form of a 1D image. <literallayout><computeroutput>A radial average of a 2D or 3D image is calculated between a minimum
and maximum radius.  An interpolative method is used where the value of
a voxel is distributed between the two nearest radial annuli.
The final sum in an annulus is normalized by the number of voxels
contributing to the annulus sum.
The symmetry is used to adjust the radius to follow the contours of a shell.
The origins within the sub-image structures are used.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 206 of file Bimage_polar.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a47f717fb32a8f0dc296581f6987e5c23"/>    <section>
    <title>radial_to_full()</title>
<indexterm><primary>radial_to_full</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>radial_to_full</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::radial_to_full (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; origin)</computeroutput></para><para>

<para>Generates a full 2D or 3D image from a radial profile in a 1D image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nusize</entry>
                                <entry>
<para>size of image to expand to. </para>
</entry>
                            </row>
                            <row>
                                <entry>origin</entry>
                                <entry>
<para>origin for radial profile. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* new 2D or 3D image. <literallayout><computeroutput>It assumes the resultant image is square or cubic.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 409 of file Bimage_polar.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa758e00d61b0cf27d877e46a8054d93c"/>    <section>
    <title>read_data()</title>
<indexterm><primary>read_data</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>read_data</secondary></indexterm>
<para><computeroutput>unsigned char * Bimage::read_data (ifstream * fimg, int img_select, int sb, int vax, long pad)</computeroutput></para><para>

<para>Read image data in a generalized style. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*fimg</entry>
                                <entry>
<para>file descriptor: file opened in calling function. </para>
</entry>
                            </row>
                            <row>
                                <entry>img_select</entry>
                                <entry>
<para>image selection: if -1, all images, if &gt;= 0, one image. </para>
</entry>
                            </row>
                            <row>
                                <entry>sb</entry>
                                <entry>
<para>flag activates byte swapping. </para>
</entry>
                            </row>
                            <row>
                                <entry>vax</entry>
                                <entry>
<para>indicate vax style floating point - activates conversion. </para>
</entry>
                            </row>
                            <row>
                                <entry>pad</entry>
                                <entry>
<para>any interspersed control or separation bytes. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>unsigned char* data pointer, NULL if reading failed. The whole file or a single image from a file may be read. The data is read in the largest blocks possible for efficiency. Any interspersed padding and page sizes not matching the data size contribute to inefficiency in reading. Swapping: sb = 1: swap bytes the size of the data type sb &gt; 1: swap these number of bytes regardless of the data type </para>
</formalpara>
</para>
<para>
Definition at line 2263 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a02752b6d64220d5d43dfae13fc137e7a"/>    <section>
    <title>real_coordinates()</title>
<indexterm><primary>real_coordinates</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>real_coordinates</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt;double&gt; Bimage::real_coordinates (long i)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 456 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1ae40d87dc98e649c9183f5566de964b32"/>    <section>
    <title>real_size()</title>
<indexterm><primary>real_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>real_size</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt;double&gt; Bimage::real_size ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 503 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a1264a6b082a28fca56f75e11053d23cb"/>    <section>
    <title>reciprocal_half()</title>
<indexterm><primary>reciprocal_half</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>reciprocal_half</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt;long&gt; Bimage::reciprocal_half ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 1225 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a5b36e3e577be485764fd630ed6cd4134"/>    <section>
    <title>red_white_blue()</title>
<indexterm><primary>red_white_blue</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>red_white_blue</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::red_white_blue (double red_min, double white_min, double white_max, double blue_max)</computeroutput></para><para>

<para>Colorizes an image with blue positive and red negative. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>red_min</entry>
                                <entry>
<para>beginning of red gradient (most negative). </para>
</entry>
                            </row>
                            <row>
                                <entry>white_min</entry>
                                <entry>
<para>end of red gradient (fade into white). </para>
</entry>
                            </row>
                            <row>
                                <entry>white_max</entry>
                                <entry>
<para>beginning of blue gradient (start with white). </para>
</entry>
                            </row>
                            <row>
                                <entry>blue_max</entry>
                                <entry>
<para>end of blue gradient (most positive) </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* color scale image. <literallayout><computeroutput>A grayscale image is converted to RGB and colored with blue positive, 
red negative, and white in between.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 478 of file Bimage_color.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0fab637fb5be036d3821df66f90559ba"/>    <section>
    <title>refine_peak()</title>
<indexterm><primary>refine_peak</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>refine_peak</secondary></indexterm>
<para><computeroutput>int Bimage::refine_peak ( )</computeroutput></para><para>

<para>Refines the position of a peak to sub-voxel resolution. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>The sub-voxel resolution peak in the vicinity of a voxel is defined 
by fitting a 2D/3D second order function around the voxel.
(typically used to find the shift vector in a cross-correlation map).
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1617 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae8655ec31cdfa4008f2cd15e5810300b"/>    <section>
    <title>refine_peak_new()</title>
<indexterm><primary>refine_peak_new</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>refine_peak_new</secondary></indexterm>
<para><computeroutput>int Bimage::refine_peak_new ( )</computeroutput></para><para>

<para>Refines the position of a peak to sub-voxel resolution. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>The sub-voxel resolution peak in the vicinity of a voxel is defined 
by fitting a 2D/3D second order function around the voxel.
(typically used to find the shift vector in a cross-correlation map).
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1576 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7c44ca1140db2f36355ae99a0d0e933a"/>    <section>
    <title>region_assign()</title>
<indexterm><primary>region_assign</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>region_assign</secondary></indexterm>
<para><computeroutput>long Bimage::region_assign (<link linkend="_class_bimage">Bimage</link> * pmask, long idx, long region_number, double threshold, int sign)</computeroutput></para><para>

<para>Finds all the pixels that are part of the same region. </para>
</para>

<para><formalpara><title>Author</title>

<para>Bernard Heymann and Samuel Payne </para>
</formalpara>

                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>a mask holding region assignments. </para>
</entry>
                            </row>
                            <row>
                                <entry>idx</entry>
                                <entry>
<para>the first voxel of a region. </para>
</entry>
                            </row>
                            <row>
                                <entry>region_number</entry>
                                <entry>
<para>the region number that voxels are assigned. </para>
</entry>
                            </row>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>the level to define background. </para>
</entry>
                            </row>
                            <row>
                                <entry>sign</entry>
                                <entry>
<para>sign controlling direction of thresholding. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>This method uses a list to keep track of voxels assigned to a region.
In subsequent iterations the non-assigned voxels next to those in
the list are assigned if they exceed the threshold, and their indices
are kept in a new list. The new list is transferred to the old list
and the process iteratively continued until the new list contains
no more voxels.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 100 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab0e749d2074b4a2e493324e9b526c4e0"/>    <section>
    <title>region_flood()</title>
<indexterm><primary>region_flood</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>region_flood</secondary></indexterm>
<para><computeroutput>long Bimage::region_flood (<link linkend="_class_bimage">Bimage</link> * pmask, double threshold_hi, double threshold_lo, double threshold_step, int fill_borders)</computeroutput></para><para>

<para>Creates and expands a region map from a starting to ending threshold value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>region map (if NULL, generate from high threshold). </para>
</entry>
                            </row>
                            <row>
                                <entry>threshold_hi</entry>
                                <entry>
<para>the level to pick initial regions. </para>
</entry>
                            </row>
                            <row>
                                <entry>threshold_lo</entry>
                                <entry>
<para>the lowest level to include voxels in regions. </para>
</entry>
                            </row>
                            <row>
                                <entry>threshold_step</entry>
                                <entry>
<para>the incremental change in threshold. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_borders</entry>
                                <entry>
<para>flag to assign borders between regions (default not). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of regions. <literallayout><computeroutput>A region map is calculated at the threshold furthest from the average.
The region map is then expanded by lowering the threshold gradually 
and assigning newly included voxels to neighboring regions (i.e., flooding).
Voxels with neighbours assigned to two or more different regions are tagged
as indeterminate to indicate borders between regions. These border voxels
are counted and can be used to estimate the extent of interfaces.
The indices of all the final regions are packed into an integer data block
within a new image.
The image is assumed to have high values for objects (i.e., density is white).
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 237 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a97e5ef2e7188a1ba225d6f2c31932686"/>    <section>
    <title>region_peaks()</title>
<indexterm><primary>region_peaks</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>region_peaks</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::region_peaks (long kernel_size, double threshold, int flood = <computeroutput>0</computeroutput>
, int wrap = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Generates a segmented image from peaks above a threshold value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>kernel_size</entry>
                                <entry>
<para>size of kernel to determine peaks. </para>
</entry>
                            </row>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>the lowest level to include voxels in regions. </para>
</entry>
                            </row>
                            <row>
                                <entry>flood</entry>
                                <entry>
<para>flag to flood to the threshold. </para>
</entry>
                            </row>
                            <row>
                                <entry>wrap</entry>
                                <entry>
<para>flag to wrap the kernel around image boundaries. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* integer image containing region index numbers. <literallayout><computeroutput>Every voxel with a value above the threshold is tagged by a pointer 
pointing to the highest value within a kernel. 
A peak is defined as pointing to itself, while every other voxel
points towards a peak.
The voxels in the mask are then iteratively assigned to the peaks
they point to.
The indices of all the final regions are packed into an integer data block
within a new image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 488 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a5480279ea3c3895fb01a20ffb1839ce7"/>    <section>
    <title>region_threshold_series()</title>
<indexterm><primary>region_threshold_series</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>region_threshold_series</secondary></indexterm>
<para><computeroutput>int Bimage::region_threshold_series (double threshold_first, double threshold_last, double threshold_step)</computeroutput></para><para>

<para>Segments a map through a series of thresholds and reports results. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>threshold_first</entry>
                                <entry>
<para>the level to pick initial regions. </para>
</entry>
                            </row>
                            <row>
                                <entry>threshold_last</entry>
                                <entry>
<para>the lowest level to include voxels in regions. </para>
</entry>
                            </row>
                            <row>
                                <entry>threshold_step</entry>
                                <entry>
<para>the incremental change in threshold. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. </para>
</formalpara>
</para>
<para>
Definition at line 181 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac55bb02394e154f3b19519c3be2c8c98"/>    <section>
    <title>regions()</title>
<indexterm><primary>regions</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>regions</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::regions (double threshold, int sign)</computeroutput></para><para>

<para>Segments an image into contiguous regions. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>the level at which things are ignored. </para>
</entry>
                            </row>
                            <row>
                                <entry>sign</entry>
                                <entry>
<para>sign controlling direction of thresholding. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* level mask with indexed regions. <literallayout><computeroutput>The image is segmented into contiguous regions where a region is 
defined as all those voxels exceeding the given threshold and
adjacent to each other.
This method uses a list to keep track of voxels assigned to a region.
In subsequent iterations the non-assigned voxels next to those in
the list are assigned if they exceed the threshold, and their indices
are kept in a new list. The new list is transferred to the old list
and the process iteratively continued until the new list contains
no more voxels. The indices of all the regions are packed into
an integer data block within a new image.
The new image maps the indices of the regions starting from one to as
many regions as were found (the maximum gives the number of regions).
The new image has zeroes for all voxels outside the regions.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 37 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a53c0e1a29c59f66cea84af7fbc18fd14"/>    <section>
    <title>relative_density()</title>
<indexterm><primary>relative_density</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>relative_density</secondary></indexterm>
<para><computeroutput>double Bimage::relative_density (<link linkend="_class_bimage">Bimage</link> * pmask)</computeroutput></para><para>

<para>Calculates the relative density in a region defined by a mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>a 4 level mask. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double relative density. <literallayout><computeroutput>The mask is assumed to have 4 levels:
0       region of no interest
1       region to estimate relative density
2       reference region
3       background region
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 3266 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3e690ba847608adfe186083d63e0a8f8"/>    <section>
    <title>replace()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>replace</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>replace</secondary></indexterm>
<para><computeroutput>int Bimage::replace (<link linkend="_class_bimage">Bimage</link> * img)</computeroutput></para><para>

<para>Replaces the data with that from the given image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*img</entry>
                                <entry>
<para>source image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The input image must be the same size as the receiving image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2897 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a9898fd3b514d2f774ddd72c2673450a0"/>    <section>
    <title>replace()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>replace</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>replace</secondary></indexterm>
<para><computeroutput>int Bimage::replace (long nn, <link linkend="_class_bimage">Bimage</link> * img, long nr, double fill)</computeroutput></para><para>

<para>Replaces one sub-image in an image structure. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number to replace. </para>
</entry>
                            </row>
                            <row>
                                <entry>*img</entry>
                                <entry>
<para>source image. </para>
</entry>
                            </row>
                            <row>
                                <entry>nr</entry>
                                <entry>
<para>source sub-image number. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>fill vlue. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The input image may have a different size as the receiving image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2938 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a42023ed856fd661419b1d2ac9d4f7508"/>    <section>
    <title>replace()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>replace</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>replace</secondary></indexterm>
<para><computeroutput>int Bimage::replace (long nn, <link linkend="_class_bimage">Bimage</link> * img, long nr = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Replaces one sub-image in an image structure. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number to replace. </para>
</entry>
                            </row>
                            <row>
                                <entry>*img</entry>
                                <entry>
<para>source image. </para>
</entry>
                            </row>
                            <row>
                                <entry>nr</entry>
                                <entry>
<para>source sub-image number. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The input image must be the same size as the receiving image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2916 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2f42862e052c422dc5868b9b1234cd5d"/>    <section>
    <title>replace_maxima()</title>
<indexterm><primary>replace_maxima</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>replace_maxima</secondary></indexterm>
<para><computeroutput>long Bimage::replace_maxima (double threshold)</computeroutput></para><para>

<para>Replaces maxima above a threshold using local averages. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>threshold. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of voxels replaced. <literallayout><computeroutput>The image is first segemented into regions, each defined as a 
contiguous cluster of voxels with values above the threshold. 
Each region is encoded in an integer image, with all the values
in this image set to the indices of the regions, or zero elsewhere.
The regions are iteratively filled in, where in every iteration, 
the border values of the regions are replaced by the average 
of the neighbouring voxels outside the region. After each iteration, 
every region is shrunk by excluding the newly replaced voxels.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 748 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2051e36bed46213a60d8c727a8e4fd6e"/>    <section>
    <title>replicate_asymmetric_unit()</title>
<indexterm><primary>replicate_asymmetric_unit</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>replicate_asymmetric_unit</secondary></indexterm>
<para><computeroutput>int Bimage::replicate_asymmetric_unit (<link linkend="_struct_bsymmetry">Bsymmetry</link> &amp; sym)</computeroutput></para><para>

<para>Calculates a full map from one asymmetric unit. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*sym</entry>
                                <entry>
<para>symmetry structure. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>A reference view for each point group is generated such that it is
located close to the center of the canonical asymmetric unit.
For each voxel in the target map, a set of symmetry-related views 
are generated and the one closest to the reference view used
to determine the corresponding voxels within the asymmetric unit.
The new voxel value is calculated by trilinear interpolation of the
voxels in the asymmetric unit. 
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 972 of file Bimage_symmetry.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a9b7833cb5588bdc30b2a46f45eaf3224"/>    <section>
    <title>rescale()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>rescale</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rescale</secondary></indexterm>
<para><computeroutput>int Bimage::rescale (double scale, double shift)</computeroutput></para><para>

<para>Rescales the image data with a given multiplier and offset. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>multiplier. </para>
</entry>
                            </row>
                            <row>
                                <entry>shift</entry>
                                <entry>
<para>addition or offset. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>The new data is calculated as:
    new_datum = datum*scale + shift
The new data replaces the old data.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 27 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac4a76e101fc59bdcabd5f3bb4299955e"/>    <section>
    <title>rescale()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>rescale</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rescale</secondary></indexterm>
<para><computeroutput>int Bimage::rescale (long nn, double scale, double shift)</computeroutput></para><para>

<para>Rescales the image data with a given multiplier and offset. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>multiplier. </para>
</entry>
                            </row>
                            <row>
                                <entry>shift</entry>
                                <entry>
<para>addition or offset. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>Requirement: The images must have the same size.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 62 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa480cb0fa61541df90440f2e929142ce"/>    <section>
    <title>rescale_to_avg_std()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>rescale_to_avg_std</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rescale_to_avg_std</secondary></indexterm>
<para><computeroutput>int Bimage::rescale_to_avg_std (double nuavg, double nustd)</computeroutput></para><para>

<para>Rescales the image data to a given average and standard deviation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nuavg</entry>
                                <entry>
<para>new average. </para>
</entry>
                            </row>
                            <row>
                                <entry>nustd</entry>
                                <entry>
<para>new standard deviation. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>The new data is calculated as:
                                new_std_dev
    new_datum = (datum - avg) * ----------- + new_avg
                                  std_dev
The new data replaces the old data.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 163 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ace3199a5d7bb5c9ea9fcd544e67dff6b"/>    <section>
    <title>rescale_to_avg_std()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>rescale_to_avg_std</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rescale_to_avg_std</secondary></indexterm>
<para><computeroutput>int Bimage::rescale_to_avg_std (double nuavg, double nustd, <link linkend="_class_bimage">Bimage</link> * pmask)</computeroutput></para><para>

<para>Rescales the image data to a given average and standard deviation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nuavg</entry>
                                <entry>
<para>new average. </para>
</entry>
                            </row>
                            <row>
                                <entry>nustd</entry>
                                <entry>
<para>new standard deviation. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>statistical calculations limited to the masked region. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>The new data is calculated as:
                                new_std_dev
    new_datum = (datum - avg) * ----------- + new_avg
                                  std_dev
The new data replaces the old data.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 235 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1abda4a7e4de4efa8b83f0a1ef6445da09"/>    <section>
    <title>rescale_to_avg_std()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>rescale_to_avg_std</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rescale_to_avg_std</secondary></indexterm>
<para><computeroutput>int Bimage::rescale_to_avg_std (long nn, double nuavg, double nustd)</computeroutput></para><para>

<para>Rescales the image data to a given average and standard deviation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>nuavg</entry>
                                <entry>
<para>new average. </para>
</entry>
                            </row>
                            <row>
                                <entry>nustd</entry>
                                <entry>
<para>new standard deviation. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>The new data is calculated as:
                                new_std_dev
    new_datum = (datum - avg) * ----------- + new_avg
                                  std_dev
The new data replaces the old data.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 199 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6a5bdce631807ed399818c368aa246f4"/>    <section>
    <title>rescale_to_min_max()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>rescale_to_min_max</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rescale_to_min_max</secondary></indexterm>
<para><computeroutput>int Bimage::rescale_to_min_max (double numin, double numax)</computeroutput></para><para>

<para>Rescales the image data to a given minimum and maximum. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>numin</entry>
                                <entry>
<para>new minimum. </para>
</entry>
                            </row>
                            <row>
                                <entry>numax</entry>
                                <entry>
<para>new maximum. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>The new data is calculated as:
                                new_max - new_min
    new_datum = (datum - min) * ----------------- + new_min
                                    max - min
The new data replaces the old data.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 100 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae86c101a63bbebc20a1a83b359e4c898"/>    <section>
    <title>rescale_to_min_max()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>rescale_to_min_max</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rescale_to_min_max</secondary></indexterm>
<para><computeroutput>int Bimage::rescale_to_min_max (long nn, double numin, double numax)</computeroutput></para><para>

<para>Rescales the image data to a given minimum and maximum. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>numin</entry>
                                <entry>
<para>new minimum. </para>
</entry>
                            </row>
                            <row>
                                <entry>numax</entry>
                                <entry>
<para>new maximum. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. <literallayout><computeroutput>The new data is calculated as:
                                new_max - new_min
    new_datum = (datum - min) * ----------------- + new_min
                                    max - min
The new data replaces the old data.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 132 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa92d1c8b78e7032d0810e50691308d6a"/>    <section>
    <title>resize()</title>
<indexterm><primary>resize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>resize</secondary></indexterm>
<para><computeroutput>int Bimage::resize (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; translate, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Resizes without interpolation or rescaling. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nusize</entry>
                                <entry>
<para>new image size three-value vector. </para>
</entry>
                            </row>
                            <row>
                                <entry>translate</entry>
                                <entry>
<para>three-value translation vector. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value to fill in new regions. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>An image is resized with translation and filling of new regions with 
a given value.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 28 of file Bimage_resize.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aceac93b83e083d4149e77dc87b21d468"/>    <section>
    <title>resize_copy()</title>
<indexterm><primary>resize_copy</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>resize_copy</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::resize_copy (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; translate, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Resizes without interpolation or rescaling. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nusize</entry>
                                <entry>
<para>new image size three-value vector. </para>
</entry>
                            </row>
                            <row>
                                <entry>translate</entry>
                                <entry>
<para>three-value translation vector. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value to fill in new regions. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* resized image. <literallayout><computeroutput>An image is resized with translation and filling of new regions with 
a given value.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 124 of file Bimage_resize.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a9e6f5ec793f21d082df60e9365eeb417"/>    <section>
    <title>resize_wrap()</title>
<indexterm><primary>resize_wrap</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>resize_wrap</secondary></indexterm>
<para><computeroutput>int Bimage::resize_wrap (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; translate)</computeroutput></para><para>

<para>Resizes without interpolation or rescaling. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nusize</entry>
                                <entry>
<para>new image size three-value vector. </para>
</entry>
                            </row>
                            <row>
                                <entry>translate</entry>
                                <entry>
<para>three-value translation vector. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>An image is resized with translation and filling of new regions with 
a given value.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 202 of file Bimage_resize.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a34ad16a7706778bce66dc7caf93ceea0"/>    <section>
    <title>resize_wrap_copy()</title>
<indexterm><primary>resize_wrap_copy</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>resize_wrap_copy</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::resize_wrap_copy (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; translate)</computeroutput></para><para>

<para>Resizes with wrapping without interpolation or rescaling. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nusize</entry>
                                <entry>
<para>new image size three-value vector. </para>
</entry>
                            </row>
                            <row>
                                <entry>translate</entry>
                                <entry>
<para>three-value translation vector. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* resized image. <literallayout><computeroutput>An image is resized with translation and filling of new regions with 
a given value.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 280 of file Bimage_resize.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad5ed5dc6affb2312432591d328c6d27b"/>    <section>
    <title>reslice()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>reslice</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>reslice</secondary></indexterm>
<para><computeroutput>void Bimage::reslice (<link linkend="_class_bstring">Bstring</link> order)</computeroutput></para><para>

<para>Switches axes of an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>order</entry>
                                <entry>
<para>string encoding the reslicing order. <literallayout><computeroutput>Reslicing refers to switching the axes of a multidimensional image.
The equivalent is rotation around angles that are multiples of pi/2.
The reslicing is encoded as a string of x, y and z, with the order
and sign indicating the type of reslicing to be done.
The new data replaces the old data.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 3334 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a46db3bd25b8e4a6477a4ef686604ceab"/>    <section>
    <title>reslice()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>reslice</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>reslice</secondary></indexterm>
<para><computeroutput>void Bimage::reslice (const char * order)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 728 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a2d625d181159abc9d151369048f20733"/>    <section>
    <title>resolution_prepare()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>resolution_prepare</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>resolution_prepare</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::resolution_prepare (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>
Definition at line 17 of file Bimage_resolution.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aeebfb1d152e36bd7aaf0b7549ba7bc6e"/>    <section>
    <title>resolution_prepare()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>resolution_prepare</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>resolution_prepare</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::resolution_prepare (<link linkend="_class_bimage">Bimage</link> * p, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> plan)</computeroutput></para><para>
Definition at line 46 of file Bimage_resolution.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2d343109d74d589f4fc4ce873b4f9e03"/>    <section>
    <title>rgb()</title>
<indexterm><primary>rgb</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rgb</secondary></indexterm>
<para><computeroutput><link linkend="_class_r_g_b">RGB</link>&lt; double &gt; Bimage::rgb (long j)</computeroutput></para><para>

<para>Returns a color value at the given index. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>j</entry>
                                <entry>
<para>index. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>RGB&lt;double&gt; the color value. <literallayout><computeroutput>The index refers to compound values.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1064 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae66b4728fbd4a4338eb41ab606915fb4"/>    <section>
    <title>rgb_to_cmyk()</title>
<indexterm><primary>rgb_to_cmyk</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rgb_to_cmyk</secondary></indexterm>
<para><computeroutput>void Bimage::rgb_to_cmyk ( )</computeroutput></para><para>

<para>Converts an <link linkend="_class_r_g_b">RGB</link> color image to <link linkend="_class_c_m_y_k">CMYK</link>. </para>
</para>
<para>
Definition at line 176 of file Bimage_color.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0c7ab28a033eb07c2c62b38044affdfa"/>    <section>
    <title>rgb_to_rgba()</title>
<indexterm><primary>rgb_to_rgba</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rgb_to_rgba</secondary></indexterm>
<para><computeroutput>void Bimage::rgb_to_rgba ( )</computeroutput></para><para>

<para>An alpha channel is added to a <link linkend="_class_r_g_b">RGB</link> color image. </para>
</para>

<para><literallayout><computeroutput>The alpha channel value is set to 255.
</computeroutput></literallayout> </para>
<para>
Definition at line 122 of file Bimage_color.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7bffddc51e0a60f24d2768534501f9d7"/>    <section>
    <title>rgba()</title>
<indexterm><primary>rgba</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rgba</secondary></indexterm>
<para><computeroutput><link linkend="_class_r_g_b_a">RGBA</link>&lt; double &gt; Bimage::rgba (long j)</computeroutput></para><para>

<para>Returns a color value at the given index. </para>
</para>

<para><literallayout><computeroutput>The index refers to compound values.
</computeroutput></literallayout> 
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>j</entry>
                                <entry>
<para>index. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>RGBA&lt;double&gt; the color value. </para>
</formalpara>
</para>
<para>
Definition at line 1078 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a99a75c617a560025a571c7635b7f015a"/>    <section>
    <title>rgba_to_rgb()</title>
<indexterm><primary>rgba_to_rgb</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rgba_to_rgb</secondary></indexterm>
<para><computeroutput>void Bimage::rgba_to_rgb ( )</computeroutput></para><para>

<para>The alpha channel is delete from an <link linkend="_class_r_g_b_a">RGBA</link> color image. </para>
</para>
<para>
Definition at line 149 of file Bimage_color.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a88866b740da67ec07103b1d342cc3a98"/>    <section>
    <title>rotate()<computeroutput>[1/13]</computeroutput></title>
<indexterm><primary>rotate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate</secondary></indexterm>
<para><computeroutput>int Bimage::rotate ( )</computeroutput></para><para>

<para>Rotates an image using parameters defined in the image in place. </para>
</para>

<para><formalpara><title>Returns</title>

<para>0 error code. <literallayout><computeroutput>The image is rotated according to the view and origin encoded
for the sub-image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 255 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab27f87167748ab84725b81c74438b932"/>    <section>
    <title>rotate()<computeroutput>[2/13]</computeroutput></title>
<indexterm><primary>rotate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate</secondary></indexterm>
<para><computeroutput>int Bimage::rotate (double angle)</computeroutput></para><para>

<para>Rotates an image around the z-axis by the given angle in place. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>angle</entry>
                                <entry>
<para>rotation angle in radians. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>0 error code. <literallayout><computeroutput>The image is rotated according to the axis and angle given.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 274 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad6256d410696b7e3294809706e015efe"/>    <section>
    <title>rotate()<computeroutput>[3/13]</computeroutput></title>
<indexterm><primary>rotate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate</secondary></indexterm>
<para><computeroutput>int Bimage::rotate (<link linkend="_class_matrix3">Matrix3</link> mat)</computeroutput></para><para>

<para>Rotates an image using the specified matrix. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>mat</entry>
                                <entry>
<para>3x3 rotation matrix. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>0 error code. <literallayout><computeroutput>An image is rotated according to the input matrix.
The input image origin is the rotation center.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 351 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1adc92a9f1c9ff02d2c22b9e7a9ffb1be4"/>    <section>
    <title>rotate()<computeroutput>[4/13]</computeroutput></title>
<indexterm><primary>rotate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate</secondary></indexterm>
<para><computeroutput>int Bimage::rotate (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; axis, double angle)</computeroutput></para><para>

<para>Rotates an image using an axis and angle in place. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>axis</entry>
                                <entry>
<para>3-value rotation axis. </para>
</entry>
                            </row>
                            <row>
                                <entry>angle</entry>
                                <entry>
<para>rotation angle in radians. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>0 error code. <literallayout><computeroutput>The image is rotated according to the axis and angle given.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 294 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aac8847c323035bc8efc85d9f8de52baf"/>    <section>
    <title>rotate()<computeroutput>[5/13]</computeroutput></title>
<indexterm><primary>rotate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate</secondary></indexterm>
<para><computeroutput>int Bimage::rotate (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; translate, <link linkend="_class_matrix3">Matrix3</link> mat)</computeroutput></para><para>

<para>Rotates an image using the specified shift and matrix. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>translate</entry>
                                <entry>
<para>translation after rotation. </para>
</entry>
                            </row>
                            <row>
                                <entry>mat</entry>
                                <entry>
<para>3x3 rotation matrix. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>0 error code. <literallayout><computeroutput>An image is rotated according to the input view vector and angle. 
The input image origin is the rotation center.
The rotated image is translated to the input origin.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 371 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad2c655354c84a54ec1b4bd71c8af60be"/>    <section>
    <title>rotate()<computeroutput>[6/13]</computeroutput></title>
<indexterm><primary>rotate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate</secondary></indexterm>
<para><computeroutput>int Bimage::rotate (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; translate, <link linkend="_class_view">View</link> view)</computeroutput></para><para>

<para>Rotates an image to a specified view in place. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>translate</entry>
                                <entry>
<para>translation after rotation. </para>
</entry>
                            </row>
                            <row>
                                <entry>*view</entry>
                                <entry>
<para>view vector and angle. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>0 error code. <literallayout><computeroutput>An image is rotated according to the input view vector and angle. 
The input image origin is the rotation center.
The rotated image is translated to the input origin.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 332 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6607d768271a95c3b9f35933e991ad2e"/>    <section>
    <title>rotate()<computeroutput>[7/13]</computeroutput></title>
<indexterm><primary>rotate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::rotate (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize)</computeroutput></para><para>

<para>Rotates an image using parameters defined in the image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nusize</entry>
                                <entry>
<para>3-value new image size. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* rotated image. <literallayout><computeroutput>The image is rotated according to the view and origin encoded
for the sub-image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 389 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab7b52ec12fd191c8f312cfa658fca1ba"/>    <section>
    <title>rotate()<computeroutput>[8/13]</computeroutput></title>
<indexterm><primary>rotate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::rotate (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, double angle)</computeroutput></para><para>

<para>Rotates an image around the z-axis by the given angle. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nusize</entry>
                                <entry>
<para>3-value new image size. </para>
</entry>
                            </row>
                            <row>
                                <entry>angle</entry>
                                <entry>
<para>rotation angle in radians. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* rotated image. <literallayout><computeroutput>The image is rotated according to the axis and angle given.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 409 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa27ac57c3c18d91f290b3881d2f29d95"/>    <section>
    <title>rotate()<computeroutput>[9/13]</computeroutput></title>
<indexterm><primary>rotate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::rotate (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_matrix3">Matrix3</link> mat)</computeroutput></para><para>

<para>Rotates an image using the specified matrix. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nusize</entry>
                                <entry>
<para>new image size. </para>
</entry>
                            </row>
                            <row>
                                <entry>mat</entry>
                                <entry>
<para>3x3 rotation matrix. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* rotated image. <literallayout><computeroutput>An image is rotated according to the input matrix.
The input image origin is the rotation center.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 490 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af9c535401a34f4be682c0cedc8de5237"/>    <section>
    <title>rotate()<computeroutput>[10/13]</computeroutput></title>
<indexterm><primary>rotate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::rotate (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; axis, double angle)</computeroutput></para><para>

<para>Rotates an image using an axis and angle. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nusize</entry>
                                <entry>
<para>3-value new image size. </para>
</entry>
                            </row>
                            <row>
                                <entry>axis</entry>
                                <entry>
<para>3-value rotation axis. </para>
</entry>
                            </row>
                            <row>
                                <entry>angle</entry>
                                <entry>
<para>rotation angle in radians. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* rotated image. <literallayout><computeroutput>The image is rotated according to the axis and angle given.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 430 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0e3c27171aa545d21f78bf9053bb5055"/>    <section>
    <title>rotate()<computeroutput>[11/13]</computeroutput></title>
<indexterm><primary>rotate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::rotate (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; translate, <link linkend="_class_view">View</link> view)</computeroutput></para><para>

<para>Rotates an image to a specified view. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nusize</entry>
                                <entry>
<para>3-value new image size. </para>
</entry>
                            </row>
                            <row>
                                <entry>translate</entry>
                                <entry>
<para>translation after rotation. </para>
</entry>
                            </row>
                            <row>
                                <entry>*view</entry>
                                <entry>
<para>view vector and angle. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* rotated image. <literallayout><computeroutput>An image is rotated according to the input view vector and angle. 
The input image origin is the rotation center.
The rotated image is translated to the input origin.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 470 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3e899df9053f40b4f83f2f2398c79629"/>    <section>
    <title>rotate()<computeroutput>[12/13]</computeroutput></title>
<indexterm><primary>rotate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::rotate (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_view">View</link> view)</computeroutput></para><para>

<para>Rotates an image to a specified view. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nusize</entry>
                                <entry>
<para>3-value new image size. </para>
</entry>
                            </row>
                            <row>
                                <entry>*view</entry>
                                <entry>
<para>view vector and angle. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* rotated image. <literallayout><computeroutput>An image is rotated according to the input view vector and angle. 
The input image origin is the rotation center.
The rotated image is translated to the input origin.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 451 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7bf45aa1df7f0171cc46ffaf00d4507a"/>    <section>
    <title>rotate()<computeroutput>[13/13]</computeroutput></title>
<indexterm><primary>rotate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate</secondary></indexterm>
<para><computeroutput>int Bimage::rotate (<link linkend="_class_view">View</link> view)</computeroutput></para><para>

<para>Rotates an image to a specified view in place. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*view</entry>
                                <entry>
<para>view vector and angle. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>0 error code. <literallayout><computeroutput>An image is rotated according to the input view vector and angle. 
The input image origin is the rotation center.
The rotated image is translated to the input origin.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 314 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad873912e785241f662e91058d513cc91"/>    <section>
    <title>rotate_and_add()</title>
<indexterm><primary>rotate_and_add</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate_and_add</secondary></indexterm>
<para><computeroutput>int Bimage::rotate_and_add (<link linkend="_class_bimage">Bimage</link> * p, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; origin, <link linkend="_class_view">View</link> view)</computeroutput></para><para>

<para>Rotates an image to a specified view and adds it to another image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>the image to rotate and add (modified). </para>
</entry>
                            </row>
                            <row>
                                <entry>origin</entry>
                                <entry>
<para>origin in input image. </para>
</entry>
                            </row>
                            <row>
                                <entry>*view</entry>
                                <entry>
<para>view vector and angle. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>An image is rotated according to the input view vector and angle. 
The input image origin is the rotation center.
The rotated image is translated to the input origin.
The result is added to the current image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 512 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa0e7e96e701d68bc872693a78aa74c8f"/>    <section>
    <title>rotate_correlate()</title>
<indexterm><primary>rotate_correlate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate_correlate</secondary></indexterm>
<para><computeroutput>double Bimage::rotate_correlate (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; axis, double angle)</computeroutput></para><para>

<para>Rotates a copy of an image and correlates it with the original. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>axis</entry>
                                <entry>
<para>rotation axis. </para>
</entry>
                            </row>
                            <row>
                                <entry>angle</entry>
                                <entry>
<para>rotation angle. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double correlation coefficient, -1 if error. <literallayout><computeroutput>This mainly used to determine the symmetry of a map.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 195 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7169f09ebd58457a19368b08bf994833"/>    <section>
    <title>rotate_cross_correlate()</title>
<indexterm><primary>rotate_cross_correlate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate_cross_correlate</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt; double &gt; Bimage::rotate_cross_correlate (<link linkend="_class_bimage">Bimage</link> * pref, <link linkend="_class_view">View</link> view, double hires, double lores, double search_radius, <link linkend="_class_bimage">Bimage</link> * pmask, double &amp; cc, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb)</computeroutput></para><para>
Definition at line 803 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7f5f4a66f61f68ea7af007429c246baa"/>    <section>
    <title>rotate_cross_correlate_two_way()</title>
<indexterm><primary>rotate_cross_correlate_two_way</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate_cross_correlate_two_way</secondary></indexterm>
<para><computeroutput>double Bimage::rotate_cross_correlate_two_way (<link linkend="_class_bimage">Bimage</link> * pref, double angle, double res_hi, double res_lo, double shift_limit, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb)</computeroutput></para><para>
Definition at line 861 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ae5e061b02110ae259864ad686a234038"/>    <section>
    <title>rotate_find_shift()</title>
<indexterm><primary>rotate_find_shift</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate_find_shift</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt; double &gt; Bimage::rotate_find_shift (<link linkend="_class_matrix3">Matrix3</link> mat, double hires, double lores, double radius, double sigma, int refine_flag, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb, double &amp; cc)</computeroutput></para><para>

<para>Rotates and find shift by cross-correlation. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>mat</entry>
                                <entry>
<para>rotation matrix. </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit in angstroms. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit in angstroms. </para>
</entry>
                            </row>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>search radius. </para>
</entry>
                            </row>
                            <row>
                                <entry>sigma</entry>
                                <entry>
<para>soften search radius cutoff. </para>
</entry>
                            </row>
                            <row>
                                <entry>refine_flag</entry>
                                <entry>
<para>refine shift. </para>
</entry>
                            </row>
                            <row>
                                <entry>planf</entry>
                                <entry>
<para>forward Fourier transform plan. </para>
</entry>
                            </row>
                            <row>
                                <entry>planb</entry>
                                <entry>
<para>backward Fourier transform plan.k </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;cc</entry>
                                <entry>
<para>correlation coefficient </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para><link linkend="_class_vector3">Vector3&lt;double&gt;</link> origin. <literallayout><computeroutput>The point group symmetry operations are applied to an image with an
orientation defined by the reference symmetry axis (default {0,0,1}). 
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1310 of file Bimage_correlate.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a94d462f9cb36da0a45674bcedfa787d1"/>    <section>
    <title>rotate_height()</title>
<indexterm><primary>rotate_height</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate_height</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::rotate_height (<link linkend="_class_matrix3">Matrix3</link> mat, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; translate, double threshold = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Rotates a 3D map and calculates the height along the z-axis. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>mat</entry>
                                <entry>
<para>3x3 rotation or skewing matrix. </para>
</entry>
                            </row>
                            <row>
                                <entry>translate</entry>
                                <entry>
<para>3-value vector for translation after transformation. </para>
</entry>
                            </row>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>density threshold to consider as object. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* new 2D height image. <literallayout><computeroutput>The 3D map is rotated around its center as origin and the height 
calculated along the z-direction.
The resultant 2D image is translated if the translation vector is 
non-zero.
The rotation origin is obtained from the map origin.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 164 of file Bimage_topo.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa6dea162b89d48d12f9f29f757a299e3"/>    <section>
    <title>rotate_project()</title>
<indexterm><primary>rotate_project</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate_project</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::rotate_project (<link linkend="_class_matrix3">Matrix3</link> mat, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; translate, double radial_cutoff, int norm_flag = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Rotates a 3D map and projects it along the z-axis. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>mat</entry>
                                <entry>
<para>3x3 rotation or skewing matrix. </para>
</entry>
                            </row>
                            <row>
                                <entry>translate</entry>
                                <entry>
<para>3-value vector for translation after transformation. </para>
</entry>
                            </row>
                            <row>
                                <entry>radial_cutoff</entry>
                                <entry>
<para>spherical cutoff to apply. </para>
</entry>
                            </row>
                            <row>
                                <entry>norm_flag</entry>
                                <entry>
<para>flag to normalize projection. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* new 2D projection image. <literallayout><computeroutput>The 3D map is rotated around its center as origin and the data 
integrated along the z-direction after subtraction of the
background (which must be calculated before this function).
The resultant 2D image is translated if the translation vector is 
non-zero. A radial cutoff can be applied to decrease the computation 
time. A value of zero or less sets the default to the length of the 
x-axis (i.e., no effective cutoff).
The rotation origin is obtained from the map origin.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 118 of file Bimage_project.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a1204e425ce7833d410445af713a8792a"/>    <section>
    <title>rotate_to_axis()</title>
<indexterm><primary>rotate_to_axis</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>rotate_to_axis</secondary></indexterm>
<para><computeroutput>long Bimage::rotate_to_axis (<link linkend="_struct_bsymmetry">Bsymmetry</link> &amp; sym, long axis, long axis_flag)</computeroutput></para><para>

<para>Rotates to a symmetry axis. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*sym</entry>
                                <entry>
<para>symmetry structure. </para>
</entry>
                            </row>
                            <row>
                                <entry>axis</entry>
                                <entry>
<para>desired symmetry axis order. </para>
</entry>
                            </row>
                            <row>
                                <entry>axis_flag</entry>
                                <entry>
<para>view modifier. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long 0. </para>
</formalpara>
</para>
<para>
Definition at line 560 of file Bimage_symmetry.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a12c7c8891367557aef7043dd2774c9fa"/>    <section>
    <title>sampling()<computeroutput>[1/7]</computeroutput></title>
<indexterm><primary>sampling</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>sampling</secondary></indexterm>
<para><computeroutput>vector&lt;<link linkend="_class_vector3">Vector3</link>&lt;double&gt; &gt; Bimage::sampling ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 532 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a44553b4ff840993fa3911892949b46f7"/>    <section>
    <title>sampling()<computeroutput>[2/7]</computeroutput></title>
<indexterm><primary>sampling</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>sampling</secondary></indexterm>
<para><computeroutput>void Bimage::sampling (double ux, double uy, double uz)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 526 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a986b9bf2b43b4bc3ba2670794604da07"/>    <section>
    <title>sampling()<computeroutput>[3/7]</computeroutput></title>
<indexterm><primary>sampling</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>sampling</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt;double&gt; Bimage::sampling (long nn)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 529 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1af1e1de0aa7f12bb2db5dba29f400cce7"/>    <section>
    <title>sampling()<computeroutput>[4/7]</computeroutput></title>
<indexterm><primary>sampling</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>sampling</secondary></indexterm>
<para><computeroutput>void Bimage::sampling (long nn, double ux, double uy, double uz)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 520 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1aea6d4d42a222c4916583a05e196e0fd1"/>    <section>
    <title>sampling()<computeroutput>[5/7]</computeroutput></title>
<indexterm><primary>sampling</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>sampling</secondary></indexterm>
<para><computeroutput>void Bimage::sampling (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; u)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 517 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1aadcb407c60a020cea5a03823a958f26e"/>    <section>
    <title>sampling()<computeroutput>[6/7]</computeroutput></title>
<indexterm><primary>sampling</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>sampling</secondary></indexterm>
<para><computeroutput>void Bimage::sampling (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; u)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 523 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a6e9a4660f2ae9526391c3551e77d70d5"/>    <section>
    <title>sampling()<computeroutput>[7/7]</computeroutput></title>
<indexterm><primary>sampling</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>sampling</secondary></indexterm>
<para><computeroutput>void Bimage::sampling (vector&lt; <link linkend="_class_vector3">Vector3</link>&lt; double &gt;&gt; sam)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 537 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a8221a6b44bccd9fb4bd31cc31320fcaa"/>    <section>
    <title>scale_to_reference()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>scale_to_reference</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>scale_to_reference</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::scale_to_reference (<link linkend="_class_bimage">Bimage</link> * pref, <link linkend="_class_bimage">Bimage</link> * pmask, double scalemin, double scalemax, double step)</computeroutput></para><para>

<para>Scales and image to the given reference, searching for the correct scale. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>pref</entry>
                                <entry>
<para>reference/template image. </para>
</entry>
                            </row>
                            <row>
                                <entry>pmask</entry>
                                <entry>
<para>mask to limit correlation calculation (can be NULL). </para>
</entry>
                            </row>
                            <row>
                                <entry>scalemin</entry>
                                <entry>
<para>minimum scaling to start search. </para>
</entry>
                            </row>
                            <row>
                                <entry>scalemax</entry>
                                <entry>
<para>maximum scaling to end search. </para>
</entry>
                            </row>
                            <row>
                                <entry>step</entry>
                                <entry>
<para>scaling search step size. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* scaled image. </para>
</formalpara>
</para>
<para>
Definition at line 759 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1afa7a3a7acb990d667c474c2c7d694b30"/>    <section>
    <title>scale_to_reference()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>scale_to_reference</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>scale_to_reference</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::scale_to_reference (<link linkend="_class_bimage">Bimage</link> * pref, <link linkend="_class_bimage">Bimage</link> * pmask = <computeroutput>NULL</computeroutput>
)</computeroutput></para><para>

<para>Scales and image to the given reference, searching for the correct scale. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>pref</entry>
                                <entry>
<para>reference/template image. </para>
</entry>
                            </row>
                            <row>
                                <entry>pmask</entry>
                                <entry>
<para>mask to limit correlation calculation (can be NULL). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* scaled image. </para>
</formalpara>
</para>
<para>
Definition at line 817 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a5003afb6ec7e7d88800197dc47e4abfc"/>    <section>
    <title>scale_to_same_size()</title>
<indexterm><primary>scale_to_same_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>scale_to_same_size</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::scale_to_same_size (<link linkend="_class_bimage">Bimage</link> * pref)</computeroutput></para><para>

<para>Scales and image to the given reference. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>pref</entry>
                                <entry>
<para>reference/template image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* scaled image. </para>
</formalpara>
</para>
<para>
Definition at line 735 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a45b58edcb6fea8c4b1bd1ccd54790ffd"/>    <section>
    <title>seamed_helix_symmetrize()</title>
<indexterm><primary>seamed_helix_symmetrize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>seamed_helix_symmetrize</secondary></indexterm>
<para><computeroutput><link linkend="_class_bplot">Bplot</link> * Bimage::seamed_helix_symmetrize (double helix_rise, double helix_angle, double seam_shift, int dyad_axis, int zmin, int zmax, double radius, int norm_flag)</computeroutput></para><para>

<para>Symmetrizes an image given helical symmetry parameters and seam shift parameter. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>helix_rise</entry>
                                <entry>
<para>rise per asymmetric unit (angstrom). </para>
</entry>
                            </row>
                            <row>
                                <entry>helix_angle</entry>
                                <entry>
<para>rotation angle per asymmetric unit (radians). </para>
</entry>
                            </row>
                            <row>
                                <entry>seam_shift</entry>
                                <entry>
<para>translation along the seam (subunit height units). </para>
</entry>
                            </row>
                            <row>
                                <entry>dyad_axis</entry>
                                <entry>
<para>dyad axis indicator: 2=dyad axis on x-axis, otherwise none. </para>
</entry>
                            </row>
                            <row>
                                <entry>zmin</entry>
                                <entry>
<para>mimimum z slice to include. </para>
</entry>
                            </row>
                            <row>
                                <entry>zmax</entry>
                                <entry>
<para>maximum z slice to include. </para>
</entry>
                            </row>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>radius to do symmetrizing over (pixels). </para>
</entry>
                            </row>
                            <row>
                                <entry>norm_flag</entry>
                                <entry>
<para>if 1, normalize </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bplot* plot. <literallayout><computeroutput>The data between the z limits are replicated along the helical axis
according to the helical rise and rotation and the seam to fill the new volume.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 280 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a1d6eeb216ad95114a41546c5f948661e"/>    <section>
    <title>search_views()</title>
<indexterm><primary>search_views</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>search_views</secondary></indexterm>
<para><computeroutput>double Bimage::search_views (<link linkend="_class_bimage">Bimage</link> * ptemp, <link linkend="_class_view">View</link> * views, double hires, double lores, double search_radius, <link linkend="_class_bimage">Bimage</link> * pmask, <link linkend="_class_view">View</link> &amp; currview, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; &amp; currshift)</computeroutput></para><para>

<para>Searches a 2D/3D density map for a template. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*ptemp</entry>
                                <entry>
<para>the template to be searched for. </para>
</entry>
                            </row>
                            <row>
                                <entry>*views</entry>
                                <entry>
<para>list of views to search. </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>search_radius</entry>
                                <entry>
<para>radius for shift search. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>mask for cross-correlation (ignored if NULL). </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;currview</entry>
                                <entry>
<para>best current view to return. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;currshift</entry>
                                <entry>
<para>best current shift to return. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double the best correlation coefficient. <literallayout><computeroutput>The template is rotated and cross-correlated to find the best fit.
The views must be calculated externally to allow for custom sets.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 34 of file Bimage_search.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7ce30d7a0b92b8e8886a19be03e23eff"/>    <section>
    <title>search_volume()</title>
<indexterm><primary>search_volume</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>search_volume</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::search_volume (<link linkend="_class_bimage">Bimage</link> * ptemp, <link linkend="_class_view">View</link> * view, double alpha, double alpha_step, double hires, double lores, <link linkend="_class_bimage">Bimage</link> * pmask, double threshold)</computeroutput></para><para>

<para>Searches a 2D/3D density map for a template. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*ptemp</entry>
                                <entry>
<para>the template to be searched for. </para>
</entry>
                            </row>
                            <row>
                                <entry>*view</entry>
                                <entry>
<para>views. </para>
</entry>
                            </row>
                            <row>
                                <entry>alpha</entry>
                                <entry>
<para>rotation around view vector, &lt;0 = use 2*PI (radians). </para>
</entry>
                            </row>
                            <row>
                                <entry>alpha_step</entry>
                                <entry>
<para>angular step size around view vector (radians). </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>mask for cross-correlation (ignored if NULL). </para>
</entry>
                            </row>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>threshold value, if 0, threshold = FOMmax/2. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* image with the best view at each voxel and FOM block. <literallayout><computeroutput>The template is rotated and cross-correlated to find the best fit.
The views must be calculated externally to allow for custom sets.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 208 of file Bimage_search.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a5ac6c12ee2b9faa6521107716e981814"/>    <section>
    <title>search_volume_view()</title>
<indexterm><primary>search_volume_view</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>search_volume_view</secondary></indexterm>
<para><computeroutput>double Bimage::search_volume_view (<link linkend="_class_bimage">Bimage</link> * ptemp, <link linkend="_class_view">View</link> view, double hires, double lores, <link linkend="_class_bimage">Bimage</link> * pmask, double threshold, <link linkend="_class_bimage">Bimage</link> * pfit)</computeroutput></para><para>

<para>Searches a 2D/3D density map for a template using a specific view. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*ptemp</entry>
                                <entry>
<para>the template to be searched for. </para>
</entry>
                            </row>
                            <row>
                                <entry>view</entry>
                                <entry>
<para>view. </para>
</entry>
                            </row>
                            <row>
                                <entry>hires</entry>
                                <entry>
<para>high resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>lores</entry>
                                <entry>
<para>low resolution limit. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>mask for cross-correlation (ignored if NULL). </para>
</entry>
                            </row>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>threshold value, if 0, threshold = FOMmax/2. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pfit</entry>
                                <entry>
<para>view image with FOM block to hold results. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double maximum FOM. <literallayout><computeroutput>The template is rotated to the view and cross-correlated.
A view image is updated with the results where the correlation coefficients are higher.
The views must be calculated externally to allow for custom sets.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 151 of file Bimage_search.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad890b6b933f3f467cf30b787b0d7bbc4"/>    <section>
    <title>select_images()</title>
<indexterm><primary>select_images</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>select_images</secondary></indexterm>
<para><computeroutput>long Bimage::select_images (<link linkend="_class_bstring">Bstring</link> list)</computeroutput></para><para>
Definition at line 2243 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a08e615360c7c3c68ed3144acccf40f02"/>    <section>
    <title>set()<computeroutput>[1/7]</computeroutput></title>
<indexterm><primary>set</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>set</secondary></indexterm>
<para><computeroutput>void Bimage::set (long j, <link linkend="_class_c_m_y_k">CMYK</link>&lt; double &gt; color)</computeroutput></para><para>

<para>Sets a color value at the given index. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>j</entry>
                                <entry>
<para>index. </para>
</entry>
                            </row>
                            <row>
                                <entry>color</entry>
                                <entry>
<para>color value. <literallayout><computeroutput>The index refers to compound values.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 1215 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a44a60b5de3fd18a6c8e0858af9cd65b8"/>    <section>
    <title>set()<computeroutput>[2/7]</computeroutput></title>
<indexterm><primary>set</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>set</secondary></indexterm>
<para><computeroutput>void Bimage::set (long j, <link linkend="_class_complex">Complex</link>&lt; double &gt; cv)</computeroutput></para><para>

<para>Sets a complex value at the given index. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>j</entry>
                                <entry>
<para>index. </para>
</entry>
                            </row>
                            <row>
                                <entry>cv</entry>
                                <entry>
<para>complex value. <literallayout><computeroutput>The index refers to compound values.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 1160 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7f091b084f0e714284d7c761dd4c0b15"/>    <section>
    <title>set()<computeroutput>[3/7]</computeroutput></title>
<indexterm><primary>set</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>set</secondary></indexterm>
<para><computeroutput>void Bimage::set (long j, double v)</computeroutput></para><para>

<para>Sets a single value at the given index. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>j</entry>
                                <entry>
<para>index. </para>
</entry>
                            </row>
                            <row>
                                <entry>v</entry>
                                <entry>
<para>value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 1127 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1abff9753006d934364d77b51c87b34fa4"/>    <section>
    <title>set()<computeroutput>[4/7]</computeroutput></title>
<indexterm><primary>set</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>set</secondary></indexterm>
<para><computeroutput>void Bimage::set (long j, <link linkend="_class_r_g_b">RGB</link>&lt; double &gt; color)</computeroutput></para><para>

<para>Sets a color value at the given index. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>j</entry>
                                <entry>
<para>index. </para>
</entry>
                            </row>
                            <row>
                                <entry>color</entry>
                                <entry>
<para>color value. <literallayout><computeroutput>The index refers to compound values.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 1176 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0e4265c10a266a3f930f0f773f4d1d45"/>    <section>
    <title>set()<computeroutput>[5/7]</computeroutput></title>
<indexterm><primary>set</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>set</secondary></indexterm>
<para><computeroutput>void Bimage::set (long j, <link linkend="_class_r_g_b_a">RGBA</link>&lt; double &gt; color)</computeroutput></para><para>

<para>Sets a color value at the given index. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>j</entry>
                                <entry>
<para>index. </para>
</entry>
                            </row>
                            <row>
                                <entry>color</entry>
                                <entry>
<para>color value. <literallayout><computeroutput>The index refers to compound values.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 1195 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a53c53e826eac2717012b6c08e04c0d9a"/>    <section>
    <title>set()<computeroutput>[6/7]</computeroutput></title>
<indexterm><primary>set</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>set</secondary></indexterm>
<para><computeroutput>void Bimage::set (long j, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec)</computeroutput></para><para>

<para>Sets a 3-value vector at the given index. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>j</entry>
                                <entry>
<para>index. </para>
</entry>
                            </row>
                            <row>
                                <entry>vec</entry>
                                <entry>
<para>3-value vector. <literallayout><computeroutput>The index refers to compound values.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 1235 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a30e0d8a5922143b1c8edba5c07aacb13"/>    <section>
    <title>set()<computeroutput>[7/7]</computeroutput></title>
<indexterm><primary>set</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>set</secondary></indexterm>
<para><computeroutput>void Bimage::set (long j, <link linkend="_class_view">View</link> view)</computeroutput></para><para>

<para>Sets a 3-value vector at the given index. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>j</entry>
                                <entry>
<para>index. </para>
</entry>
                            </row>
                            <row>
                                <entry>view</entry>
                                <entry>
<para>4-value view. <literallayout><computeroutput>The index refers to compound values.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 1253 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a059a3df092b74a3b4f56ef2623a1a45d"/>    <section>
    <title>set_max()</title>
<indexterm><primary>set_max</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>set_max</secondary></indexterm>
<para><computeroutput>void Bimage::set_max (double xx, double yy, double zz, long nn, double v)</computeroutput></para><para>

<para>Sets a value at a given location to neigboring data elements if it is larger. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>xx</entry>
                                <entry>
<para>x location. </para>
</entry>
                            </row>
                            <row>
                                <entry>yy</entry>
                                <entry>
<para>y location. </para>
</entry>
                            </row>
                            <row>
                                <entry>zz</entry>
                                <entry>
<para>z location. </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image number (4 th dimension). </para>
</entry>
                            </row>
                            <row>
                                <entry>v</entry>
                                <entry>
<para>value to assess and set. <literallayout><computeroutput>All neighboring voxels are checked and set to the given value if it is larger.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 1312 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aeff910cb0d91aa55d4ec824e2ecf2b58"/>    <section>
    <title>set_subset_selection()</title>
<indexterm><primary>set_subset_selection</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>set_subset_selection</secondary></indexterm>
<para><computeroutput>long Bimage::set_subset_selection (<link linkend="_class_bstring">Bstring</link> list)</computeroutput></para><para>

<para>Sets the sub-image selections based on a list. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>list</entry>
                                <entry>
<para>list of sub-images to select. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of images selected. <literallayout><computeroutput>The data is not altered.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 2187 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a9143f5bc96c3fb12dada8d1be1120332"/>    <section>
    <title>set_time()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>set_time</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>set_time</secondary></indexterm>
<para><computeroutput>void Bimage::set_time (time_t t)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 259 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a906cdf211bd171c7af7088c3ac70423c"/>    <section>
    <title>set_time()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>set_time</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>set_time</secondary></indexterm>
<para><computeroutput>void Bimage::set_time (tm * t)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 260 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a38e87c1320e30753ce7e908a4ccd93b6"/>    <section>
    <title>shape()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>shape</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>shape</secondary></indexterm>
<para><computeroutput>int Bimage::shape (int type, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; rect, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, double width, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Creates a shape in an image and fills it with a constant value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>type</entry>
                                <entry>
<para>type of shape: 0=rectangle, 1=oval, 2=cylinder </para>
</entry>
                            </row>
                            <row>
                                <entry>rect</entry>
                                <entry>
<para>three-value size of the area to be filled. </para>
</entry>
                            </row>
                            <row>
                                <entry>start</entry>
                                <entry>
<para>three-value start of area. </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>gaussian width of smoothing function. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>fill value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The edge of the area is smoothed with a function:
                    v_old(x,y,z) + fill*exp(1.618*dist/width)
    v_new(x,y,z) = ------------------------------------------
                           1 + exp(1.618*dist/width)
where   fill is the constant fill value.
        dist is the distance to the rectangular boundary defined by 
            the input size and start
        width is the gaussian width (softness)
With very small values of the gaussian width, the edge approaches a
step function.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 105 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8c5f912dd3240b4763bf53cda85da9e1"/>    <section>
    <title>shape()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>shape</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>shape</secondary></indexterm>
<para><computeroutput>int Bimage::shape (long nn, int type, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; rect, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; start, double width, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Creates a shape in an image and fills it with a constant value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>type</entry>
                                <entry>
<para>type of edge: 0=rectangle, 1=oval, 2=cylinder </para>
</entry>
                            </row>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>rect</entry>
                                <entry>
<para>three-value size of the area to be filled. </para>
</entry>
                            </row>
                            <row>
                                <entry>start</entry>
                                <entry>
<para>three-value start of area. </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>gaussian width of smoothing function. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>fill value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The edge of the area is smoothed with a function:
                    v_old(x,y,z) + fill*exp(1.618*dist/width)
    v_new(x,y,z) = ------------------------------------------
                           1 + exp(1.618*dist/width)
where   fill is the constant fill value.
        dist is the distance to the rectangular boundary defined by 
            the input size and start
        width is the gaussian width (softness)
With very small values of the gaussian width, the edge approaches a
step function.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 139 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa909a61852ba0685fbebca6c091c667e"/>    <section>
    <title>shell()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>shell</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>shell</secondary></indexterm>
<para><computeroutput>int Bimage::shell (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; center, double minrad, double maxrad, double width, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Fills a shell within an image with a uniform value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>center</entry>
                                <entry>
<para>center of shell. </para>
</entry>
                            </row>
                            <row>
                                <entry>minrad</entry>
                                <entry>
<para>minimum radius of shell. </para>
</entry>
                            </row>
                            <row>
                                <entry>maxrad</entry>
                                <entry>
<para>maximum radius of shell. </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>gaussian width of smoothing function. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>fill value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>All voxels within a shell at a given location and within given radii
are set to a given fill value.
The new data replaces the old data.
The default center is {0,0,0}.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 646 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aafb93c9e36f480a8b8c7cf40b826a37a"/>    <section>
    <title>shell()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>shell</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>shell</secondary></indexterm>
<para><computeroutput>int Bimage::shell (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; center, double minrad, double maxrad, double width, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Fills a shell within an image with a uniform value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>center</entry>
                                <entry>
<para>center of shell. </para>
</entry>
                            </row>
                            <row>
                                <entry>minrad</entry>
                                <entry>
<para>minimum radius of shell. </para>
</entry>
                            </row>
                            <row>
                                <entry>maxrad</entry>
                                <entry>
<para>maximum radius of shell. </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>gaussian width of smoothing function. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>fill value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>All voxels within a shell at a given location and within given radii
are set to a given fill value.
The new data replaces the old data.
The default center is {0,0,0}.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 618 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a50d40a435fef4c6e8c9bff4bf4b4d6f5"/>    <section>
    <title>shell_wrap()</title>
<indexterm><primary>shell_wrap</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>shell_wrap</secondary></indexterm>
<para><computeroutput>int Bimage::shell_wrap (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; center, double minrad, double maxrad, double width, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Fills a shell within an image with a uniform value with wrapping. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>center</entry>
                                <entry>
<para>center of shell. </para>
</entry>
                            </row>
                            <row>
                                <entry>minrad</entry>
                                <entry>
<para>minimum radius of shell. </para>
</entry>
                            </row>
                            <row>
                                <entry>maxrad</entry>
                                <entry>
<para>maximum radius of shell. </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>gaussian width of smoothing function. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>fill value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>All voxels within a shell at a given location and within given radii
are set to a given fill value.
The new data replaces the old data.
The default center is {0,0,0}.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 728 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa35b264e07b883cb7128b9539ceb05af"/>    <section>
    <title>shift()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>shift</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>shift</secondary></indexterm>
<para><computeroutput>int Bimage::shift (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Shifts one sub-image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>vec</entry>
                                <entry>
<para>3-value real space shift vector. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>fill type for filling empty regions. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value to fill in empty regions. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. </para>
</formalpara>
</para>
<para>
Definition at line 605 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7f416c3ad809348ac75ef571b6874d99"/>    <section>
    <title>shift()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>shift</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>shift</secondary></indexterm>
<para><computeroutput>int Bimage::shift (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Shifts an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>vec</entry>
                                <entry>
<para>3-value real space shift vector. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>fill type for filling empty regions. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value to fill in empty regions. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. </para>
</formalpara>
</para>
<para>
Definition at line 589 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a45890e60f74185ddfc88080dcbeda69e"/>    <section>
    <title>shift_background()</title>
<indexterm><primary>shift_background</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>shift_background</secondary></indexterm>
<para><computeroutput>int Bimage::shift_background (double bkg)</computeroutput></para><para>

<para>Sets the background for each sub-image to a given value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>bkg</entry>
                                <entry>
<para>new background value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0, &lt;0 on error. <literallayout><computeroutput>The background is taken as the average of the values outside the
circle or sphere enclosed by the image.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 353 of file Bimage_background.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a215f5b8d6d4748458c05434ebd7f006b"/>    <section>
    <title>shift_wrap()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>shift_wrap</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>shift_wrap</secondary></indexterm>
<para><computeroutput>int Bimage::shift_wrap (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec)</computeroutput></para><para>

<para>Shifts one sub-image with wrapping. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image. </para>
</entry>
                            </row>
                            <row>
                                <entry>vec</entry>
                                <entry>
<para>3-value real space shift vector. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. </para>
</formalpara>
</para>
<para>
Definition at line 655 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a358a46af05970ae98fe37d43333af8fb"/>    <section>
    <title>shift_wrap()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>shift_wrap</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>shift_wrap</secondary></indexterm>
<para><computeroutput>int Bimage::shift_wrap (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; vec)</computeroutput></para><para>

<para>Shifts an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>vec</entry>
                                <entry>
<para>3-value real space shift vector. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int error code. </para>
</formalpara>
</para>
<para>
Definition at line 641 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a2341b7e858a5c023cd4be98b1ab64773"/>    <section>
    <title>show_image()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>show_image</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>show_image</secondary></indexterm>
<para><computeroutput>long Bimage::show_image ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 563 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a9391231710bedec11f8bddad05150770"/>    <section>
    <title>show_image()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>show_image</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>show_image</secondary></indexterm>
<para><computeroutput>void Bimage::show_image (long nn)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 564 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a15c6ec8dead569920900c0abef394fa3"/>    <section>
    <title>show_maximum()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>show_maximum</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>show_maximum</secondary></indexterm>
<para><computeroutput>double Bimage::show_maximum ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 570 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a3db073fe28ad4546b95b2f8993cfc2de"/>    <section>
    <title>show_maximum()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>show_maximum</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>show_maximum</secondary></indexterm>
<para><computeroutput>void Bimage::show_maximum (double v)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 572 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1ac845ec573ac4f2e8d2da9806a27423ed"/>    <section>
    <title>show_minimum()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>show_minimum</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>show_minimum</secondary></indexterm>
<para><computeroutput>double Bimage::show_minimum ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 569 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1af5616baac679d6a1250d86db6ecba273"/>    <section>
    <title>show_minimum()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>show_minimum</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>show_minimum</secondary></indexterm>
<para><computeroutput>void Bimage::show_minimum (double v)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 571 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1af9f10d298cff665dca49330d90e3b2f6"/>    <section>
    <title>show_scale()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>show_scale</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>show_scale</secondary></indexterm>
<para><computeroutput>double Bimage::show_scale ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 567 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a37bf22fd62b24a81897e5a69bcd85784"/>    <section>
    <title>show_scale()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>show_scale</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>show_scale</secondary></indexterm>
<para><computeroutput>void Bimage::show_scale (double scale)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 568 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1af903a9c1e50c06aafeb8464426d88a3b"/>    <section>
    <title>show_slice()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>show_slice</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>show_slice</secondary></indexterm>
<para><computeroutput>long Bimage::show_slice ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 565 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a29efa892a7c10ec5a88b3f686f97045d"/>    <section>
    <title>show_slice()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>show_slice</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>show_slice</secondary></indexterm>
<para><computeroutput>void Bimage::show_slice (long nz)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 566 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1abf488f62aca81f8ec7d4835c97103bc8"/>    <section>
    <title>shrink_wrap()</title>
<indexterm><primary>shrink_wrap</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>shrink_wrap</secondary></indexterm>
<para><computeroutput>int Bimage::shrink_wrap (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; translate)</computeroutput></para><para>

<para>Shrinks an image to a new size with wrapping of the excluded edges. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nusize</entry>
                                <entry>
<para>new image size three-value vector. </para>
</entry>
                            </row>
                            <row>
                                <entry>translate</entry>
                                <entry>
<para>three-value translation vector. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>An image is resized to a smaller size with translation and wrapping
of the excluded edges to complete periodic boundaries. The image is
first converted to floating point to prevent overflows of smaller 
data types. The new image is finally converted back to the original
data type.
The new data replaces the old data.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 432 of file Bimage_resize.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a140b990f45d37151903ebc5d7541cddd"/>    <section>
    <title>simple_to_complex()</title>
<indexterm><primary>simple_to_complex</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>simple_to_complex</secondary></indexterm>
<para><computeroutput>void Bimage::simple_to_complex ( )</computeroutput></para><para>

<para>A simple image is converted to a complex image. </para>
</para>

<para><literallayout><computeroutput>The input image is written into the real part of the complex image.
</computeroutput></literallayout> </para>
<para>
Definition at line 22 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aafc8731d276675569a09899fe294cb52"/>    <section>
    <title>simple_to_rgb()</title>
<indexterm><primary>simple_to_rgb</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>simple_to_rgb</secondary></indexterm>
<para><computeroutput>void Bimage::simple_to_rgb ( )</computeroutput></para><para>

<para>A simple image is converted to a color image. </para>
</para>

<para><literallayout><computeroutput>All three color values in each voxel are the same (i.e., gray).
</computeroutput></literallayout> </para>
<para>
Definition at line 21 of file Bimage_color.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a288b49e2101c603a259453e74f8fb9ee"/>    <section>
    <title>simple_to_rgba()</title>
<indexterm><primary>simple_to_rgba</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>simple_to_rgba</secondary></indexterm>
<para><computeroutput>void Bimage::simple_to_rgba ( )</computeroutput></para><para>

<para>A simple image is converted to a color image. </para>
</para>

<para><literallayout><computeroutput>All three color values in each voxel are the same (i.e., gray).
The alpha value is set to 255.
</computeroutput></literallayout> </para>
<para>
Definition at line 58 of file Bimage_color.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8d8f237b0f540eb66bde5e5640097b18"/>    <section>
    <title>size()<computeroutput>[1/4]</computeroutput></title>
<indexterm><primary>size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>size</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt;long&gt; Bimage::size ( ) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 381 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a04248059b87991c9de87d916c3dacfe9"/>    <section>
    <title>size()<computeroutput>[2/4]</computeroutput></title>
<indexterm><primary>size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>size</secondary></indexterm>
<para><computeroutput>void Bimage::size (long nx, long ny, long nz)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 382 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1ad92c7423ec3efeebff4da5fc880282bb"/>    <section>
    <title>size()<computeroutput>[3/4]</computeroutput></title>
<indexterm><primary>size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>size</secondary></indexterm>
<para><computeroutput>void Bimage::size (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; vec)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 383 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a15a3862564a94ee0bef5c1d2b0a33180"/>    <section>
    <title>size()<computeroutput>[4/4]</computeroutput></title>
<indexterm><primary>size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>size</secondary></indexterm>
<para><computeroutput>void Bimage::size (vector&lt; long &gt; vec)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 384 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a573098677821d6cb2a3f971a60600585"/>    <section>
    <title>sizeX()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>sizeX</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>sizeX</secondary></indexterm>
<para><computeroutput>long Bimage::sizeX ( ) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 388 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a8a7935b0778f079de4436a87e6007beb"/>    <section>
    <title>sizeX()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>sizeX</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>sizeX</secondary></indexterm>
<para><computeroutput>void Bimage::sizeX (long nx)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 385 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a950470752066c7c8c3a42df1dcbba815"/>    <section>
    <title>sizeY()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>sizeY</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>sizeY</secondary></indexterm>
<para><computeroutput>long Bimage::sizeY ( ) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 389 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a24fff6fffe26b2cf9954c7086838deac"/>    <section>
    <title>sizeY()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>sizeY</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>sizeY</secondary></indexterm>
<para><computeroutput>void Bimage::sizeY (long ny)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 386 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a598f1a14a9194965bb93d57c0510536f"/>    <section>
    <title>sizeZ()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>sizeZ</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>sizeZ</secondary></indexterm>
<para><computeroutput>long Bimage::sizeZ ( ) const<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 390 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1aa0af0b19b20a1f3a29f6d46cf0a38964"/>    <section>
    <title>sizeZ()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>sizeZ</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>sizeZ</secondary></indexterm>
<para><computeroutput>void Bimage::sizeZ (long nz)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 387 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1aacbdfdfe1d47935021b5868821eb4f89"/>    <section>
    <title>slices_to_images()</title>
<indexterm><primary>slices_to_images</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>slices_to_images</secondary></indexterm>
<para><computeroutput>int Bimage::slices_to_images ( )</computeroutput></para><para>

<para>Changes the slices in a 3D image into a set of 2D images. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int error code (&lt;0 means failure). </para>
</formalpara>
</para>
<para>
Definition at line 2111 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa7fd506ba5395c911834305a76c3fe66"/>    <section>
    <title>smallest()</title>
<indexterm><primary>smallest</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>smallest</secondary></indexterm>
<para><computeroutput>void Bimage::smallest (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Selects the smallest of each pixel from two images. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>other image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 4005 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af717a562427570bee1788cf53f3dc408"/>    <section>
    <title>snvariance()</title>
<indexterm><primary>snvariance</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>snvariance</secondary></indexterm>
<para><computeroutput>double Bimage::snvariance (double snradius)</computeroutput></para><para>

<para>Calculates the ratio of variance inside and outside a given radius. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>snradius</entry>
                                <entry>
<para>radius of signal. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double the SNR. <literallayout><computeroutput>The region outside the radial limit is considered noise and the region
inside is considered signal plus noise.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1532 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a06916652b8d41c5bad363331a0095862"/>    <section>
    <title>space_group()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>space_group</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>space_group</secondary></indexterm>
<para><computeroutput>long Bimage::space_group ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 602 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1ad458840e2a3e8969140355c131443cad"/>    <section>
    <title>space_group()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>space_group</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>space_group</secondary></indexterm>
<para><computeroutput>void Bimage::space_group (unsigned int grp)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 606 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a540ad8a401b61ff5602ffe643efc2b58"/>    <section>
    <title>sphere()</title>
<indexterm><primary>sphere</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>sphere</secondary></indexterm>
<para><computeroutput>int Bimage::sphere (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; center, double radius, double width = <computeroutput>0</computeroutput>
, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Fills a sphere within an image with a uniform value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>center</entry>
                                <entry>
<para>three vector center of sphere. </para>
</entry>
                            </row>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>sphere radius. </para>
</entry>
                            </row>
                            <row>
                                <entry>width</entry>
                                <entry>
<para>gaussian width of smoothing function. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>FILL_AVERAGE, FILL_BACKGROUND, FILL_USER. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>fill value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>All voxels within a sphere at a given location and with a given radius 
are increased by a given fill value.
The new data replaces the old data.
The default center is {0,0,0}.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 512 of file Bimage_edit.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a33659b73113d0d84e2482517310311d5"/>    <section>
    <title>split_channels()</title>
<indexterm><primary>split_channels</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>split_channels</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::split_channels ( )</computeroutput></para><para>

<para>Splits the channels into individual images. </para>
</para>

<para><formalpara><title>Returns</title>

<para>Bimage* new image. <literallayout><computeroutput>The channels are converted to successive sets of images.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1992 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1abaa0057b767acf23c99af72b999b5368"/>    <section>
    <title>square()</title>
<indexterm><primary>square</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>square</secondary></indexterm>
<para><computeroutput>void Bimage::square ( )</computeroutput></para><para>

<para>Calculates the square of an image. </para>
</para>

<para><literallayout><computeroutput>Values less than zero are set to zero.
Values greater than the data type maximum are set to the maximum.
</computeroutput></literallayout> </para>
<para>
Definition at line 678 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7411e52811a3b4f86631e89f3a19da2e"/>    <section>
    <title>square_root()</title>
<indexterm><primary>square_root</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>square_root</secondary></indexterm>
<para><computeroutput>void Bimage::square_root ( )</computeroutput></para><para>

<para>Calculates the square root of an image. </para>
</para>

<para><literallayout><computeroutput>Values less than zero are set to zero.
Values greater than the data type maximum are set to the maximum.
</computeroutput></literallayout> </para>
<para>
Definition at line 698 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad055b167896256474d3cf3cf6bb5c6a4"/>    <section>
    <title>standard_deviation()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>standard_deviation</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>standard_deviation</secondary></indexterm>
<para><computeroutput>double Bimage::standard_deviation ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 547 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a70982cf915d12b0d32511c299dd2a003"/>    <section>
    <title>standard_deviation()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>standard_deviation</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>standard_deviation</secondary></indexterm>
<para><computeroutput>void Bimage::standard_deviation (double d)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 552 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a164807e87f62d5e817344738f69b8c16"/>    <section>
    <title>statistics()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>statistics</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>statistics</secondary></indexterm>
<para><computeroutput>long Bimage::statistics ( )</computeroutput></para><para>

<para>Calculates the statistics for an image. </para>
</para>

<para><formalpara><title>Returns</title>

<para>long number of errors. </para>
</formalpara>
</para>
<para>
Definition at line 22 of file Bimage_stats.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0e4bd3138163814bd4f96e38d8f9d5fd"/>    <section>
    <title>statistics()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>statistics</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>statistics</secondary></indexterm>
<para><computeroutput>long Bimage::statistics (<link linkend="_class_bimage">Bimage</link> * pmask, double &amp; regavg, double &amp; regstd)</computeroutput></para><para>

<para>Calculates the statistics for a region in an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>region. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;regavg</entry>
                                <entry>
<para>region average to be calculated. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;regstd</entry>
                                <entry>
<para>region standard deviation to be calculated. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of voxels. </para>
</formalpara>
</para>
<para>
Definition at line 167 of file Bimage_stats.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a1d479463c3714a99b670129d62d3fe7a"/>    <section>
    <title>statistics()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>statistics</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>statistics</secondary></indexterm>
<para><computeroutput>long Bimage::statistics (long img_num)</computeroutput></para><para>

<para>Calculates the statistics for a sub-image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>img_num</entry>
                                <entry>
<para>sub-image number. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of errors. </para>
</formalpara>
</para>
<para>
Definition at line 101 of file Bimage_stats.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac6e146a61ad251fc4e5562495f6021aa"/>    <section>
    <title>stats_in_mask()</title>
<indexterm><primary>stats_in_mask</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>stats_in_mask</secondary></indexterm>
<para><computeroutput>long Bimage::stats_in_mask (long nn, <link linkend="_class_bimage">Bimage</link> * pmask)</computeroutput></para><para>

<para>Calculates the statistics for an image for each level in a mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image number. </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>mask with two or more levels </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of levels (0 means failure). </para>
</formalpara>
</para>
<para>
Definition at line 508 of file Bimage_stats.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a4524e0f31e3c2c83e3d579cb199aa03f"/>    <section>
    <title>stats_in_poly()</title>
<indexterm><primary>stats_in_poly</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>stats_in_poly</secondary></indexterm>
<para><computeroutput>long Bimage::stats_in_poly (long nn, int nvert, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; * poly, double &amp; vavg, double &amp; vstd)</computeroutput></para><para>

<para>Calculates the statistics for an image within the given polyhedron. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image number. </para>
</entry>
                            </row>
                            <row>
                                <entry>nvert</entry>
                                <entry>
<para>number of polygon vertices. </para>
</entry>
                            </row>
                            <row>
                                <entry>*poly</entry>
                                <entry>
<para>array of polygon vertices. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;vavg</entry>
                                <entry>
<para>return value for the average. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;vstd</entry>
                                <entry>
<para>return value for the standard deviation. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of values (0 means failure). <literallayout><computeroutput>If a voxel lies within the specified polyhedron, it is included in
the statistical calculations.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 437 of file Bimage_stats.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af67e899354c36a6d1a4abdb37136f079"/>    <section>
    <title>stats_in_shape()</title>
<indexterm><primary>stats_in_shape</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>stats_in_shape</secondary></indexterm>
<para><computeroutput>long Bimage::stats_in_shape (long nn, int type, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; start, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; end, double &amp; vavg, double &amp; vstd)</computeroutput></para><para>

<para>Calculates the statistics for an image within the given box. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image number. </para>
</entry>
                            </row>
                            <row>
                                <entry>type</entry>
                                <entry>
<para>type of selection: 1=rectangle, 2=ellipse. </para>
</entry>
                            </row>
                            <row>
                                <entry>start</entry>
                                <entry>
<para>starting coordinates. </para>
</entry>
                            </row>
                            <row>
                                <entry>end</entry>
                                <entry>
<para>ending coordinates. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;vavg</entry>
                                <entry>
<para>return value for the average. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;vstd</entry>
                                <entry>
<para>return value for the standard deviation. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of values (0 means failure). <literallayout><computeroutput>If a voxel lies within the specified box, it is included in
the statistical calculations.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 300 of file Bimage_stats.cpp.</para>
    </section><anchor xml:id="_class_bimage_1acce5020e4d29e2e0fc0b3ee369b68bc0"/>    <section>
    <title>stats_within_radii()</title>
<indexterm><primary>stats_within_radii</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>stats_within_radii</secondary></indexterm>
<para><computeroutput>long Bimage::stats_within_radii (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; loc, double rad_min, double rad_max, double &amp; vavg, double &amp; vstd)</computeroutput></para><para>

<para>Calculates the statistics for an image within given radii from a location. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image number. </para>
</entry>
                            </row>
                            <row>
                                <entry>loc</entry>
                                <entry>
<para>center of shell. </para>
</entry>
                            </row>
                            <row>
                                <entry>rad_min</entry>
                                <entry>
<para>minimum radius (pixel units). </para>
</entry>
                            </row>
                            <row>
                                <entry>rad_max</entry>
                                <entry>
<para>maximum radius (pixel units). </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;vavg</entry>
                                <entry>
<para>return value for the average. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;vstd</entry>
                                <entry>
<para>return value for the standard deviation. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of values (0 means failure). <literallayout><computeroutput>If a voxel lies within the specified radii, it is included in
the statistical calculations.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 223 of file Bimage_stats.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac63bc84ebfa0da20f4783d5406fb0ada"/>    <section>
    <title>subimage_information()</title>
<indexterm><primary>subimage_information</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>subimage_information</secondary></indexterm>
<para><computeroutput>int Bimage::subimage_information ( )</computeroutput></para><para>

<para>Prints out header information for all sub-images. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int error code (&lt;0 means failure). </para>
</formalpara>
</para>
<para>
Definition at line 2634 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7349e99d1a9375c118ca86b69d387f0f"/>    <section>
    <title>subtract()</title>
<indexterm><primary>subtract</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>subtract</secondary></indexterm>
<para><computeroutput>void Bimage::subtract (<link linkend="_class_bimage">Bimage</link> * p)</computeroutput></para><para>

<para>Subtracts another image from an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*p</entry>
                                <entry>
<para>image to be added. <literallayout><computeroutput>Requirement: The images must have the same size.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 3678 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1abb34c252e6a493a4672317f6790c6bfc"/>    <section>
    <title>subtract_background()</title>
<indexterm><primary>subtract_background</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>subtract_background</secondary></indexterm>
<para><computeroutput>int Bimage::subtract_background ( )</computeroutput></para><para>

<para>Subtracts the background for each sub-image. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0, &lt;0 on error. <literallayout><computeroutput>The background is taken from the sub-image structures.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 339 of file Bimage_background.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a48263b31ee57d8c986bb1256413b71bd"/>    <section>
    <title>sum()</title>
<indexterm><primary>sum</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>sum</secondary></indexterm>
<para><computeroutput>void Bimage::sum (long m, <link linkend="_class_bimage">Bimage</link> ** p)</computeroutput></para><para>

<para>Sums an array of images with their FOM blocks. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>m</entry>
                                <entry>
<para>number of images in the array. </para>
</entry>
                            </row>
                            <row>
                                <entry>**p</entry>
                                <entry>
<para>array of images. <literallayout><computeroutput>The images must all have the same dimensions.
</computeroutput></literallayout> </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
<para>
Definition at line 23 of file Bimage_combine.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aca83b7f355394a839d387473c46cb804"/>    <section>
    <title>sum_images()</title>
<indexterm><primary>sum_images</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>sum_images</secondary></indexterm>
<para><computeroutput>void Bimage::sum_images ( )</computeroutput></para><para>

<para>Adds all sub-images. </para>
</para>
<para>
Definition at line 3503 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa33a023390e57b9360c07a7e29897096"/>    <section>
    <title>superpixels()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>superpixels</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>superpixels</secondary></indexterm>
<para><computeroutput>vector&lt; <link linkend="_class_bsuperpixel">Bsuperpixel</link> &gt; Bimage::superpixels (long step, double colorweight = <computeroutput>0.2</computeroutput>
, long iterations = <computeroutput>10</computeroutput>
, double stop = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Segment the image into superpixels. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>step</entry>
                                <entry>
<para>initial superpixel intervals. </para>
</entry>
                            </row>
                            <row>
                                <entry>colorweight</entry>
                                <entry>
<para>weight of color differences compared to spatial distances. </para>
</entry>
                            </row>
                            <row>
                                <entry>iterations</entry>
                                <entry>
<para>maximum number of iterations. </para>
</entry>
                            </row>
                            <row>
                                <entry>stop</entry>
                                <entry>
<para>stopping condition as a percent of voxel changes. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>vector&lt;Bsuperpixel&gt; array of superpixels. <literallayout><computeroutput>The segment array contents are:
0       count
1-3     coordinates
4+      channels
last    color weight for the segment - maximum squared distance

The mask is linked to the original image for return.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1819 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af8595e7180726af4e712990b8d8c1e69"/>    <section>
    <title>superpixels()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>superpixels</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>superpixels</secondary></indexterm>
<para><computeroutput>vector&lt; <link linkend="_class_bsuperpixel">Bsuperpixel</link> &gt; Bimage::superpixels (long step, double colorweight = <computeroutput>0.2</computeroutput>
, long iterations = <computeroutput>10</computeroutput>
, long bin_levels = <computeroutput>1</computeroutput>
, double stop = <computeroutput>1</computeroutput>
)</computeroutput></para><para>
Definition at line 1886 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aed87b5005e95430846c84a77a59a7231"/>    <section>
    <title>superpixels_from_mask()</title>
<indexterm><primary>superpixels_from_mask</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>superpixels_from_mask</secondary></indexterm>
<para><computeroutput>vector&lt; <link linkend="_class_bsuperpixel">Bsuperpixel</link> &gt; Bimage::superpixels_from_mask (long cc, long step)</computeroutput></para><para>

<para>Create superpixels from a multilevel mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>cc</entry>
                                <entry>
<para>number of channels in the original image. </para>
</entry>
                            </row>
                            <row>
                                <entry>step</entry>
                                <entry>
<para>distance limit to determine neigbors. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>vector&lt;Bsuperpixel&gt; array of superpixels. </para>
</formalpara>
</para>
<para>
Definition at line 1768 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0967da4dc8941259b9e4e03fbc169b8e"/>    <section>
    <title>superpixels_update()</title>
<indexterm><primary>superpixels_update</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>superpixels_update</secondary></indexterm>
<para><computeroutput>int Bimage::superpixels_update (<link linkend="_class_bimage">Bimage</link> * pmask, vector&lt; long &gt; vstep, double colorweight, vector&lt; <link linkend="_class_bsuperpixel">Bsuperpixel</link> &gt; &amp; seg)</computeroutput></para><para>
Definition at line 1556 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a1de22ac24c7afaac9c174a4b4ff27bc9"/>    <section>
    <title>surface_to_topograph()</title>
<indexterm><primary>surface_to_topograph</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>surface_to_topograph</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::surface_to_topograph (double threshold, int dir = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Converts a 3D image to a 2D height image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>threshold to define the surface (assuming positive density). </para>
</entry>
                            </row>
                            <row>
                                <entry>dir</entry>
                                <entry>
<para>direction: 0=bottom up, 1=top down. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* 2D height image. <literallayout><computeroutput>The threshold defines the surface of the positive density in the 3D image.
Each line of voxels in the z-direction is scanned for the voxel
exceeding the threshold with the highest z-index.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 119 of file Bimage_topo.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac9d5028551a2b8fde28e38228f3e998b"/>    <section>
    <title>symmetrize()<computeroutput>[1/4]</computeroutput></title>
<indexterm><primary>symmetrize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>symmetrize</secondary></indexterm>
<para><computeroutput>double Bimage::symmetrize (<link linkend="_class_bstring">Bstring</link> &amp; symmetry_string, int flag)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 1233 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1adcb92270632a302bdf4773ee5da2be0a"/>    <section>
    <title>symmetrize()<computeroutput>[2/4]</computeroutput></title>
<indexterm><primary>symmetrize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>symmetrize</secondary></indexterm>
<para><computeroutput>double Bimage::symmetrize (<link linkend="_class_bstring">Bstring</link> &amp; symmetry_string, <link linkend="_class_view">View</link> ref_view, int flag)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 1241 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1ac9234ec2ff8a260449cf950cdafa717a"/>    <section>
    <title>symmetrize()<computeroutput>[3/4]</computeroutput></title>
<indexterm><primary>symmetrize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>symmetrize</secondary></indexterm>
<para><computeroutput>double Bimage::symmetrize (<link linkend="_struct_bsymmetry">Bsymmetry</link> sym, int flag)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 1237 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1adda5f353fd53c60a772c4457e6585a8b"/>    <section>
    <title>symmetrize()<computeroutput>[4/4]</computeroutput></title>
<indexterm><primary>symmetrize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>symmetrize</secondary></indexterm>
<para><computeroutput>double Bimage::symmetrize (<link linkend="_struct_bsymmetry">Bsymmetry</link> sym, <link linkend="_class_view">View</link> ref_view, int flag)</computeroutput></para><para>

<para>Applies point group symmetry to an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>sym</entry>
                                <entry>
<para>point group. </para>
</entry>
                            </row>
                            <row>
                                <entry>ref_view</entry>
                                <entry>
<para>reference view vector and rotation angle. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>flag to normalize after symmetrization. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double symmetry FOM. <literallayout><computeroutput>The point group symmetry operations are applied to an image with an
orientation defined by the reference symmetry axis (default {0,0,1}). 
The fill value is taken from image&apos;s background value.
The symmetry FOM is taken as the ratio of the power after to before
symmetrization. 
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 31 of file Bimage_symmetry.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a9780d7cbd494044686c433a6b525b9b6"/>    <section>
    <title>symmetrize_cyclic()</title>
<indexterm><primary>symmetrize_cyclic</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>symmetrize_cyclic</secondary></indexterm>
<para><computeroutput>double Bimage::symmetrize_cyclic (int cyclic, int flag)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 1245 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1abff0d6899e55fcad02d800f179e87e46"/>    <section>
    <title>symmetrize_cylinder()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>symmetrize_cylinder</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>symmetrize_cylinder</secondary></indexterm>
<para><computeroutput>int Bimage::symmetrize_cylinder ( )</computeroutput></para><para>

<para>Calculates a cylindrically symmetrized map. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The image is replaced with its cylindrically symmetrized version.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 585 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8e04fb8bc837bf7f030b4fb061e1bdbf"/>    <section>
    <title>symmetrize_cylinder()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>symmetrize_cylinder</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>symmetrize_cylinder</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::symmetrize_cylinder (int flag)</computeroutput></para><para>

<para>Calculates a cylindrically symmetrized map. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>0: </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* 2D image with the cylindrical average. <literallayout><computeroutput>A 2D cylindrically symmetrized average is calculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 524 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7e1793d4db04c33e603983b47c95b0ba"/>    <section>
    <title>symmetry()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>symmetry</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>symmetry</secondary></indexterm>
<para><computeroutput>string&amp; Bimage::symmetry ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 607 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a356f24e44b64a98a02e7e3100e3349a9"/>    <section>
    <title>symmetry()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>symmetry</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>symmetry</secondary></indexterm>
<para><computeroutput>void Bimage::symmetry (string grp)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 611 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a9b10d20714d9de3585a5d17a5db6021b"/>    <section>
    <title>symmetry_equivalent()</title>
<indexterm><primary>symmetry_equivalent</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>symmetry_equivalent</secondary></indexterm>
<para><computeroutput><link linkend="_class_matrix3">Matrix3</link> Bimage::symmetry_equivalent (<link linkend="_class_bimage">Bimage</link> * pref, <link linkend="_class_bimage">Bimage</link> * pmask, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp; sym)</computeroutput></para><para>

<para>Finds the symmetry equivalent orientation of a particle with respect to a template. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pref</entry>
                                <entry>
<para>template to test against (same size as input image). </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>mask to limit correlation calculation. </para>
</entry>
                            </row>
                            <row>
                                <entry>*sym</entry>
                                <entry>
<para>symmetry structure. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para><link linkend="_class_matrix3">Matrix3</link> transformed image. <literallayout><computeroutput>For point groups up to tetrahedral symmetry, there is an ambiguity in the
orientation of a particle even though it is oriented according to the 
standard orientation for the symmetry.
A template is used to select the desired orientation and the image is transformed.
Both the input image and template must be in the standard orientation
for the point group.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 656 of file Bimage_symmetry.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a441cf6a9232c52cd99f32acdb1ba905d"/>    <section>
    <title>symmetry_equivalent_cyclic()</title>
<indexterm><primary>symmetry_equivalent_cyclic</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>symmetry_equivalent_cyclic</secondary></indexterm>
<para><computeroutput><link linkend="_class_matrix3">Matrix3</link> Bimage::symmetry_equivalent_cyclic (<link linkend="_class_bimage">Bimage</link> * pref, <link linkend="_class_bimage">Bimage</link> * pmask, <link linkend="_struct_bsymmetry">Bsymmetry</link> &amp; sym)</computeroutput></para><para>

<para>Finds the cyclic symmetry equivalent orientation of a particle with respect to a template. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*pref</entry>
                                <entry>
<para>template to test against (same size as input image). </para>
</entry>
                            </row>
                            <row>
                                <entry>*pmask</entry>
                                <entry>
<para>mask to limit correlation calculation. </para>
</entry>
                            </row>
                            <row>
                                <entry>*sym</entry>
                                <entry>
<para>symmetry structure. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para><link linkend="_class_matrix3">Matrix3</link> transformed image. <literallayout><computeroutput>For point groups up to tetrahedral symmetry, there is an ambiguity in the
orientation of a particle even though it is oriented according to the 
standard orientation for the symmetry.
A template is used to select the desired orientation and the image is transformed.
Both the input image and template must be in the standard orientation
for the point group.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 778 of file Bimage_symmetry.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8d7f8e0e6c7601e156216fc0552f24d7"/>    <section>
    <title>test_helix_parameters()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>test_helix_parameters</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>test_helix_parameters</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt; double &gt; Bimage::test_helix_parameters (double angle, double hires, double lores, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; mask_size, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; mask_start, long max_iter, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planf, <link linkend="_fft_8h_1a61d23c567e69684715ea52482137a5e6">fft_plan</link> planb, double &amp; cc)</computeroutput></para><para>
Definition at line 831 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3d6a7f6c65c1e731404fee3c2fbf7336"/>    <section>
    <title>test_helix_parameters()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>test_helix_parameters</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>test_helix_parameters</secondary></indexterm>
<para><computeroutput>double Bimage::test_helix_parameters (double rise, double angle, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; mask_size, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; mask_start)</computeroutput></para><para>
Definition at line 1022 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a960a7f0cde5092bb23f788c359c5388a"/>    <section>
    <title>thickness()</title>
<indexterm><primary>thickness</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>thickness</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::thickness (double reference, double emfp)</computeroutput></para><para>

<para>Calculates a thickness based on intensities with respect to a reference. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>reference</entry>
                                <entry>
<para>reference intensity. </para>
</entry>
                            </row>
                            <row>
                                <entry>emfp</entry>
                                <entry>
<para>proportionaility coefficient. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>vector&lt;double&gt; 7-value array of parameters. <literallayout><computeroutput>The thickness for each pixel is:
    t = emfp * ln(Iref/Ipix)
If Ipix &lt;= 0, t = 0
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 951 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ad8ef4e4f4bf08e4282763b429c2ff060"/>    <section>
    <title>tile_coordinates()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>tile_coordinates</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>tile_coordinates</secondary></indexterm>
<para><computeroutput>vector&lt; <link linkend="_class_vector3">Vector3</link>&lt; long &gt; &gt; Bimage::tile_coordinates (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; &amp; start, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; &amp; region, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; &amp; tile_size, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; &amp; step_size, int exceed)</computeroutput></para><para>

<para>Generates a set of tile coordinates for an image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>&amp;start</entry>
                                <entry>
<para>3-vector start for first tile to be extracted. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;region</entry>
                                <entry>
<para>3-vector size of part of image to be extracted (0 = whole image). </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;tile_size</entry>
                                <entry>
<para>3-vector size of extracted image. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;step_size</entry>
                                <entry>
<para>3-vector size of intervals between tiles. </para>
</entry>
                            </row>
                            <row>
                                <entry>exceed</entry>
                                <entry>
<para>flag to allow tiles to exceed the input image size. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>vector&lt;<link linkend="_class_vector3">Vector3&lt;long&gt;</link>&gt; set of coordinates. <literallayout><computeroutput>Calculating the coordinates of tiles of a specified size and within
a specified region within the image. The overlap is specified by
the step size and a flag indicates the option to exceed the
bounds of the image.
The old data is not affected.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 258 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6c8ec73b38f79aca1d59c87ed1a7d27c"/>    <section>
    <title>tile_coordinates()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>tile_coordinates</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>tile_coordinates</secondary></indexterm>
<para><computeroutput>vector&lt; <link linkend="_class_vector3">Vector3</link>&lt; long &gt; &gt; Bimage::tile_coordinates (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; tile_size, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; &amp; step_size)</computeroutput></para><para>

<para>Generates a set of tile coordinates to fit in the image dimensions. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>tile_size</entry>
                                <entry>
<para>3-vector size of extracted image. </para>
</entry>
                            </row>
                            <row>
                                <entry>&amp;step_size</entry>
                                <entry>
<para>3-vector size of intervals between tiles. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>vector&lt;<link linkend="_class_vector3">Vector3&lt;long&gt;</link>&gt; set of coordinates. <literallayout><computeroutput>Calculating the coordinates of tiles of a specified size to fit within
the bounds of the image. The overlap is specified by
the given step size, which is adjusted to fit the image bounds.
The old data is not affected.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 328 of file Bimage_extract.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa0ac74f2bb136585165376ab7feb7b2b"/>    <section>
    <title>tile_mask()</title>
<indexterm><primary>tile_mask</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>tile_mask</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::tile_mask (long step)</computeroutput></para><para>

<para>Converts a mask to a tiled multilevel mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>step</entry>
                                <entry>
<para>isotropic tile edge size. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* new mask. <literallayout><computeroutput>The old data is unmodified.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1453 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a1513d43b73d238e6b087fe2e4a2dc873"/>    <section>
    <title>to_mask()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>to_mask</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>to_mask</secondary></indexterm>
<para><computeroutput>long Bimage::to_mask ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 1366 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a9d8256eb1e4caa7cabb1a72f0287d98d"/>    <section>
    <title>to_mask()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>to_mask</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>to_mask</secondary></indexterm>
<para><computeroutput>long Bimage::to_mask (double threshold)</computeroutput></para><para>

<para>Change the image to a mask. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>set mask above this value. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>long number of mask voxels. <literallayout><computeroutput>The input image is effectively thresholded and a mask with 0 and 1 generated.
The new data type is unsigned char/byte.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 51 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8c930e1334ca602ae39bcf26b3a6f851"/>    <section>
    <title>topograph_to_surface()</title>
<indexterm><primary>topograph_to_surface</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>topograph_to_surface</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::topograph_to_surface (<link linkend="_class_bimage">Bimage</link> * psd, long nz, double density, double resolution)</computeroutput></para><para>

<para>Converts a 2D AFM image to a 3D density map. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>*psd</entry>
                                <entry>
<para>2D standard deviation image. </para>
</entry>
                            </row>
                            <row>
                                <entry>nz</entry>
                                <entry>
<para>z dimension of the new 3D map. </para>
</entry>
                            </row>
                            <row>
                                <entry>density</entry>
                                <entry>
<para>density inside the surface (Da/A3). </para>
</entry>
                            </row>
                            <row>
                                <entry>resolution</entry>
                                <entry>
<para>sigma bounds. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The 2D image is expanded in the z direction according to:
                          voxel_density
dens[x,y,z] = --------------------------------------
              1+exp(factor*(z-zdis[x,y])/sigma[x,y])
where   voxel_density is the total density attributed to a voxel
        factor = 1.618
        z - zdis[x,y] is the z distance from the surface
        sigma is a standard deviation term to describe the surface variability.
The sigma term can be set automatically or given by an input standard deviation map.
The position of the surface is calculated as:
zdis[x,y] = loz + (hiz - loz)*(image[x,y] - min)/(max - min)
where   loz and hiz are the lowest and highest points of the surface in the 3D map
        min and max are the image minimum and maximum values
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 39 of file Bimage_topo.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a08fd2cd3face95c2fb85f2adfb36532f"/>    <section>
    <title>track_gradient()</title>
<indexterm><primary>track_gradient</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>track_gradient</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::track_gradient (double threshold, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Generates a segmented image from peaks above a threshold value. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>threshold</entry>
                                <entry>
<para>the lowest level to include voxels in regions. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>Track towards maxima (0) or minima (1). </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* integer image containing tracking indices. <literallayout><computeroutput>Every voxel with a value above (below) the threshold is tagged by a pointer
pointing to the highest (lowest) value within a kernel of 3x3x3.
A peak is defined as pointing to itself, while every other voxel
points towards a peak.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 432 of file Bimage_segment.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3eb5e8ee13e1fdc6ae91cf24a7b1000c"/>    <section>
    <title>transform()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>transform</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>transform</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::transform (long nn, <link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; scale, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; origin, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; translate, <link linkend="_class_matrix3">Matrix3</link> mat, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Transforms a sub-image by translation, rotation, scaling and skewing, returning a single new image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>sub-image to process. </para>
</entry>
                            </row>
                            <row>
                                <entry>nusize</entry>
                                <entry>
<para>3-value new image size. </para>
</entry>
                            </row>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>3-value scale factor vector to apply. </para>
</entry>
                            </row>
                            <row>
                                <entry>origin</entry>
                                <entry>
<para>3-value origin for rotation and skewing. </para>
</entry>
                            </row>
                            <row>
                                <entry>translate</entry>
                                <entry>
<para>3-value vector for translation after transformation. </para>
</entry>
                            </row>
                            <row>
                                <entry>mat</entry>
                                <entry>
<para>3x3 rotation or skewing matrix. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>fill type for filling empty regions. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value to fill in empty regions. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* new image. <literallayout><computeroutput>A number of transformation types are combined in this function for
efficiency. The basic operation is the conversion of the image data 
from the original data block to a new data block, applying a 
transformation matrix and translation vector with a specified origin 
followed by an optional translation:
    y = R*x + t
where   R is the rotation/skewing/scaling matrix.
        t is the translation vector.
Note: The image is converted to floating point to improve interpolation.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 138 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1afeb9247a8453a7e7907517b837d31144"/>    <section>
    <title>transform()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>transform</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>transform</secondary></indexterm>
<para><computeroutput>int Bimage::transform (<link linkend="_class_vector3">Vector3</link>&lt; double &gt; scale, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; origin, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; translate, <link linkend="_class_matrix3">Matrix3</link> mat, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Transforms an image by translation, rotation, scaling and skewing, in place. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>3-value scale factor vector to apply. </para>
</entry>
                            </row>
                            <row>
                                <entry>origin</entry>
                                <entry>
<para>3-value origin for rotation and skewing. </para>
</entry>
                            </row>
                            <row>
                                <entry>translate</entry>
                                <entry>
<para>3-value vector for translation after transformation. </para>
</entry>
                            </row>
                            <row>
                                <entry>mat</entry>
                                <entry>
<para>3x3 rotation or skewing matrix. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>fill type for filling empty regions. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value to fill in empty regions. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>0 error code. <literallayout><computeroutput>A number of transformation types are combined in this function for
efficiency. The basic operation is the conversion of the image data 
from the original data block to a new data block, applying a 
transformation matrix and translation vector with a specified origin 
followed by an optional translation:
    y = R*x + t
where   R is the rotation/skewing/scaling matrix.
        t is the translation vector.
Note: The image is converted to floating point to improve interpolation.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 37 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1af8b24fc84bde3d429023c6a2d19e993b"/>    <section>
    <title>transform()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>transform</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>transform</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::transform (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; nusize, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; scale, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; origin, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; translate, <link linkend="_class_matrix3">Matrix3</link> mat, int fill_type = <computeroutput>0</computeroutput>
, double fill = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Transforms an image by translation, rotation, scaling and skewing, returning a new image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nusize</entry>
                                <entry>
<para>3-value new image size. </para>
</entry>
                            </row>
                            <row>
                                <entry>scale</entry>
                                <entry>
<para>3-value scale factor vector to apply. </para>
</entry>
                            </row>
                            <row>
                                <entry>origin</entry>
                                <entry>
<para>3-value origin for rotation and skewing. </para>
</entry>
                            </row>
                            <row>
                                <entry>translate</entry>
                                <entry>
<para>3-value vector for translation after transformation. </para>
</entry>
                            </row>
                            <row>
                                <entry>mat</entry>
                                <entry>
<para>3x3 rotation or skewing matrix. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill_type</entry>
                                <entry>
<para>fill type for filling empty regions. </para>
</entry>
                            </row>
                            <row>
                                <entry>fill</entry>
                                <entry>
<para>value to fill in empty regions. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* new image. <literallayout><computeroutput>A number of transformation types are combined in this function for
efficiency. The basic operation is the conversion of the image data 
from the original data block to a new data block, applying a 
transformation matrix and translation vector with a specified origin 
followed by an optional translation:
    y = R*x + t
where   R is the rotation/skewing/scaling matrix.
        t is the translation vector.
Note: The image is converted to floating point to improve interpolation.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 75 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3b6ce6033d308dc4276493460266243c"/>    <section>
    <title>transform_lines()</title>
<indexterm><primary>transform_lines</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>transform_lines</secondary></indexterm>
<para><computeroutput>int Bimage::transform_lines ( )</computeroutput></para><para>
Definition at line 1365 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aba54e71d897721376cfaab4e6c360cf5"/>    <section>
    <title>transform_voxel()</title>
<indexterm><primary>transform_voxel</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>transform_voxel</secondary></indexterm>
<para><computeroutput>void Bimage::transform_voxel (long i, <link linkend="_class_bimage">Bimage</link> * pt, long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; oldorigin, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; nuorigin, <link linkend="_class_matrix3">Matrix3</link> affmat, double fill)</computeroutput></para><para>
Definition at line 104 of file Bimage_transform.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a55253f5cbc24af2d07edf348d81772cb"/>    <section>
    <title>truncate()</title>
<indexterm><primary>truncate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>truncate</secondary></indexterm>
<para><computeroutput>int Bimage::truncate (double minim, double maxim, double setmin, double setmax)</computeroutput></para><para>

<para>Truncates image data to a given minimum and maximum. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>minim</entry>
                                <entry>
<para>minimum. </para>
</entry>
                            </row>
                            <row>
                                <entry>maxim</entry>
                                <entry>
<para>maximum. </para>
</entry>
                            </row>
                            <row>
                                <entry>setmin</entry>
                                <entry>
<para>value to set voxels smaller than minimum. </para>
</entry>
                            </row>
                            <row>
                                <entry>setmax</entry>
                                <entry>
<para>value to set voxels larger than maximum. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>All values smaller than the new minimum are set to the new minimum
and all values larger than the new maximum are set to the new maximum.
In cases where the given minimum and maximum are outside the data
type ranges, they are reset to the data type range limits.
The new data replaces the old data.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 277 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a972a0567449bfb9aff48b05aafec5c7e"/>    <section>
    <title>truncate_to_avg()</title>
<indexterm><primary>truncate_to_avg</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>truncate_to_avg</secondary></indexterm>
<para><computeroutput>int Bimage::truncate_to_avg (double minim, double maxim)</computeroutput></para><para>

<para>Sets voxels in image data exceeding a given minimum and maximum to the average. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>minim</entry>
                                <entry>
<para>minimum. </para>
</entry>
                            </row>
                            <row>
                                <entry>maxim</entry>
                                <entry>
<para>maximum. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>All values smaller than the new minimum or larger than the new 
maximum are set to the image average.
The new data replaces the old data.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 349 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a76678f39fb8dc645ec3d54d9494db3d9"/>    <section>
    <title>truncate_to_background()</title>
<indexterm><primary>truncate_to_background</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>truncate_to_background</secondary></indexterm>
<para><computeroutput>int Bimage::truncate_to_background (double minim, double maxim)</computeroutput></para><para>

<para>Sets voxels in image data exceeding a given minimum and maximum to the image background. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>minim</entry>
                                <entry>
<para>minimum. </para>
</entry>
                            </row>
                            <row>
                                <entry>maxim</entry>
                                <entry>
<para>maximum. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>All values smaller than the new minimum or larger than the new 
maximum are set to the background value.
The new data replaces the old data.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 367 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a0112a4c9c0d3c8dcd41b17f540584517"/>    <section>
    <title>truncate_to_min_max()</title>
<indexterm><primary>truncate_to_min_max</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>truncate_to_min_max</secondary></indexterm>
<para><computeroutput>int Bimage::truncate_to_min_max (double minim, double maxim)</computeroutput></para><para>

<para>Truncates image data to a given minimum and maximum. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>minim</entry>
                                <entry>
<para>minimum. </para>
</entry>
                            </row>
                            <row>
                                <entry>maxim</entry>
                                <entry>
<para>maximum. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>All values smaller than the new minimum are set to the new minimum
and all values larger than the new maximum are set to the new maximum.
In cases where the given minimum and maximum are outside the data
type ranges, they are reset to the data type range limits.
The new data replaces the old data.
Image statistics are recalculated.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 331 of file Bimage_rescale.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a200ab278f109331849725f5398930f8e"/>    <section>
    <title>tube_interpolate()</title>
<indexterm><primary>tube_interpolate</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>tube_interpolate</secondary></indexterm>
<para><computeroutput>double Bimage::tube_interpolate (long i, int h, int k, double latconst, int zmin, int zmax, double radius, int norm_flag = <computeroutput>1</computeroutput>
)</computeroutput></para><para>
Definition at line 73 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a8f9ffa51405f1702ea3091f35fa66902"/>    <section>
    <title>tube_symmetrize()</title>
<indexterm><primary>tube_symmetrize</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>tube_symmetrize</secondary></indexterm>
<para><computeroutput>double Bimage::tube_symmetrize (int h, int k, double latconst, int zmin, int zmax, double radius, int norm_flag = <computeroutput>1</computeroutput>
)</computeroutput></para><para>

<para>Symmetrizes an image given tubular lattice parameters. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>h</entry>
                                <entry>
<para>units along u vector. </para>
</entry>
                            </row>
                            <row>
                                <entry>k</entry>
                                <entry>
<para>units along v vector. </para>
</entry>
                            </row>
                            <row>
                                <entry>latconst</entry>
                                <entry>
<para>lattice constant (angstrom). </para>
</entry>
                            </row>
                            <row>
                                <entry>zmin</entry>
                                <entry>
<para>mimimum z slice to include. </para>
</entry>
                            </row>
                            <row>
                                <entry>zmax</entry>
                                <entry>
<para>maximum z slice to include. </para>
</entry>
                            </row>
                            <row>
                                <entry>radius</entry>
                                <entry>
<para>radius to do symmetrizing over (pixels). </para>
</entry>
                            </row>
                            <row>
                                <entry>norm_flag</entry>
                                <entry>
<para>if 1, normalize </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double R factor. <literallayout><computeroutput>The data between the z limits are replicated along the helical axis
according to the lattice parameters to fill the new volume.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 633 of file Bimage_helix.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a58e341bd1fde6068b484a265a546b39a"/>    <section>
    <title>unit_cell()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>unit_cell</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>unit_cell</secondary></indexterm>
<para><computeroutput><link linkend="_class_unit_cell">UnitCell</link> Bimage::unit_cell ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 619 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a3b435df6c3ad057b73957aad67172ea5"/>    <section>
    <title>unit_cell()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>unit_cell</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>unit_cell</secondary></indexterm>
<para><computeroutput>void Bimage::unit_cell (<link linkend="_class_unit_cell">UnitCell</link> uc)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 612 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1ab581cd7985b8d57b0fce1d70a1651f1a"/>    <section>
    <title>unpack_combined_transform()</title>
<indexterm><primary>unpack_combined_transform</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>unpack_combined_transform</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::unpack_combined_transform ( )</computeroutput></para><para>

<para>Unpacks a complex transform obtained from two real images. </para>
</para>

<para><formalpara><title>Returns</title>

<para>Bimage* transform of second image. <literallayout><computeroutput>The complex image must be a Fourier transform obtained from two real 
space images which were packed into the real and imaginary parts
of the complex image before Fourier transformation.
The input image is used to hold the transform of the first image.
A new image is created to hold the transform of the second image.
Both these images are complex floating point.
Note: Images with even dimensions cannot be unpacked exactly because
    the inverse is not present when x=nx/2 or y=ny/2 or z=nz/2.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 814 of file Bimage_complex.cpp.</para>
    </section><anchor xml:id="_class_bimage_1abac3ddeaa17b3475f3023da92ddbc786"/>    <section>
    <title>unpack_transform()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>unpack_transform</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>unpack_transform</secondary></indexterm>
<para><computeroutput>int Bimage::unpack_transform (int img_select, unsigned char * data, <link linkend="__bimage_8h_1a01e0deba350901d769526633e868806f">FourierType</link> tf)</computeroutput></para><para>
Definition at line 2417 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a5d169bcc5a3105a3b258b3d62449618f"/>    <section>
    <title>unpack_transform()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>unpack_transform</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>unpack_transform</secondary></indexterm>
<para><computeroutput>int Bimage::unpack_transform (unsigned char * data, <link linkend="__bimage_8h_1a01e0deba350901d769526633e868806f">FourierType</link> tf)</computeroutput></para><para>
Definition at line 2412 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a42dd5c73484665555ed8068a6fc0f63c"/>    <section>
    <title>update_from_meta_data()</title>
<indexterm><primary>update_from_meta_data</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>update_from_meta_data</secondary></indexterm>
<para><computeroutput>void Bimage::update_from_meta_data ( )</computeroutput></para><para>

<para>Update sub-image information from the metadata. </para>
</para>

<para><literallayout><computeroutput>The metadata in JSON format is transferred to the sub-image information.
</computeroutput></literallayout> </para>
<para>
Definition at line 734 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a6ca731eb52bfb717eb037284aa5f5948"/>    <section>
    <title>values()<computeroutput>[1/3]</computeroutput></title>
<indexterm><primary>values</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>values</secondary></indexterm>
<para><computeroutput>vector&lt;double&gt; Bimage::values (long i)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 292 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a0c5c2a2c6d2b645b5c076703c2ef35c4"/>    <section>
    <title>values()<computeroutput>[2/3]</computeroutput></title>
<indexterm><primary>values</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>values</secondary></indexterm>
<para><computeroutput>void Bimage::values (long i, vector&lt; double &gt; val)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 298 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1aab1bb8c97d8f6513ae63dc0f101f4f81"/>    <section>
    <title>values()<computeroutput>[3/3]</computeroutput></title>
<indexterm><primary>values</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>values</secondary></indexterm>
<para><computeroutput>vector&lt; double &gt; Bimage::values (long nn, <link linkend="_class_vector3">Vector3</link>&lt; double &gt; vox)</computeroutput></para><para>

<para>Returns an array with all channel data at the given coordinates. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>nn</entry>
                                <entry>
<para>image index. </para>
</entry>
                            </row>
                            <row>
                                <entry>vox</entry>
                                <entry>
<para>voxel coordinates. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>vector&lt;double&gt; value array. <literallayout><computeroutput>The values of all channels are returned in double precision.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1012 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a4bf8a5dccfa06f31723598cfb9f08a22"/>    <section>
    <title>variance()<computeroutput>[1/4]</computeroutput></title>
<indexterm><primary>variance</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>variance</secondary></indexterm>
<para><computeroutput>double Bimage::variance ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 548 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1afc9022fbf57ed364f1c2f52b71f7af4d"/>    <section>
    <title>variance()<computeroutput>[2/4]</computeroutput></title>
<indexterm><primary>variance</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>variance</secondary></indexterm>
<para><computeroutput>int Bimage::variance (<link linkend="_class_bimage">Bimage</link> * pweight)</computeroutput></para><para>

<para>Calculates the local variance weighed with the given image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>pweight</entry>
                                <entry>
<para>weight image. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The local variance is calculated using the given image as kernel weights.
The calculation is threaded if compiled with GCD or OpenMP.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 773 of file Bimage_stats.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a9dff1ffc38196ca423bf5f842fc3c1e6"/>    <section>
    <title>variance()<computeroutput>[3/4]</computeroutput></title>
<indexterm><primary>variance</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>variance</secondary></indexterm>
<para><computeroutput>int Bimage::variance (long kernel_size, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates the local variance within the given kernel. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>kernel_size</entry>
                                <entry>
<para>size of kernel edge. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>selects type of output. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The local variance within a kernel is calculated.
The calculation is threaded if compiled with GCD or OpenMP.
Flag values:
0   variance
1   standard deviation
2   poisson excess variance
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 643 of file Bimage_stats.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3f1e1cdce8cdbf4f060da4c6bb22df70"/>    <section>
    <title>variance()<computeroutput>[4/4]</computeroutput></title>
<indexterm><primary>variance</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>variance</secondary></indexterm>
<para><computeroutput>int Bimage::variance (<link linkend="_class_vector3">Vector3</link>&lt; long &gt; kernel_size, int flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates the local variance within the given kernel. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>kernel_size</entry>
                                <entry>
<para>3-value size of kernel edge. </para>
</entry>
                            </row>
                            <row>
                                <entry>flag</entry>
                                <entry>
<para>selects type of output. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>int 0. <literallayout><computeroutput>The local variance within a kernel is calculated.
The calculation is threaded if compiled with GCD or OpenMP.
Flag values:
0   variance
1   standard deviation
2   poisson excess variance
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 671 of file Bimage_stats.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a3d30db7452d06854cadb693a84e2385a"/>    <section>
    <title>variance_mask()</title>
<indexterm><primary>variance_mask</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>variance_mask</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link> * Bimage::variance_mask (long kernel_size, double lowvar = <computeroutput>1e-6</computeroutput>
, int bkg_flag = <computeroutput>0</computeroutput>
)</computeroutput></para><para>

<para>Calculates a mask based on local variance. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>kernel_size</entry>
                                <entry>
<para>size of kernel edge. </para>
</entry>
                            </row>
                            <row>
                                <entry>lowvar</entry>
                                <entry>
<para>low variance threshold. </para>
</entry>
                            </row>
                            <row>
                                <entry>bkg_flag</entry>
                                <entry>
<para>flag to generate a background with value -1. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Bimage* binary mask. <literallayout><computeroutput>The local variance within a kernel is calculated and used to generate the mask.
A threshold is calculated to define the foreground and background.
Excluded regions are defined by a low variance parameter.
Foreground is set to 1, background is set to -1, excluded areas are set to 0.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1405 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ac78b4ad1046f5e78339620f7ac38309f"/>    <section>
    <title>variance_threshold()</title>
<indexterm><primary>variance_threshold</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>variance_threshold</secondary></indexterm>
<para><computeroutput>double Bimage::variance_threshold (double lowvar)</computeroutput></para><para>

<para>Calculates a threshold for a local variance image. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>lowvar</entry>
                                <entry>
<para>low variance threshold. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>double threshold. <literallayout><computeroutput>A threshold is calculated to define the foreground and background.
Excluded regions are defined by a low variance parameter.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1346 of file Bimage_mask.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a47314981f2e8b29a34b0eeba3f25e541"/>    <section>
    <title>vector3()</title>
<indexterm><primary>vector3</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>vector3</secondary></indexterm>
<para><computeroutput><link linkend="_class_vector3">Vector3</link>&lt; double &gt; Bimage::vector3 (long j)</computeroutput></para><para>

<para>Returns a 3-value vector at the given index. </para>
</para>

<para>
                <formalpara>
                    <title>
Parameters                    </title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
                                <entry>j</entry>
                                <entry>
<para>index. </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para><link linkend="_class_vector3">Vector3&lt;double&gt;</link> the 3-value vector. <literallayout><computeroutput>The index refers to compound values.
</computeroutput></literallayout> </para>
</formalpara>
</para>
<para>
Definition at line 1050 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1aa3c2b8af69df7f99b805f0e0a226e59d"/>    <section>
    <title>vector_to_simple()</title>
<indexterm><primary>vector_to_simple</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>vector_to_simple</secondary></indexterm>
<para><computeroutput>void Bimage::vector_to_simple ( )</computeroutput></para><para>

<para>A vector image is converted to a simple image. </para>
</para>

<para><literallayout><computeroutput>The new value for each voxel is the length of each vector.
</computeroutput></literallayout> </para>
<para>
Definition at line 4183 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1ab474ad5f14737ab4931c0171a5d95579"/>    <section>
    <title>view()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>view</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>view</secondary></indexterm>
<para><computeroutput>void Bimage::view (double vx, double vy, double vz, double va)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 600 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1ab13be5e642f025a863a9ac1a50d75ab9"/>    <section>
    <title>view()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>view</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>view</secondary></indexterm>
<para><computeroutput>void Bimage::view (<link linkend="_class_view">View</link> vw)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 601 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1af38e5d5dbc312e6ee7f56a7c962e62d5"/>    <section>
    <title>voxel_size()</title>
<indexterm><primary>voxel_size</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>voxel_size</secondary></indexterm>
<para><computeroutput>double Bimage::voxel_size ( )<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 509 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a3e84daec20bb95e8212c96f06e308de5"/>    <section>
    <title>within_boundaries()<computeroutput>[1/2]</computeroutput></title>
<indexterm><primary>within_boundaries</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>within_boundaries</secondary></indexterm>
<para><computeroutput>bool Bimage::within_boundaries (long xx, long yy, long zz)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 465 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1af5185f2ed4cc550d97a5520280de9b48"/>    <section>
    <title>within_boundaries()<computeroutput>[2/2]</computeroutput></title>
<indexterm><primary>within_boundaries</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>within_boundaries</secondary></indexterm>
<computeroutput>template&lt;typename T &gt; </computeroutput><para><computeroutput>bool Bimage::within_boundaries (<link linkend="_class_vector3">Vector3</link>&lt; T &gt; loc)<computeroutput>[inline]</computeroutput></computeroutput></para><para>
Definition at line 460 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a3acc3a092a8e100f263dbf6625863b72"/>    <section>
    <title>write()</title>
<indexterm><primary>write</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>write</secondary></indexterm>
<para><computeroutput>int Bimage::write (<link linkend="_class_bstring">Bstring</link> &amp; fn)</computeroutput></para><para>
Definition at line 2395 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a7c09597809c7610566d5615cf9dbfca1"/>    <section>
    <title>zero_fourier_origin()</title>
<indexterm><primary>zero_fourier_origin</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>zero_fourier_origin</secondary></indexterm>
<para><computeroutput>void Bimage::zero_fourier_origin ( )</computeroutput></para><para>

<para>Zeroes the first voxel in each image. </para>
</para>
<para>
Definition at line 2070 of file Bimage.cpp.</para>
    </section><anchor xml:id="_class_bimage_1a32b57fc3c6d4e3ea245b11686bf4c8ae"/>    <section>
    <title>zero_origin()</title>
<indexterm><primary>zero_origin</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>zero_origin</secondary></indexterm>
<para><computeroutput>int Bimage::zero_origin ( )</computeroutput></para><para>

<para>Shifts the origins to zero with wrapping. </para>
</para>

<para><formalpara><title>Returns</title>

<para>int error code. </para>
</formalpara>
</para>
<para>
Definition at line 722 of file Bimage_transform.cpp.</para>
</section>
</section>
<section>
<title>Member Data Documentation</title>
<anchor xml:id="_class_bimage_1a4c3d90a7e963c8fb653f825eb139b045"/>    <section>
    <title>image</title>
<indexterm><primary>image</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>image</secondary></indexterm>
<para><computeroutput><link linkend="_class_bsub__image">Bsub_image</link>* Bimage::image</computeroutput></para><para>
Definition at line 186 of file Bimage.h.</para>
    </section><anchor xml:id="_class_bimage_1a0195ccc461a1a7c1170461211e66f103"/>    <section>
    <title>next</title>
<indexterm><primary>next</primary><secondary>Bimage</secondary></indexterm>
<indexterm><primary>Bimage</primary><secondary>next</secondary></indexterm>
<para><computeroutput><link linkend="_class_bimage">Bimage</link>* Bimage::next</computeroutput></para><para>
Definition at line 163 of file Bimage.h.</para>
</section>
<para>
The documentation for this class was generated from the following files:</para>
/Users/bernard/b20/bsoft/include/<link linkend="__bimage_8h">Bimage.h</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage_8cpp">Bimage.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__align_8cpp">Bimage_align.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__background_8cpp">Bimage_background.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__bin_8cpp">Bimage_bin.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__color_8cpp">Bimage_color.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__combine_8cpp">Bimage_combine.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__complex_8cpp">Bimage_complex.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__correlate_8cpp">Bimage_correlate.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__edit_8cpp">Bimage_edit.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__extract_8cpp">Bimage_extract.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__fft_8cpp">Bimage_fft.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__filter_8cpp">Bimage_filter.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__fspace_8cpp">Bimage_fspace.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__helix_8cpp">Bimage_helix.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__histogram_8cpp">Bimage_histogram.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__mask_8cpp">Bimage_mask.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__montage_8cpp">Bimage_montage.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__nad_8cpp">Bimage_nad.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__noise_8cpp">Bimage_noise.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__polar_8cpp">Bimage_polar.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__powerspectrum_8cpp">Bimage_powerspectrum.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__project_8cpp">Bimage_project.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__reconstruct_8cpp">Bimage_reconstruct.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__rescale_8cpp">Bimage_rescale.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__resize_8cpp">Bimage_resize.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__resolution_8cpp">Bimage_resolution.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__search_8cpp">Bimage_search.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__segment_8cpp">Bimage_segment.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__stats_8cpp">Bimage_stats.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__symmetry_8cpp">Bimage_symmetry.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__topo_8cpp">Bimage_topo.cpp</link>/Users/bernard/b20/bsoft/src/img/<link linkend="__bimage__transform_8cpp">Bimage_transform.cpp</link></section>
</section>
